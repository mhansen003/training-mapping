<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Lock Desk FAQs for Retail - Process Workflow</title>
    <link href="https://fonts.googleapis.com/css2?family=Plus+Jakarta+Sans:wght@400;500;600;700;800&family=JetBrains+Mono:wght@400;500&display=swap" rel="stylesheet">
    <style>
        :root {
            --bg-primary: #0a0f1a;
            --bg-secondary: #111827;
            --bg-card: #1a2234;
            --accent-blue: #3b82f6;
            --accent-teal: #14b8a6;
            --accent-amber: #f59e0b;
            --accent-rose: #f43f5e;
            --accent-green: #22c55e;
            --accent-purple: #8b5cf6;
            --text-primary: #f1f5f9;
            --text-secondary: #94a3b8;
            --text-muted: #64748b;
            --border-subtle: rgba(255,255,255,0.08);
            --sidebar-width: 280px;
        }

        * { box-sizing: border-box; margin: 0; padding: 0; }
        html { scroll-behavior: smooth; }
        body {
            font-family: 'Plus Jakarta Sans', -apple-system, BlinkMacSystemFont, sans-serif;
            background: var(--bg-primary);
            color: var(--text-primary);
            min-height: 100vh;
        }

        /* Breadcrumb */
        .breadcrumb {
            background: linear-gradient(90deg, #0d1525 0%, #1a2234 100%);
            padding: 14px 25px;
            display: flex;
            align-items: center;
            gap: 12px;
            font-size: 0.95rem;
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            z-index: 1001;
            border-bottom: 1px solid var(--border-subtle);
        }

        .breadcrumb a {
            color: var(--text-secondary);
            text-decoration: none;
            font-weight: 600;
            padding: 8px 16px;
            background: rgba(255,255,255,0.05);
            border-radius: 8px;
            transition: all 0.2s;
            border: 1px solid var(--border-subtle);
        }

        .breadcrumb a:hover {
            background: rgba(59, 130, 246, 0.15);
            color: var(--accent-blue);
            border-color: rgba(59, 130, 246, 0.3);
        }

        .breadcrumb .separator { color: var(--text-muted); font-size: 1.2rem; }
        .breadcrumb .current { color: var(--accent-amber); font-weight: 600; padding: 8px 16px; }

        /* Sidebar */
        .sidebar {
            position: fixed;
            top: 54px;
            left: 0;
            width: var(--sidebar-width);
            height: calc(100vh - 54px);
            background: var(--bg-secondary);
            overflow-y: auto;
            z-index: 1000;
            border-right: 1px solid var(--border-subtle);
            display: flex;
            flex-direction: column;
        }

        .sidebar-header {
            padding: 25px 20px;
            background: rgba(0,0,0,0.3);
            border-bottom: 1px solid var(--border-subtle);
        }

        .sidebar-header h2 { color: var(--text-primary); font-size: 1.2rem; font-weight: 700; margin-bottom: 5px; }
        .sidebar-header p { color: var(--text-muted); font-size: 0.85rem; }

        /* Tab Switch */
        .sidebar-tabs {
            display: flex;
            border-bottom: 1px solid var(--border-subtle);
        }

        .sidebar-tab {
            flex: 1;
            padding: 14px 10px;
            text-align: center;
            font-size: 0.8rem;
            font-weight: 700;
            color: var(--text-muted);
            cursor: pointer;
            transition: all 0.2s;
            border-bottom: 3px solid transparent;
            background: none;
            border-left: none;
            border-right: none;
            border-top: none;
        }

        .sidebar-tab:hover { background: rgba(255,255,255,0.03); color: var(--text-secondary); }
        .sidebar-tab.active { color: var(--accent-blue); border-bottom-color: var(--accent-blue); background: rgba(59, 130, 246, 0.08); }
        .sidebar-tab.agent-tab.active { color: var(--accent-purple); border-bottom-color: var(--accent-purple); background: rgba(139, 92, 246, 0.08); }

        .sidebar-nav { padding: 15px 0; flex: 1; overflow-y: auto; }

        .nav-item {
            display: flex;
            align-items: center;
            gap: 12px;
            padding: 14px 20px;
            color: var(--text-secondary);
            text-decoration: none;
            border-left: 3px solid transparent;
            transition: all 0.2s ease;
            cursor: pointer;
        }

        .nav-item:hover { background: rgba(255,255,255,0.03); color: var(--text-primary); }
        .nav-item.active { background: rgba(59, 130, 246, 0.1); border-left-color: var(--accent-blue); color: var(--text-primary); }

        .nav-number {
            background: rgba(255,255,255,0.1);
            color: var(--text-secondary);
            width: 28px;
            height: 28px;
            border-radius: 8px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 700;
            font-size: 0.85rem;
            flex-shrink: 0;
        }

        .nav-item.active .nav-number { background: var(--accent-blue); color: white; }
        .nav-label { font-size: 0.95rem; font-weight: 500; }

        .sidebar-footer {
            padding: 20px;
            border-top: 1px solid var(--border-subtle);
            background: rgba(0,0,0,0.2);
        }

        .doc-btn {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
            width: 100%;
            padding: 14px 20px;
            background: linear-gradient(135deg, var(--accent-blue) 0%, var(--accent-teal) 100%);
            color: white;
            border: none;
            border-radius: 10px;
            font-weight: 600;
            cursor: pointer;
            transition: transform 0.2s, box-shadow 0.2s;
            text-decoration: none;
            font-size: 0.95rem;
        }

        .doc-btn:hover { transform: translateY(-2px); box-shadow: 0 8px 25px rgba(59, 130, 246, 0.3); }

        /* Main Content */
        .main-content { margin-left: var(--sidebar-width); padding: 80px 40px 40px 40px; }

        /* Tab Panels */
        .tab-panel { display: none; }
        .tab-panel.active { display: block; }

        .header {
            background: var(--bg-card);
            border: 1px solid var(--border-subtle);
            padding: 35px;
            border-radius: 16px;
            margin-bottom: 30px;
            position: relative;
            overflow: hidden;
        }

        .header::before {
            content: '';
            position: absolute;
            top: 0; left: 0; right: 0; bottom: 0;
            background:
                radial-gradient(ellipse at 20% 20%, rgba(59, 130, 246, 0.1) 0%, transparent 50%),
                radial-gradient(ellipse at 80% 80%, rgba(20, 184, 166, 0.08) 0%, transparent 50%);
            pointer-events: none;
        }

        .header h1 {
            font-size: 2.2rem;
            font-weight: 800;
            margin-bottom: 10px;
            position: relative;
            background: linear-gradient(135deg, var(--text-primary) 0%, var(--accent-blue) 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .header .subtitle { color: var(--text-secondary); font-size: 1.1rem; position: relative; }

        .header .meta { display: flex; gap: 15px; margin-top: 20px; flex-wrap: wrap; position: relative; }

        .header .meta-item {
            background: rgba(255,255,255,0.05);
            border: 1px solid var(--border-subtle);
            padding: 8px 16px;
            border-radius: 8px;
            font-size: 0.9rem;
            color: var(--text-secondary);
        }

        /* Legend */
        .legend {
            display: flex;
            flex-wrap: wrap;
            gap: 15px;
            padding: 18px 22px;
            background: var(--bg-card);
            border: 1px solid var(--border-subtle);
            border-radius: 12px;
            margin-bottom: 25px;
        }

        .legend-item { display: flex; align-items: center; gap: 8px; font-size: 0.85rem; color: var(--text-secondary); }
        .legend-color { width: 18px; height: 18px; border-radius: 4px; }

        /* Sections */
        .section {
            background: var(--bg-card);
            border: 1px solid var(--border-subtle);
            border-radius: 16px;
            margin-bottom: 25px;
            overflow: hidden;
            scroll-margin-top: 75px;
        }

        .section-header {
            background: linear-gradient(135deg, var(--bg-secondary) 0%, rgba(59, 130, 246, 0.1) 100%);
            border-bottom: 1px solid var(--border-subtle);
            padding: 22px 25px;
            display: flex;
            align-items: center;
            gap: 18px;
        }

        .section-number {
            background: linear-gradient(135deg, var(--accent-blue) 0%, var(--accent-teal) 100%);
            color: white;
            width: 48px;
            height: 48px;
            border-radius: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 800;
            font-size: 1.3rem;
            flex-shrink: 0;
        }

        .section-title h2 { font-size: 1.35rem; font-weight: 700; margin-bottom: 4px; color: var(--text-primary); }
        .section-title span { font-size: 0.9rem; color: var(--text-muted); }
        .section-content { padding: 28px; }

        /* Tables */
        .field-table { width: 100%; border-collapse: collapse; margin: 18px 0; }

        .field-table th {
            background: rgba(59, 130, 246, 0.15);
            color: var(--accent-blue);
            padding: 14px 18px;
            text-align: left;
            font-weight: 600;
            font-size: 0.9rem;
            text-transform: uppercase;
            letter-spacing: 0.05em;
            border-bottom: 1px solid var(--border-subtle);
        }

        .field-table td { padding: 14px 18px; border-bottom: 1px solid var(--border-subtle); color: var(--text-secondary); }
        .field-table tr:hover { background: rgba(255,255,255,0.02); }

        .badge { display: inline-block; padding: 4px 12px; border-radius: 6px; font-size: 0.75rem; font-weight: 700; text-transform: uppercase; letter-spacing: 0.05em; }
        .badge.required-badge { background: rgba(244, 63, 94, 0.15); color: var(--accent-rose); }
        .badge.optional-badge { background: rgba(34, 197, 94, 0.15); color: var(--accent-green); }
        .badge.calculated-badge { background: rgba(59, 130, 246, 0.15); color: var(--accent-blue); }

        /* Info Boxes */
        .exception-box, .tip-box, .info-box {
            padding: 18px 22px;
            margin: 18px 0;
            border-radius: 0 10px 10px 0;
            border-left-width: 4px;
            border-left-style: solid;
        }

        .exception-box { background: rgba(244, 63, 94, 0.08); border-color: var(--accent-rose); border: 1px solid rgba(244, 63, 94, 0.2); border-left: 4px solid var(--accent-rose); }
        .exception-box h4 { color: var(--accent-rose); margin-bottom: 10px; font-size: 1rem; }
        .exception-box p, .exception-box li { color: var(--text-secondary); }

        .tip-box { background: rgba(34, 197, 94, 0.08); border-color: var(--accent-green); border: 1px solid rgba(34, 197, 94, 0.2); border-left: 4px solid var(--accent-green); }
        .tip-box h4 { color: var(--accent-green); margin-bottom: 10px; font-size: 1rem; }
        .tip-box p, .tip-box li { color: var(--text-secondary); }

        .info-box { background: rgba(59, 130, 246, 0.08); border-color: var(--accent-blue); border: 1px solid rgba(59, 130, 246, 0.2); border-left: 4px solid var(--accent-blue); }
        .info-box h4 { color: var(--accent-blue); margin-bottom: 10px; font-size: 1rem; }
        .info-box p, .info-box li { color: var(--text-secondary); }

        /* Summary Grid */
        .summary-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(180px, 1fr)); gap: 18px; margin: 22px 0; }

        .summary-card { background: rgba(0,0,0,0.3); border: 1px solid var(--border-subtle); border-radius: 12px; padding: 22px; text-align: center; }
        .summary-card h4 { color: var(--text-secondary); margin-bottom: 12px; font-size: 0.9rem; }
        .summary-card .value {
            font-size: 2.2rem;
            font-weight: 800;
            background: linear-gradient(135deg, var(--accent-blue) 0%, var(--accent-teal) 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }
        .summary-card .label { font-size: 0.85rem; color: var(--text-muted); margin-top: 8px; }

        /* Contact Cards */
        .contact-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(280px, 1fr)); gap: 20px; margin: 22px 0; }

        .contact-card { background: rgba(0,0,0,0.2); border: 1px solid var(--border-subtle); border-radius: 12px; overflow: hidden; }
        .contact-card-header { background: linear-gradient(135deg, var(--accent-blue) 0%, var(--accent-teal) 100%); color: white; padding: 18px; text-align: center; }
        .contact-card-header h4 { font-size: 1.05rem; }
        .contact-card-body { padding: 22px; }
        .contact-card ul { list-style: none; padding: 0; }
        .contact-card li { padding: 10px 0; border-bottom: 1px solid var(--border-subtle); display: flex; align-items: center; gap: 12px; color: var(--text-secondary); font-size: 0.95rem; }
        .contact-card li:last-child { border-bottom: none; }

        /* Step List */
        .step-list { list-style: none; padding: 0; margin: 18px 0; }
        .step-list li {
            padding: 14px 18px;
            border-left: 3px solid var(--accent-blue);
            background: rgba(0,0,0,0.2);
            margin-bottom: 10px;
            border-radius: 0 8px 8px 0;
            color: var(--text-secondary);
        }
        .step-list li strong { color: var(--text-primary); }

        /* Quick Reference */
        .quick-ref {
            background: linear-gradient(135deg, var(--bg-secondary) 0%, var(--bg-card) 100%);
            border: 1px solid var(--border-subtle);
            padding: 28px;
            border-radius: 16px;
            margin-top: 30px;
            font-family: 'JetBrains Mono', monospace;
            scroll-margin-top: 75px;
        }

        .quick-ref h3 { color: var(--accent-amber); margin-bottom: 18px; font-family: 'Plus Jakarta Sans', sans-serif; }
        .quick-ref pre { background: rgba(0,0,0,0.4); border: 1px solid var(--border-subtle); padding: 20px; border-radius: 10px; overflow-x: auto; font-size: 0.85rem; line-height: 1.7; color: var(--text-secondary); }

        /* ====== AGENT OPPORTUNITIES STYLES ====== */
        .agent-header {
            background: var(--bg-card);
            border: 1px solid var(--border-subtle);
            padding: 35px;
            border-radius: 16px;
            margin-bottom: 30px;
            position: relative;
            overflow: hidden;
        }

        .agent-header::before {
            content: '';
            position: absolute;
            top: 0; left: 0; right: 0; bottom: 0;
            background:
                radial-gradient(ellipse at 20% 20%, rgba(139, 92, 246, 0.12) 0%, transparent 50%),
                radial-gradient(ellipse at 80% 80%, rgba(245, 158, 11, 0.1) 0%, transparent 50%);
            pointer-events: none;
        }

        .agent-header h1 {
            font-size: 2.2rem;
            font-weight: 800;
            margin-bottom: 10px;
            position: relative;
            background: linear-gradient(135deg, var(--accent-purple) 0%, var(--accent-amber) 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .agent-header .subtitle { color: var(--text-secondary); font-size: 1.1rem; position: relative; }

        /* Heat Map */
        .heatmap-container { margin-bottom: 35px; }
        .heatmap-title { font-size: 1.3rem; font-weight: 700; color: var(--text-primary); margin-bottom: 20px; display: flex; align-items: center; gap: 12px; }

        .heatmap-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
        }

        .heat-item {
            background: var(--bg-card);
            border: 1px solid var(--border-subtle);
            border-radius: 12px;
            padding: 20px;
            position: relative;
            overflow: hidden;
            transition: transform 0.2s, box-shadow 0.2s;
            cursor: pointer;
        }

        .heat-item:hover { transform: translateY(-3px); box-shadow: 0 10px 30px rgba(0,0,0,0.3); }
        .heat-item:active { transform: scale(0.98); }

        .heat-item::before {
            content: '';
            position: absolute;
            top: 0; left: 0; right: 0; height: 4px;
        }

        .heat-item.critical::before { background: linear-gradient(90deg, #ef4444, #f97316); }
        .heat-item.high::before { background: linear-gradient(90deg, #f97316, #eab308); }
        .heat-item.medium::before { background: linear-gradient(90deg, #eab308, #22c55e); }
        .heat-item.low::before { background: linear-gradient(90deg, #22c55e, #14b8a6); }

        .heat-score {
            position: absolute;
            top: 15px;
            right: 15px;
            font-size: 1.8rem;
            font-weight: 800;
        }

        .heat-item.critical .heat-score { color: #ef4444; }
        .heat-item.high .heat-score { color: #f97316; }
        .heat-item.medium .heat-score { color: #eab308; }
        .heat-item.low .heat-score { color: #22c55e; }

        .heat-name { font-size: 1rem; font-weight: 700; color: var(--text-primary); margin-bottom: 6px; padding-right: 50px; }
        .heat-desc { font-size: 0.85rem; color: var(--text-muted); margin-bottom: 12px; }

        .heat-metrics { display: flex; gap: 15px; margin-top: 12px; }
        .heat-metric { font-size: 0.75rem; color: var(--text-muted); }
        .heat-metric span { color: var(--text-secondary); font-weight: 600; }

        /* Agent Cards */
        .agent-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(380px, 1fr)); gap: 25px; margin-bottom: 35px; }

        .agent-card {
            background: var(--bg-card);
            border: 1px solid var(--border-subtle);
            border-radius: 16px;
            overflow: hidden;
            transition: transform 0.2s, box-shadow 0.2s;
        }

        .agent-card:hover { transform: translateY(-5px); box-shadow: 0 15px 50px rgba(0,0,0,0.3); }

        .agent-card.highlight {
            animation: highlightPulse 2s ease;
            box-shadow: 0 0 0 3px var(--accent-purple), 0 15px 50px rgba(139, 92, 246, 0.4);
        }

        @keyframes highlightPulse {
            0% { box-shadow: 0 0 0 3px var(--accent-purple), 0 15px 50px rgba(139, 92, 246, 0.6); }
            50% { box-shadow: 0 0 0 6px rgba(139, 92, 246, 0.5), 0 15px 50px rgba(139, 92, 246, 0.3); }
            100% { box-shadow: 0 0 0 0px transparent, 0 15px 50px rgba(0,0,0,0.3); }
        }

        .agent-card-header {
            padding: 22px;
            display: flex;
            align-items: flex-start;
            gap: 18px;
            border-bottom: 1px solid var(--border-subtle);
        }

        .agent-icon {
            width: 55px;
            height: 55px;
            background: linear-gradient(135deg, var(--accent-purple) 0%, var(--accent-blue) 100%);
            border-radius: 14px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.6rem;
            flex-shrink: 0;
        }

        .agent-info { flex: 1; }
        .agent-name { font-size: 1.15rem; font-weight: 700; color: var(--text-primary); margin-bottom: 5px; }
        .agent-type { font-size: 0.8rem; color: var(--accent-purple); font-weight: 600; text-transform: uppercase; letter-spacing: 0.05em; }

        .agent-priority {
            padding: 6px 12px;
            border-radius: 20px;
            font-size: 0.75rem;
            font-weight: 700;
            text-transform: uppercase;
        }

        .agent-priority.critical { background: rgba(239, 68, 68, 0.15); color: #ef4444; }
        .agent-priority.high { background: rgba(249, 115, 22, 0.15); color: #f97316; }
        .agent-priority.medium { background: rgba(234, 179, 8, 0.15); color: #eab308; }
        .agent-priority.low { background: rgba(34, 197, 94, 0.15); color: #22c55e; }

        .agent-card-body { padding: 22px; }
        .agent-description { font-size: 0.95rem; color: var(--text-secondary); line-height: 1.6; margin-bottom: 20px; }

        .agent-flow {
            background: rgba(0,0,0,0.3);
            border: 1px solid var(--border-subtle);
            border-radius: 10px;
            padding: 18px;
            margin-bottom: 20px;
        }

        .agent-flow-title { font-size: 0.85rem; color: var(--text-muted); margin-bottom: 12px; font-weight: 600; text-transform: uppercase; letter-spacing: 0.05em; }

        .agent-flow-diagram { display: flex; align-items: center; flex-wrap: wrap; gap: 8px; justify-content: center; }

        .agent-step {
            background: linear-gradient(135deg, var(--accent-purple) 0%, var(--accent-blue) 100%);
            color: white;
            padding: 8px 14px;
            border-radius: 6px;
            font-size: 0.8rem;
            font-weight: 600;
            white-space: nowrap;
        }

        .agent-arrow { color: var(--accent-purple); font-size: 1.2rem; }

        .agent-stats { display: grid; grid-template-columns: repeat(3, 1fr); gap: 12px; }

        .agent-stat {
            background: rgba(0,0,0,0.2);
            border-radius: 8px;
            padding: 12px;
            text-align: center;
        }

        .agent-stat-value {
            font-size: 1.3rem;
            font-weight: 800;
            background: linear-gradient(135deg, var(--accent-purple) 0%, var(--accent-amber) 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .agent-stat-label { font-size: 0.7rem; color: var(--text-muted); text-transform: uppercase; letter-spacing: 0.05em; margin-top: 4px; }

        /* View Prompt Button */
        .agent-prompt-btn {
            width: 100%;
            margin-top: 18px;
            padding: 14px 20px;
            background: linear-gradient(135deg, rgba(139, 92, 246, 0.2) 0%, rgba(59, 130, 246, 0.2) 100%);
            border: 1px solid rgba(139, 92, 246, 0.4);
            border-radius: 10px;
            color: var(--accent-purple);
            font-weight: 700;
            cursor: pointer;
            transition: all 0.2s;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
            font-size: 0.9rem;
        }

        .agent-prompt-btn:hover {
            background: linear-gradient(135deg, rgba(139, 92, 246, 0.3) 0%, rgba(59, 130, 246, 0.3) 100%);
            border-color: var(--accent-purple);
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(139, 92, 246, 0.25);
        }

        /* Summary Stats */
        .agent-summary {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin-bottom: 35px;
        }

        .agent-summary-card {
            background: var(--bg-card);
            border: 1px solid var(--border-subtle);
            border-radius: 14px;
            padding: 25px;
            text-align: center;
        }

        .agent-summary-value {
            font-size: 2.5rem;
            font-weight: 800;
            background: linear-gradient(135deg, var(--accent-purple) 0%, var(--accent-amber) 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .agent-summary-label { font-size: 0.9rem; color: var(--text-muted); margin-top: 8px; }

        /* Heat Map Legend */
        .heat-legend {
            display: flex;
            gap: 25px;
            padding: 18px 22px;
            background: var(--bg-card);
            border: 1px solid var(--border-subtle);
            border-radius: 12px;
            margin-bottom: 25px;
            flex-wrap: wrap;
        }

        .heat-legend-item { display: flex; align-items: center; gap: 10px; font-size: 0.9rem; color: var(--text-secondary); }
        .heat-legend-color { width: 24px; height: 24px; border-radius: 6px; }

        /* Modal */
        .modal-overlay {
            display: none;
            position: fixed;
            top: 0; left: 0; right: 0; bottom: 0;
            background: rgba(10, 15, 26, 0.9);
            z-index: 2000;
            justify-content: center;
            align-items: center;
            padding: 20px;
            backdrop-filter: blur(5px);
        }

        .modal-overlay.show { display: flex; }

        .modal {
            background: var(--bg-card);
            border: 1px solid var(--border-subtle);
            border-radius: 16px;
            width: 100%;
            max-width: 950px;
            max-height: 90vh;
            display: flex;
            flex-direction: column;
            box-shadow: 0 25px 80px rgba(0,0,0,0.5);
        }

        .modal-header {
            background: linear-gradient(135deg, var(--accent-blue) 0%, var(--accent-teal) 100%);
            color: white;
            padding: 22px 28px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            border-radius: 16px 16px 0 0;
        }

        .modal-header h3 { font-size: 1.25rem; font-weight: 700; }
        .modal-actions { display: flex; gap: 12px; }

        .modal-btn {
            padding: 10px 18px;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-weight: 700;
            transition: transform 0.2s;
            font-size: 0.9rem;
        }

        .modal-btn:hover { transform: scale(1.05); }
        .modal-btn.copy { background: white; color: var(--accent-blue); }
        .modal-btn.close { background: rgba(255,255,255,0.2); color: white; }

        .modal-body { padding: 28px; overflow-y: auto; flex: 1; }

        .modal-body pre {
            background: rgba(0,0,0,0.3);
            border: 1px solid var(--border-subtle);
            padding: 22px;
            border-radius: 10px;
            font-family: 'JetBrains Mono', monospace;
            font-size: 0.9rem;
            line-height: 1.7;
            white-space: pre-wrap;
            word-wrap: break-word;
            color: var(--text-secondary);
        }

        .copy-success {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: var(--accent-green);
            color: white;
            padding: 18px 35px;
            border-radius: 10px;
            font-weight: 700;
            z-index: 3000;
            display: none;
            animation: fadeInOut 2s ease;
        }

        @keyframes fadeInOut { 0%, 100% { opacity: 0; } 10%, 90% { opacity: 1; } }

        /* Prompt Modal */
        .prompt-modal .modal { max-width: 800px; }
        .prompt-modal .modal-header { background: linear-gradient(135deg, var(--accent-purple) 0%, var(--accent-blue) 100%); }

        .prompt-section { margin-bottom: 25px; }
        .prompt-section h4 { color: var(--accent-purple); font-size: 1rem; margin-bottom: 12px; display: flex; align-items: center; gap: 8px; }

        .prompt-box {
            background: rgba(0,0,0,0.4);
            border: 1px solid var(--border-subtle);
            border-radius: 10px;
            padding: 20px;
            font-family: 'JetBrains Mono', monospace;
            font-size: 0.85rem;
            line-height: 1.7;
            color: var(--text-secondary);
            white-space: pre-wrap;
            word-wrap: break-word;
        }

        .prompt-tags { display: flex; gap: 10px; flex-wrap: wrap; margin-bottom: 20px; }
        .prompt-tag { background: rgba(139, 92, 246, 0.15); color: var(--accent-purple); padding: 6px 14px; border-radius: 20px; font-size: 0.8rem; font-weight: 600; }

        @media (max-width: 900px) {
            .sidebar { display: none; }
            .main-content { margin-left: 0; padding: 75px 20px 30px 20px; }
            .agent-grid { grid-template-columns: 1fr; }
        }
    </style>
</head>
<body>
    <!-- Breadcrumb -->
    <nav class="breadcrumb">
        <a href="../../index.html">Portal Home</a>
        <span class="separator">></span>
        <a href="./index.html">Optimal Blue</a>
        <span class="separator">></span>
        <span class="current">Lock Desk FAQs for Retail</span>
    </nav>

    <!-- Fixed Sidebar -->
    <aside class="sidebar">
        <div class="sidebar-header">
            <h2>Lock Desk FAQs</h2>
            <p>Retail Workflow Guide</p>
        </div>

        <!-- Tab Switcher -->
        <div class="sidebar-tabs">
            <button class="sidebar-tab active" onclick="switchTab('workflow')">Workflow</button>
            <button class="sidebar-tab agent-tab" onclick="switchTab('agents')">AI Agents</button>
        </div>

        <!-- Workflow Navigation -->
        <nav class="sidebar-nav" id="workflow-nav">
            <a href="#section-1" class="nav-item active">
                <span class="nav-number">1</span>
                <span class="nav-label">Hours of Operations</span>
            </a>
            <a href="#section-2" class="nav-item">
                <span class="nav-number">2</span>
                <span class="nav-label">Pricing & Rate Sheets</span>
            </a>
            <a href="#section-3" class="nav-item">
                <span class="nav-number">3</span>
                <span class="nav-label">Specialty Locks</span>
            </a>
            <a href="#section-4" class="nav-item">
                <span class="nav-number">4</span>
                <span class="nav-label">OB Self-Service</span>
            </a>
            <a href="#section-5" class="nav-item">
                <span class="nav-number">5</span>
                <span class="nav-label">Lock Desk Requests</span>
            </a>
            <a href="#section-6" class="nav-item">
                <span class="nav-number">6</span>
                <span class="nav-label">General FAQs</span>
            </a>
            <a href="#section-7" class="nav-item">
                <span class="nav-number">7</span>
                <span class="nav-label">Bonds & HFA FAQs</span>
            </a>
            <a href="#section-8" class="nav-item">
                <span class="nav-number">8</span>
                <span class="nav-label">Non-Agency FAQs</span>
            </a>
            <a href="#quick-ref" class="nav-item">
                <span class="nav-number">*</span>
                <span class="nav-label">Quick Reference</span>
            </a>
        </nav>

        <!-- Agent Navigation -->
        <nav class="sidebar-nav" id="agents-nav" style="display: none;">
            <a href="#agent-summary" class="nav-item active">
                <span class="nav-number">S</span>
                <span class="nav-label">Summary</span>
            </a>
            <a href="#agent-heatmap" class="nav-item">
                <span class="nav-number">H</span>
                <span class="nav-label">Heat Map</span>
            </a>
            <a href="#agent-details" class="nav-item">
                <span class="nav-number">A</span>
                <span class="nav-label">Agent Details</span>
            </a>
        </nav>

        <div class="sidebar-footer">
            <button class="doc-btn" onclick="window.print()">
                Print Document
            </button>
        </div>
    </aside>

    <!-- Main Content -->
    <main class="main-content">

        <!-- ==================== WORKFLOW TAB ==================== -->
        <div id="workflowPanel" class="tab-panel active">
            <!-- Header -->
            <div class="header">
                <h1>CMG Retail Lock Desk FAQ</h1>
                <p class="subtitle">Complete guide for locking operations, pricing, and Lock Desk support for Retail channels</p>
                <div class="meta">
                    <span class="meta-item">System: Optimal Blue</span>
                    <span class="meta-item">Role: Loan Officer / Loan Team</span>
                    <span class="meta-item">Updated: April 7, 2025</span>
                    <span class="meta-item">Phone: 925-983-3223</span>
                </div>
            </div>

            <!-- Legend -->
            <div class="legend">
                <div class="legend-item"><div class="legend-color" style="background: linear-gradient(135deg, #22c55e, #16a34a);"></div><span>Self-Service in OB</span></div>
                <div class="legend-item"><div class="legend-color" style="background: linear-gradient(135deg, #3b82f6, #2563eb);"></div><span>Lock Desk Assisted</span></div>
                <div class="legend-item"><div class="legend-color" style="background: linear-gradient(135deg, #f59e0b, #d97706);"></div><span>Manual Process</span></div>
                <div class="legend-item"><div class="legend-color" style="background: linear-gradient(135deg, #f43f5e, #dc2626);"></div><span>Not Handled by Lock Desk</span></div>
            </div>

            <!-- Section 1: Hours of Operations -->
            <section id="section-1" class="section">
                <div class="section-header">
                    <div class="section-number">1</div>
                    <div class="section-title"><h2>Hours of Operations</h2><span>Locking hours and support availability by product type</span></div>
                </div>
                <div class="section-content">
                    <table class="field-table">
                        <thead>
                            <tr>
                                <th>Product Type</th>
                                <th>Locking Hours (PST)</th>
                                <th>Notes</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td><strong>Agency Programs</strong></td>
                                <td>7:00am - 11:59pm</td>
                                <td><span class="badge calculated-badge">Extended Hours</span></td>
                            </tr>
                            <tr>
                                <td><strong>Jumbo/Non-Agency/Near Miss Alt-A/Non-QM</strong></td>
                                <td>8:45am - 4:00pm</td>
                                <td>Jumbo Express & Solar Express end at 3:30pm PST</td>
                            </tr>
                            <tr>
                                <td><strong>AIO Loans</strong></td>
                                <td>8:00am - 4:00pm</td>
                                <td><span class="badge required-badge">Manual Lock</span></td>
                            </tr>
                            <tr>
                                <td><strong>HFA Bond</strong></td>
                                <td>8:00am - 4:00pm</td>
                                <td><span class="badge required-badge">Manual Lock</span></td>
                            </tr>
                            <tr>
                                <td><strong>Chenoa and Buyers Choice</strong></td>
                                <td>8:30am - 1:00pm</td>
                                <td>Limited hours</td>
                            </tr>
                        </tbody>
                    </table>

                    <div class="info-box">
                        <h4>Lock Desk General Support Hours</h4>
                        <p><strong>Monday - Friday: 5:00am - 6:30pm Pacific Time</strong></p>
                        <p style="margin-top: 10px;">The preferred method of communication is via email. For urgent requests after email submission, call 925-983-3223.</p>
                    </div>

                    <div class="tip-box">
                        <h4>Email Subject Line Best Practice</h4>
                        <p>Include the following in your email subject:</p>
                        <ul style="margin-top: 10px; margin-left: 20px;">
                            <li>Borrower's last name</li>
                            <li>Complete loan number with prefix (RWE, RNW, RSR)</li>
                            <li>Nature of request (Lock Extension, Program Change)</li>
                            <li>Loan program or product type (Conventional, Jumbo, 101, Non-QM, etc.)</li>
                        </ul>
                    </div>

                    <div class="contact-grid">
                        <div class="contact-card">
                            <div class="contact-card-header"><h4>Email Contacts</h4></div>
                            <div class="contact-card-body">
                                <ul>
                                    <li><strong>RetailLockDesk@cmgfi.com</strong> - Agency, Extended Locks, AIO, General Pricing</li>
                                    <li><strong>BondLocks@cmgfi.com</strong> - Bond/HFA Products</li>
                                    <li><strong>NonAgencyLocks@cmgfi.com</strong> - Jumbo, Non-Agency, Non-QM, CMG 2nds</li>
                                </ul>
                            </div>
                        </div>
                        <div class="contact-card">
                            <div class="contact-card-header"><h4>Phone Support</h4></div>
                            <div class="contact-card-body">
                                <ul>
                                    <li><strong>925-983-3223</strong> - Retail Lock Desk Line (General)</li>
                                    <li><strong>925-983-3230</strong> - Non-Agency/Non-QM Urgent Line</li>
                                </ul>
                            </div>
                        </div>
                    </div>
                </div>
            </section>

            <!-- Section 2: Pricing and Rate Sheets -->
            <section id="section-2" class="section">
                <div class="section-header">
                    <div class="section-number">2</div>
                    <div class="section-title"><h2>Pricing and Rate Sheets</h2><span>Product types and lock support routing</span></div>
                </div>
                <div class="section-content">
                    <table class="field-table">
                        <thead>
                            <tr>
                                <th>Product Type</th>
                                <th>Price/Lock in OB?</th>
                                <th>Lock Related Support</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td><strong>Agency Conventional and Government</strong></td>
                                <td><span class="badge optional-badge">Yes</span></td>
                                <td>RetailLockDesk@cmgfi.com</td>
                            </tr>
                            <tr>
                                <td><strong>PLS Program</strong></td>
                                <td><span class="badge optional-badge">Yes</span></td>
                                <td>RetailLockDesk@cmgfi.com</td>
                            </tr>
                            <tr>
                                <td><strong>All-In-One (AIO)</strong></td>
                                <td><span class="badge required-badge">No</span></td>
                                <td>RetailLockDesk@cmgfi.com</td>
                            </tr>
                            <tr>
                                <td><strong>Jumbo/Non Agency</strong></td>
                                <td><span class="badge optional-badge">Yes</span></td>
                                <td>NonAgencyLocks@cmgfi.com</td>
                            </tr>
                            <tr>
                                <td><strong>Non-QM (Sharp, Horizon, Prime, Advantage, Connect, Edge, River)</strong></td>
                                <td><span class="badge optional-badge">Yes</span></td>
                                <td>NonAgencyLocks@cmgfi.com</td>
                            </tr>
                            <tr>
                                <td><strong>Near Miss & Alt-A</strong></td>
                                <td><span class="badge required-badge">No</span></td>
                                <td>NonAgencyLocks@cmgfi.com</td>
                            </tr>
                            <tr>
                                <td><strong>Community Lending (Classic & Plus)</strong></td>
                                <td><span class="badge optional-badge">Yes</span></td>
                                <td>NonAgencyLocks@cmgfi.com</td>
                            </tr>
                            <tr>
                                <td><strong>CMG 2nds or HELOCs</strong></td>
                                <td><span class="badge required-badge">No</span></td>
                                <td>NonAgencyLocks@cmgfi.com</td>
                            </tr>
                            <tr>
                                <td><strong>Premier CES</strong></td>
                                <td><span class="badge required-badge">No</span></td>
                                <td>NonAgencyLocks@cmgfi.com</td>
                            </tr>
                            <tr>
                                <td><strong>Med Pro Advantage</strong></td>
                                <td><span class="badge optional-badge">Yes</span></td>
                                <td>NonAgencyLocks@cmgfi.com</td>
                            </tr>
                            <tr>
                                <td><strong>FHA Buyers Choice</strong></td>
                                <td><span class="badge optional-badge">Yes</span></td>
                                <td>BondLocks@cmgfi.com</td>
                            </tr>
                            <tr>
                                <td><strong>All Bond programs (incl. Chenoa)</strong></td>
                                <td><span class="badge required-badge">No</span></td>
                                <td>BondLocks@cmgfi.com</td>
                            </tr>
                            <tr>
                                <td><strong>Figure</strong></td>
                                <td><span class="badge required-badge">No</span></td>
                                <td>N/a - determined by Figure</td>
                            </tr>
                            <tr>
                                <td><strong>Flex HELOC</strong></td>
                                <td><span class="badge required-badge">No</span></td>
                                <td>loflexhelocsupport@cmghomeloans.com</td>
                            </tr>
                            <tr>
                                <td><strong>Renovation (203K, Choice, Homestyle)</strong></td>
                                <td><span class="badge optional-badge">Yes</span></td>
                                <td>RetailLockDesk@cmgfi.com</td>
                            </tr>
                            <tr>
                                <td><strong>Construction 2X Close (Agency & Jumbo)</strong></td>
                                <td><span class="badge required-badge">No</span></td>
                                <td>RetailLockDesk@cmgfi.com</td>
                            </tr>
                            <tr>
                                <td><strong>Jumbo Renovation</strong></td>
                                <td><span class="badge required-badge">No</span></td>
                                <td>RetailLockDesk@cmgfi.com</td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </section>

            <!-- Section 3: Specialty Locks -->
            <section id="section-3" class="section">
                <div class="section-header">
                    <div class="section-number">3</div>
                    <div class="section-title"><h2>Specialty Locks</h2><span>Special lock programs and policies</span></div>
                </div>
                <div class="section-content">
                    <div class="summary-grid">
                        <div class="summary-card">
                            <h4>Lock N Shop</h4>
                            <div class="value">LNS</div>
                            <div class="label">Policy & Procedure</div>
                        </div>
                        <div class="summary-card">
                            <h4>List & Lock</h4>
                            <div class="value">L&L</div>
                            <div class="label">Policy & Procedure</div>
                        </div>
                        <div class="summary-card">
                            <h4>Rate Rebound</h4>
                            <div class="value">RR</div>
                            <div class="label">Policy & Workflow</div>
                        </div>
                        <div class="summary-card">
                            <h4>Spec Lock</h4>
                            <div class="value">SL</div>
                            <div class="label">Policy & Procedure</div>
                        </div>
                    </div>

                    <div class="info-box">
                        <h4>Available Resources</h4>
                        <ul style="margin-top: 10px; margin-left: 20px;">
                            <li>Lock N Shop Policy & Procedure</li>
                            <li>List & Lock Policy and Procedure (with Resources)</li>
                            <li>Rate Rebound Policy & Workflow</li>
                            <li>Bond Lock Policy</li>
                            <li>HELOC/2nds Lock Request Form</li>
                            <li>Spec Lock Policy and Procedure</li>
                        </ul>
                    </div>
                </div>
            </section>

            <!-- Section 4: OB Self-Service -->
            <section id="section-4" class="section">
                <div class="section-header">
                    <div class="section-number">4</div>
                    <div class="section-title"><h2>OB Self-Service Functions</h2><span>Requests/Functions LOs and Loan Teams can process within Optimal Blue</span></div>
                </div>
                <div class="section-content">
                    <ul class="step-list">
                        <li><strong>Locking:</strong> Lock new loans directly in Optimal Blue</li>
                        <li><strong>Relocking:</strong> Relock expired locks through the system</li>
                        <li><strong>Extending a lock:</strong> Request lock extensions via Change Request icon</li>
                        <li><strong>Floating down:</strong> One-time float down on Agency loans</li>
                        <li><strong>Locked loan parameter changes:</strong> Loan Amount, Appraised Value, Property Type, etc.</li>
                        <li><strong>Switching loan programs:</strong> Change between Conventional/FHA/Jumbo</li>
                        <li><strong>Concession request:</strong> Submit concession requests</li>
                        <li><strong>Viewing pricing/rate options:</strong> View rate stack from original lock date</li>
                    </ul>

                    <div class="tip-box">
                        <h4>How to Use Change Request</h4>
                        <p>Access Optimal Blue through Byte/Clear, click the <strong>Change Request</strong> icon, and select the appropriate radio button (Lock Extension, Profile Change, Relock, or Float Down). For full instructions, refer to the Optimal Blue Pricing Manual.</p>
                    </div>
                </div>
            </section>

            <!-- Section 5: Lock Desk Requests -->
            <section id="section-5" class="section">
                <div class="section-header">
                    <div class="section-number">5</div>
                    <div class="section-title"><h2>Lock Desk Requests</h2><span>Requests that require Lock Desk assistance</span></div>
                </div>
                <div class="section-content">
                    <h3 style="color: var(--accent-blue); margin-bottom: 15px;">Processed by Lock Desk</h3>
                    <ul class="step-list">
                        <li><strong>Price quotes</strong> not available directly through the system</li>
                        <li><strong>Locking assistance</strong> for complex scenarios</li>
                        <li><strong>Lock Extension Help</strong></li>
                        <li><strong>Floatdowns</strong> not available directly through the system</li>
                        <li><strong>Relocks</strong></li>
                        <li><strong>Temporary Buydown Selection</strong></li>
                        <li><strong>Manual locks</strong> for AIO, CMG 2nds, Near Miss, Chenoa, Bonds/HFA products</li>
                        <li><strong>Loan parameter changes</strong> for AIO, CMG 2nds, Near Miss, Chenoa, Bonds/HFA products</li>
                        <li><strong>Lock transfers</strong></li>
                        <li><strong>Applying approved concessions</strong></li>
                    </ul>

                    <div class="exception-box">
                        <h4>NOT Handled by Lock Desk</h4>
                        <ul style="margin-top: 10px; margin-left: 20px;">
                            <li><strong>Changes on unlocked loans</strong> - Contact your Processor or Processing Manager</li>
                            <li><strong>Updating branch, loan officer, or lead type</strong> - Contact Red Team (red@cmgfi.com)</li>
                            <li><strong>Product assistance for non-standard scenarios</strong> - Retail Scenario desk or ProductHelp@cmgfi.com</li>
                            <li><strong>Clear or Byte login issues</strong> - AppSupport@cmgfi.com</li>
                            <li><strong>Workflow and Data Entry support</strong> - salestraining@cmgfi.com</li>
                            <li><strong>Adding origination fees</strong> (non-Smartfees) - Contact your Disclosure team lead</li>
                        </ul>
                    </div>
                </div>
            </section>

            <!-- Section 6: General FAQs -->
            <section id="section-6" class="section">
                <div class="section-header">
                    <div class="section-number">6</div>
                    <div class="section-title"><h2>General FAQs</h2><span>Common questions about locking and pricing</span></div>
                </div>
                <div class="section-content">
                    <div class="info-box">
                        <h4>Q: How do I extend my lock? How much does it cost?</h4>
                        <p>Lock extensions for most loans can be completed via Optimal Blue using the <strong>Change Request</strong> icon and selecting the <strong>Lock Extension</strong> radio button. The cost for Agency and Jumbo lock extension is <strong>0.02 per day</strong>.</p>
                    </div>

                    <div class="info-box">
                        <h4>Q: Does CMG offer overnight price protection?</h4>
                        <p><strong>Yes.</strong> Users should notify the lock desk via email <strong>prior to 8:30AM EST</strong> to hold pricing for the previous day. Then lock the loan in the system and contact the lock desk via email to adjust the pricing to the previous day.</p>
                    </div>

                    <div class="info-box">
                        <h4>Q: How do I change loan parameters on my locked loan?</h4>
                        <p>Changes to locked loans can be processed through Optimal Blue's <strong>Profile Change Request</strong> feature. Select the Change Request icon, choose 'Profile Change', make the necessary changes to your loan amount, appraised value, etc., and proceed with the changes.</p>
                    </div>

                    <div class="info-box">
                        <h4>Q: I need to switch my loan from Fannie to Freddie or Conv to FHA. How do I do it?</h4>
                        <p>Use the <strong>Profile Change Request</strong> feature. Choose Profile Change, review the loan parameters, select the appropriate Loan Type, hit Submit, and you should see eligible products and pricing. Hit the lock icon and proceed with the change.</p>
                    </div>

                    <div class="info-box">
                        <h4>Q: My lock expired. How do I relock?</h4>
                        <p>Relocks can be performed through the system by accessing OB through Byte/Clear for Agency and Jumbo products. Select the <strong>Change Request</strong> icon and then the radio button to <strong>Relock</strong>.</p>
                    </div>

                    <div class="info-box">
                        <h4>Q: Rates have improved since I locked. Can I float down?</h4>
                        <p><strong>Yes.</strong> CMG offers a one-time float down option on Agency loans. Float down requests can be completed through the system via Byte/Clear. Select the Change Request icon and then the radio button to Float Down. Refer to the Lock Policy (page 5) for additional information.</p>
                    </div>

                    <div class="tip-box">
                        <h4>Net Lender Credit vs. General Lender Credit</h4>
                        <p><strong>Net Lender Credit:</strong> A price improvement adjustment typically used to lower discount points. Can also be used toward borrower's closing costs when price is above par.</p>
                        <p style="margin-top: 10px;"><strong>General Lender Credit:</strong> A lump sum lender credit itemized on the LE and CD. Once disclosed, it <strong>cannot be reduced or removed</strong>.</p>
                    </div>

                    <div class="info-box">
                        <h4>Q: I cannot find this product in Optimal Blue. How do I price it?</h4>
                        <p>Some products are handled manually. Contact the appropriate lock desk inbox:</p>
                        <ul style="margin-top: 10px; margin-left: 20px;">
                            <li><strong>AIO's</strong> - RetailLockDesk@cmgfi.com</li>
                            <li><strong>Bond/HFA products</strong> - BondLocks@cmgfi.com</li>
                            <li><strong>Chenoa</strong> - BondLocks@cmgfi.com</li>
                            <li><strong>CMG 2nds</strong> - NonAgencyLocks@cmgfi.com</li>
                            <li><strong>Near Miss and Alt A</strong> - NonAgencyLocks@cmgfi.com</li>
                        </ul>
                    </div>

                    <div class="exception-box">
                        <h4>Q: I would like to lock my AIO loan. How do I lock it?</h4>
                        <p>AIO products must be in <strong>UW Approved status</strong> prior to locking. Once approved, email RetailLockDesk@cmgfi.com with the loan number, borrower's last name, and the desired margin.</p>
                    </div>
                </div>
            </section>

            <!-- Section 7: Bonds and HFA FAQs -->
            <section id="section-7" class="section">
                <div class="section-header">
                    <div class="section-number">7</div>
                    <div class="section-title"><h2>Bonds and HFA Products FAQs</h2><span>Bond lock procedures and helpful tips</span></div>
                </div>
                <div class="section-content">
                    <div class="info-box">
                        <h4>Q: I have a bond lock. How do I get it locked in the system?</h4>
                        <p>If you have the commitment completed from the HFA site, email <strong>BondLocks@cmgfi.com</strong> with the commitment confirmation along with the loan #. The desk will lock the loan in the LOS system.</p>
                    </div>

                    <div class="info-box">
                        <h4>Q: I need to extend my bond lock.</h4>
                        <p>Lock desk (BondLocks@cmgfi.com) requires an <strong>updated lock commitment from the HFA</strong> showing that the lock has been extended. This can be the lock commitment with new expiration date, email from bond agency, or extension form approved by the agency.</p>
                    </div>

                    <div class="info-box">
                        <h4>Q: Why do I not get the same lock expiration as the one on my commitment?</h4>
                        <p>CMG adds time for <strong>delivery and settlement</strong> to each lock.</p>
                    </div>

                    <div class="exception-box">
                        <h4>Bond Lock Delays - Common Causes</h4>
                        <ul style="margin-top: 10px; margin-left: 20px;">
                            <li>When locking with 1st, 2nd and 3rd loan, make sure the 2nd and 3rd are created in Byte and already synchronized</li>
                            <li>Confirm HFA reservation is for the <strong>total loan amount</strong>, not base loan amount (account for MIP)</li>
                            <li>Ensure accuracy on property information (street address, city, zip code)</li>
                            <li>Attach a <strong>PDF of the actual commitment confirmation</strong> from the HFA site, not just a screenshot</li>
                        </ul>
                    </div>

                    <div class="tip-box">
                        <h4>Bond Lock Best Practice</h4>
                        <p>Provide base and total loan amount for the lock desk to prevent back and forth. If there is a discrepancy between Byte figures and the HFA reservation, lock desk will ask for correction before updating the system.</p>
                    </div>
                </div>
            </section>

            <!-- Section 8: Non-Agency/Non-QM FAQs -->
            <section id="section-8" class="section">
                <div class="section-header">
                    <div class="section-number">8</div>
                    <div class="section-title"><h2>Non-Agency/Non-QM FAQs</h2><span>Jumbo, Non-QM, and specialty product questions</span></div>
                </div>
                <div class="section-content">
                    <div class="info-box">
                        <h4>Q: What is the cutoff for locking a Jumbo/Non Agency/Non-QM loan in the system?</h4>
                        <p><strong>4:00pm PT</strong> for most Jumbo and Non Agency products.</p>
                    </div>

                    <div class="info-box">
                        <h4>Q: I just requested a lock for a Non QM CMG product. Why isn't it reflecting locked in Byte/Clear yet?</h4>
                        <p>The Non Agency Lock Desk has to review these requests to assure all necessary fields are correctly selected. Due to the complexity of these products (doc type options, DSCR, DTI, etc.), we want to ensure data accuracy across all systems (Byte/OB/Clear).</p>
                    </div>

                    <div class="info-box">
                        <h4>Q: I cannot get pricing, and I keep getting disqualifiers. What can I do?</h4>
                        <p>Find the product you are trying to lock and hit the <strong>show button</strong> to the far right of that disqualifier to see what is preventing you from getting pricing. Clear the disqualifier by correcting the information causing the hard stop.</p>
                    </div>

                    <div class="info-box">
                        <h4>Q: I cannot price this loan because the FICO, Loan amount or LTV does not fit within guidelines. How do I get pricing?</h4>
                        <p>If an exception is being requested with a specific investor via producthelp@cmgfi.com or Underwriter, the lock desk can send you pricing manually once confirmed. Provide evidence of <strong>written exception approval</strong> from Product help or the underwriter.</p>
                    </div>

                    <div class="info-box">
                        <h4>Q: How do I price a DSCR Foreign National with no FICO and no Social Security #?</h4>
                        <p>Use a <strong>680 FICO</strong> to price out the loan and select <strong>Foreign National</strong> in the drop down.</p>
                    </div>

                    <div class="exception-box">
                        <h4>Q: Are float downs allowed on Non-Agency loans?</h4>
                        <p><strong>Chase</strong> is the only investor currently who allows a floatdown, and it must be requested with them first before CMG can allow.</p>
                    </div>

                    <div class="exception-box">
                        <h4>Q: Can you lock at the current market rate after a lock has been expired for 30 days?</h4>
                        <p><strong>No.</strong> Non-Agency locks can be locked at current market after being expired for <strong>60 days</strong>.</p>
                    </div>

                    <div class="exception-box">
                        <h4>Q: Can my loan be locked for 10 days?</h4>
                        <p><strong>No.</strong> The 10-day lock option is not allowed for any Non-Agency/Jumbo products.</p>
                    </div>

                    <div class="tip-box">
                        <h4>Non-QM Doc Type Guidance</h4>
                        <p>Our training team has put together informational guidance on what to enter in the system for the specific doc type for Non QM product selections. If you're having issues or getting disqualifiers in Optimal Blue, reach out to <strong>NonAgencyLocks@cmgfi.com</strong> with a screenshot of the error.</p>
                    </div>
                </div>
            </section>

            <!-- Quick Reference -->
            <div id="quick-ref" class="quick-ref">
                <h3>Lock Desk Quick Reference</h3>
                <pre>
LOCK DESK CONTACT SUMMARY
=========================

EMAIL CONTACTS:
RetailLockDesk@cmgfi.com  - Agency, AIO, Extended Locks, General Pricing, Renovation
BondLocks@cmgfi.com       - Bond/HFA, Chenoa, FHA Buyers Choice
NonAgencyLocks@cmgfi.com  - Jumbo, Non-Agency, Non-QM, CMG 2nds, Near Miss, Alt-A

PHONE CONTACTS:
925-983-3223              - Retail Lock Desk Line (General)
925-983-3230              - Non-Agency/Non-QM Urgent Line

LOCKING HOURS (PST):
Agency Programs           - 7:00am - 11:59pm
Jumbo/Non-Agency/Non-QM   - 8:45am - 4:00pm (Jumbo/Solar Express: 3:30pm)
AIO Loans                 - 8:00am - 4:00pm
HFA Bond                  - 8:00am - 4:00pm
Chenoa/Buyers Choice      - 8:30am - 1:00pm

LOCK DESK SUPPORT HOURS:
Monday - Friday           - 5:00am - 6:30pm Pacific Time

SELF-SERVICE IN OPTIMAL BLUE:
- Locking / Relocking
- Lock Extensions (0.02/day for Agency/Jumbo)
- Float Downs (Agency only - one time)
- Profile Changes (Loan Amount, Appraised Value, Property Type)
- Program Changes (Conv/FHA/Jumbo)
- Concession Requests
- View Rate Options

LOCK DESK ASSISTANCE REQUIRED:
- Manual locks (AIO, CMG 2nds, Near Miss, Chenoa, Bonds/HFA)
- Lock transfers
- Temporary Buydown Selection
- Approved concessions
- Floatdowns not in system
- Price quotes not in system

NOT HANDLED BY LOCK DESK:
- Changes on unlocked loans -> Processor/Processing Manager
- Branch/LO/Lead Type updates -> Red Team (red@cmgfi.com)
- Product scenarios -> ProductHelp@cmgfi.com
- Login issues -> AppSupport@cmgfi.com
- Workflow/Data Entry -> salestraining@cmgfi.com

KEY POLICIES:
- Overnight Price Protection: Email before 8:30AM EST
- AIO Locks: Must be UW Approved status first
- Bond Locks: Attach PDF commitment (not screenshot)
- Non-Agency Relocks: Current market after 60 days expired
- 10-day locks: Not allowed for Non-Agency/Jumbo

LINKS AND RESOURCES:
- Retail Lock Policy
- Extended Rate Lock Procedure (pages 8-9)
- CMG Guidelines
- Optimal Blue Pricing Manual
- Bond and E-Housing Programs and Guidelines
- Lender Credit Procedure / Policy / Request Form
- Competitive Price Match Request Form
                </pre>
            </div>
        </div>

        <!-- ==================== AI AGENTS TAB ==================== -->
        <div id="agentsPanel" class="tab-panel">
            <!-- Agent Header -->
            <div class="agent-header">
                <h1>AI Agent Opportunities</h1>
                <p class="subtitle">Automation opportunities identified for the Lock Desk FAQ process</p>
            </div>

            <!-- Summary Stats -->
            <div class="agent-summary" id="agent-summary">
                <div class="agent-summary-card">
                    <div class="agent-summary-value">4</div>
                    <div class="agent-summary-label">Agent Opportunities</div>
                </div>
                <div class="agent-summary-card">
                    <div class="agent-summary-value">65%</div>
                    <div class="agent-summary-label">Automation Potential</div>
                </div>
                <div class="agent-summary-card">
                    <div class="agent-summary-value">12 min</div>
                    <div class="agent-summary-label">Est. Time Saved</div>
                </div>
                <div class="agent-summary-card">
                    <div class="agent-summary-value">High</div>
                    <div class="agent-summary-label">Process Impact</div>
                </div>
            </div>

            <!-- Heat Map Legend -->
            <div class="heat-legend">
                <div class="heat-legend-item">
                    <div class="heat-legend-color" style="background: linear-gradient(90deg, #ef4444, #f97316);"></div>
                    <span>Critical Priority (9-10)</span>
                </div>
                <div class="heat-legend-item">
                    <div class="heat-legend-color" style="background: linear-gradient(90deg, #f97316, #eab308);"></div>
                    <span>High Priority (7-8)</span>
                </div>
                <div class="heat-legend-item">
                    <div class="heat-legend-color" style="background: linear-gradient(90deg, #eab308, #22c55e);"></div>
                    <span>Medium Priority (5-6)</span>
                </div>
                <div class="heat-legend-item">
                    <div class="heat-legend-color" style="background: linear-gradient(90deg, #22c55e, #14b8a6);"></div>
                    <span>Low Priority (1-4)</span>
                </div>
            </div>

            <!-- Heat Map Grid -->
            <div class="heatmap-container" id="agent-heatmap">
                <div class="heatmap-title">Priority Heat Map by Section</div>
                <div class="heatmap-grid">
                    <div class="heat-item critical" onclick="scrollToAgent('agent-lockrouter')">
                        <div class="heat-score">9.0</div>
                        <div class="heat-name">Lock Request Router</div>
                        <div class="heat-desc">Auto-route lock requests to correct desk based on product type</div>
                        <div class="heat-metrics">
                            <div class="heat-metric">Time: <span>5 min</span></div>
                            <div class="heat-metric">Complexity: <span>Medium</span></div>
                        </div>
                    </div>
                    <div class="heat-item high" onclick="scrollToAgent('agent-extensioncalc')">
                        <div class="heat-score">8.2</div>
                        <div class="heat-name">Extension Calculator</div>
                        <div class="heat-desc">Calculate lock extension costs and auto-submit requests</div>
                        <div class="heat-metrics">
                            <div class="heat-metric">Time: <span>3 min</span></div>
                            <div class="heat-metric">Complexity: <span>Low</span></div>
                        </div>
                    </div>
                    <div class="heat-item high" onclick="scrollToAgent('agent-pricingassist')">
                        <div class="heat-score">7.8</div>
                        <div class="heat-name">Pricing Assistant</div>
                        <div class="heat-desc">Identify pricing disqualifiers and suggest corrections</div>
                        <div class="heat-metrics">
                            <div class="heat-metric">Time: <span>4 min</span></div>
                            <div class="heat-metric">Complexity: <span>Medium</span></div>
                        </div>
                    </div>
                    <div class="heat-item medium" onclick="scrollToAgent('agent-bondvalidator')">
                        <div class="heat-score">6.5</div>
                        <div class="heat-name">Bond Lock Validator</div>
                        <div class="heat-desc">Validate bond commitment data before submission</div>
                        <div class="heat-metrics">
                            <div class="heat-metric">Time: <span>2 min</span></div>
                            <div class="heat-metric">Complexity: <span>Low</span></div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Agent Details -->
            <div id="agent-details">
                <h2 style="color: var(--text-primary); margin-bottom: 25px; font-size: 1.5rem;">Agent Details</h2>
                <div class="agent-grid">
                    <!-- Lock Request Router Agent -->
                    <div class="agent-card" id="agent-lockrouter">
                        <div class="agent-card-header">
                            <div class="agent-icon">R</div>
                            <div class="agent-info">
                                <div class="agent-name">Lock Request Router</div>
                                <div class="agent-type">Intelligent Routing / Classification</div>
                            </div>
                            <span class="agent-priority critical">Critical</span>
                        </div>
                        <div class="agent-card-body">
                            <p class="agent-description">Automatically analyzes incoming lock requests and routes them to the correct lock desk email based on product type, ensuring faster processing and reducing misdirected requests.</p>
                            <div class="agent-flow">
                                <div class="agent-flow-title">Agent Flow</div>
                                <div class="agent-flow-diagram">
                                    <span class="agent-step">Receive Request</span>
                                    <span class="agent-arrow">-></span>
                                    <span class="agent-step">Classify Product</span>
                                    <span class="agent-arrow">-></span>
                                    <span class="agent-step">Route to Desk</span>
                                    <span class="agent-arrow">-></span>
                                    <span class="agent-step">Confirm Receipt</span>
                                </div>
                            </div>
                            <div class="agent-stats">
                                <div class="agent-stat">
                                    <div class="agent-stat-value">5 min</div>
                                    <div class="agent-stat-label">Time Saved</div>
                                </div>
                                <div class="agent-stat">
                                    <div class="agent-stat-value">95%</div>
                                    <div class="agent-stat-label">Accuracy</div>
                                </div>
                                <div class="agent-stat">
                                    <div class="agent-stat-value">Med</div>
                                    <div class="agent-stat-label">Complexity</div>
                                </div>
                            </div>
                            <button class="agent-prompt-btn" onclick="showAgentPrompt('lockrouter')">
                                View Build Prompt
                            </button>
                        </div>
                    </div>

                    <!-- Extension Calculator Agent -->
                    <div class="agent-card" id="agent-extensioncalc">
                        <div class="agent-card-header">
                            <div class="agent-icon">E</div>
                            <div class="agent-info">
                                <div class="agent-name">Extension Calculator</div>
                                <div class="agent-type">Calculation / Automation</div>
                            </div>
                            <span class="agent-priority high">High</span>
                        </div>
                        <div class="agent-card-body">
                            <p class="agent-description">Calculates lock extension costs based on product type and duration, auto-fills extension requests in Optimal Blue, and provides cost estimates before submission.</p>
                            <div class="agent-flow">
                                <div class="agent-flow-title">Agent Flow</div>
                                <div class="agent-flow-diagram">
                                    <span class="agent-step">Get Lock Details</span>
                                    <span class="agent-arrow">-></span>
                                    <span class="agent-step">Calculate Cost</span>
                                    <span class="agent-arrow">-></span>
                                    <span class="agent-step">Display Estimate</span>
                                    <span class="agent-arrow">-></span>
                                    <span class="agent-step">Submit Request</span>
                                </div>
                            </div>
                            <div class="agent-stats">
                                <div class="agent-stat">
                                    <div class="agent-stat-value">3 min</div>
                                    <div class="agent-stat-label">Time Saved</div>
                                </div>
                                <div class="agent-stat">
                                    <div class="agent-stat-value">99%</div>
                                    <div class="agent-stat-label">Accuracy</div>
                                </div>
                                <div class="agent-stat">
                                    <div class="agent-stat-value">Low</div>
                                    <div class="agent-stat-label">Complexity</div>
                                </div>
                            </div>
                            <button class="agent-prompt-btn" onclick="showAgentPrompt('extensioncalc')">
                                View Build Prompt
                            </button>
                        </div>
                    </div>

                    <!-- Pricing Assistant Agent -->
                    <div class="agent-card" id="agent-pricingassist">
                        <div class="agent-card-header">
                            <div class="agent-icon">P</div>
                            <div class="agent-info">
                                <div class="agent-name">Pricing Assistant</div>
                                <div class="agent-type">Analysis / Guidance</div>
                            </div>
                            <span class="agent-priority high">High</span>
                        </div>
                        <div class="agent-card-body">
                            <p class="agent-description">Analyzes pricing disqualifiers in Optimal Blue, identifies the root cause, and provides step-by-step guidance to resolve issues and get valid pricing for complex Non-QM and specialty products.</p>
                            <div class="agent-flow">
                                <div class="agent-flow-title">Agent Flow</div>
                                <div class="agent-flow-diagram">
                                    <span class="agent-step">Detect Disqualifier</span>
                                    <span class="agent-arrow">-></span>
                                    <span class="agent-step">Analyze Cause</span>
                                    <span class="agent-arrow">-></span>
                                    <span class="agent-step">Suggest Fix</span>
                                    <span class="agent-arrow">-></span>
                                    <span class="agent-step">Verify Pricing</span>
                                </div>
                            </div>
                            <div class="agent-stats">
                                <div class="agent-stat">
                                    <div class="agent-stat-value">4 min</div>
                                    <div class="agent-stat-label">Time Saved</div>
                                </div>
                                <div class="agent-stat">
                                    <div class="agent-stat-value">88%</div>
                                    <div class="agent-stat-label">Accuracy</div>
                                </div>
                                <div class="agent-stat">
                                    <div class="agent-stat-value">Med</div>
                                    <div class="agent-stat-label">Complexity</div>
                                </div>
                            </div>
                            <button class="agent-prompt-btn" onclick="showAgentPrompt('pricingassist')">
                                View Build Prompt
                            </button>
                        </div>
                    </div>

                    <!-- Bond Lock Validator Agent -->
                    <div class="agent-card" id="agent-bondvalidator">
                        <div class="agent-card-header">
                            <div class="agent-icon">B</div>
                            <div class="agent-info">
                                <div class="agent-name">Bond Lock Validator</div>
                                <div class="agent-type">Validation / Data Quality</div>
                            </div>
                            <span class="agent-priority medium">Medium</span>
                        </div>
                        <div class="agent-card-body">
                            <p class="agent-description">Validates bond lock commitments before submission by checking loan amounts match (base vs total with MIP), property data accuracy, and ensuring proper documentation is attached.</p>
                            <div class="agent-flow">
                                <div class="agent-flow-title">Agent Flow</div>
                                <div class="agent-flow-diagram">
                                    <span class="agent-step">Parse Commitment</span>
                                    <span class="agent-arrow">-></span>
                                    <span class="agent-step">Validate Data</span>
                                    <span class="agent-arrow">-></span>
                                    <span class="agent-step">Check Docs</span>
                                    <span class="agent-arrow">-></span>
                                    <span class="agent-step">Report Issues</span>
                                </div>
                            </div>
                            <div class="agent-stats">
                                <div class="agent-stat">
                                    <div class="agent-stat-value">2 min</div>
                                    <div class="agent-stat-label">Time Saved</div>
                                </div>
                                <div class="agent-stat">
                                    <div class="agent-stat-value">96%</div>
                                    <div class="agent-stat-label">Accuracy</div>
                                </div>
                                <div class="agent-stat">
                                    <div class="agent-stat-value">Low</div>
                                    <div class="agent-stat-label">Complexity</div>
                                </div>
                            </div>
                            <button class="agent-prompt-btn" onclick="showAgentPrompt('bondvalidator')">
                                View Build Prompt
                            </button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </main>

    <!-- AI Prompt Modal -->
    <div class="modal-overlay prompt-modal" id="promptModal">
        <div class="modal">
            <div class="modal-header">
                <h3 id="promptModalTitle">AI Agent Build Prompt</h3>
                <div class="modal-actions">
                    <button class="modal-btn copy" onclick="copyPromptToClipboard()">Copy Prompt</button>
                    <button class="modal-btn close" onclick="closePromptModal()">Close</button>
                </div>
            </div>
            <div class="modal-body">
                <div class="prompt-tags" id="promptTags"></div>
                <div class="prompt-section">
                    <h4>Agent Purpose</h4>
                    <div class="prompt-box" id="promptPurpose"></div>
                </div>
                <div class="prompt-section">
                    <h4>Full Build Prompt</h4>
                    <div class="prompt-box" id="promptContent"></div>
                </div>
                <div class="prompt-section">
                    <h4>Integration Points</h4>
                    <div class="prompt-box" id="promptIntegration"></div>
                </div>
            </div>
        </div>
    </div>

    <div class="copy-success" id="copySuccess">Copied to clipboard!</div>

    <script>
        // Tab switching
        function switchTab(tab) {
            document.querySelectorAll('.sidebar-tab').forEach(t => t.classList.remove('active'));
            document.querySelectorAll('.tab-panel').forEach(p => p.classList.remove('active'));

            if (tab === 'workflow') {
                document.querySelector('.sidebar-tab:not(.agent-tab)').classList.add('active');
                document.getElementById('workflowPanel').classList.add('active');
                document.getElementById('workflow-nav').style.display = 'block';
                document.getElementById('agents-nav').style.display = 'none';
            } else {
                document.querySelector('.sidebar-tab.agent-tab').classList.add('active');
                document.getElementById('agentsPanel').classList.add('active');
                document.getElementById('workflow-nav').style.display = 'none';
                document.getElementById('agents-nav').style.display = 'block';
            }

            window.scrollTo(0, 0);
        }

        // Scroll spy with isScrolling flag and 1000ms timeout
        const sections = document.querySelectorAll('.section, .quick-ref');
        const navItems = document.querySelectorAll('#workflow-nav .nav-item');
        let isScrolling = false;
        let scrollTimeout;

        function updateActiveNav() {
            if (isScrolling) return;

            let current = '';
            sections.forEach(section => {
                const sectionTop = section.offsetTop - 100;
                if (window.scrollY >= sectionTop) current = section.getAttribute('id');
            });
            navItems.forEach(item => {
                item.classList.remove('active');
                if (item.getAttribute('href') === '#' + current) item.classList.add('active');
            });
        }

        // Handle nav click to temporarily disable scroll spy
        navItems.forEach(item => {
            item.addEventListener('click', function(e) {
                isScrolling = true;
                clearTimeout(scrollTimeout);

                // Remove active from all, add to clicked
                navItems.forEach(nav => nav.classList.remove('active'));
                this.classList.add('active');

                // Re-enable scroll spy after 1000ms
                scrollTimeout = setTimeout(() => {
                    isScrolling = false;
                }, 1000);
            });
        });

        window.addEventListener('scroll', updateActiveNav);

        document.addEventListener('keydown', (e) => { if (e.key === 'Escape') closePromptModal(); });

        document.addEventListener('DOMContentLoaded', () => { updateActiveNav(); });

        // Scroll to agent card and highlight
        function scrollToAgent(agentId) {
            const agentCard = document.getElementById(agentId);
            if (agentCard) {
                document.querySelectorAll('.agent-card.highlight').forEach(card => {
                    card.classList.remove('highlight');
                });

                agentCard.scrollIntoView({ behavior: 'smooth', block: 'center' });

                setTimeout(() => {
                    agentCard.classList.add('highlight');
                }, 300);

                setTimeout(() => {
                    agentCard.classList.remove('highlight');
                }, 2500);
            }
        }

        // Agent Prompt System
        const agentPrompts = {
            lockrouter: {
                name: 'Lock Request Router',
                tags: ['Intelligent Routing', 'Classification', 'Medium Complexity', 'Critical Priority'],
                purpose: `This agent automatically analyzes incoming lock requests and routes them to the correct lock desk email based on product type (Agency, Non-Agency, Bond), ensuring faster processing and reducing misdirected requests that cause delays.`,
                prompt: `You are building an Intelligent Routing Agent for CMG Financial's Lock Desk operations.

AGENT NAME: Lock Request Router
TYPE: Classification / Email Routing

OBJECTIVE:
Create an agent that automatically classifies lock-related emails and routes them to the correct lock desk based on product type and request nature.

INPUT DATA:
- Email subject line
- Email body content
- Loan number (extract from email)
- Product type keywords

CLASSIFICATION RULES:

1. RetailLockDesk@cmgfi.com:
   - Agency Conventional/Government
   - PLS Program
   - AIO Loans
   - Renovation (203K, Choice, Homestyle)
   - Construction 2X Close
   - General pricing questions

2. NonAgencyLocks@cmgfi.com:
   - Jumbo/Non Agency
   - Non-QM (Sharp, Horizon, Prime, Advantage, Connect, Edge, River)
   - Near Miss & Alt-A
   - Community Lending
   - CMG 2nds/HELOCs
   - Premier CES
   - Med Pro Advantage

3. BondLocks@cmgfi.com:
   - FHA Buyers Choice
   - All Bond programs
   - Chenoa
   - HFA products

KEYWORD DETECTION:
{
  "agency_keywords": ["conventional", "FHA", "VA", "USDA", "government", "agency"],
  "nonagency_keywords": ["jumbo", "non-qm", "DSCR", "near miss", "alt-a", "2nd", "HELOC"],
  "bond_keywords": ["bond", "HFA", "chenoa", "buyers choice", "DPA"]
}

OUTPUT:
{
  "classified_desk": "RetailLockDesk@cmgfi.com",
  "confidence": 0.95,
  "detected_product": "Agency Conventional",
  "loan_number": "RWE123456",
  "request_type": "Lock Extension"
}`,
                integration: `INTEGRATION POINTS:
1. Email System (Outlook/Exchange)
   - Monitor incoming emails to shared inbox
   - Parse subject and body
   - Forward to correct desk

2. Loan Origination System
   - Query loan number for product type validation
   - Cross-reference with OB product codes

3. Tracking Database
   - Log all routing decisions
   - Track accuracy metrics
   - Generate misroute reports

DEPLOYMENT:
- Triggered on new email arrival
- Sub-second classification
- Auto-forward with routing note`
            },
            extensioncalc: {
                name: 'Extension Calculator',
                tags: ['Calculation', 'Automation', 'Low Complexity', 'High Priority'],
                purpose: `This agent calculates lock extension costs based on product type and duration, displays cost estimates to users before submission, and auto-fills extension requests in Optimal Blue, reducing manual calculation errors.`,
                prompt: `You are building a Calculation Agent for CMG Financial's Lock Extension process.

AGENT NAME: Extension Calculator
TYPE: Calculation / Form Automation

OBJECTIVE:
Calculate lock extension costs and streamline the extension request process in Optimal Blue.

INPUT DATA:
- Current lock expiration date
- Requested new expiration date
- Product type (Agency, Jumbo, Non-QM, etc.)
- Current loan amount

CALCULATION RULES:

1. Agency and Jumbo Products:
   - Extension cost: 0.02% per day
   - Formula: loan_amount * 0.0002 * days_extended

2. Non-QM Products:
   - Extension cost: varies by investor
   - Default: 0.03% per day
   - Max extension: 30 days

3. Bond Products:
   - Must have HFA approval first
   - No direct cost calculation
   - Flag for manual processing

OUTPUT:
{
  "current_expiration": "2026-02-15",
  "new_expiration": "2026-02-25",
  "days_extended": 10,
  "extension_cost": 0.20,
  "cost_amount": "$400.00",
  "loan_amount": "$200,000",
  "product_type": "Agency Conventional",
  "auto_submit_eligible": true
}

UI DISPLAY:
- Show cost breakdown before submission
- Highlight if extension exceeds max allowed
- Confirm user intent before submission`,
                integration: `INTEGRATION POINTS:
1. Optimal Blue API
   - Read current lock details
   - Submit extension request
   - Retrieve confirmation

2. Byte/Clear LOS
   - Update lock expiration in loan file
   - Sync pricing changes

3. User Interface
   - Extension cost calculator widget
   - One-click extension submission
   - Confirmation notifications

DEPLOYMENT:
- Embedded in OB Change Request flow
- Instant cost calculation on date change
- Batch processing for multiple extensions`
            },
            pricingassist: {
                name: 'Pricing Assistant',
                tags: ['Analysis', 'Guidance', 'Medium Complexity', 'High Priority'],
                purpose: `This agent analyzes pricing disqualifiers in Optimal Blue, identifies the specific data causing the issue, and provides step-by-step guidance to resolve problems and get valid pricing, especially for complex Non-QM products.`,
                prompt: `You are building an Analysis Agent for CMG Financial's Optimal Blue pricing process.

AGENT NAME: Pricing Assistant
TYPE: Disqualifier Analysis / Guidance

OBJECTIVE:
Analyze OB pricing disqualifiers and provide actionable guidance to resolve issues and retrieve valid pricing.

INPUT DATA:
- Disqualifier message from OB
- Loan scenario data (LTV, FICO, DTI, etc.)
- Product type selected
- Doc type selected

COMMON DISQUALIFIERS AND RESOLUTIONS:

1. LTV Out of Range:
   - Check: loan_amount / appraised_value
   - Resolution: Adjust loan amount or verify appraisal
   - Alternative: Suggest different product tier

2. FICO Below Minimum:
   - Check: borrower credit score vs product minimum
   - Resolution: Select appropriate FICO tier
   - Alternative: Suggest product with lower FICO floor

3. DTI Exceeds Maximum:
   - Check: debt_to_income vs product limit
   - Resolution: Verify income or adjust debts
   - Alternative: Suggest product with higher DTI allowance

4. Doc Type Mismatch:
   - Common with Non-QM products
   - Resolution: Guide to correct doc type selection
   - Reference training guidance link

5. DSCR Not Calculated:
   - For investment property Non-QM
   - Resolution: Ensure rental income entered
   - Formula: PITIA / Rental Income

OUTPUT:
{
  "disqualifier": "LTV exceeds maximum for selected product",
  "root_cause": "LTV at 85% but product max is 80%",
  "current_values": {
    "loan_amount": "$425,000",
    "appraised_value": "$500,000",
    "ltv": "85%"
  },
  "resolutions": [
    "Reduce loan amount to $400,000 for 80% LTV",
    "Select product tier that allows 85% LTV",
    "Add subordinate financing if eligible"
  ],
  "alternative_products": ["Non-QM Prime 85", "Agency with MI"]
}`,
                integration: `INTEGRATION POINTS:
1. Optimal Blue API
   - Read disqualifier messages
   - Query loan scenario data
   - Test alternative scenarios

2. Product Guidelines Database
   - LTV/FICO/DTI matrices
   - Doc type requirements
   - Investor overlays

3. User Interface
   - Real-time disqualifier analysis
   - Step-by-step resolution wizard
   - One-click scenario testing

DEPLOYMENT:
- Triggered when disqualifier appears
- Inline guidance in OB interface
- Chat-based assistance option`
            },
            bondvalidator: {
                name: 'Bond Lock Validator',
                tags: ['Validation', 'Data Quality', 'Low Complexity', 'Medium Priority'],
                purpose: `This agent validates bond lock commitments before submission by checking loan amounts (base vs total with MIP), property data accuracy, document attachments, and 2nd/3rd lien synchronization, preventing common delays.`,
                prompt: `You are building a Validation Agent for CMG Financial's Bond Lock process.

AGENT NAME: Bond Lock Validator
TYPE: Data Validation / Quality Check

OBJECTIVE:
Validate bond lock commitment data before submission to prevent delays and back-and-forth with the lock desk.

VALIDATION CHECKS:

1. Loan Amount Validation:
   - Compare HFA commitment amount vs Byte total loan amount
   - Must account for MIP (Mortgage Insurance Premium)
   - Formula: base_loan + mip_amount = total_loan
   - Flag if discrepancy > $1

2. Property Data Validation:
   - Street address exact match
   - City name match (fuzzy OK)
   - State code match
   - ZIP code match
   - Flag any property mismatches

3. Multi-Loan Synchronization:
   - If 1st, 2nd, 3rd loans exist
   - Verify all created in Byte
   - Verify all synchronized
   - Flag unsynchronized loans

4. Document Validation:
   - Check for PDF commitment (not screenshot)
   - Verify file is readable
   - Check for HFA watermark/signature
   - Flag if only screenshot attached

5. Expiration Date Check:
   - Compare HFA expiration vs requested
   - Account for CMG delivery/settlement time
   - Warn if tight timeline

OUTPUT:
{
  "validation_status": "FAIL",
  "issues": [
    {
      "type": "LOAN_AMOUNT_MISMATCH",
      "severity": "HIGH",
      "details": "HFA commitment: $305,000, Byte total: $300,000",
      "resolution": "Update Byte to include $5,000 MIP amount"
    },
    {
      "type": "DOCUMENT_FORMAT",
      "severity": "MEDIUM",
      "details": "Attached file appears to be screenshot, not PDF commitment",
      "resolution": "Download and attach actual PDF from HFA site"
    }
  ],
  "ready_for_submission": false
}`,
                integration: `INTEGRATION POINTS:
1. Byte LOS
   - Read loan amounts (base, MIP, total)
   - Check 2nd/3rd lien status
   - Verify synchronization status

2. Document System
   - Analyze attached commitment files
   - Detect file type (PDF vs image)
   - Extract data from PDF if possible

3. HFA Data (if API available)
   - Cross-reference commitment data
   - Verify reservation status
   - Check expiration dates

4. User Interface
   - Pre-submission validation checklist
   - Issue highlights with resolutions
   - One-click data correction

DEPLOYMENT:
- Triggered before bond lock submission
- Real-time validation feedback
- Block submission if critical issues`
            }
        };

        // Show agent prompt modal
        let currentPromptContent = '';

        function showAgentPrompt(agentKey) {
            const agent = agentPrompts[agentKey];
            if (!agent) return;

            document.getElementById('promptModalTitle').textContent = agent.name + ' - Build Prompt';

            const tagsHtml = agent.tags.map(tag => '<span class="prompt-tag">' + tag + '</span>').join('');
            document.getElementById('promptTags').innerHTML = tagsHtml;

            document.getElementById('promptPurpose').textContent = agent.purpose;
            document.getElementById('promptContent').textContent = agent.prompt;
            document.getElementById('promptIntegration').textContent = agent.integration;

            currentPromptContent = '# ' + agent.name + '\n\n## Purpose\n' + agent.purpose + '\n\n## Build Prompt\n' + agent.prompt + '\n\n## Integration Points\n' + agent.integration;

            document.getElementById('promptModal').classList.add('show');
            document.body.style.overflow = 'hidden';
        }

        function closePromptModal() {
            document.getElementById('promptModal').classList.remove('show');
            document.body.style.overflow = '';
        }

        async function copyPromptToClipboard() {
            try {
                await navigator.clipboard.writeText(currentPromptContent);
                const success = document.getElementById('copySuccess');
                success.style.display = 'block';
                setTimeout(() => { success.style.display = 'none'; }, 2000);
            } catch (e) {
                alert('Failed to copy prompt.');
            }
        }

        document.getElementById('promptModal').addEventListener('click', (e) => {
            if (e.target.id === 'promptModal') closePromptModal();
        });
    </script>
</body>
</html>
