<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Lock Desk FAQs for JV Partners - Process Workflow</title>
    <link href="https://fonts.googleapis.com/css2?family=Plus+Jakarta+Sans:wght@400;500;600;700;800&family=JetBrains+Mono:wght@400;500&display=swap" rel="stylesheet">
    <style>
        :root {
            --bg-primary: #0a0f1a;
            --bg-secondary: #111827;
            --bg-card: #1a2234;
            --accent-blue: #3b82f6;
            --accent-teal: #14b8a6;
            --accent-amber: #f59e0b;
            --accent-rose: #f43f5e;
            --accent-green: #22c55e;
            --accent-purple: #8b5cf6;
            --text-primary: #f1f5f9;
            --text-secondary: #94a3b8;
            --text-muted: #64748b;
            --border-subtle: rgba(255,255,255,0.08);
            --sidebar-width: 280px;
        }

        * { box-sizing: border-box; margin: 0; padding: 0; }
        html { scroll-behavior: smooth; }
        body {
            font-family: 'Plus Jakarta Sans', -apple-system, BlinkMacSystemFont, sans-serif;
            background: var(--bg-primary);
            color: var(--text-primary);
            min-height: 100vh;
        }

        /* Breadcrumb */
        .breadcrumb {
            background: linear-gradient(90deg, #0d1525 0%, #1a2234 100%);
            padding: 14px 25px;
            display: flex;
            align-items: center;
            gap: 12px;
            font-size: 0.95rem;
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            z-index: 1001;
            border-bottom: 1px solid var(--border-subtle);
        }

        .breadcrumb a {
            color: var(--text-secondary);
            text-decoration: none;
            font-weight: 600;
            padding: 8px 16px;
            background: rgba(255,255,255,0.05);
            border-radius: 8px;
            transition: all 0.2s;
            border: 1px solid var(--border-subtle);
        }

        .breadcrumb a:hover {
            background: rgba(59, 130, 246, 0.15);
            color: var(--accent-blue);
            border-color: rgba(59, 130, 246, 0.3);
        }

        .breadcrumb .separator { color: var(--text-muted); font-size: 1.2rem; }
        .breadcrumb .current { color: var(--accent-amber); font-weight: 600; padding: 8px 16px; }

        /* Sidebar */
        .sidebar {
            position: fixed;
            top: 54px;
            left: 0;
            width: var(--sidebar-width);
            height: calc(100vh - 54px);
            background: var(--bg-secondary);
            overflow-y: auto;
            z-index: 1000;
            border-right: 1px solid var(--border-subtle);
            display: flex;
            flex-direction: column;
        }

        .sidebar-header {
            padding: 25px 20px;
            background: rgba(0,0,0,0.3);
            border-bottom: 1px solid var(--border-subtle);
        }

        .sidebar-header h2 { color: var(--text-primary); font-size: 1.2rem; font-weight: 700; margin-bottom: 5px; }
        .sidebar-header p { color: var(--text-muted); font-size: 0.85rem; }

        /* Tab Switch */
        .sidebar-tabs {
            display: flex;
            border-bottom: 1px solid var(--border-subtle);
        }

        .sidebar-tab {
            flex: 1;
            padding: 14px 10px;
            text-align: center;
            font-size: 0.8rem;
            font-weight: 700;
            color: var(--text-muted);
            cursor: pointer;
            transition: all 0.2s;
            border-bottom: 3px solid transparent;
            background: none;
            border-left: none;
            border-right: none;
            border-top: none;
        }

        .sidebar-tab:hover { background: rgba(255,255,255,0.03); color: var(--text-secondary); }
        .sidebar-tab.active { color: var(--accent-blue); border-bottom-color: var(--accent-blue); background: rgba(59, 130, 246, 0.08); }
        .sidebar-tab.agent-tab.active { color: var(--accent-purple); border-bottom-color: var(--accent-purple); background: rgba(139, 92, 246, 0.08); }

        .sidebar-nav { padding: 15px 0; flex: 1; overflow-y: auto; }

        .nav-item {
            display: flex;
            align-items: center;
            gap: 12px;
            padding: 14px 20px;
            color: var(--text-secondary);
            text-decoration: none;
            border-left: 3px solid transparent;
            transition: all 0.2s ease;
            cursor: pointer;
        }

        .nav-item:hover { background: rgba(255,255,255,0.03); color: var(--text-primary); }
        .nav-item.active { background: rgba(59, 130, 246, 0.1); border-left-color: var(--accent-blue); color: var(--text-primary); }

        .nav-number {
            background: rgba(255,255,255,0.1);
            color: var(--text-secondary);
            width: 28px;
            height: 28px;
            border-radius: 8px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 700;
            font-size: 0.85rem;
            flex-shrink: 0;
        }

        .nav-item.active .nav-number { background: var(--accent-blue); color: white; }
        .nav-label { font-size: 0.95rem; font-weight: 500; }

        .sidebar-footer {
            padding: 20px;
            border-top: 1px solid var(--border-subtle);
            background: rgba(0,0,0,0.2);
        }

        .doc-btn {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
            width: 100%;
            padding: 14px 20px;
            background: linear-gradient(135deg, var(--accent-blue) 0%, var(--accent-teal) 100%);
            color: white;
            border: none;
            border-radius: 10px;
            font-weight: 600;
            cursor: pointer;
            transition: transform 0.2s, box-shadow 0.2s;
            text-decoration: none;
            font-size: 0.95rem;
        }

        .doc-btn:hover { transform: translateY(-2px); box-shadow: 0 8px 25px rgba(59, 130, 246, 0.3); }

        /* Main Content */
        .main-content { margin-left: var(--sidebar-width); padding: 80px 40px 40px 40px; }

        /* Tab Panels */
        .tab-panel { display: none; }
        .tab-panel.active { display: block; }

        .header {
            background: var(--bg-card);
            border: 1px solid var(--border-subtle);
            padding: 35px;
            border-radius: 16px;
            margin-bottom: 30px;
            position: relative;
            overflow: hidden;
        }

        .header::before {
            content: '';
            position: absolute;
            top: 0; left: 0; right: 0; bottom: 0;
            background:
                radial-gradient(ellipse at 20% 20%, rgba(59, 130, 246, 0.1) 0%, transparent 50%),
                radial-gradient(ellipse at 80% 80%, rgba(20, 184, 166, 0.08) 0%, transparent 50%);
            pointer-events: none;
        }

        .header h1 {
            font-size: 2.2rem;
            font-weight: 800;
            margin-bottom: 10px;
            position: relative;
            background: linear-gradient(135deg, var(--text-primary) 0%, var(--accent-blue) 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .header .subtitle { color: var(--text-secondary); font-size: 1.1rem; position: relative; }

        .header .meta { display: flex; gap: 15px; margin-top: 20px; flex-wrap: wrap; position: relative; }

        .header .meta-item {
            background: rgba(255,255,255,0.05);
            border: 1px solid var(--border-subtle);
            padding: 8px 16px;
            border-radius: 8px;
            font-size: 0.9rem;
            color: var(--text-secondary);
        }

        /* Legend */
        .legend {
            display: flex;
            flex-wrap: wrap;
            gap: 15px;
            padding: 18px 22px;
            background: var(--bg-card);
            border: 1px solid var(--border-subtle);
            border-radius: 12px;
            margin-bottom: 25px;
        }

        .legend-item { display: flex; align-items: center; gap: 8px; font-size: 0.85rem; color: var(--text-secondary); }
        .legend-color { width: 18px; height: 18px; border-radius: 4px; }

        /* Sections */
        .section {
            background: var(--bg-card);
            border: 1px solid var(--border-subtle);
            border-radius: 16px;
            margin-bottom: 25px;
            overflow: hidden;
            scroll-margin-top: 75px;
        }

        .section-header {
            background: linear-gradient(135deg, var(--bg-secondary) 0%, rgba(59, 130, 246, 0.1) 100%);
            border-bottom: 1px solid var(--border-subtle);
            padding: 22px 25px;
            display: flex;
            align-items: center;
            gap: 18px;
        }

        .section-number {
            background: linear-gradient(135deg, var(--accent-blue) 0%, var(--accent-teal) 100%);
            color: white;
            width: 48px;
            height: 48px;
            border-radius: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 800;
            font-size: 1.3rem;
            flex-shrink: 0;
        }

        .section-title h2 { font-size: 1.35rem; font-weight: 700; margin-bottom: 4px; color: var(--text-primary); }
        .section-title span { font-size: 0.9rem; color: var(--text-muted); }
        .section-content { padding: 28px; }

        /* Workflow Diagrams */
        .workflow-diagram {
            background: rgba(0,0,0,0.3);
            border: 1px solid var(--border-subtle);
            border-radius: 12px;
            padding: 28px;
            margin-bottom: 22px;
        }

        .flow-row { display: flex; align-items: center; justify-content: center; flex-wrap: wrap; gap: 12px; margin: 15px 0; }

        .flow-node {
            padding: 14px 22px;
            border-radius: 10px;
            text-align: center;
            font-size: 0.9rem;
            font-weight: 600;
            min-width: 150px;
            border: 1px solid var(--border-subtle);
        }

        .flow-node.start { background: linear-gradient(135deg, var(--accent-green) 0%, #16a34a 100%); color: white; border-radius: 25px; border: none; }
        .flow-node.action { background: linear-gradient(135deg, var(--accent-blue) 0%, #2563eb 100%); color: white; border: none; }
        .flow-node.decision { background: linear-gradient(135deg, var(--accent-amber) 0%, #d97706 100%); color: var(--bg-primary); border: none; }
        .flow-node.input { background: var(--bg-secondary); border: 2px solid var(--accent-blue); color: var(--text-primary); }
        .flow-node.output { background: linear-gradient(135deg, var(--accent-teal) 0%, #0d9488 100%); color: white; border: none; }
        .flow-node.exception { background: linear-gradient(135deg, var(--accent-rose) 0%, #dc2626 100%); color: white; border: none; }

        .flow-arrow { color: var(--accent-blue); font-size: 1.5rem; }
        .flow-arrow.down { transform: rotate(90deg); }

        .decision-branch { display: flex; gap: 40px; justify-content: center; margin: 20px 0; flex-wrap: wrap; }
        .branch { display: flex; flex-direction: column; align-items: center; gap: 10px; }

        .branch-label {
            background: var(--bg-secondary);
            border: 1px solid var(--border-subtle);
            padding: 6px 16px;
            border-radius: 20px;
            font-size: 0.8rem;
            font-weight: 700;
            color: var(--text-secondary);
        }

        /* Tables */
        .field-table { width: 100%; border-collapse: collapse; margin: 18px 0; }

        .field-table th {
            background: rgba(59, 130, 246, 0.15);
            color: var(--accent-blue);
            padding: 14px 18px;
            text-align: left;
            font-weight: 600;
            font-size: 0.9rem;
            text-transform: uppercase;
            letter-spacing: 0.05em;
            border-bottom: 1px solid var(--border-subtle);
        }

        .field-table td { padding: 14px 18px; border-bottom: 1px solid var(--border-subtle); color: var(--text-secondary); }
        .field-table tr:hover { background: rgba(255,255,255,0.02); }

        .badge { display: inline-block; padding: 4px 12px; border-radius: 6px; font-size: 0.75rem; font-weight: 700; text-transform: uppercase; letter-spacing: 0.05em; }
        .badge.required-badge { background: rgba(244, 63, 94, 0.15); color: var(--accent-rose); }
        .badge.optional-badge { background: rgba(34, 197, 94, 0.15); color: var(--accent-green); }
        .badge.calculated-badge { background: rgba(59, 130, 246, 0.15); color: var(--accent-blue); }

        /* Info Boxes */
        .exception-box, .tip-box, .info-box {
            padding: 18px 22px;
            margin: 18px 0;
            border-radius: 0 10px 10px 0;
            border-left-width: 4px;
            border-left-style: solid;
        }

        .exception-box { background: rgba(244, 63, 94, 0.08); border-color: var(--accent-rose); border: 1px solid rgba(244, 63, 94, 0.2); border-left: 4px solid var(--accent-rose); }
        .exception-box h4 { color: var(--accent-rose); margin-bottom: 10px; font-size: 1rem; }
        .exception-box p, .exception-box li { color: var(--text-secondary); }

        .tip-box { background: rgba(34, 197, 94, 0.08); border-color: var(--accent-green); border: 1px solid rgba(34, 197, 94, 0.2); border-left: 4px solid var(--accent-green); }
        .tip-box h4 { color: var(--accent-green); margin-bottom: 10px; font-size: 1rem; }
        .tip-box p, .tip-box li { color: var(--text-secondary); }

        .info-box { background: rgba(59, 130, 246, 0.08); border-color: var(--accent-blue); border: 1px solid rgba(59, 130, 246, 0.2); border-left: 4px solid var(--accent-blue); }
        .info-box h4 { color: var(--accent-blue); margin-bottom: 10px; font-size: 1rem; }
        .info-box p, .info-box li { color: var(--text-secondary); }

        /* Decision Tree */
        .decision-tree {
            background: rgba(0,0,0,0.2);
            border: 1px solid var(--border-subtle);
            border-radius: 12px;
            padding: 22px;
            margin: 22px 0;
        }

        .decision-tree h3 { color: var(--accent-blue); margin-bottom: 18px; padding-bottom: 12px; border-bottom: 1px solid var(--border-subtle); font-size: 1.1rem; }

        .tree-node { margin-left: 20px; padding: 12px; border-left: 2px solid var(--accent-teal); position: relative; color: var(--text-secondary); }
        .tree-node::before { content: ''; position: absolute; left: -2px; top: 22px; width: 15px; height: 2px; background: var(--accent-teal); }
        .tree-node.level-1 { margin-left: 0; border-left: none; }
        .tree-node.level-1::before { display: none; }

        .tree-label { background: var(--accent-amber); color: var(--bg-primary); padding: 6px 14px; border-radius: 6px; font-weight: 700; display: inline-block; margin-bottom: 6px; font-size: 0.9rem; }

        /* Summary Grid */
        .summary-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(180px, 1fr)); gap: 18px; margin: 22px 0; }

        .summary-card { background: rgba(0,0,0,0.3); border: 1px solid var(--border-subtle); border-radius: 12px; padding: 22px; text-align: center; }
        .summary-card h4 { color: var(--text-secondary); margin-bottom: 12px; font-size: 0.9rem; }
        .summary-card .value {
            font-size: 2.2rem;
            font-weight: 800;
            background: linear-gradient(135deg, var(--accent-blue) 0%, var(--accent-teal) 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }
        .summary-card .label { font-size: 0.85rem; color: var(--text-muted); margin-top: 8px; }

        /* Quick Reference */
        .quick-ref {
            background: linear-gradient(135deg, var(--bg-secondary) 0%, var(--bg-card) 100%);
            border: 1px solid var(--border-subtle);
            padding: 28px;
            border-radius: 16px;
            margin-top: 30px;
            font-family: 'JetBrains Mono', monospace;
            scroll-margin-top: 75px;
        }

        .quick-ref h3 { color: var(--accent-amber); margin-bottom: 18px; font-family: 'Plus Jakarta Sans', sans-serif; }
        .quick-ref pre { background: rgba(0,0,0,0.4); border: 1px solid var(--border-subtle); padding: 20px; border-radius: 10px; overflow-x: auto; font-size: 0.85rem; line-height: 1.7; color: var(--text-secondary); }

        /* ====== AGENT OPPORTUNITIES STYLES ====== */
        .agent-header {
            background: var(--bg-card);
            border: 1px solid var(--border-subtle);
            padding: 35px;
            border-radius: 16px;
            margin-bottom: 30px;
            position: relative;
            overflow: hidden;
        }

        .agent-header::before {
            content: '';
            position: absolute;
            top: 0; left: 0; right: 0; bottom: 0;
            background:
                radial-gradient(ellipse at 20% 20%, rgba(139, 92, 246, 0.12) 0%, transparent 50%),
                radial-gradient(ellipse at 80% 80%, rgba(245, 158, 11, 0.1) 0%, transparent 50%);
            pointer-events: none;
        }

        .agent-header h1 {
            font-size: 2.2rem;
            font-weight: 800;
            margin-bottom: 10px;
            position: relative;
            background: linear-gradient(135deg, var(--accent-purple) 0%, var(--accent-amber) 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .agent-header .subtitle { color: var(--text-secondary); font-size: 1.1rem; position: relative; }

        /* Heat Map */
        .heat-map-container { margin-bottom: 35px; }
        .heat-map-title { font-size: 1.3rem; font-weight: 700; color: var(--text-primary); margin-bottom: 20px; display: flex; align-items: center; gap: 12px; }

        .heat-map-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
        }

        .heat-item {
            background: var(--bg-card);
            border: 1px solid var(--border-subtle);
            border-radius: 12px;
            padding: 20px;
            position: relative;
            overflow: hidden;
            transition: transform 0.2s, box-shadow 0.2s;
            cursor: pointer;
        }

        .heat-item:hover { transform: translateY(-3px); box-shadow: 0 10px 30px rgba(0,0,0,0.3); }
        .heat-item:active { transform: scale(0.98); }

        .heat-item::before {
            content: '';
            position: absolute;
            top: 0; left: 0; right: 0; height: 4px;
        }

        .heat-item.critical::before { background: linear-gradient(90deg, #ef4444, #f97316); }
        .heat-item.high::before { background: linear-gradient(90deg, #f97316, #eab308); }
        .heat-item.medium::before { background: linear-gradient(90deg, #eab308, #22c55e); }
        .heat-item.low::before { background: linear-gradient(90deg, #22c55e, #14b8a6); }

        .heat-score {
            position: absolute;
            top: 15px;
            right: 15px;
            font-size: 1.8rem;
            font-weight: 800;
        }

        .heat-item.critical .heat-score { color: #ef4444; }
        .heat-item.high .heat-score { color: #f97316; }
        .heat-item.medium .heat-score { color: #eab308; }
        .heat-item.low .heat-score { color: #22c55e; }

        .heat-name { font-size: 1rem; font-weight: 700; color: var(--text-primary); margin-bottom: 6px; padding-right: 50px; }
        .heat-desc { font-size: 0.85rem; color: var(--text-muted); margin-bottom: 12px; }

        .heat-metrics { display: flex; gap: 15px; margin-top: 12px; }
        .heat-metric { font-size: 0.75rem; color: var(--text-muted); }
        .heat-metric span { color: var(--text-secondary); font-weight: 600; }

        /* Agent Cards */
        .agent-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(380px, 1fr)); gap: 25px; margin-bottom: 35px; }

        .agent-card {
            background: var(--bg-card);
            border: 1px solid var(--border-subtle);
            border-radius: 16px;
            overflow: hidden;
            transition: transform 0.2s, box-shadow 0.2s;
        }

        .agent-card:hover { transform: translateY(-5px); box-shadow: 0 15px 50px rgba(0,0,0,0.3); }

        .agent-card.highlight {
            animation: highlightPulse 2s ease;
            box-shadow: 0 0 0 3px var(--accent-purple), 0 15px 50px rgba(139, 92, 246, 0.4);
        }

        @keyframes highlightPulse {
            0% { box-shadow: 0 0 0 3px var(--accent-purple), 0 15px 50px rgba(139, 92, 246, 0.6); }
            50% { box-shadow: 0 0 0 6px rgba(139, 92, 246, 0.5), 0 15px 50px rgba(139, 92, 246, 0.3); }
            100% { box-shadow: 0 0 0 0px transparent, 0 15px 50px rgba(0,0,0,0.3); }
        }

        .agent-card-header {
            padding: 22px;
            display: flex;
            align-items: flex-start;
            gap: 18px;
            border-bottom: 1px solid var(--border-subtle);
        }

        .agent-icon {
            width: 55px;
            height: 55px;
            background: linear-gradient(135deg, var(--accent-purple) 0%, var(--accent-blue) 100%);
            border-radius: 14px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.6rem;
            flex-shrink: 0;
        }

        .agent-info { flex: 1; }
        .agent-name { font-size: 1.15rem; font-weight: 700; color: var(--text-primary); margin-bottom: 5px; }
        .agent-type { font-size: 0.8rem; color: var(--accent-purple); font-weight: 600; text-transform: uppercase; letter-spacing: 0.05em; }

        .agent-priority {
            padding: 6px 12px;
            border-radius: 20px;
            font-size: 0.75rem;
            font-weight: 700;
            text-transform: uppercase;
        }

        .agent-priority.critical { background: rgba(239, 68, 68, 0.15); color: #ef4444; }
        .agent-priority.high { background: rgba(249, 115, 22, 0.15); color: #f97316; }
        .agent-priority.medium { background: rgba(234, 179, 8, 0.15); color: #eab308; }
        .agent-priority.low { background: rgba(34, 197, 94, 0.15); color: #22c55e; }

        .agent-card-body { padding: 22px; }
        .agent-description { font-size: 0.95rem; color: var(--text-secondary); line-height: 1.6; margin-bottom: 20px; }

        .agent-flow {
            background: rgba(0,0,0,0.3);
            border: 1px solid var(--border-subtle);
            border-radius: 10px;
            padding: 18px;
            margin-bottom: 20px;
        }

        .agent-flow-title { font-size: 0.85rem; color: var(--text-muted); margin-bottom: 12px; font-weight: 600; text-transform: uppercase; letter-spacing: 0.05em; }

        .agent-flow-diagram { display: flex; align-items: center; flex-wrap: wrap; gap: 8px; justify-content: center; }

        .agent-step {
            background: linear-gradient(135deg, var(--accent-purple) 0%, var(--accent-blue) 100%);
            color: white;
            padding: 8px 14px;
            border-radius: 6px;
            font-size: 0.8rem;
            font-weight: 600;
            white-space: nowrap;
        }

        .agent-arrow { color: var(--accent-purple); font-size: 1.2rem; }

        .agent-stats { display: grid; grid-template-columns: repeat(3, 1fr); gap: 12px; }

        .agent-stat {
            background: rgba(0,0,0,0.2);
            border-radius: 8px;
            padding: 12px;
            text-align: center;
        }

        .agent-stat-value {
            font-size: 1.3rem;
            font-weight: 800;
            background: linear-gradient(135deg, var(--accent-purple) 0%, var(--accent-amber) 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .agent-stat-label { font-size: 0.7rem; color: var(--text-muted); text-transform: uppercase; letter-spacing: 0.05em; margin-top: 4px; }

        /* View Prompt Button */
        .agent-prompt-btn {
            width: 100%;
            margin-top: 18px;
            padding: 14px 20px;
            background: linear-gradient(135deg, rgba(139, 92, 246, 0.2) 0%, rgba(59, 130, 246, 0.2) 100%);
            border: 1px solid rgba(139, 92, 246, 0.4);
            border-radius: 10px;
            color: var(--accent-purple);
            font-weight: 700;
            cursor: pointer;
            transition: all 0.2s;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
            font-size: 0.9rem;
        }

        .agent-prompt-btn:hover {
            background: linear-gradient(135deg, rgba(139, 92, 246, 0.3) 0%, rgba(59, 130, 246, 0.3) 100%);
            border-color: var(--accent-purple);
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(139, 92, 246, 0.25);
        }

        /* Summary Stats */
        .agent-summary {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin-bottom: 35px;
        }

        .agent-summary-card {
            background: var(--bg-card);
            border: 1px solid var(--border-subtle);
            border-radius: 14px;
            padding: 25px;
            text-align: center;
        }

        .agent-summary-value {
            font-size: 2.5rem;
            font-weight: 800;
            background: linear-gradient(135deg, var(--accent-purple) 0%, var(--accent-amber) 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .agent-summary-label { font-size: 0.9rem; color: var(--text-muted); margin-top: 8px; }

        /* Heat Map Legend */
        .heat-legend {
            display: flex;
            gap: 25px;
            padding: 18px 22px;
            background: var(--bg-card);
            border: 1px solid var(--border-subtle);
            border-radius: 12px;
            margin-bottom: 25px;
            flex-wrap: wrap;
        }

        .heat-legend-item { display: flex; align-items: center; gap: 10px; font-size: 0.9rem; color: var(--text-secondary); }
        .heat-legend-color { width: 24px; height: 24px; border-radius: 6px; }

        /* Modal */
        .modal-overlay {
            display: none;
            position: fixed;
            top: 0; left: 0; right: 0; bottom: 0;
            background: rgba(10, 15, 26, 0.9);
            z-index: 2000;
            justify-content: center;
            align-items: center;
            padding: 20px;
            backdrop-filter: blur(5px);
        }

        .modal-overlay.show { display: flex; }

        .modal {
            background: var(--bg-card);
            border: 1px solid var(--border-subtle);
            border-radius: 16px;
            width: 100%;
            max-width: 950px;
            max-height: 90vh;
            display: flex;
            flex-direction: column;
            box-shadow: 0 25px 80px rgba(0,0,0,0.5);
        }

        .modal-header {
            background: linear-gradient(135deg, var(--accent-blue) 0%, var(--accent-teal) 100%);
            color: white;
            padding: 22px 28px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            border-radius: 16px 16px 0 0;
        }

        .modal-header h3 { font-size: 1.25rem; font-weight: 700; }
        .modal-actions { display: flex; gap: 12px; }

        .modal-btn {
            padding: 10px 18px;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-weight: 700;
            transition: transform 0.2s;
            font-size: 0.9rem;
        }

        .modal-btn:hover { transform: scale(1.05); }
        .modal-btn.copy { background: white; color: var(--accent-blue); }
        .modal-btn.close { background: rgba(255,255,255,0.2); color: white; }

        .modal-body { padding: 28px; overflow-y: auto; flex: 1; }

        .modal-body pre {
            background: rgba(0,0,0,0.3);
            border: 1px solid var(--border-subtle);
            padding: 22px;
            border-radius: 10px;
            font-family: 'JetBrains Mono', monospace;
            font-size: 0.9rem;
            line-height: 1.7;
            white-space: pre-wrap;
            word-wrap: break-word;
            color: var(--text-secondary);
        }

        .copy-success {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: var(--accent-green);
            color: white;
            padding: 18px 35px;
            border-radius: 10px;
            font-weight: 700;
            z-index: 3000;
            display: none;
            animation: fadeInOut 2s ease;
        }

        @keyframes fadeInOut { 0%, 100% { opacity: 0; } 10%, 90% { opacity: 1; } }

        /* Prompt Modal */
        .prompt-modal .modal { max-width: 800px; }
        .prompt-modal .modal-header { background: linear-gradient(135deg, var(--accent-purple) 0%, var(--accent-blue) 100%); }

        .prompt-section { margin-bottom: 25px; }
        .prompt-section h4 { color: var(--accent-purple); font-size: 1rem; margin-bottom: 12px; display: flex; align-items: center; gap: 8px; }

        .prompt-box {
            background: rgba(0,0,0,0.4);
            border: 1px solid var(--border-subtle);
            border-radius: 10px;
            padding: 20px;
            font-family: 'JetBrains Mono', monospace;
            font-size: 0.85rem;
            line-height: 1.7;
            color: var(--text-secondary);
            white-space: pre-wrap;
            word-wrap: break-word;
        }

        .prompt-tags { display: flex; gap: 10px; flex-wrap: wrap; margin-bottom: 20px; }
        .prompt-tag { background: rgba(139, 92, 246, 0.15); color: var(--accent-purple); padding: 6px 14px; border-radius: 20px; font-size: 0.8rem; font-weight: 600; }

        .copy-prompt-btn {
            background: linear-gradient(135deg, var(--accent-purple) 0%, var(--accent-blue) 100%);
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 8px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.2s;
            margin-top: 15px;
        }

        .copy-prompt-btn:hover { transform: scale(1.05); box-shadow: 0 5px 20px rgba(139, 92, 246, 0.3); }

        /* Step List */
        .step-list { list-style: none; padding: 0; margin: 18px 0; }
        .step-list li {
            padding: 14px 18px;
            border-left: 3px solid var(--accent-blue);
            background: rgba(0,0,0,0.2);
            margin-bottom: 10px;
            border-radius: 0 8px 8px 0;
            color: var(--text-secondary);
        }
        .step-list li strong { color: var(--text-primary); }

        /* Contact Card */
        .contact-card {
            background: rgba(59, 130, 246, 0.1);
            border: 1px solid rgba(59, 130, 246, 0.3);
            border-radius: 12px;
            padding: 22px;
            margin: 18px 0;
        }

        .contact-card h4 { color: var(--accent-blue); margin-bottom: 15px; }
        .contact-item { display: flex; align-items: center; gap: 12px; margin-bottom: 10px; color: var(--text-secondary); }
        .contact-item:last-child { margin-bottom: 0; }
        .contact-item strong { color: var(--text-primary); min-width: 80px; }

        @media (max-width: 900px) {
            .sidebar { display: none; }
            .main-content { margin-left: 0; padding: 75px 20px 30px 20px; }
            .agent-grid { grid-template-columns: 1fr; }
        }
    </style>
</head>
<body>
    <!-- Breadcrumb -->
    <nav class="breadcrumb">
        <a href="../../index.html">Portal Home</a>
        <span class="separator">></span>
        <a href="./index.html">Optimal Blue</a>
        <span class="separator">></span>
        <span class="current">Lock Desk FAQs for JV Partners</span>
    </nav>

    <!-- Fixed Sidebar -->
    <aside class="sidebar">
        <div class="sidebar-header">
            <h2>Lock Desk FAQs</h2>
            <p>JV Partner Quick Reference</p>
        </div>

        <!-- Tab Switcher -->
        <div class="sidebar-tabs">
            <button class="sidebar-tab active" onclick="switchTab('workflow')">Workflow</button>
            <button class="sidebar-tab agent-tab" onclick="switchTab('agents')">AI Agents</button>
        </div>

        <!-- Workflow Navigation -->
        <nav class="sidebar-nav" id="workflow-nav">
            <a href="#section-1" class="nav-item active">
                <span class="nav-number">1</span>
                <span class="nav-label">Hours of Operations</span>
            </a>
            <a href="#section-2" class="nav-item">
                <span class="nav-number">2</span>
                <span class="nav-label">Pricing & Rate Sheets</span>
            </a>
            <a href="#section-3" class="nav-item">
                <span class="nav-number">3</span>
                <span class="nav-label">Specialty Locks</span>
            </a>
            <a href="#section-4" class="nav-item">
                <span class="nav-number">4</span>
                <span class="nav-label">OB Self-Service</span>
            </a>
            <a href="#section-5" class="nav-item">
                <span class="nav-number">5</span>
                <span class="nav-label">Lock Desk Requests</span>
            </a>
            <a href="#section-6" class="nav-item">
                <span class="nav-number">6</span>
                <span class="nav-label">General FAQs</span>
            </a>
            <a href="#section-7" class="nav-item">
                <span class="nav-number">7</span>
                <span class="nav-label">Bonds & HFA FAQs</span>
            </a>
            <a href="#section-8" class="nav-item">
                <span class="nav-number">8</span>
                <span class="nav-label">Non-Agency FAQs</span>
            </a>
            <a href="#quick-ref" class="nav-item">
                <span class="nav-number">*</span>
                <span class="nav-label">Quick Reference</span>
            </a>
        </nav>

        <!-- Agent Navigation -->
        <nav class="sidebar-nav" id="agents-nav" style="display: none;">
            <a href="#agent-summary" class="nav-item active">
                <span class="nav-number">S</span>
                <span class="nav-label">Summary</span>
            </a>
            <a href="#agent-heatmap" class="nav-item">
                <span class="nav-number">H</span>
                <span class="nav-label">Heat Map</span>
            </a>
            <a href="#agent-details" class="nav-item">
                <span class="nav-number">A</span>
                <span class="nav-label">Agent Details</span>
            </a>
        </nav>

        <div class="sidebar-footer">
            <button class="doc-btn" onclick="window.print()">
                Print Document
            </button>
        </div>
    </aside>

    <!-- Main Content -->
    <main class="main-content">

        <!-- ==================== WORKFLOW TAB ==================== -->
        <div id="workflow-panel" class="tab-panel active">
            <!-- Header -->
            <div class="header">
                <h1>Lock Desk FAQs for JV Partners</h1>
                <p class="subtitle">Comprehensive guide for Joint Venture Partner lock desk operations in Optimal Blue</p>
                <div class="meta">
                    <span class="meta-item">System: Optimal Blue</span>
                    <span class="meta-item">Role: JV Partner</span>
                    <span class="meta-item">Updated: Feb 10, 2025</span>
                    <span class="meta-item">Contact: jvcapmkts@cmgfi.com</span>
                </div>
            </div>

            <!-- Legend -->
            <div class="legend">
                <div class="legend-item"><div class="legend-color" style="background: linear-gradient(135deg, #22c55e, #16a34a);"></div><span>Start/End</span></div>
                <div class="legend-item"><div class="legend-color" style="background: linear-gradient(135deg, #3b82f6, #2563eb);"></div><span>Action Step</span></div>
                <div class="legend-item"><div class="legend-color" style="background: linear-gradient(135deg, #f59e0b, #d97706);"></div><span>Decision Point</span></div>
                <div class="legend-item"><div class="legend-color" style="background: #111827; border: 2px solid #3b82f6;"></div><span>User Input</span></div>
                <div class="legend-item"><div class="legend-color" style="background: linear-gradient(135deg, #f43f5e, #dc2626);"></div><span>Exception</span></div>
                <div class="legend-item"><div class="legend-color" style="background: linear-gradient(135deg, #14b8a6, #0d9488);"></div><span>Output</span></div>
            </div>

            <!-- Section 1: Hours of Operations -->
            <section id="section-1" class="section">
                <div class="section-header">
                    <div class="section-number">1</div>
                    <div class="section-title"><h2>Hours of Operations</h2><span>Locking hours and support availability</span></div>
                </div>
                <div class="section-content">
                    <div class="contact-card">
                        <h4>JV Lock Desk Contact Information</h4>
                        <div class="contact-item"><strong>Phone:</strong> 925-983-3225</div>
                        <div class="contact-item"><strong>Email:</strong> jvcapmkts@cmgfi.com</div>
                        <div class="contact-item"><strong>Support:</strong> Monday-Friday, 7:00am - 4:00pm PT</div>
                    </div>

                    <table class="field-table">
                        <thead>
                            <tr>
                                <th>Product Type</th>
                                <th>Locking Hours (PST)</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td><strong>Agency Programs</strong></td>
                                <td>7:00am - 11:59pm</td>
                            </tr>
                            <tr>
                                <td><strong>Jumbo/Non-Agency/Near Miss Alt-A/Non-QM</strong></td>
                                <td>8:45am - 4:00pm</td>
                            </tr>
                            <tr>
                                <td><strong>Jumbo Express & Solar Express</strong></td>
                                <td>8:45am - 3:30pm</td>
                            </tr>
                            <tr>
                                <td><strong>AIO Loans</strong></td>
                                <td>8:00am - 4:00pm</td>
                            </tr>
                            <tr>
                                <td><strong>HFA Bond</strong></td>
                                <td>8:00am - 4:00pm</td>
                            </tr>
                            <tr>
                                <td><strong>Chenoa & Buyers Choice</strong></td>
                                <td>8:30am - 1:00pm</td>
                            </tr>
                        </tbody>
                    </table>

                    <div class="info-box">
                        <h4>Email Subject Line Best Practice</h4>
                        <p>Include the following in your email subject:</p>
                        <ul style="margin-top: 10px; margin-left: 20px;">
                            <li>Borrower's last name and complete loan # with "J" prefix</li>
                            <li>For FHA Brokered Out: Include WPH loan # as well</li>
                            <li>Nature of request (Lock Extension, Program Change)</li>
                            <li>Product type (Conventional, Jumbo, 101, Non-QM, etc.)</li>
                        </ul>
                    </div>

                    <div class="tip-box">
                        <h4>Preferred Communication</h4>
                        <p>Email is the preferred method of communication. Be clear and concise in your request. If something looks off, provide screenshots and examples.</p>
                    </div>
                </div>
            </section>

            <!-- Section 2: Pricing & Rate Sheets -->
            <section id="section-2" class="section">
                <div class="section-header">
                    <div class="section-number">2</div>
                    <div class="section-title"><h2>Pricing & Rate Sheets</h2><span>Product types and lock support by category</span></div>
                </div>
                <div class="section-content">
                    <table class="field-table">
                        <thead>
                            <tr>
                                <th>Product Type</th>
                                <th>Price/Lock in OB?</th>
                                <th>Lock Support</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td><strong>Agency Conventional & Government</strong></td>
                                <td><span class="badge optional-badge">Yes</span></td>
                                <td>jvcapmkts@cmgfi.com</td>
                            </tr>
                            <tr>
                                <td><strong>PLS Program</strong></td>
                                <td><span class="badge optional-badge">Yes</span></td>
                                <td>jvcapmkts@cmgfi.com</td>
                            </tr>
                            <tr>
                                <td><strong>All-In-One (AIO)</strong></td>
                                <td><span class="badge required-badge">No</span></td>
                                <td>jvcapmkts@cmgfi.com</td>
                            </tr>
                            <tr>
                                <td><strong>Jumbo/Non Agency</strong></td>
                                <td><span class="badge optional-badge">Yes</span></td>
                                <td>jvcapmkts@cmgfi.com</td>
                            </tr>
                            <tr>
                                <td><strong>Non-QM (Sharp, Horizon, Prime, etc.)</strong></td>
                                <td><span class="badge optional-badge">Yes</span></td>
                                <td>jvcapmkts@cmgfi.com</td>
                            </tr>
                            <tr>
                                <td><strong>Near Miss & Alt-A</strong></td>
                                <td><span class="badge required-badge">No</span></td>
                                <td>jvcapmkts@cmgfi.com</td>
                            </tr>
                            <tr>
                                <td><strong>Community Lending (Classic & Plus)</strong></td>
                                <td><span class="badge optional-badge">Yes</span></td>
                                <td>jvcapmkts@cmgfi.com</td>
                            </tr>
                            <tr>
                                <td><strong>CMG 2nds or HELOCs</strong></td>
                                <td><span class="badge required-badge">No</span></td>
                                <td>jvcapmkts@cmgfi.com</td>
                            </tr>
                            <tr>
                                <td><strong>Premier CES</strong></td>
                                <td><span class="badge required-badge">No</span></td>
                                <td>jvcapmkts@cmgfi.com</td>
                            </tr>
                            <tr>
                                <td><strong>Med Pro Advantage</strong></td>
                                <td><span class="badge optional-badge">Yes</span></td>
                                <td>jvcapmkts@cmgfi.com</td>
                            </tr>
                            <tr>
                                <td><strong>FHA Buyers Choice</strong></td>
                                <td><span class="badge optional-badge">Yes</span></td>
                                <td>jvcapmkts@cmgfi.com</td>
                            </tr>
                            <tr>
                                <td><strong>All Bond programs (incl. Chenoa)</strong></td>
                                <td><span class="badge required-badge">No</span></td>
                                <td>jvcapmkts@cmgfi.com</td>
                            </tr>
                            <tr>
                                <td><strong>Figure</strong></td>
                                <td><span class="badge required-badge">No</span></td>
                                <td>N/A - Determined by Figure</td>
                            </tr>
                            <tr>
                                <td><strong>Renovation (203K, Choice, Homestyle)</strong></td>
                                <td><span class="badge optional-badge">Yes</span></td>
                                <td>jvcapmkts@cmgfi.com</td>
                            </tr>
                            <tr>
                                <td><strong>Construction 2X Close</strong></td>
                                <td><span class="badge required-badge">No</span></td>
                                <td>jvcapmkts@cmgfi.com</td>
                            </tr>
                            <tr>
                                <td><strong>Jumbo Renovation</strong></td>
                                <td><span class="badge required-badge">No</span></td>
                                <td>jvcapmkts@cmgfi.com</td>
                            </tr>
                        </tbody>
                    </table>

                    <div class="info-box">
                        <h4>Product Guidelines</h4>
                        <p>Details of how and where to lock are validated in each product's guidelines on SharePoint.</p>
                    </div>
                </div>
            </section>

            <!-- Section 3: Specialty Locks -->
            <section id="section-3" class="section">
                <div class="section-header">
                    <div class="section-number">3</div>
                    <div class="section-title"><h2>Specialty Locks</h2><span>Special lock programs and resources</span></div>
                </div>
                <div class="section-content">
                    <div class="summary-grid">
                        <div class="summary-card">
                            <h4>Lock N Shop</h4>
                            <div class="value" style="font-size: 1.5rem;">Policy</div>
                            <div class="label">Pre-Approval Lock</div>
                        </div>
                        <div class="summary-card">
                            <h4>List & Lock</h4>
                            <div class="value" style="font-size: 1.5rem;">Policy</div>
                            <div class="label">Listing Lock</div>
                        </div>
                        <div class="summary-card">
                            <h4>Rate Rebound</h4>
                            <div class="value" style="font-size: 1.5rem;">Workflow</div>
                            <div class="label">Rate Improvement</div>
                        </div>
                        <div class="summary-card">
                            <h4>Bond Lock</h4>
                            <div class="value" style="font-size: 1.5rem;">Policy</div>
                            <div class="label">HFA Programs</div>
                        </div>
                    </div>

                    <div class="decision-tree">
                        <h3>Available Specialty Lock Resources</h3>
                        <ul class="step-list">
                            <li><strong>Lock N Shop:</strong> Policy & Procedure documentation</li>
                            <li><strong>List & Lock:</strong> Policy, Procedure, and Resources</li>
                            <li><strong>Rate Rebound:</strong> Policy & Workflow guide</li>
                            <li><strong>Bond Lock:</strong> Policy documentation</li>
                            <li><strong>HELOC/2nds:</strong> Lock Request Form</li>
                            <li><strong>Spec Lock:</strong> Policy and Procedure</li>
                        </ul>
                    </div>
                </div>
            </section>

            <!-- Section 4: OB Self-Service -->
            <section id="section-4" class="section">
                <div class="section-header">
                    <div class="section-number">4</div>
                    <div class="section-title"><h2>OB Self-Service Functions</h2><span>What LOs and Loan Teams can do in Optimal Blue</span></div>
                </div>
                <div class="section-content">
                    <div class="workflow-diagram">
                        <div class="flow-row">
                            <div class="flow-node start">Access OB</div>
                            <span class="flow-arrow">-></span>
                            <div class="flow-node decision">Self-Service?</div>
                        </div>
                        <div class="decision-branch">
                            <div class="branch">
                                <span class="branch-label">YES</span>
                                <div class="flow-node action">Use Change Request Icon</div>
                            </div>
                            <div class="branch">
                                <span class="branch-label">NO</span>
                                <div class="flow-node exception">Contact Lock Desk</div>
                            </div>
                        </div>
                    </div>

                    <div class="decision-tree">
                        <h3>Self-Service Functions in Optimal Blue</h3>
                        <ul class="step-list">
                            <li><strong>Locking:</strong> Initial rate lock on eligible products</li>
                            <li><strong>Relocking:</strong> After lock expiration (Agency/Jumbo)</li>
                            <li><strong>Extending a Lock:</strong> Via Change Request icon</li>
                            <li><strong>Floating Down:</strong> One-time float down (Agency)</li>
                            <li><strong>Parameter Changes:</strong> Loan Amount, Appraised Value, Property Type</li>
                            <li><strong>Program Switching:</strong> Conv to FHA, Fannie to Freddie, etc.</li>
                            <li><strong>Concession Requests:</strong> Submit via system</li>
                            <li><strong>Viewing Pricing:</strong> Rate options and pricing scenarios</li>
                        </ul>
                    </div>

                    <div class="tip-box">
                        <h4>Lock Extension Cost</h4>
                        <p>The cost for Agency and Jumbo lock extension is <strong>0.02 per day</strong>. Use the Change Request icon and select the Lock Extension radio button.</p>
                    </div>
                </div>
            </section>

            <!-- Section 5: Lock Desk Requests -->
            <section id="section-5" class="section">
                <div class="section-header">
                    <div class="section-number">5</div>
                    <div class="section-title"><h2>Lock Desk Requests</h2><span>What requires Lock Desk assistance</span></div>
                </div>
                <div class="section-content">
                    <div class="decision-tree">
                        <h3>Requests Processed by Lock Desk</h3>
                        <ul class="step-list">
                            <li><strong>Price Quotes:</strong> Not available directly through the system</li>
                            <li><strong>Locking Assistance:</strong> Complex scenarios or issues</li>
                            <li><strong>Lock Extension Help:</strong> When self-service unavailable</li>
                            <li><strong>Floatdowns:</strong> Not available through system</li>
                            <li><strong>Relocks:</strong> Special circumstances</li>
                            <li><strong>Temporary Buydown:</strong> Selection and processing</li>
                            <li><strong>Manual Locks:</strong> AIO, CMG 2nds, Near Miss, Chenoa, Bonds/HFA</li>
                            <li><strong>Parameter Changes:</strong> For manual lock products</li>
                            <li><strong>Lock Transfers:</strong> Between loans/entities</li>
                            <li><strong>Concessions:</strong> Applying approved concessions</li>
                        </ul>
                    </div>

                    <div class="exception-box">
                        <h4>Not Handled by Lock Desk</h4>
                        <ul style="margin-top: 10px; margin-left: 20px;">
                            <li><strong>Changes on unlocked loans:</strong> Contact Processor or Processing Manager</li>
                            <li><strong>Branch/LO/Lead type updates:</strong> Contact Red Team (red@cmgfi.com)</li>
                            <li><strong>Product/scenario assistance:</strong> ProductHelp@cmgfi.com or Retail Scenario desk</li>
                            <li><strong>Clear/Byte login issues:</strong> AppSupport@cmgfi.com</li>
                            <li><strong>Workflow/Data Entry support:</strong> salestraining@cmgfi.com</li>
                            <li><strong>Origination fees (non-Smartfees):</strong> Contact Disclosure team lead</li>
                        </ul>
                    </div>
                </div>
            </section>

            <!-- Section 6: General FAQs -->
            <section id="section-6" class="section">
                <div class="section-header">
                    <div class="section-number">6</div>
                    <div class="section-title"><h2>General FAQs</h2><span>Common questions and answers</span></div>
                </div>
                <div class="section-content">
                    <div class="decision-tree">
                        <h3>Q: I have an urgent request. How do I reach a live person?</h3>
                        <p style="color: var(--text-secondary); margin: 15px 0;">Call <strong>925-983-3225</strong> after submitting your email request. Leave a detailed voicemail with loan number and nature of request if no answer.</p>
                    </div>

                    <div class="decision-tree">
                        <h3>Q: How do I extend my lock? How much does it cost?</h3>
                        <p style="color: var(--text-secondary); margin: 15px 0;">Use Optimal Blue Change Request icon, select Lock Extension. Cost: <strong>0.02 per day</strong> for Agency and Jumbo. See Optimal Blue Pricing Manual for details.</p>
                    </div>

                    <div class="decision-tree">
                        <h3>Q: Does CMG offer overnight price protection?</h3>
                        <p style="color: var(--text-secondary); margin: 15px 0;"><strong>Yes.</strong> Notify lock desk via email prior to 8:30AM EST to hold previous day pricing. Lock the loan, then contact lock desk to adjust pricing.</p>
                    </div>

                    <div class="decision-tree">
                        <h3>Q: How do I change loan parameters on my locked loan?</h3>
                        <p style="color: var(--text-secondary); margin: 15px 0;">Use Profile Change Request in Optimal Blue. Select Change Request icon > Profile Change radio button > Make changes > Click lock icon.</p>
                    </div>

                    <div class="decision-tree">
                        <h3>Q: My lock expired. How do I relock?</h3>
                        <p style="color: var(--text-secondary); margin: 15px 0;">Access OB through Byte/Clear for Agency and Jumbo. Select Change Request icon > Relock radio button. See Optimal Blue Pricing Manual.</p>
                    </div>

                    <div class="decision-tree">
                        <h3>Q: Rates improved. Can I float down?</h3>
                        <p style="color: var(--text-secondary); margin: 15px 0;"><strong>Yes.</strong> One-time float down available on Agency loans. Use Change Request icon > Float Down. Refer to Lock Policy page 4 for details.</p>
                    </div>

                    <div class="decision-tree">
                        <h3>Q: What's the difference between Net and General Lender Credit?</h3>
                        <ul class="step-list">
                            <li><strong>Net Lender Credit:</strong> Price improvement to lower discount points or apply overage to closing costs. Flexible.</li>
                            <li><strong>General Lender Credit:</strong> Lump sum itemized on LE/CD. Once disclosed, cannot be reduced or removed.</li>
                        </ul>
                    </div>

                    <div class="decision-tree">
                        <h3>Q: I cannot find this product in OB. How do I price it?</h3>
                        <p style="color: var(--text-secondary); margin: 15px 0;">Some products are manual. Contact jvcapmkts@cmgfi.com for: AIO, Bond/HFA, Chenoa, CMG 2nds, Near Miss, Alt-A.</p>
                    </div>

                    <div class="decision-tree">
                        <h3>Q: How do I lock my AIO loan?</h3>
                        <p style="color: var(--text-secondary); margin: 15px 0;">AIO must be in <strong>UW Approved status</strong> before locking. Email jvcapmkts@cmgfi.com with loan number, borrower last name, and desired margin.</p>
                    </div>
                </div>
            </section>

            <!-- Section 7: Bonds & HFA FAQs -->
            <section id="section-7" class="section">
                <div class="section-header">
                    <div class="section-number">7</div>
                    <div class="section-title"><h2>Bonds & HFA Products</h2><span>Helpful tips for Bond and HFA locks</span></div>
                </div>
                <div class="section-content">
                    <div class="decision-tree">
                        <h3>Q: How do I get my bond lock in the system?</h3>
                        <p style="color: var(--text-secondary); margin: 15px 0;">Email jvcapmkts@cmgfi.com with commitment confirmation from HFA site and loan #. Lock desk will enter in LOS. See Bond/DPA Loan workflow guide.</p>
                    </div>

                    <div class="decision-tree">
                        <h3>Q: How do I extend my bond lock?</h3>
                        <p style="color: var(--text-secondary); margin: 15px 0;">Provide updated lock commitment from HFA showing extension (new expiration date, email from agency, or approved extension form).</p>
                    </div>

                    <div class="decision-tree">
                        <h3>Q: Why is my lock expiration different from the commitment?</h3>
                        <p style="color: var(--text-secondary); margin: 15px 0;">CMG adds time for delivery and settlement. This is standard practice.</p>
                    </div>

                    <div class="exception-box">
                        <h4>Bond Lock Common Delays</h4>
                        <ul style="margin-top: 10px; margin-left: 20px;">
                            <li>When locking 1st, 2nd, and 3rd loan - ensure all are created and synced in Byte first</li>
                            <li>HFA reservation must be for <strong>total loan amount</strong> (including MIP), not base amount</li>
                            <li>Property info must be accurate: street address, city, zip code</li>
                            <li>Submit actual PDF commitment confirmation (not just screenshot of reservation page)</li>
                        </ul>
                    </div>

                    <div class="tip-box">
                        <h4>Bond Lock Best Practice</h4>
                        <p>Provide both base and total loan amount when requesting lock to prevent back-and-forth with lock desk.</p>
                    </div>
                </div>
            </section>

            <!-- Section 8: Non-Agency FAQs -->
            <section id="section-8" class="section">
                <div class="section-header">
                    <div class="section-number">8</div>
                    <div class="section-title"><h2>Non-Agency/Non-QM Products</h2><span>Helpful tips for Jumbo and Non-QM locks</span></div>
                </div>
                <div class="section-content">
                    <div class="contact-card">
                        <h4>Non-Agency Lock Desk Contacts</h4>
                        <div class="contact-item"><strong>JV Lock:</strong> 925-983-3225</div>
                        <div class="contact-item"><strong>Non-Agency:</strong> 925-983-3230</div>
                        <div class="contact-item"><strong>Email:</strong> NonAgencyLocks@cmgfi.com</div>
                    </div>

                    <div class="decision-tree">
                        <h3>Q: What's the cutoff for Non-Agency/Non-QM locks?</h3>
                        <p style="color: var(--text-secondary); margin: 15px 0;"><strong>4:00pm PT</strong> for most Jumbo and Non-Agency products.</p>
                    </div>

                    <div class="decision-tree">
                        <h3>Q: Why isn't my Non-QM lock reflecting in Byte/Clear yet?</h3>
                        <p style="color: var(--text-secondary); margin: 15px 0;">Non-Agency Lock Desk reviews requests to verify all fields are correct (doc type, DSCR, DTI, etc.) before processing.</p>
                    </div>

                    <div class="decision-tree">
                        <h3>Q: I keep getting pricing disqualifiers. What can I do?</h3>
                        <p style="color: var(--text-secondary); margin: 15px 0;">Click "Show" button next to disqualifier to see the cause. Correct the information creating the hard stop.</p>
                    </div>

                    <div class="decision-tree">
                        <h3>Q: Loan doesn't fit guidelines (FICO/LTV/Loan Amount). How do I get pricing?</h3>
                        <p style="color: var(--text-secondary); margin: 15px 0;">Request exception through producthelp@cmgfi.com or Underwriter. Lock desk can provide manual pricing with written approval.</p>
                    </div>

                    <div class="decision-tree">
                        <h3>Q: How do I price a DSCR Foreign National with no FICO/SSN?</h3>
                        <p style="color: var(--text-secondary); margin: 15px 0;">Use <strong>680 FICO</strong> for pricing. Select "Foreign National" from the dropdown menu.</p>
                    </div>

                    <div class="decision-tree">
                        <h3>Q: Are float downs allowed on Non-Agency loans?</h3>
                        <p style="color: var(--text-secondary); margin: 15px 0;"><strong>Chase only.</strong> Must be requested with investor first before lock desk can process.</p>
                    </div>

                    <div class="exception-box">
                        <h4>Non-Agency Lock Restrictions</h4>
                        <ul style="margin-top: 10px; margin-left: 20px;">
                            <li><strong>Relock after expiration:</strong> 60 days (not 30) before current market available</li>
                            <li><strong>10-day lock:</strong> NOT allowed for any Non-Agency/Jumbo products</li>
                        </ul>
                    </div>
                </div>
            </section>

            <!-- Quick Reference -->
            <div id="quick-ref" class="quick-ref">
                <h3>Lock Desk Quick Reference</h3>
                <pre>
JV LOCK DESK CONTACT INFO
==========================
Phone: 925-983-3225
Email: jvcapmkts@cmgfi.com
Non-Agency: 925-983-3230 / NonAgencyLocks@cmgfi.com
Hours: Mon-Fri 7:00am - 4:00pm PT

LOCKING HOURS (PST)
==========================
Agency Programs:           7:00am - 11:59pm
Jumbo/Non-Agency/Non-QM:   8:45am - 4:00pm
Jumbo Express/Solar:       8:45am - 3:30pm
AIO Loans:                 8:00am - 4:00pm
HFA Bond:                  8:00am - 4:00pm
Chenoa/Buyers Choice:      8:30am - 1:00pm

EMAIL SUBJECT LINE FORMAT
==========================
[Borrower Last Name] [J-Loan#] [Request Type] [Product Type]
Example: Smith J123456789 Lock Extension Conventional

SELF-SERVICE IN OPTIMAL BLUE
==========================
[ ] Locking (eligible products)
[ ] Relocking (Agency/Jumbo)
[ ] Lock Extensions (0.02/day)
[ ] Float Downs (Agency, one-time)
[ ] Parameter Changes
[ ] Program Switching
[ ] Concession Requests

MANUAL LOCK PRODUCTS (Contact Lock Desk)
==========================
- AIO Loans (requires UW Approved status)
- Bond/HFA Products
- Chenoa
- CMG 2nds/HELOCs
- Near Miss & Alt-A
- Premier CES
- Construction 2X Close
- Jumbo Renovation

NON-AGENCY REMINDERS
==========================
- Cutoff: 4:00pm PT
- No 10-day locks
- Relock current market: 60 days after expiration
- Float down: Chase only (investor approval required)
- DSCR Foreign National: Use 680 FICO

LINKS & RESOURCES
==========================
- Joint Ventures Lock Policy
- Extended Rate Lock Procedure (pages 5-9)
- JV Guidelines
- Optimal Blue Pricing Manual
- Lender Credit Procedure/Policy/Request Form
- Competitive Price Match Request Form
                </pre>
            </div>
        </div>

        <!-- ==================== AI AGENTS TAB ==================== -->
        <div id="agents-panel" class="tab-panel">
            <!-- Agent Header -->
            <div class="agent-header">
                <h1>AI Agent Opportunities</h1>
                <p class="subtitle">Automation opportunities identified for the Lock Desk FAQ process</p>
            </div>

            <!-- Summary Stats -->
            <div class="agent-summary" id="agent-summary">
                <div class="agent-summary-card">
                    <div class="agent-summary-value">4</div>
                    <div class="agent-summary-label">Agent Opportunities</div>
                </div>
                <div class="agent-summary-card">
                    <div class="agent-summary-value">68%</div>
                    <div class="agent-summary-label">Automation Potential</div>
                </div>
                <div class="agent-summary-card">
                    <div class="agent-summary-value">12 min</div>
                    <div class="agent-summary-label">Est. Time Saved</div>
                </div>
                <div class="agent-summary-card">
                    <div class="agent-summary-value">High</div>
                    <div class="agent-summary-label">Efficiency Impact</div>
                </div>
            </div>

            <!-- Heat Map Legend -->
            <div class="heat-legend">
                <div class="heat-legend-item">
                    <div class="heat-legend-color" style="background: linear-gradient(90deg, #ef4444, #f97316);"></div>
                    <span>Critical Priority (9-10)</span>
                </div>
                <div class="heat-legend-item">
                    <div class="heat-legend-color" style="background: linear-gradient(90deg, #f97316, #eab308);"></div>
                    <span>High Priority (7-8)</span>
                </div>
                <div class="heat-legend-item">
                    <div class="heat-legend-color" style="background: linear-gradient(90deg, #eab308, #22c55e);"></div>
                    <span>Medium Priority (5-6)</span>
                </div>
                <div class="heat-legend-item">
                    <div class="heat-legend-color" style="background: linear-gradient(90deg, #22c55e, #14b8a6);"></div>
                    <span>Low Priority (1-4)</span>
                </div>
            </div>

            <!-- Heat Map Grid -->
            <div class="heat-map-container" id="agent-heatmap">
                <div class="heat-map-title">Priority Heat Map</div>
                <div class="heat-map-grid">
                    <div class="heat-item critical" onclick="scrollToAgent('agent-lockrouter')">
                        <div class="heat-score">9.1</div>
                        <div class="heat-name">Lock Request Router</div>
                        <div class="heat-desc">Auto-route lock requests to correct desk based on product type</div>
                        <div class="heat-metrics">
                            <div class="heat-metric">Time: <span>5 min</span></div>
                            <div class="heat-metric">Complexity: <span>Medium</span></div>
                        </div>
                    </div>
                    <div class="heat-item high" onclick="scrollToAgent('agent-producteligibility')">
                        <div class="heat-score">8.3</div>
                        <div class="heat-name">Product Eligibility Agent</div>
                        <div class="heat-desc">Auto-determine if product can be locked in OB or requires manual</div>
                        <div class="heat-metrics">
                            <div class="heat-metric">Time: <span>3 min</span></div>
                            <div class="heat-metric">Complexity: <span>Low</span></div>
                        </div>
                    </div>
                    <div class="heat-item high" onclick="scrollToAgent('agent-lockexpiration')">
                        <div class="heat-score">7.8</div>
                        <div class="heat-name">Lock Expiration Monitor</div>
                        <div class="heat-desc">Alert before locks expire with extension cost calculation</div>
                        <div class="heat-metrics">
                            <div class="heat-metric">Time: <span>2 min</span></div>
                            <div class="heat-metric">Complexity: <span>Low</span></div>
                        </div>
                    </div>
                    <div class="heat-item medium" onclick="scrollToAgent('agent-bondvalidator')">
                        <div class="heat-score">6.5</div>
                        <div class="heat-name">Bond Lock Validator</div>
                        <div class="heat-desc">Validate bond commitment data before lock submission</div>
                        <div class="heat-metrics">
                            <div class="heat-metric">Time: <span>2 min</span></div>
                            <div class="heat-metric">Complexity: <span>Medium</span></div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Agent Details -->
            <div id="agent-details">
                <h2 style="color: var(--text-primary); margin-bottom: 25px; font-size: 1.5rem;">Agent Details</h2>
                <div class="agent-grid">
                    <!-- Lock Request Router Agent -->
                    <div class="agent-card" id="agent-lockrouter">
                        <div class="agent-card-header">
                            <div class="agent-icon">R</div>
                            <div class="agent-info">
                                <div class="agent-name">Lock Request Router</div>
                                <div class="agent-type">Workflow Automation</div>
                            </div>
                            <span class="agent-priority critical">Critical</span>
                        </div>
                        <div class="agent-card-body">
                            <p class="agent-description">Automatically analyzes incoming lock requests and routes them to the correct inbox/team based on product type, ensuring JV partners don't have to determine which desk handles their specific product.</p>
                            <div class="agent-flow">
                                <div class="agent-flow-title">Agent Flow</div>
                                <div class="agent-flow-diagram">
                                    <span class="agent-step">Parse Request</span>
                                    <span class="agent-arrow">-></span>
                                    <span class="agent-step">Identify Product</span>
                                    <span class="agent-arrow">-></span>
                                    <span class="agent-step">Route to Desk</span>
                                    <span class="agent-arrow">-></span>
                                    <span class="agent-step">Confirm Receipt</span>
                                </div>
                            </div>
                            <div class="agent-stats">
                                <div class="agent-stat">
                                    <div class="agent-stat-value">5 min</div>
                                    <div class="agent-stat-label">Time Saved</div>
                                </div>
                                <div class="agent-stat">
                                    <div class="agent-stat-value">92%</div>
                                    <div class="agent-stat-label">Accuracy</div>
                                </div>
                                <div class="agent-stat">
                                    <div class="agent-stat-value">Med</div>
                                    <div class="agent-stat-label">Complexity</div>
                                </div>
                            </div>
                            <button class="agent-prompt-btn" onclick="showAgentPrompt('lockrouter')">
                                View Build Prompt
                            </button>
                        </div>
                    </div>

                    <!-- Product Eligibility Agent -->
                    <div class="agent-card" id="agent-producteligibility">
                        <div class="agent-card-header">
                            <div class="agent-icon">E</div>
                            <div class="agent-info">
                                <div class="agent-name">Product Eligibility Agent</div>
                                <div class="agent-type">Decision Support</div>
                            </div>
                            <span class="agent-priority high">High</span>
                        </div>
                        <div class="agent-card-body">
                            <p class="agent-description">Instantly determines whether a product can be locked directly in Optimal Blue or requires manual lock desk intervention, saving time spent researching product locking procedures.</p>
                            <div class="agent-flow">
                                <div class="agent-flow-title">Agent Flow</div>
                                <div class="agent-flow-diagram">
                                    <span class="agent-step">Input Product</span>
                                    <span class="agent-arrow">-></span>
                                    <span class="agent-step">Check Matrix</span>
                                    <span class="agent-arrow">-></span>
                                    <span class="agent-step">Return Method</span>
                                    <span class="agent-arrow">-></span>
                                    <span class="agent-step">Provide Steps</span>
                                </div>
                            </div>
                            <div class="agent-stats">
                                <div class="agent-stat">
                                    <div class="agent-stat-value">3 min</div>
                                    <div class="agent-stat-label">Time Saved</div>
                                </div>
                                <div class="agent-stat">
                                    <div class="agent-stat-value">99%</div>
                                    <div class="agent-stat-label">Accuracy</div>
                                </div>
                                <div class="agent-stat">
                                    <div class="agent-stat-value">Low</div>
                                    <div class="agent-stat-label">Complexity</div>
                                </div>
                            </div>
                            <button class="agent-prompt-btn" onclick="showAgentPrompt('producteligibility')">
                                View Build Prompt
                            </button>
                        </div>
                    </div>

                    <!-- Lock Expiration Monitor Agent -->
                    <div class="agent-card" id="agent-lockexpiration">
                        <div class="agent-card-header">
                            <div class="agent-icon">X</div>
                            <div class="agent-info">
                                <div class="agent-name">Lock Expiration Monitor</div>
                                <div class="agent-type">Monitoring / Alerts</div>
                            </div>
                            <span class="agent-priority high">High</span>
                        </div>
                        <div class="agent-card-body">
                            <p class="agent-description">Monitors all active locks and sends proactive alerts before expiration, including calculated extension costs and step-by-step instructions for extending or relocking.</p>
                            <div class="agent-flow">
                                <div class="agent-flow-title">Agent Flow</div>
                                <div class="agent-flow-diagram">
                                    <span class="agent-step">Scan Locks</span>
                                    <span class="agent-arrow">-></span>
                                    <span class="agent-step">Check Dates</span>
                                    <span class="agent-arrow">-></span>
                                    <span class="agent-step">Calculate Cost</span>
                                    <span class="agent-arrow">-></span>
                                    <span class="agent-step">Send Alert</span>
                                </div>
                            </div>
                            <div class="agent-stats">
                                <div class="agent-stat">
                                    <div class="agent-stat-value">2 min</div>
                                    <div class="agent-stat-label">Time Saved</div>
                                </div>
                                <div class="agent-stat">
                                    <div class="agent-stat-value">99%</div>
                                    <div class="agent-stat-label">Accuracy</div>
                                </div>
                                <div class="agent-stat">
                                    <div class="agent-stat-value">Low</div>
                                    <div class="agent-stat-label">Complexity</div>
                                </div>
                            </div>
                            <button class="agent-prompt-btn" onclick="showAgentPrompt('lockexpiration')">
                                View Build Prompt
                            </button>
                        </div>
                    </div>

                    <!-- Bond Lock Validator Agent -->
                    <div class="agent-card" id="agent-bondvalidator">
                        <div class="agent-card-header">
                            <div class="agent-icon">B</div>
                            <div class="agent-info">
                                <div class="agent-name">Bond Lock Validator</div>
                                <div class="agent-type">Data Validation</div>
                            </div>
                            <span class="agent-priority medium">Medium</span>
                        </div>
                        <div class="agent-card-body">
                            <p class="agent-description">Validates bond/HFA lock requests before submission, checking for common issues like loan amount mismatches, missing subordinate loans, and commitment document requirements.</p>
                            <div class="agent-flow">
                                <div class="agent-flow-title">Agent Flow</div>
                                <div class="agent-flow-diagram">
                                    <span class="agent-step">Extract Data</span>
                                    <span class="agent-arrow">-></span>
                                    <span class="agent-step">Validate Fields</span>
                                    <span class="agent-arrow">-></span>
                                    <span class="agent-step">Check Sync</span>
                                    <span class="agent-arrow">-></span>
                                    <span class="agent-step">Report Issues</span>
                                </div>
                            </div>
                            <div class="agent-stats">
                                <div class="agent-stat">
                                    <div class="agent-stat-value">2 min</div>
                                    <div class="agent-stat-label">Time Saved</div>
                                </div>
                                <div class="agent-stat">
                                    <div class="agent-stat-value">95%</div>
                                    <div class="agent-stat-label">Accuracy</div>
                                </div>
                                <div class="agent-stat">
                                    <div class="agent-stat-value">Med</div>
                                    <div class="agent-stat-label">Complexity</div>
                                </div>
                            </div>
                            <button class="agent-prompt-btn" onclick="showAgentPrompt('bondvalidator')">
                                View Build Prompt
                            </button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </main>

    <!-- Documentation Modal -->
    <div class="modal-overlay" id="docModal">
        <div class="modal">
            <div class="modal-header">
                <h3>Lock Desk FAQs Documentation</h3>
                <div class="modal-actions">
                    <button class="modal-btn copy" onclick="copyToClipboard()">Copy</button>
                    <button class="modal-btn close" onclick="closeDocModal()">Close</button>
                </div>
            </div>
            <div class="modal-body">
                <pre id="docContent"># Lock Desk FAQs for JV Partners - Optimal Blue

## Contact Information
- Phone: 925-983-3225
- Email: jvcapmkts@cmgfi.com
- Hours: Mon-Fri 7:00am - 4:00pm PT

## Locking Hours
- Agency: 7:00am - 11:59pm PST
- Jumbo/Non-Agency: 8:45am - 4:00pm PST
- AIO/HFA Bond: 8:00am - 4:00pm PST
- Chenoa/Buyers Choice: 8:30am - 1:00pm PST

## Self-Service in Optimal Blue
- Locking, Relocking, Extensions
- Float Downs (Agency, one-time)
- Parameter Changes
- Program Switching

## Manual Lock Products
- AIO, Bond/HFA, Chenoa
- CMG 2nds/HELOCs, Near Miss, Alt-A
- Construction 2X Close, Jumbo Renovation

## Key Reminders
- Lock Extension Cost: 0.02/day (Agency/Jumbo)
- Non-Agency Relock: 60 days after expiration
- No 10-day locks for Non-Agency
- AIO requires UW Approved status</pre>
            </div>
        </div>
    </div>

    <!-- AI Prompt Modal -->
    <div class="modal-overlay prompt-modal" id="promptModal">
        <div class="modal">
            <div class="modal-header">
                <h3 id="promptModalTitle">AI Agent Build Prompt</h3>
                <div class="modal-actions">
                    <button class="modal-btn copy" onclick="copyPromptToClipboard()">Copy Prompt</button>
                    <button class="modal-btn close" onclick="closePromptModal()">Close</button>
                </div>
            </div>
            <div class="modal-body">
                <div class="prompt-tags" id="promptTags"></div>
                <div class="prompt-section">
                    <h4>Agent Purpose</h4>
                    <div class="prompt-box" id="promptPurpose"></div>
                </div>
                <div class="prompt-section">
                    <h4>Full Build Prompt</h4>
                    <div class="prompt-box" id="promptContent"></div>
                </div>
                <div class="prompt-section">
                    <h4>Integration Points</h4>
                    <div class="prompt-box" id="promptIntegration"></div>
                </div>
            </div>
        </div>
    </div>

    <div class="copy-success" id="copySuccess">Copied to clipboard!</div>

    <script>
        // Tab switching
        function switchTab(tab) {
            document.querySelectorAll('.sidebar-tab').forEach(t => t.classList.remove('active'));
            document.querySelectorAll('.tab-panel').forEach(p => p.classList.remove('active'));

            if (tab === 'workflow') {
                document.querySelector('.sidebar-tab:not(.agent-tab)').classList.add('active');
                document.getElementById('workflow-panel').classList.add('active');
                document.getElementById('workflow-nav').style.display = 'block';
                document.getElementById('agents-nav').style.display = 'none';
            } else {
                document.querySelector('.sidebar-tab.agent-tab').classList.add('active');
                document.getElementById('agents-panel').classList.add('active');
                document.getElementById('workflow-nav').style.display = 'none';
                document.getElementById('agents-nav').style.display = 'block';
            }

            window.scrollTo(0, 0);
        }

        // Scroll spy with isScrolling flag and 1000ms timeout
        const sections = document.querySelectorAll('.section, .quick-ref');
        const navItems = document.querySelectorAll('#workflow-nav .nav-item');
        let isScrolling = false;
        let scrollTimeout;

        function updateActiveNav() {
            if (isScrolling) return;

            let current = '';
            sections.forEach(section => {
                const sectionTop = section.offsetTop - 100;
                if (window.scrollY >= sectionTop) current = section.getAttribute('id');
            });
            navItems.forEach(item => {
                item.classList.remove('active');
                if (item.getAttribute('href') === '#' + current) item.classList.add('active');
            });
        }

        // Handle nav click to temporarily disable scroll spy
        navItems.forEach(item => {
            item.addEventListener('click', function(e) {
                isScrolling = true;
                clearTimeout(scrollTimeout);

                // Remove active from all, add to clicked
                navItems.forEach(nav => nav.classList.remove('active'));
                this.classList.add('active');

                // Re-enable scroll spy after 1000ms
                scrollTimeout = setTimeout(() => {
                    isScrolling = false;
                }, 1000);
            });
        });

        window.addEventListener('scroll', updateActiveNav);

        // Modal
        function openDocModal() {
            document.getElementById('docModal').classList.add('show');
            document.body.style.overflow = 'hidden';
        }

        function closeDocModal() {
            document.getElementById('docModal').classList.remove('show');
            document.body.style.overflow = '';
        }

        async function copyToClipboard() {
            try {
                await navigator.clipboard.writeText(document.getElementById('docContent').textContent);
                const success = document.getElementById('copySuccess');
                success.style.display = 'block';
                setTimeout(() => { success.style.display = 'none'; }, 2000);
            } catch (e) { alert('Failed to copy.'); }
        }

        document.addEventListener('keydown', (e) => { if (e.key === 'Escape') { closeDocModal(); closePromptModal(); } });
        document.getElementById('docModal').addEventListener('click', (e) => { if (e.target.id === 'docModal') closeDocModal(); });

        document.addEventListener('DOMContentLoaded', () => { updateActiveNav(); });

        // Scroll to agent card and highlight
        function scrollToAgent(agentId) {
            const agentCard = document.getElementById(agentId);
            if (agentCard) {
                document.querySelectorAll('.agent-card.highlight').forEach(card => {
                    card.classList.remove('highlight');
                });

                agentCard.scrollIntoView({ behavior: 'smooth', block: 'center' });

                setTimeout(() => {
                    agentCard.classList.add('highlight');
                }, 300);

                setTimeout(() => {
                    agentCard.classList.remove('highlight');
                }, 2500);
            }
        }

        // Agent Prompt System
        const agentPrompts = {
            lockrouter: {
                name: 'Lock Request Router',
                tags: ['Workflow Automation', 'Email Processing', 'Medium Complexity', 'Critical Priority'],
                purpose: `This agent automatically analyzes incoming lock request emails and routes them to the appropriate lock desk team based on product type, eliminating confusion about which inbox handles which products and reducing response time.`,
                prompt: `You are building a Workflow Automation Agent for CMG Financial's JV Lock Desk process.

AGENT NAME: Lock Request Router
TYPE: Email Processing / Workflow Automation

OBJECTIVE:
Automatically parse incoming lock request emails and route them to the correct lock desk inbox based on product type identification.

INPUT DATA:
- Email subject line
- Email body content
- Loan number (J-prefix)
- Product type keywords

ROUTING RULES:
1. Agency/Conventional/Government -> jvcapmkts@cmgfi.com
2. Jumbo/Non-Agency -> jvcapmkts@cmgfi.com (or NonAgencyLocks@cmgfi.com for complex)
3. AIO Loans -> jvcapmkts@cmgfi.com (flag as manual)
4. Bond/HFA/Chenoa -> jvcapmkts@cmgfi.com (flag as manual)
5. Non-QM Products -> jvcapmkts@cmgfi.com
6. Figure -> Route to Figure directly (N/A)

PRODUCT IDENTIFICATION KEYWORDS:
{
  "agency": ["conventional", "fannie", "freddie", "fha", "va", "usda", "government"],
  "jumbo": ["jumbo", "non-agency", "non-qm", "dscr", "bank statement"],
  "aio": ["all-in-one", "aio", "heloc first"],
  "bond": ["bond", "hfa", "chenoa", "down payment assistance", "dpa"],
  "nonqm": ["sharp", "horizon", "prime", "advantage", "connect", "edge", "river"]
}

OUTPUT:
{
  "loan_number": "J123456789",
  "product_type": "Jumbo",
  "routing_desk": "jvcapmkts@cmgfi.com",
  "manual_lock": false,
  "priority": "normal",
  "auto_response": true
}

AUTO-RESPONSE TEMPLATE:
Subject: RE: [Original Subject] - Routed to [Desk Name]
Body: Your lock request has been received and routed to the appropriate team.
      Estimated response time: [X] hours
      Reference: [Ticket ID]`,
                integration: `INTEGRATION POINTS:
1. Email Server (Exchange/O365)
   - Monitor incoming emails to shared inbox
   - Parse subject and body
   - Auto-forward with routing metadata

2. Ticketing System
   - Create ticket on receipt
   - Track routing decisions
   - Measure response times

3. Notification Service
   - Send confirmation to sender
   - Alert desk on high-priority items
   - Escalate aged items

4. Reporting Dashboard
   - Volume by product type
   - Routing accuracy metrics
   - Response time analytics`
            },
            producteligibility: {
                name: 'Product Eligibility Agent',
                tags: ['Decision Support', 'Knowledge Base', 'Low Complexity', 'High Priority'],
                purpose: `This agent instantly determines whether a loan product can be locked directly in Optimal Blue or requires manual lock desk intervention, providing clear next steps for the user.`,
                prompt: `You are building a Decision Support Agent for CMG Financial's Optimal Blue lock process.

AGENT NAME: Product Eligibility Agent
TYPE: Knowledge Base / Decision Support

OBJECTIVE:
Instantly determine lock method eligibility for any product and provide actionable guidance.

INPUT:
- Product name/type
- Loan scenario details (optional)

PRODUCT MATRIX:
{
  "ob_enabled": [
    "Agency Conventional",
    "Government (FHA/VA/USDA)",
    "PLS Program",
    "Jumbo/Non Agency",
    "Non-QM (Sharp, Horizon, Prime, Advantage, Connect, Edge, River)",
    "Community Lending (Classic & Plus)",
    "Med Pro Advantage",
    "FHA Buyers Choice",
    "Renovation (203K, Choice, Homestyle)"
  ],
  "manual_only": [
    "All-In-One (AIO)",
    "Near Miss & Alt-A",
    "CMG 2nds or HELOCs",
    "Premier CES",
    "All Bond programs (incl. Chenoa)",
    "Construction 2X Close",
    "Jumbo Renovation"
  ],
  "external": [
    "Figure"
  ]
}

OUTPUT:
{
  "product": "AIO",
  "lock_method": "manual",
  "ob_available": false,
  "contact": "jvcapmkts@cmgfi.com",
  "prerequisites": ["UW Approved status required"],
  "steps": [
    "Ensure loan is UW Approved",
    "Email jvcapmkts@cmgfi.com",
    "Include: loan number, borrower last name, desired margin"
  ],
  "locking_hours": "8:00am - 4:00pm PST"
}`,
                integration: `INTEGRATION POINTS:
1. Product Database
   - Maintain current product matrix
   - Track guideline changes
   - Version control for audit

2. Byte/Clear Integration
   - Pull loan product type
   - Check loan status
   - Pre-populate lock request

3. Chatbot/UI
   - Instant lookup interface
   - Natural language query
   - Mobile-friendly

4. Training Content
   - Link to relevant job aids
   - Video tutorials
   - FAQ responses`
            },
            lockexpiration: {
                name: 'Lock Expiration Monitor',
                tags: ['Monitoring', 'Alerts', 'Low Complexity', 'High Priority'],
                purpose: `This agent monitors all active locks and sends proactive alerts before expiration, calculating extension costs and providing step-by-step guidance for extending or relocking.`,
                prompt: `You are building a Monitoring Agent for CMG Financial's Lock Desk operations.

AGENT NAME: Lock Expiration Monitor
TYPE: Monitoring / Push Notifications

OBJECTIVE:
Monitor all active locks and alert users before expiration with calculated costs and action steps.

MONITORING PARAMETERS:
- Lock expiration date
- Product type (affects extension cost)
- Days remaining
- Current loan status

ALERT THRESHOLDS:
- 7 days: INFO - Friendly reminder
- 3 days: WARNING - Action recommended
- 1 day: URGENT - Immediate action required
- 0 days: CRITICAL - Lock expired

EXTENSION COST CALCULATION:
{
  "agency_jumbo": {
    "daily_rate": 0.02,
    "formula": "days_needed * 0.02 * loan_amount / 100"
  },
  "non_agency": {
    "daily_rate": "varies by investor",
    "contact_required": true
  }
}

ALERT MESSAGE:
{
  "loan_number": "J123456789",
  "borrower": "John Smith",
  "product": "Conventional 30yr",
  "lock_date": "2025-01-15",
  "expiration_date": "2025-02-14",
  "days_remaining": 3,
  "alert_level": "WARNING",
  "extension_cost": {
    "per_day": "$200",
    "7_days": "$1,400",
    "14_days": "$2,800"
  },
  "action_steps": [
    "Log into Optimal Blue via Byte/Clear",
    "Click Change Request icon",
    "Select Lock Extension",
    "Choose extension period",
    "Confirm and submit"
  ],
  "alternative": "If lock expires, relock available after 30 days (60 days for Non-Agency)"
}`,
                integration: `INTEGRATION POINTS:
1. Optimal Blue API
   - Pull active locks
   - Get expiration dates
   - Calculate costs

2. Notification Channels
   - Email alerts
   - SMS for urgent
   - Dashboard notifications

3. Escalation Rules
   - Auto-escalate on no action
   - Manager alerts at CRITICAL
   - Weekly summary reports

4. Analytics
   - Extension frequency
   - Cost trends
   - Expired lock patterns`
            },
            bondvalidator: {
                name: 'Bond Lock Validator',
                tags: ['Data Validation', 'Document Processing', 'Medium Complexity', 'Medium Priority'],
                purpose: `This agent validates bond/HFA lock requests before submission, checking for common issues that cause delays and providing a pre-submission checklist to ensure first-time success.`,
                prompt: `You are building a Data Validation Agent for CMG Financial's Bond Lock process.

AGENT NAME: Bond Lock Validator
TYPE: Data Validation / Pre-submission Check

OBJECTIVE:
Validate bond lock requests before submission to prevent common delays and back-and-forth with lock desk.

VALIDATION CHECKS:
1. Loan Amount Validation
   - Compare Byte loan amount vs HFA commitment
   - Check: Total amount (with MIP) vs Base amount
   - Flag if mismatch > $100

2. Subordinate Loan Sync
   - If 2nd/3rd loan exists, verify created in Byte
   - Check synchronization status
   - Flag if not synced

3. Property Data Match
   - Street address accuracy
   - City/State/Zip validation
   - Cross-reference with HFA commitment

4. Document Requirements
   - PDF commitment confirmation (not screenshot)
   - Valid expiration date
   - Agency signature/stamp visible

5. Lock Timing
   - Within locking hours (8:00am - 4:00pm PST)
   - Sufficient time before commitment expiration

INPUT:
{
  "loan_number": "J123456789",
  "byte_loan_amount": 350000,
  "hfa_commitment_amount": 356750,
  "has_2nd_loan": true,
  "2nd_loan_synced": false,
  "property_address": "123 Main St, Phoenix, AZ 85001",
  "commitment_doc_type": "pdf",
  "commitment_expiration": "2025-02-28"
}

OUTPUT:
{
  "validation_status": "FAILED",
  "issues": [
    {
      "severity": "CRITICAL",
      "field": "2nd_loan_sync",
      "message": "2nd loan not synchronized in Byte",
      "action": "Create and sync 2nd loan before requesting lock"
    },
    {
      "severity": "WARNING",
      "field": "loan_amount",
      "message": "Difference of $6,750 between Byte and HFA",
      "action": "Verify MIP is included in HFA commitment"
    }
  ],
  "ready_to_submit": false,
  "checklist_complete": 3,
  "checklist_total": 5
}`,
                integration: `INTEGRATION POINTS:
1. Byte LOS
   - Pull loan data
   - Check subordinate loans
   - Verify sync status

2. Document Processing
   - Extract data from PDF commitments
   - OCR for amount validation
   - Expiration date parsing

3. HFA Portal APIs (where available)
   - Real-time commitment verification
   - Amount reconciliation
   - Status checks

4. Pre-submission UI
   - Interactive checklist
   - Issue resolution guidance
   - One-click revalidation`
            }
        };

        // Show agent prompt modal
        let currentPromptContent = '';

        function showAgentPrompt(agentKey) {
            const agent = agentPrompts[agentKey];
            if (!agent) return;

            document.getElementById('promptModalTitle').textContent = agent.name + ' - Build Prompt';

            const tagsHtml = agent.tags.map(tag => '<span class="prompt-tag">' + tag + '</span>').join('');
            document.getElementById('promptTags').innerHTML = tagsHtml;

            document.getElementById('promptPurpose').textContent = agent.purpose;
            document.getElementById('promptContent').textContent = agent.prompt;
            document.getElementById('promptIntegration').textContent = agent.integration;

            currentPromptContent = '# ' + agent.name + '\n\n## Purpose\n' + agent.purpose + '\n\n## Build Prompt\n' + agent.prompt + '\n\n## Integration Points\n' + agent.integration;

            document.getElementById('promptModal').classList.add('show');
            document.body.style.overflow = 'hidden';
        }

        function closePromptModal() {
            document.getElementById('promptModal').classList.remove('show');
            document.body.style.overflow = '';
        }

        async function copyPromptToClipboard() {
            try {
                await navigator.clipboard.writeText(currentPromptContent);
                const success = document.getElementById('copySuccess');
                success.style.display = 'block';
                setTimeout(() => { success.style.display = 'none'; }, 2000);
            } catch (e) {
                alert('Failed to copy prompt.');
            }
        }

        document.getElementById('promptModal').addEventListener('click', (e) => {
            if (e.target.id === 'promptModal') closePromptModal();
        });
    </script>
</body>
</html>
