<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Byte Disclosure 1004D COC - Process Workflow</title>
    <link href="https://fonts.googleapis.com/css2?family=Plus+Jakarta+Sans:wght@400;500;600;700;800&family=JetBrains+Mono:wght@400;500&display=swap" rel="stylesheet">
    <style>
        :root {
            --bg-primary: #0a0f1a;
            --bg-secondary: #111827;
            --bg-card: #1a2234;
            --accent-blue: #3b82f6;
            --accent-teal: #14b8a6;
            --accent-amber: #f59e0b;
            --accent-rose: #f43f5e;
            --accent-green: #22c55e;
            --accent-purple: #8b5cf6;
            --text-primary: #f1f5f9;
            --text-secondary: #94a3b8;
            --text-muted: #64748b;
            --border-subtle: rgba(255,255,255,0.08);
            --sidebar-width: 280px;
        }

        * { box-sizing: border-box; margin: 0; padding: 0; }
        html { scroll-behavior: smooth; }
        body {
            font-family: 'Plus Jakarta Sans', -apple-system, BlinkMacSystemFont, sans-serif;
            background: var(--bg-primary);
            color: var(--text-primary);
            min-height: 100vh;
        }

        /* Breadcrumb */
        .breadcrumb {
            background: linear-gradient(90deg, #0d1525 0%, #1a2234 100%);
            padding: 14px 25px;
            display: flex;
            align-items: center;
            gap: 12px;
            font-size: 0.95rem;
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            z-index: 1001;
            border-bottom: 1px solid var(--border-subtle);
        }

        .breadcrumb a {
            color: var(--text-secondary);
            text-decoration: none;
            font-weight: 600;
            padding: 8px 16px;
            background: rgba(255,255,255,0.05);
            border-radius: 8px;
            transition: all 0.2s;
            border: 1px solid var(--border-subtle);
        }

        .breadcrumb a:hover {
            background: rgba(59, 130, 246, 0.15);
            color: var(--accent-blue);
            border-color: rgba(59, 130, 246, 0.3);
        }

        .breadcrumb .separator { color: var(--text-muted); font-size: 1.2rem; }
        .breadcrumb .current { color: var(--accent-amber); font-weight: 600; padding: 8px 16px; }

        /* Sidebar */
        .sidebar {
            position: fixed;
            top: 54px;
            left: 0;
            width: var(--sidebar-width);
            height: calc(100vh - 54px);
            background: var(--bg-secondary);
            overflow-y: auto;
            z-index: 1000;
            border-right: 1px solid var(--border-subtle);
            display: flex;
            flex-direction: column;
        }

        .sidebar-header {
            padding: 25px 20px;
            background: rgba(0,0,0,0.3);
            border-bottom: 1px solid var(--border-subtle);
        }

        .sidebar-header h2 { color: var(--text-primary); font-size: 1.2rem; font-weight: 700; margin-bottom: 5px; }
        .sidebar-header p { color: var(--text-muted); font-size: 0.85rem; }

        /* Tab Switch */
        .sidebar-tabs {
            display: flex;
            border-bottom: 1px solid var(--border-subtle);
        }

        .sidebar-tab {
            flex: 1;
            padding: 14px 10px;
            text-align: center;
            font-size: 0.8rem;
            font-weight: 700;
            color: var(--text-muted);
            cursor: pointer;
            transition: all 0.2s;
            border-bottom: 3px solid transparent;
            background: none;
            border-left: none;
            border-right: none;
            border-top: none;
        }

        .sidebar-tab:hover { background: rgba(255,255,255,0.03); color: var(--text-secondary); }
        .sidebar-tab.active { color: var(--accent-blue); border-bottom-color: var(--accent-blue); background: rgba(59, 130, 246, 0.08); }
        .sidebar-tab.agent-tab.active { color: var(--accent-purple); border-bottom-color: var(--accent-purple); background: rgba(139, 92, 246, 0.08); }

        .sidebar-nav { padding: 15px 0; flex: 1; overflow-y: auto; }

        .nav-item {
            display: flex;
            align-items: center;
            gap: 12px;
            padding: 14px 20px;
            color: var(--text-secondary);
            text-decoration: none;
            border-left: 3px solid transparent;
            transition: all 0.2s ease;
            cursor: pointer;
        }

        .nav-item:hover { background: rgba(255,255,255,0.03); color: var(--text-primary); }
        .nav-item.active { background: rgba(59, 130, 246, 0.1); border-left-color: var(--accent-blue); color: var(--text-primary); }

        .nav-number {
            background: rgba(255,255,255,0.1);
            color: var(--text-secondary);
            width: 28px;
            height: 28px;
            border-radius: 8px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 700;
            font-size: 0.85rem;
            flex-shrink: 0;
        }

        .nav-item.active .nav-number { background: var(--accent-blue); color: white; }
        .nav-label { font-size: 0.95rem; font-weight: 500; }

        .sidebar-footer {
            padding: 20px;
            border-top: 1px solid var(--border-subtle);
            background: rgba(0,0,0,0.2);
        }

        .doc-btn {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
            width: 100%;
            padding: 14px 20px;
            background: linear-gradient(135deg, var(--accent-blue) 0%, var(--accent-teal) 100%);
            color: white;
            border: none;
            border-radius: 10px;
            font-weight: 600;
            cursor: pointer;
            transition: transform 0.2s, box-shadow 0.2s;
            text-decoration: none;
            font-size: 0.95rem;
        }

        .doc-btn:hover { transform: translateY(-2px); box-shadow: 0 8px 25px rgba(59, 130, 246, 0.3); }

        /* Main Content */
        .main-content { margin-left: var(--sidebar-width); padding: 80px 40px 40px 40px; }

        /* Tab Panels */
        .tab-panel { display: none; }
        .tab-panel.active { display: block; }

        .header {
            background: var(--bg-card);
            border: 1px solid var(--border-subtle);
            padding: 35px;
            border-radius: 16px;
            margin-bottom: 30px;
            position: relative;
            overflow: hidden;
        }

        .header::before {
            content: '';
            position: absolute;
            top: 0; left: 0; right: 0; bottom: 0;
            background:
                radial-gradient(ellipse at 20% 20%, rgba(59, 130, 246, 0.1) 0%, transparent 50%),
                radial-gradient(ellipse at 80% 80%, rgba(20, 184, 166, 0.08) 0%, transparent 50%);
            pointer-events: none;
        }

        .header h1 {
            font-size: 2.2rem;
            font-weight: 800;
            margin-bottom: 10px;
            position: relative;
            background: linear-gradient(135deg, var(--text-primary) 0%, var(--accent-blue) 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .header .subtitle { color: var(--text-secondary); font-size: 1.1rem; position: relative; }

        .header .meta { display: flex; gap: 15px; margin-top: 20px; flex-wrap: wrap; position: relative; }

        .header .meta-item {
            background: rgba(255,255,255,0.05);
            border: 1px solid var(--border-subtle);
            padding: 8px 16px;
            border-radius: 8px;
            font-size: 0.9rem;
            color: var(--text-secondary);
        }

        /* Legend */
        .legend {
            display: flex;
            flex-wrap: wrap;
            gap: 15px;
            padding: 18px 22px;
            background: var(--bg-card);
            border: 1px solid var(--border-subtle);
            border-radius: 12px;
            margin-bottom: 25px;
        }

        .legend-item { display: flex; align-items: center; gap: 8px; font-size: 0.85rem; color: var(--text-secondary); }
        .legend-color { width: 18px; height: 18px; border-radius: 4px; }

        /* Sections */
        .section {
            background: var(--bg-card);
            border: 1px solid var(--border-subtle);
            border-radius: 16px;
            margin-bottom: 25px;
            overflow: hidden;
            scroll-margin-top: 75px;
        }

        .section-header {
            background: linear-gradient(135deg, var(--bg-secondary) 0%, rgba(59, 130, 246, 0.1) 100%);
            border-bottom: 1px solid var(--border-subtle);
            padding: 22px 25px;
            display: flex;
            align-items: center;
            gap: 18px;
        }

        .section-number {
            background: linear-gradient(135deg, var(--accent-blue) 0%, var(--accent-teal) 100%);
            color: white;
            width: 48px;
            height: 48px;
            border-radius: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 800;
            font-size: 1.3rem;
            flex-shrink: 0;
        }

        .section-title h2 { font-size: 1.35rem; font-weight: 700; margin-bottom: 4px; color: var(--text-primary); }
        .section-title span { font-size: 0.9rem; color: var(--text-muted); }
        .section-content { padding: 28px; }

        /* Workflow Diagrams */
        .workflow-diagram {
            background: rgba(0,0,0,0.3);
            border: 1px solid var(--border-subtle);
            border-radius: 12px;
            padding: 28px;
            margin-bottom: 22px;
        }

        .flow-row { display: flex; align-items: center; justify-content: center; flex-wrap: wrap; gap: 12px; margin: 15px 0; }

        .flow-node {
            padding: 14px 22px;
            border-radius: 10px;
            text-align: center;
            font-size: 0.9rem;
            font-weight: 600;
            min-width: 150px;
            border: 1px solid var(--border-subtle);
        }

        .flow-node.start { background: linear-gradient(135deg, var(--accent-green) 0%, #16a34a 100%); color: white; border-radius: 25px; border: none; }
        .flow-node.action { background: linear-gradient(135deg, var(--accent-blue) 0%, #2563eb 100%); color: white; border: none; }
        .flow-node.decision { background: linear-gradient(135deg, var(--accent-amber) 0%, #d97706 100%); color: var(--bg-primary); border: none; }
        .flow-node.input { background: var(--bg-secondary); border: 2px solid var(--accent-blue); color: var(--text-primary); }
        .flow-node.output { background: linear-gradient(135deg, var(--accent-teal) 0%, #0d9488 100%); color: white; border: none; }
        .flow-node.exception { background: linear-gradient(135deg, var(--accent-rose) 0%, #dc2626 100%); color: white; border: none; }

        .flow-arrow { color: var(--accent-blue); font-size: 1.5rem; }
        .flow-arrow.down { transform: rotate(90deg); }

        .decision-branch { display: flex; gap: 40px; justify-content: center; margin: 20px 0; flex-wrap: wrap; }
        .branch { display: flex; flex-direction: column; align-items: center; gap: 10px; }

        .branch-label {
            background: var(--bg-secondary);
            border: 1px solid var(--border-subtle);
            padding: 6px 16px;
            border-radius: 20px;
            font-size: 0.8rem;
            font-weight: 700;
            color: var(--text-secondary);
        }

        /* Tables */
        .field-table { width: 100%; border-collapse: collapse; margin: 18px 0; }

        .field-table th {
            background: rgba(59, 130, 246, 0.15);
            color: var(--accent-blue);
            padding: 14px 18px;
            text-align: left;
            font-weight: 600;
            font-size: 0.9rem;
            text-transform: uppercase;
            letter-spacing: 0.05em;
            border-bottom: 1px solid var(--border-subtle);
        }

        .field-table td { padding: 14px 18px; border-bottom: 1px solid var(--border-subtle); color: var(--text-secondary); }
        .field-table tr:hover { background: rgba(255,255,255,0.02); }

        .badge { display: inline-block; padding: 4px 12px; border-radius: 6px; font-size: 0.75rem; font-weight: 700; text-transform: uppercase; letter-spacing: 0.05em; }
        .badge.required-badge { background: rgba(244, 63, 94, 0.15); color: var(--accent-rose); }
        .badge.optional-badge { background: rgba(34, 197, 94, 0.15); color: var(--accent-green); }
        .badge.calculated-badge { background: rgba(59, 130, 246, 0.15); color: var(--accent-blue); }
        .badge.conditional-badge { background: rgba(245, 158, 11, 0.15); color: var(--accent-amber); }

        /* Info Boxes */
        .exception-box, .tip-box, .info-box {
            padding: 18px 22px;
            margin: 18px 0;
            border-radius: 0 10px 10px 0;
            border-left-width: 4px;
            border-left-style: solid;
        }

        .exception-box { background: rgba(244, 63, 94, 0.08); border-color: var(--accent-rose); border: 1px solid rgba(244, 63, 94, 0.2); border-left: 4px solid var(--accent-rose); }
        .exception-box h4 { color: var(--accent-rose); margin-bottom: 10px; font-size: 1rem; }
        .exception-box p, .exception-box li { color: var(--text-secondary); }

        .tip-box { background: rgba(34, 197, 94, 0.08); border-color: var(--accent-green); border: 1px solid rgba(34, 197, 94, 0.2); border-left: 4px solid var(--accent-green); }
        .tip-box h4 { color: var(--accent-green); margin-bottom: 10px; font-size: 1rem; }
        .tip-box p, .tip-box li { color: var(--text-secondary); }

        .info-box { background: rgba(59, 130, 246, 0.08); border-color: var(--accent-blue); border: 1px solid rgba(59, 130, 246, 0.2); border-left: 4px solid var(--accent-blue); }
        .info-box h4 { color: var(--accent-blue); margin-bottom: 10px; font-size: 1rem; }
        .info-box p, .info-box li { color: var(--text-secondary); }

        /* Decision Tree */
        .decision-tree {
            background: rgba(0,0,0,0.2);
            border: 1px solid var(--border-subtle);
            border-radius: 12px;
            padding: 22px;
            margin: 22px 0;
        }

        .decision-tree h3 { color: var(--accent-blue); margin-bottom: 18px; padding-bottom: 12px; border-bottom: 1px solid var(--border-subtle); font-size: 1.1rem; }

        .tree-node { margin-left: 20px; padding: 12px; border-left: 2px solid var(--accent-teal); position: relative; color: var(--text-secondary); }
        .tree-node::before { content: ''; position: absolute; left: -2px; top: 22px; width: 15px; height: 2px; background: var(--accent-teal); }
        .tree-node.level-1 { margin-left: 0; border-left: none; }
        .tree-node.level-1::before { display: none; }

        .tree-label { background: var(--accent-amber); color: var(--bg-primary); padding: 6px 14px; border-radius: 6px; font-weight: 700; display: inline-block; margin-bottom: 6px; font-size: 0.9rem; }

        /* Summary Grid */
        .summary-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(180px, 1fr)); gap: 18px; margin: 22px 0; }

        .summary-card { background: rgba(0,0,0,0.3); border: 1px solid var(--border-subtle); border-radius: 12px; padding: 22px; text-align: center; }
        .summary-card h4 { color: var(--text-secondary); margin-bottom: 12px; font-size: 0.9rem; }
        .summary-card .value {
            font-size: 2.2rem;
            font-weight: 800;
            background: linear-gradient(135deg, var(--accent-blue) 0%, var(--accent-teal) 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }
        .summary-card .label { font-size: 0.85rem; color: var(--text-muted); margin-top: 8px; }

        /* MI Comparison Cards */
        .mi-comparison { display: grid; grid-template-columns: repeat(auto-fit, minmax(280px, 1fr)); gap: 20px; margin: 22px 0; }

        .mi-card { background: rgba(0,0,0,0.2); border: 1px solid var(--border-subtle); border-radius: 12px; overflow: hidden; }
        .mi-card-header { background: linear-gradient(135deg, var(--accent-blue) 0%, var(--accent-teal) 100%); color: white; padding: 18px; text-align: center; }
        .mi-card-header h4 { font-size: 1.05rem; }
        .mi-card-body { padding: 22px; }
        .mi-card ul { list-style: none; padding: 0; }
        .mi-card li { padding: 10px 0; border-bottom: 1px solid var(--border-subtle); display: flex; align-items: center; gap: 12px; color: var(--text-secondary); font-size: 0.95rem; }
        .mi-card li:last-child { border-bottom: none; }
        .check-icon { color: var(--accent-green); font-weight: bold; }
        .x-icon { color: var(--accent-rose); font-weight: bold; }

        /* Quick Reference */
        .quick-ref {
            background: linear-gradient(135deg, var(--bg-secondary) 0%, var(--bg-card) 100%);
            border: 1px solid var(--border-subtle);
            padding: 28px;
            border-radius: 16px;
            margin-top: 30px;
            font-family: 'JetBrains Mono', monospace;
            scroll-margin-top: 75px;
        }

        .quick-ref h3 { color: var(--accent-amber); margin-bottom: 18px; font-family: 'Plus Jakarta Sans', sans-serif; }
        .quick-ref pre { background: rgba(0,0,0,0.4); border: 1px solid var(--border-subtle); padding: 20px; border-radius: 10px; overflow-x: auto; font-size: 0.85rem; line-height: 1.7; color: var(--text-secondary); }

        /* ====== AGENT OPPORTUNITIES STYLES ====== */
        .agent-header {
            background: var(--bg-card);
            border: 1px solid var(--border-subtle);
            padding: 35px;
            border-radius: 16px;
            margin-bottom: 30px;
            position: relative;
            overflow: hidden;
        }

        .agent-header::before {
            content: '';
            position: absolute;
            top: 0; left: 0; right: 0; bottom: 0;
            background:
                radial-gradient(ellipse at 20% 20%, rgba(139, 92, 246, 0.12) 0%, transparent 50%),
                radial-gradient(ellipse at 80% 80%, rgba(245, 158, 11, 0.1) 0%, transparent 50%);
            pointer-events: none;
        }

        .agent-header h1 {
            font-size: 2.2rem;
            font-weight: 800;
            margin-bottom: 10px;
            position: relative;
            background: linear-gradient(135deg, var(--accent-purple) 0%, var(--accent-amber) 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .agent-header .subtitle { color: var(--text-secondary); font-size: 1.1rem; position: relative; }

        /* Heat Map */
        .heat-map-container { margin-bottom: 35px; }
        .heat-map-title { font-size: 1.3rem; font-weight: 700; color: var(--text-primary); margin-bottom: 20px; display: flex; align-items: center; gap: 12px; }

        .heat-map-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
        }

        .heat-item {
            background: var(--bg-card);
            border: 1px solid var(--border-subtle);
            border-radius: 12px;
            padding: 20px;
            position: relative;
            overflow: hidden;
            transition: transform 0.2s, box-shadow 0.2s;
            cursor: pointer;
        }

        .heat-item:hover { transform: translateY(-3px); box-shadow: 0 10px 30px rgba(0,0,0,0.3); }
        .heat-item:active { transform: scale(0.98); }

        .heat-item::before {
            content: '';
            position: absolute;
            top: 0; left: 0; right: 0; height: 4px;
        }

        .heat-item.critical::before { background: linear-gradient(90deg, #ef4444, #f97316); }
        .heat-item.high::before { background: linear-gradient(90deg, #f97316, #eab308); }
        .heat-item.medium::before { background: linear-gradient(90deg, #eab308, #22c55e); }
        .heat-item.low::before { background: linear-gradient(90deg, #22c55e, #14b8a6); }

        .heat-score {
            position: absolute;
            top: 15px;
            right: 15px;
            font-size: 1.8rem;
            font-weight: 800;
        }

        .heat-item.critical .heat-score { color: #ef4444; }
        .heat-item.high .heat-score { color: #f97316; }
        .heat-item.medium .heat-score { color: #eab308; }
        .heat-item.low .heat-score { color: #22c55e; }

        .heat-name { font-size: 1rem; font-weight: 700; color: var(--text-primary); margin-bottom: 6px; padding-right: 50px; }
        .heat-desc { font-size: 0.85rem; color: var(--text-muted); margin-bottom: 12px; }

        .heat-metrics { display: flex; gap: 15px; margin-top: 12px; }
        .heat-metric { font-size: 0.75rem; color: var(--text-muted); }
        .heat-metric span { color: var(--text-secondary); font-weight: 600; }

        /* Agent Cards */
        .agent-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(380px, 1fr)); gap: 25px; margin-bottom: 35px; }

        .agent-card {
            background: var(--bg-card);
            border: 1px solid var(--border-subtle);
            border-radius: 16px;
            overflow: hidden;
            transition: transform 0.2s, box-shadow 0.2s;
        }

        .agent-card:hover { transform: translateY(-5px); box-shadow: 0 15px 50px rgba(0,0,0,0.3); }

        .agent-card.highlight {
            animation: highlightPulse 2s ease;
            box-shadow: 0 0 0 3px var(--accent-purple), 0 15px 50px rgba(139, 92, 246, 0.4);
        }

        @keyframes highlightPulse {
            0% { box-shadow: 0 0 0 3px var(--accent-purple), 0 15px 50px rgba(139, 92, 246, 0.6); }
            50% { box-shadow: 0 0 0 6px rgba(139, 92, 246, 0.5), 0 15px 50px rgba(139, 92, 246, 0.3); }
            100% { box-shadow: 0 0 0 0px transparent, 0 15px 50px rgba(0,0,0,0.3); }
        }

        .agent-card-header {
            padding: 22px;
            display: flex;
            align-items: flex-start;
            gap: 18px;
            border-bottom: 1px solid var(--border-subtle);
        }

        .agent-icon {
            width: 55px;
            height: 55px;
            background: linear-gradient(135deg, var(--accent-purple) 0%, var(--accent-blue) 100%);
            border-radius: 14px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.6rem;
            flex-shrink: 0;
        }

        .agent-info { flex: 1; }
        .agent-name { font-size: 1.15rem; font-weight: 700; color: var(--text-primary); margin-bottom: 5px; }
        .agent-type { font-size: 0.8rem; color: var(--accent-purple); font-weight: 600; text-transform: uppercase; letter-spacing: 0.05em; }

        .agent-priority {
            padding: 6px 12px;
            border-radius: 20px;
            font-size: 0.75rem;
            font-weight: 700;
            text-transform: uppercase;
        }

        .agent-priority.critical { background: rgba(239, 68, 68, 0.15); color: #ef4444; }
        .agent-priority.high { background: rgba(249, 115, 22, 0.15); color: #f97316; }
        .agent-priority.medium { background: rgba(234, 179, 8, 0.15); color: #eab308; }
        .agent-priority.low { background: rgba(34, 197, 94, 0.15); color: #22c55e; }

        .agent-card-body { padding: 22px; }
        .agent-description { font-size: 0.95rem; color: var(--text-secondary); line-height: 1.6; margin-bottom: 20px; }

        .agent-flow {
            background: rgba(0,0,0,0.3);
            border: 1px solid var(--border-subtle);
            border-radius: 10px;
            padding: 18px;
            margin-bottom: 20px;
        }

        .agent-flow-title { font-size: 0.85rem; color: var(--text-muted); margin-bottom: 12px; font-weight: 600; text-transform: uppercase; letter-spacing: 0.05em; }

        .agent-flow-diagram { display: flex; align-items: center; flex-wrap: wrap; gap: 8px; justify-content: center; }

        .agent-step {
            background: linear-gradient(135deg, var(--accent-purple) 0%, var(--accent-blue) 100%);
            color: white;
            padding: 8px 14px;
            border-radius: 6px;
            font-size: 0.8rem;
            font-weight: 600;
            white-space: nowrap;
        }

        .agent-arrow { color: var(--accent-purple); font-size: 1.2rem; }

        .agent-stats { display: grid; grid-template-columns: repeat(3, 1fr); gap: 12px; }

        .agent-stat {
            background: rgba(0,0,0,0.2);
            border-radius: 8px;
            padding: 12px;
            text-align: center;
        }

        .agent-stat-value {
            font-size: 1.3rem;
            font-weight: 800;
            background: linear-gradient(135deg, var(--accent-purple) 0%, var(--accent-amber) 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .agent-stat-label { font-size: 0.7rem; color: var(--text-muted); text-transform: uppercase; letter-spacing: 0.05em; margin-top: 4px; }

        .agent-prompt-btn {
            width: 100%;
            margin-top: 18px;
            padding: 14px 20px;
            background: linear-gradient(135deg, rgba(139, 92, 246, 0.2) 0%, rgba(59, 130, 246, 0.2) 100%);
            border: 1px solid rgba(139, 92, 246, 0.4);
            border-radius: 10px;
            color: var(--accent-purple);
            font-weight: 700;
            cursor: pointer;
            transition: all 0.2s;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
            font-size: 0.9rem;
        }

        .agent-prompt-btn:hover {
            background: linear-gradient(135deg, rgba(139, 92, 246, 0.3) 0%, rgba(59, 130, 246, 0.3) 100%);
            border-color: var(--accent-purple);
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(139, 92, 246, 0.25);
        }

        /* Summary Stats */
        .agent-summary {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin-bottom: 35px;
        }

        .agent-summary-card {
            background: var(--bg-card);
            border: 1px solid var(--border-subtle);
            border-radius: 14px;
            padding: 25px;
            text-align: center;
        }

        .agent-summary-value {
            font-size: 2.5rem;
            font-weight: 800;
            background: linear-gradient(135deg, var(--accent-purple) 0%, var(--accent-amber) 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .agent-summary-label { font-size: 0.9rem; color: var(--text-muted); margin-top: 8px; }

        /* Heat Map Legend */
        .heat-legend {
            display: flex;
            gap: 25px;
            padding: 18px 22px;
            background: var(--bg-card);
            border: 1px solid var(--border-subtle);
            border-radius: 12px;
            margin-bottom: 25px;
            flex-wrap: wrap;
        }

        .heat-legend-item { display: flex; align-items: center; gap: 10px; font-size: 0.9rem; color: var(--text-secondary); }
        .heat-legend-color { width: 24px; height: 24px; border-radius: 6px; }

        /* Modal */
        .modal-overlay {
            display: none;
            position: fixed;
            top: 0; left: 0; right: 0; bottom: 0;
            background: rgba(10, 15, 26, 0.9);
            z-index: 2000;
            justify-content: center;
            align-items: center;
            padding: 20px;
            backdrop-filter: blur(5px);
        }

        .modal-overlay.show { display: flex; }

        .modal {
            background: var(--bg-card);
            border: 1px solid var(--border-subtle);
            border-radius: 16px;
            width: 100%;
            max-width: 950px;
            max-height: 90vh;
            display: flex;
            flex-direction: column;
            box-shadow: 0 25px 80px rgba(0,0,0,0.5);
        }

        .modal-header {
            background: linear-gradient(135deg, var(--accent-blue) 0%, var(--accent-teal) 100%);
            color: white;
            padding: 22px 28px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            border-radius: 16px 16px 0 0;
        }

        .modal-header h3 { font-size: 1.25rem; font-weight: 700; }
        .modal-actions { display: flex; gap: 12px; }

        .modal-btn {
            padding: 10px 18px;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-weight: 700;
            transition: transform 0.2s;
            font-size: 0.9rem;
        }

        .modal-btn:hover { transform: scale(1.05); }
        .modal-btn.copy { background: white; color: var(--accent-blue); }
        .modal-btn.close { background: rgba(255,255,255,0.2); color: white; }

        .modal-body { padding: 28px; overflow-y: auto; flex: 1; }

        .modal-body pre {
            background: rgba(0,0,0,0.3);
            border: 1px solid var(--border-subtle);
            padding: 22px;
            border-radius: 10px;
            font-family: 'JetBrains Mono', monospace;
            font-size: 0.9rem;
            line-height: 1.7;
            white-space: pre-wrap;
            word-wrap: break-word;
            color: var(--text-secondary);
        }

        .copy-success {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: var(--accent-green);
            color: white;
            padding: 18px 35px;
            border-radius: 10px;
            font-weight: 700;
            z-index: 3000;
            display: none;
            animation: fadeInOut 2s ease;
        }

        @keyframes fadeInOut { 0%, 100% { opacity: 0; } 10%, 90% { opacity: 1; } }

        /* Prompt Modal */
        .prompt-modal .modal { max-width: 800px; }
        .prompt-modal .modal-header { background: linear-gradient(135deg, var(--accent-purple) 0%, var(--accent-blue) 100%); }

        .prompt-section { margin-bottom: 25px; }
        .prompt-section h4 { color: var(--accent-purple); font-size: 1rem; margin-bottom: 12px; display: flex; align-items: center; gap: 8px; }

        .prompt-box {
            background: rgba(0,0,0,0.4);
            border: 1px solid var(--border-subtle);
            border-radius: 10px;
            padding: 20px;
            font-family: 'JetBrains Mono', monospace;
            font-size: 0.85rem;
            line-height: 1.7;
            color: var(--text-secondary);
            white-space: pre-wrap;
            word-wrap: break-word;
        }

        .prompt-tags { display: flex; gap: 10px; flex-wrap: wrap; margin-bottom: 20px; }
        .prompt-tag { background: rgba(139, 92, 246, 0.15); color: var(--accent-purple); padding: 6px 14px; border-radius: 20px; font-size: 0.8rem; font-weight: 600; }

        @media (max-width: 900px) {
            .sidebar { display: none; }
            .main-content { margin-left: 0; padding: 75px 20px 30px 20px; }
            .agent-grid { grid-template-columns: 1fr; }
        }
    </style>
</head>
<body>
    <!-- Breadcrumb -->
    <nav class="breadcrumb">
        <a href="../../index.html">Portal Home</a>
        <span class="separator">></span>
        <a href="./index.html">Byte</a>
        <span class="separator">></span>
        <span class="current">Disclosure 1004D COC</span>
    </nav>

    <!-- Fixed Sidebar -->
    <aside class="sidebar">
        <div class="sidebar-header">
            <h2>Disclosure 1004D COC</h2>
            <p>Interactive Workflow Guide</p>
        </div>

        <!-- Tab Switcher -->
        <div class="sidebar-tabs">
            <button class="sidebar-tab active" onclick="switchTab('workflow')">Workflow</button>
            <button class="sidebar-tab agent-tab" onclick="switchTab('agents')">AI Agents</button>
        </div>

        <!-- Workflow Navigation -->
        <nav class="sidebar-nav" id="workflow-nav">
            <a href="#section-0" class="nav-item active">
                <span class="nav-number">0</span>
                <span class="nav-label">Overview</span>
            </a>
            <a href="#section-1" class="nav-item">
                <span class="nav-number">1</span>
                <span class="nav-label">Pipeline Report</span>
            </a>
            <a href="#section-2" class="nav-item">
                <span class="nav-number">2</span>
                <span class="nav-label">Fee History Check</span>
            </a>
            <a href="#section-3" class="nav-item">
                <span class="nav-number">3</span>
                <span class="nav-label">Appraisal Review</span>
            </a>
            <a href="#section-4" class="nav-item">
                <span class="nav-number">4</span>
                <span class="nav-label">Add Fee</span>
            </a>
            <a href="#section-5" class="nav-item">
                <span class="nav-number">5</span>
                <span class="nav-label">COC Process</span>
            </a>
            <a href="#section-6" class="nav-item">
                <span class="nav-number">6</span>
                <span class="nav-label">Document Prep</span>
            </a>
            <a href="#quick-ref" class="nav-item">
                <span class="nav-number">*</span>
                <span class="nav-label">Quick Reference</span>
            </a>
        </nav>

        <!-- Agent Navigation -->
        <nav class="sidebar-nav" id="agents-nav" style="display: none;">
            <a href="#agent-summary" class="nav-item active">
                <span class="nav-number">S</span>
                <span class="nav-label">Summary</span>
            </a>
            <a href="#agent-heatmap" class="nav-item">
                <span class="nav-number">H</span>
                <span class="nav-label">Heat Map</span>
            </a>
            <a href="#agent-details" class="nav-item">
                <span class="nav-number">A</span>
                <span class="nav-label">Agent Details</span>
            </a>
        </nav>

        <div class="sidebar-footer">
            <button class="doc-btn" onclick="openDocModal()">
                View Workflow Markdown
            </button>
        </div>
    </aside>

    <!-- Main Content -->
    <main class="main-content">

        <!-- ==================== WORKFLOW TAB ==================== -->
        <div id="workflow-panel" class="tab-panel active">
            <!-- Header -->
            <div class="header">
                <h1>Disclosure 1004D COC Process</h1>
                <p class="subtitle">Appraisal Reinspection Fee Disclosure and Change of Circumstance Workflow</p>
                <div class="meta">
                    <span class="meta-item">System: Byte</span>
                    <span class="meta-item">Role: Disclosure Coordinator</span>
                    <span class="meta-item">Updated: Feb 8, 2018</span>
                    <span class="meta-item">Duration: 5-10 min</span>
                </div>
            </div>

            <!-- Legend -->
            <div class="legend">
                <div class="legend-item"><div class="legend-color" style="background: linear-gradient(135deg, #22c55e, #16a34a);"></div><span>Start/End</span></div>
                <div class="legend-item"><div class="legend-color" style="background: linear-gradient(135deg, #3b82f6, #2563eb);"></div><span>Action Step</span></div>
                <div class="legend-item"><div class="legend-color" style="background: linear-gradient(135deg, #f59e0b, #d97706);"></div><span>Decision Point</span></div>
                <div class="legend-item"><div class="legend-color" style="background: #111827; border: 2px solid #3b82f6;"></div><span>User Input</span></div>
                <div class="legend-item"><div class="legend-color" style="background: linear-gradient(135deg, #f43f5e, #dc2626);"></div><span>Exception</span></div>
                <div class="legend-item"><div class="legend-color" style="background: linear-gradient(135deg, #14b8a6, #0d9488);"></div><span>Output</span></div>
            </div>

            <!-- Section 0: Overview -->
            <section id="section-0" class="section">
                <div class="section-header">
                    <div class="section-number">0</div>
                    <div class="section-title"><h2>Process Overview</h2><span>Understanding the 1004D COC requirement</span></div>
                </div>
                <div class="section-content">
                    <div class="workflow-diagram">
                        <div class="flow-row">
                            <div class="flow-node start">Start</div>
                            <span class="flow-arrow">-></span>
                            <div class="flow-node action">Check Pipeline Report</div>
                            <span class="flow-arrow">-></span>
                            <div class="flow-node decision">1004D Req'd = Yes?</div>
                            <span class="flow-arrow">-></span>
                            <div class="flow-node action">Verify/Add Fee</div>
                            <span class="flow-arrow">-></span>
                            <div class="flow-node output">Redisclose</div>
                        </div>
                    </div>
                    <div class="info-box">
                        <h4>What is 1004D?</h4>
                        <p>The 1004D is an Appraisal Update and/or Completion Report used when the original appraisal was subject to conditions. When an appraisal requires reinspection, the associated <strong>Appraisal Reinspection Fee</strong> must be disclosed to the borrower via a Change of Circumstance (COC).</p>
                    </div>
                    <div class="summary-grid">
                        <div class="summary-card"><h4>Standard Fee</h4><div class="value">$175</div><div class="label">Default reinspection fee</div></div>
                        <div class="summary-card"><h4>Alt Fee</h4><div class="value">$150</div><div class="label">Regional variation</div></div>
                        <div class="summary-card"><h4>Pipeline Column</h4><div class="value">1004D</div><div class="label">Retail Disclosures Revised LEs</div></div>
                    </div>
                </div>
            </section>

            <!-- Section 1: Pipeline Report -->
            <section id="section-1" class="section">
                <div class="section-header">
                    <div class="section-number">1</div>
                    <div class="section-title"><h2>Check Pipeline Report</h2><span>Identify loans requiring 1004D disclosure</span></div>
                </div>
                <div class="section-content">
                    <div class="workflow-diagram">
                        <div class="flow-row">
                            <div class="flow-node action">Open Retail Disclosures Revised LEs Pipeline Report</div>
                            <span class="flow-arrow">-></span>
                            <div class="flow-node input">Locate 1004D Req'd Column</div>
                            <span class="flow-arrow">-></span>
                            <div class="flow-node decision">Value = Yes?</div>
                        </div>
                        <div class="decision-branch">
                            <div class="branch">
                                <span class="branch-label">YES</span>
                                <span class="flow-arrow down">|</span>
                                <div class="flow-node action">Proceed to Fee History</div>
                            </div>
                            <div class="branch">
                                <span class="branch-label">NO</span>
                                <span class="flow-arrow down">|</span>
                                <div class="flow-node output">No Action Required</div>
                            </div>
                        </div>
                    </div>
                    <table class="field-table">
                        <thead>
                            <tr><th>Column</th><th>Value</th><th>Action Required</th></tr>
                        </thead>
                        <tbody>
                            <tr><td><strong style="color: var(--text-primary);">1004D Req'd</strong></td><td><span class="badge required-badge">Yes</span></td><td>Verify Appraisal Reinspection Fee disclosed or add to Byte and redisclose</td></tr>
                            <tr><td><strong style="color: var(--text-primary);">1004D Req'd</strong></td><td><span class="badge optional-badge">No</span></td><td>No additional disclosure needed</td></tr>
                            <tr><td><strong style="color: var(--text-primary);">CoC Start Date</strong></td><td><span class="badge calculated-badge">Date</span></td><td>Shows when COC process was initiated</td></tr>
                        </tbody>
                    </table>
                    <div class="tip-box">
                        <h4>Pro Tip</h4>
                        <p>The 1004D Req'd column was added specifically to streamline identification of loans requiring appraisal reinspection fee disclosure. Check this column daily during your pipeline review.</p>
                    </div>
                </div>
            </section>

            <!-- Section 2: Fee History Check -->
            <section id="section-2" class="section">
                <div class="section-header">
                    <div class="section-number">2</div>
                    <div class="section-title"><h2>Check Fee History</h2><span>Verify if Appraisal Reinspection Fee is already disclosed</span></div>
                </div>
                <div class="section-content">
                    <div class="workflow-diagram">
                        <div class="flow-row">
                            <div class="flow-node action">Open Loan File</div>
                            <span class="flow-arrow">-></span>
                            <div class="flow-node action">Click Fee History Screen</div>
                            <span class="flow-arrow">-></span>
                            <div class="flow-node input">Review TRID Disclosure History</div>
                        </div>
                    </div>
                    <div class="decision-tree">
                        <h3>Fee History Decision Tree</h3>
                        <div class="tree-node level-1">
                            <span class="tree-label">Appraisal Reinspection Fee in TRID Disclosure History?</span>
                        </div>
                        <div class="tree-node">
                            <span class="tree-label" style="background: var(--accent-green); color: white;">YES - Fee Found</span>
                            Skip to Document Preparation Screen (Section 6)
                        </div>
                        <div class="tree-node">
                            <span class="tree-label" style="background: var(--accent-rose); color: white;">NO - Fee Missing</span>
                            Continue to Appraisal Review (Section 3)
                        </div>
                    </div>
                    <div class="info-box">
                        <h4>TRID Disclosure History Location</h4>
                        <p>In the Fee History screen, look under <strong>Services You Cannot Shop For</strong> section. The Appraisal Reinspection Fee typically appears with a value of <strong>$150.00</strong> or <strong>$175.00</strong> depending on region.</p>
                    </div>
                </div>
            </section>

            <!-- Section 3: Appraisal Review -->
            <section id="section-3" class="section">
                <div class="section-header">
                    <div class="section-number">3</div>
                    <div class="section-title"><h2>Review Appraisal Report</h2><span>Verify Subject To conditions in appraisal</span></div>
                </div>
                <div class="section-content">
                    <div class="workflow-diagram">
                        <div class="flow-row">
                            <div class="flow-node action">Open Stored Documents</div>
                            <span class="flow-arrow">-></span>
                            <div class="flow-node action">Click PROP Filter</div>
                            <span class="flow-arrow">-></span>
                            <div class="flow-node action">Open Appraisal Report</div>
                        </div>
                        <div class="flow-row">
                            <span class="flow-arrow down">|</span>
                        </div>
                        <div class="flow-row">
                            <div class="flow-node input">Scroll to Page 2 - Reconciliation Section</div>
                            <span class="flow-arrow">-></span>
                            <div class="flow-node decision">Subject To Box Checked?</div>
                        </div>
                    </div>
                    <div class="mi-comparison">
                        <div class="mi-card">
                            <div class="mi-card-header"><h4>"As Is" Box Checked</h4></div>
                            <div class="mi-card-body">
                                <ul>
                                    <li><span class="check-icon">OK</span> No reinspection required</li>
                                    <li><span class="check-icon">OK</span> Skip to Document Preparation</li>
                                    <li><span class="check-icon">OK</span> No fee addition needed</li>
                                </ul>
                            </div>
                        </div>
                        <div class="mi-card">
                            <div class="mi-card-header"><h4>"Subject To" Box Checked</h4></div>
                            <div class="mi-card-body">
                                <ul>
                                    <li><span class="x-icon">!</span> Reinspection IS required</li>
                                    <li><span class="x-icon">!</span> Must add Appraisal Reinspection Fee</li>
                                    <li><span class="x-icon">!</span> Proceed to Add Fee (Section 4)</li>
                                </ul>
                            </div>
                        </div>
                    </div>
                    <div class="exception-box">
                        <h4>Subject To Conditions</h4>
                        <p>The Reconciliation section contains three checkboxes. If ANY of the <strong>"subject to"</strong> boxes are checked (completion per plans, repairs/alterations, or hypothetical condition), a reinspection fee is required. Only the <strong>"as is"</strong> checkbox exempts the loan from this requirement.</p>
                    </div>
                    <table class="field-table">
                        <thead>
                            <tr><th>Reconciliation Option</th><th>Description</th><th>Reinspection?</th></tr>
                        </thead>
                        <tbody>
                            <tr><td><strong style="color: var(--text-primary);">As Is</strong></td><td>Property valued in current condition</td><td><span class="badge optional-badge">NO</span></td></tr>
                            <tr><td><strong style="color: var(--text-primary);">Subject to Completion</strong></td><td>Subject to completion per plans and specifications</td><td><span class="badge required-badge">YES</span></td></tr>
                            <tr><td><strong style="color: var(--text-primary);">Subject to Repairs</strong></td><td>Subject to repairs or alterations</td><td><span class="badge required-badge">YES</span></td></tr>
                            <tr><td><strong style="color: var(--text-primary);">Subject to Inspection</strong></td><td>Subject to inspection based on hypothetical condition</td><td><span class="badge required-badge">YES</span></td></tr>
                        </tbody>
                    </table>
                </div>
            </section>

            <!-- Section 4: Add Fee -->
            <section id="section-4" class="section">
                <div class="section-header">
                    <div class="section-number">4</div>
                    <div class="section-title"><h2>Add Appraisal Reinspection Fee</h2><span>Enter fee on Loan Estimate Page 2</span></div>
                </div>
                <div class="section-content">
                    <div class="workflow-diagram">
                        <div class="flow-row">
                            <div class="flow-node action">Navigate to Loan Estimate Page 2</div>
                            <span class="flow-arrow">-></span>
                            <div class="flow-node action">Locate B. Services You Cannot Shop For</div>
                        </div>
                        <div class="flow-row">
                            <span class="flow-arrow down">|</span>
                        </div>
                        <div class="flow-row">
                            <div class="flow-node input">Find Appraisal Reinspection Fee Row</div>
                            <span class="flow-arrow">-></span>
                            <div class="flow-node input">Enter $175.00 (or regional pricing)</div>
                            <span class="flow-arrow">-></span>
                            <div class="flow-node output">Fee Added</div>
                        </div>
                    </div>
                    <table class="field-table">
                        <thead>
                            <tr><th>Fee Field</th><th>Location</th><th>Standard Amount</th><th>Notes</th></tr>
                        </thead>
                        <tbody>
                            <tr><td><strong style="color: var(--text-primary);">Appraisal Reinspection Fee</strong></td><td>LE Page 2, Section B</td><td>$175.00</td><td>Check PPFC and Borrower columns as needed</td></tr>
                        </tbody>
                    </table>
                    <div class="tip-box">
                        <h4>Regional Pricing</h4>
                        <p>The standard Appraisal Reinspection Fee is <strong>$175.00</strong>, but some regions may have different pricing (e.g., $150.00). Always verify the correct fee amount for your specific region before adding.</p>
                    </div>
                </div>
            </section>

            <!-- Section 5: COC Process -->
            <section id="section-5" class="section">
                <div class="section-header">
                    <div class="section-number">5</div>
                    <div class="section-title"><h2>Change of Circumstance Process</h2><span>Complete COC documentation and fee reconciliation</span></div>
                </div>
                <div class="section-content">
                    <div class="workflow-diagram">
                        <div class="flow-row">
                            <div class="flow-node action">Review Overview Pane</div>
                            <span class="flow-arrow">-></span>
                            <div class="flow-node decision">Fees Triangle Shows Alert?</div>
                            <span class="flow-arrow">-></span>
                            <div class="flow-node action">Reconcile Fees per COC Process</div>
                        </div>
                        <div class="flow-row">
                            <span class="flow-arrow down">|</span>
                        </div>
                        <div class="flow-row">
                            <div class="flow-node action">Open Changed Circumstances Screen</div>
                            <span class="flow-arrow">-></span>
                            <div class="flow-node input">Complete COC Letter Details</div>
                        </div>
                    </div>
                    <table class="field-table">
                        <thead>
                            <tr><th>COC Field</th><th>Example Value</th><th>Description</th></tr>
                        </thead>
                        <tbody>
                            <tr><td><strong style="color: var(--text-primary);">Date Of Change</strong></td><td>01/22/2018</td><td>Date the change occurred</td></tr>
                            <tr><td><strong style="color: var(--text-primary);">CoC Requested on CD</strong></td><td>Dropdown selection</td><td>Indicates CD request</td></tr>
                            <tr><td><strong style="color: var(--text-primary);">Delivery Date</strong></td><td>01/23/2018</td><td>Date disclosure delivered</td></tr>
                            <tr><td><strong style="color: var(--text-primary);">Reason For Change</strong></td><td>Appraisal Reinspection Fee Added</td><td>Brief description of change</td></tr>
                            <tr><td><strong style="color: var(--text-primary);">Details of Change</strong></td><td>Appraisal Reinspection Fee changed from $0.00 to $175.00 due to final inspection required</td><td>Detailed explanation</td></tr>
                        </tbody>
                    </table>
                    <div class="info-box">
                        <h4>Overview Pane Indicators</h4>
                        <p>The Overview Pane displays status icons for key items. Look for the <strong>Fees</strong> indicator - a triangle/alert symbol indicates fees need reconciliation. Click the triangle to access the fee reconciliation workflow.</p>
                    </div>
                </div>
            </section>

            <!-- Section 6: Document Preparation -->
            <section id="section-6" class="section">
                <div class="section-header">
                    <div class="section-number">6</div>
                    <div class="section-title"><h2>Document Preparation & Redisclosure</h2><span>Finalize and submit to IDS</span></div>
                </div>
                <div class="section-content">
                    <div class="workflow-diagram">
                        <div class="flow-row">
                            <div class="flow-node action">Open Document Preparation Screen</div>
                            <span class="flow-arrow">-></span>
                            <div class="flow-node action">Uncheck Appraisal Reinspection Needed</div>
                        </div>
                        <div class="flow-row">
                            <span class="flow-arrow down">|</span>
                        </div>
                        <div class="flow-row">
                            <div class="flow-node decision">Redisclosure Required?</div>
                        </div>
                        <div class="decision-branch">
                            <div class="branch">
                                <span class="branch-label">YES</span>
                                <span class="flow-arrow down">|</span>
                                <div class="flow-node action">Submit to IDS</div>
                                <span class="flow-arrow down">|</span>
                                <div class="flow-node output">Follow Normal Redisclosure Process</div>
                            </div>
                            <div class="branch">
                                <span class="branch-label">NO</span>
                                <span class="flow-arrow down">|</span>
                                <div class="flow-node output">Loan Falls Off Reports</div>
                            </div>
                        </div>
                    </div>
                    <div class="tip-box">
                        <h4>Completion Checkpoint</h4>
                        <p>Once the <strong>Appraisal Reinspection Needed</strong> checkbox is unchecked and no redisclosure is required, the loan file will automatically fall off the 1004D pipeline reports.</p>
                    </div>
                    <div class="exception-box">
                        <h4>Need Help?</h4>
                        <p>For assistance with this process, contact <strong>Byte Support</strong> at extension <strong>x3999</strong> or direct dial <strong>925-359-3999</strong>.</p>
                    </div>
                </div>
            </section>

            <!-- Quick Reference -->
            <section id="quick-ref" class="quick-ref">
                <h3>Quick Reference Card</h3>
                <pre>
DISCLOSURE 1004D COC PROCESS
============================

TRIGGER: 1004D Req'd = "Yes" on Retail Disclosures Revised LEs Pipeline Report

DECISION FLOW:
1. Check Fee History > TRID Disclosure History
   - Fee EXISTS? -> Skip to Document Preparation
   - Fee MISSING? -> Continue to Appraisal Review

2. Review Appraisal (Stored Documents > PROP > Appraisal Report)
   - Page 2, Reconciliation Section
   - "As Is" checked? -> No fee needed, skip to Doc Prep
   - "Subject To" checked? -> Add Appraisal Reinspection Fee

3. Add Fee (Loan Estimate Page 2)
   - Section B: Services You Cannot Shop For
   - Appraisal Reinspection Fee: $175.00 (or regional pricing)

4. COC Process
   - Review Overview Pane (Fees triangle)
   - Open Changed Circumstances screen
   - Complete: Date of Change, Reason, Details

5. Document Preparation
   - UNCHECK "Appraisal Reinspection Needed" box
   - Submit to IDS if redisclosure required
   - Loan falls off reports when complete

SUPPORT: Byte Support x3999 or 925-359-3999
                </pre>
            </section>
        </div>

        <!-- ==================== AGENT OPPORTUNITIES TAB ==================== -->
        <div id="agents-panel" class="tab-panel">
            <!-- Header -->
            <div class="agent-header">
                <h1>AI Agent Opportunities</h1>
                <p class="subtitle">Automation Analysis for 1004D COC Disclosure Workflow</p>
                <div class="meta">
                    <span class="meta-item">7 Process Steps Analyzed</span>
                    <span class="meta-item">4 Agent Candidates Identified</span>
                    <span class="meta-item">Est. 60% Time Savings</span>
                </div>
            </div>

            <!-- Summary Stats -->
            <div class="agent-summary" id="agent-summary">
                <div class="agent-summary-card">
                    <div class="agent-summary-value">4</div>
                    <div class="agent-summary-label">Agent Candidates</div>
                </div>
                <div class="agent-summary-card">
                    <div class="agent-summary-value">2</div>
                    <div class="agent-summary-label">High Priority</div>
                </div>
                <div class="agent-summary-card">
                    <div class="agent-summary-value">60%</div>
                    <div class="agent-summary-label">Time Savings</div>
                </div>
                <div class="agent-summary-card">
                    <div class="agent-summary-value">90%</div>
                    <div class="agent-summary-label">Automation Potential</div>
                </div>
            </div>

            <!-- Heat Map Legend -->
            <div class="heat-legend" id="agent-heatmap">
                <div class="heat-legend-item"><div class="heat-legend-color" style="background: linear-gradient(135deg, #ef4444, #f97316);"></div><span><strong>Critical (90-100)</strong> - Immediate ROI</span></div>
                <div class="heat-legend-item"><div class="heat-legend-color" style="background: linear-gradient(135deg, #f97316, #eab308);"></div><span><strong>High (70-89)</strong> - Strong candidate</span></div>
                <div class="heat-legend-item"><div class="heat-legend-color" style="background: linear-gradient(135deg, #eab308, #22c55e);"></div><span><strong>Medium (50-69)</strong> - Consider</span></div>
                <div class="heat-legend-item"><div class="heat-legend-color" style="background: linear-gradient(135deg, #22c55e, #14b8a6);"></div><span><strong>Low (0-49)</strong> - Future phase</span></div>
            </div>

            <!-- Heat Map Grid -->
            <div class="heat-map-container">
                <div class="heat-map-title">Automation Priority Heat Map <span style="font-size: 0.8rem; font-weight: 400; color: var(--text-muted);">(Click to jump to agent)</span></div>
                <div class="heat-map-grid">
                    <div class="heat-item critical" onclick="scrollToAgent('agent-appraisal-scanner')" title="Click to view agent details">
                        <div class="heat-score">95</div>
                        <div class="heat-name">Appraisal Scanner</div>
                        <div class="heat-desc">Auto-detect Subject To conditions in appraisals</div>
                        <div class="heat-metrics">
                            <div class="heat-metric">Effort: <span>Low</span></div>
                            <div class="heat-metric">Impact: <span>High</span></div>
                            <div class="heat-metric">Step: <span>3</span></div>
                        </div>
                    </div>
                    <div class="heat-item high" onclick="scrollToAgent('agent-fee-auto-add')" title="Click to view agent details">
                        <div class="heat-score">88</div>
                        <div class="heat-name">Fee Auto-Add</div>
                        <div class="heat-desc">Automatically add reinspection fee when triggered</div>
                        <div class="heat-metrics">
                            <div class="heat-metric">Effort: <span>Low</span></div>
                            <div class="heat-metric">Impact: <span>High</span></div>
                            <div class="heat-metric">Step: <span>4</span></div>
                        </div>
                    </div>
                    <div class="heat-item high" onclick="scrollToAgent('agent-coc-generator')" title="Click to view agent details">
                        <div class="heat-score">82</div>
                        <div class="heat-name">COC Generator</div>
                        <div class="heat-desc">Auto-populate Change of Circumstance letter</div>
                        <div class="heat-metrics">
                            <div class="heat-metric">Effort: <span>Medium</span></div>
                            <div class="heat-metric">Impact: <span>High</span></div>
                            <div class="heat-metric">Step: <span>5</span></div>
                        </div>
                    </div>
                    <div class="heat-item medium" onclick="scrollToAgent('agent-pipeline-monitor')" title="Click to view agent details">
                        <div class="heat-score">65</div>
                        <div class="heat-name">Pipeline Monitor</div>
                        <div class="heat-desc">Daily alerts for 1004D required loans</div>
                        <div class="heat-metrics">
                            <div class="heat-metric">Effort: <span>Low</span></div>
                            <div class="heat-metric">Impact: <span>Medium</span></div>
                            <div class="heat-metric">Step: <span>1</span></div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Agent Details -->
            <h2 style="font-size: 1.4rem; margin: 35px 0 22px; color: var(--text-primary);" id="agent-details">Agent Specifications</h2>

            <div class="agent-grid">
                <!-- Agent 1: Appraisal Scanner -->
                <div class="agent-card" id="agent-appraisal-scanner">
                    <div class="agent-card-header">
                        <div class="agent-icon">DOC</div>
                        <div class="agent-info">
                            <div class="agent-name">Appraisal Scanner Agent</div>
                            <div class="agent-type">Document Analysis Agent</div>
                        </div>
                        <span class="agent-priority critical">Critical</span>
                    </div>
                    <div class="agent-card-body">
                        <p class="agent-description">Automatically scans uploaded appraisal reports to detect "Subject To" conditions in the Reconciliation section. Eliminates manual PDF review and instantly flags loans requiring reinspection fees.</p>
                        <div class="agent-flow">
                            <div class="agent-flow-title">Agent Flow</div>
                            <div class="agent-flow-diagram">
                                <div class="agent-step">Appraisal Upload</div>
                                <span class="agent-arrow">-></span>
                                <div class="agent-step">OCR Page 2</div>
                                <span class="agent-arrow">-></span>
                                <div class="agent-step">Parse Checkboxes</div>
                                <span class="agent-arrow">-></span>
                                <div class="agent-step">Flag Result</div>
                            </div>
                        </div>
                        <div class="agent-stats">
                            <div class="agent-stat"><div class="agent-stat-value">5min</div><div class="agent-stat-label">Time Saved</div></div>
                            <div class="agent-stat"><div class="agent-stat-value">99%</div><div class="agent-stat-label">Accuracy</div></div>
                            <div class="agent-stat"><div class="agent-stat-value">Low</div><div class="agent-stat-label">Complexity</div></div>
                        </div>
                        <button class="agent-prompt-btn" onclick="showAgentPrompt('appraisal-scanner')">
                            View AI Prompt to Build This Agent
                        </button>
                    </div>
                </div>

                <!-- Agent 2: Fee Auto-Add -->
                <div class="agent-card" id="agent-fee-auto-add">
                    <div class="agent-card-header">
                        <div class="agent-icon">$</div>
                        <div class="agent-info">
                            <div class="agent-name">Fee Auto-Add Agent</div>
                            <div class="agent-type">Data Entry Automation Agent</div>
                        </div>
                        <span class="agent-priority high">High</span>
                    </div>
                    <div class="agent-card-body">
                        <p class="agent-description">When triggered by Appraisal Scanner, automatically navigates to Loan Estimate Page 2 and adds the Appraisal Reinspection Fee with correct regional pricing. Saves manual navigation and data entry.</p>
                        <div class="agent-flow">
                            <div class="agent-flow-title">Agent Flow</div>
                            <div class="agent-flow-diagram">
                                <div class="agent-step">Scanner Trigger</div>
                                <span class="agent-arrow">-></span>
                                <div class="agent-step">Lookup Region</div>
                                <span class="agent-arrow">-></span>
                                <div class="agent-step">Navigate LE P2</div>
                                <span class="agent-arrow">-></span>
                                <div class="agent-step">Add Fee</div>
                            </div>
                        </div>
                        <div class="agent-stats">
                            <div class="agent-stat"><div class="agent-stat-value">3min</div><div class="agent-stat-label">Time Saved</div></div>
                            <div class="agent-stat"><div class="agent-stat-value">100%</div><div class="agent-stat-label">Accuracy</div></div>
                            <div class="agent-stat"><div class="agent-stat-value">Low</div><div class="agent-stat-label">Complexity</div></div>
                        </div>
                        <button class="agent-prompt-btn" onclick="showAgentPrompt('fee-auto-add')">
                            View AI Prompt to Build This Agent
                        </button>
                    </div>
                </div>

                <!-- Agent 3: COC Generator -->
                <div class="agent-card" id="agent-coc-generator">
                    <div class="agent-card-header">
                        <div class="agent-icon">DOC</div>
                        <div class="agent-info">
                            <div class="agent-name">COC Generator Agent</div>
                            <div class="agent-type">Document Generation Agent</div>
                        </div>
                        <span class="agent-priority high">High</span>
                    </div>
                    <div class="agent-card-body">
                        <p class="agent-description">Auto-populates the Changed Circumstances screen with standardized reason codes and detailed descriptions based on the fee change detected. Ensures TRID-compliant COC documentation.</p>
                        <div class="agent-flow">
                            <div class="agent-flow-title">Agent Flow</div>
                            <div class="agent-flow-diagram">
                                <div class="agent-step">Fee Change Event</div>
                                <span class="agent-arrow">-></span>
                                <div class="agent-step">Generate Reason</div>
                                <span class="agent-arrow">-></span>
                                <div class="agent-step">Build Details</div>
                                <span class="agent-arrow">-></span>
                                <div class="agent-step">Populate Form</div>
                            </div>
                        </div>
                        <div class="agent-stats">
                            <div class="agent-stat"><div class="agent-stat-value">4min</div><div class="agent-stat-label">Time Saved</div></div>
                            <div class="agent-stat"><div class="agent-stat-value">100%</div><div class="agent-stat-label">Compliance</div></div>
                            <div class="agent-stat"><div class="agent-stat-value">Med</div><div class="agent-stat-label">Complexity</div></div>
                        </div>
                        <button class="agent-prompt-btn" onclick="showAgentPrompt('coc-generator')">
                            View AI Prompt to Build This Agent
                        </button>
                    </div>
                </div>

                <!-- Agent 4: Pipeline Monitor -->
                <div class="agent-card" id="agent-pipeline-monitor">
                    <div class="agent-card-header">
                        <div class="agent-icon">!</div>
                        <div class="agent-info">
                            <div class="agent-name">Pipeline Monitor Agent</div>
                            <div class="agent-type">Monitoring Agent</div>
                        </div>
                        <span class="agent-priority medium">Medium</span>
                    </div>
                    <div class="agent-card-body">
                        <p class="agent-description">Monitors the Retail Disclosures Revised LEs Pipeline Report daily and sends automated alerts to Disclosure Coordinators when new loans appear with 1004D Req'd = Yes.</p>
                        <div class="agent-flow">
                            <div class="agent-flow-title">Agent Flow</div>
                            <div class="agent-flow-diagram">
                                <div class="agent-step">Daily Scan</div>
                                <span class="agent-arrow">-></span>
                                <div class="agent-step">Filter 1004D</div>
                                <span class="agent-arrow">-></span>
                                <div class="agent-step">Compare Previous</div>
                                <span class="agent-arrow">-></span>
                                <div class="agent-step">Send Alerts</div>
                            </div>
                        </div>
                        <div class="agent-stats">
                            <div class="agent-stat"><div class="agent-stat-value">24/7</div><div class="agent-stat-label">Monitoring</div></div>
                            <div class="agent-stat"><div class="agent-stat-value">0</div><div class="agent-stat-label">Missed Items</div></div>
                            <div class="agent-stat"><div class="agent-stat-value">Low</div><div class="agent-stat-label">Complexity</div></div>
                        </div>
                        <button class="agent-prompt-btn" onclick="showAgentPrompt('pipeline-monitor')">
                            View AI Prompt to Build This Agent
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </main>

    <!-- Documentation Modal -->
    <div class="modal-overlay" id="docModal">
        <div class="modal">
            <div class="modal-header">
                <h3>Disclosure 1004D COC - Workflow Markdown</h3>
                <div class="modal-actions">
                    <button class="modal-btn copy" onclick="copyToClipboard()">Copy</button>
                    <button class="modal-btn close" onclick="closeDocModal()">X Close</button>
                </div>
            </div>
            <div class="modal-body">
                <pre id="docContent"># Disclosure 1004D COC Process

## Overview
The 1004D is an Appraisal Update and/or Completion Report used when the original appraisal was subject to conditions. When an appraisal requires reinspection, the Appraisal Reinspection Fee must be disclosed via Change of Circumstance (COC).

## Process Steps

### 1. Check Pipeline Report
- Open Retail Disclosures Revised LEs Pipeline Report
- Look for "1004D Req'd" column
- If marked "Yes", proceed with verification

### 2. Check Fee History
- Open loan file
- Click Fee History screen
- Review TRID Disclosure History for Appraisal Reinspection Fee
- If fee exists, skip to Document Preparation
- If fee missing, continue to Appraisal Review

### 3. Review Appraisal Report
- Open Stored Documents
- Click PROP filter
- Open Appraisal Report
- Navigate to Page 2, Reconciliation section
- Check which box is marked:
  - "As Is" = No reinspection needed
  - "Subject To" (any) = Reinspection fee required

### 4. Add Appraisal Reinspection Fee
- Navigate to Loan Estimate Page 2
- Section B: Services You Cannot Shop For
- Add Appraisal Reinspection Fee: $175.00 (or regional pricing)

### 5. Complete COC Process
- Review Overview Pane (Fees indicator)
- Open Changed Circumstances screen
- Enter Date of Change
- Enter Reason: "Appraisal Reinspection Fee Added"
- Enter Details: Fee amount change explanation

### 6. Document Preparation
- Open Document Preparation screen
- Uncheck "Appraisal Reinspection Needed" box
- If redisclosure required: Submit to IDS
- Follow normal redisclosure process

## Key Information
- Standard Fee: $175.00
- Regional Variation: $150.00
- Support: Byte Support x3999 or 925-359-3999
- Updated: February 8, 2018</pre>
            </div>
        </div>
    </div>

    <div class="copy-success" id="copySuccess">Copied to clipboard!</div>

    <!-- AI Prompt Modal -->
    <div class="modal-overlay prompt-modal" id="promptModal">
        <div class="modal">
            <div class="modal-header">
                <h3 id="promptModalTitle">AI Agent Build Prompt</h3>
                <div class="modal-actions">
                    <button class="modal-btn copy" onclick="copyPromptToClipboard()">Copy Prompt</button>
                    <button class="modal-btn close" onclick="closePromptModal()">X Close</button>
                </div>
            </div>
            <div class="modal-body">
                <div class="prompt-tags" id="promptTags"></div>
                <div class="prompt-section">
                    <h4>Agent Purpose</h4>
                    <div class="prompt-box" id="promptPurpose"></div>
                </div>
                <div class="prompt-section">
                    <h4>Full Build Prompt</h4>
                    <div class="prompt-box" id="promptContent"></div>
                </div>
                <div class="prompt-section">
                    <h4>Integration Points</h4>
                    <div class="prompt-box" id="promptIntegration"></div>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Tab switching
        function switchTab(tab) {
            document.querySelectorAll('.sidebar-tab').forEach(t => t.classList.remove('active'));
            document.querySelectorAll('.tab-panel').forEach(p => p.classList.remove('active'));

            if (tab === 'workflow') {
                document.querySelector('.sidebar-tab:not(.agent-tab)').classList.add('active');
                document.getElementById('workflow-panel').classList.add('active');
                document.getElementById('workflow-nav').style.display = 'block';
                document.getElementById('agents-nav').style.display = 'none';
            } else {
                document.querySelector('.sidebar-tab.agent-tab').classList.add('active');
                document.getElementById('agents-panel').classList.add('active');
                document.getElementById('workflow-nav').style.display = 'none';
                document.getElementById('agents-nav').style.display = 'block';
            }

            window.scrollTo(0, 0);
        }

        // Scroll spy with isScrolling flag and 1000ms timeout
        const sections = document.querySelectorAll('.section, .quick-ref');
        const navItems = document.querySelectorAll('#workflow-nav .nav-item');
        let isScrolling = false;
        let scrollTimeout = null;

        function updateActiveNav() {
            if (isScrolling) return;

            let current = '';
            sections.forEach(section => {
                const sectionTop = section.offsetTop - 100;
                if (window.scrollY >= sectionTop) current = section.getAttribute('id');
            });
            navItems.forEach(item => {
                item.classList.remove('active');
                if (item.getAttribute('href') === '#' + current) item.classList.add('active');
            });
        }

        // Handle nav clicks with scroll flag
        navItems.forEach(item => {
            item.addEventListener('click', function(e) {
                isScrolling = true;

                // Clear any existing timeout
                if (scrollTimeout) clearTimeout(scrollTimeout);

                // Reset flag after 1000ms
                scrollTimeout = setTimeout(() => {
                    isScrolling = false;
                    updateActiveNav();
                }, 1000);

                // Update active state immediately on click
                navItems.forEach(nav => nav.classList.remove('active'));
                this.classList.add('active');
            });
        });

        window.addEventListener('scroll', updateActiveNav);

        // Scroll to agent from heat map
        function scrollToAgent(agentId) {
            const agentCard = document.getElementById(agentId);
            if (agentCard) {
                agentCard.scrollIntoView({ behavior: 'smooth', block: 'center' });
                agentCard.classList.add('highlight');
                setTimeout(() => agentCard.classList.remove('highlight'), 2000);
            }
        }

        // Modal functions
        function openDocModal() {
            document.getElementById('docModal').classList.add('show');
            document.body.style.overflow = 'hidden';
        }

        function closeDocModal() {
            document.getElementById('docModal').classList.remove('show');
            document.body.style.overflow = '';
        }

        async function copyToClipboard() {
            try {
                const content = document.getElementById('docContent').textContent;
                await navigator.clipboard.writeText(content);
                const success = document.getElementById('copySuccess');
                success.style.display = 'block';
                setTimeout(() => { success.style.display = 'none'; }, 2000);
            } catch (e) { alert('Failed to copy.'); }
        }

        document.addEventListener('keydown', (e) => { if (e.key === 'Escape') { closeDocModal(); closePromptModal(); } });
        document.getElementById('docModal').addEventListener('click', (e) => { if (e.target.id === 'docModal') closeDocModal(); });

        document.addEventListener('DOMContentLoaded', () => { updateActiveNav(); });

        // Agent Prompt System
        const agentPrompts = {
            'appraisal-scanner': {
                name: 'Appraisal Scanner Agent',
                tags: ['Document Analysis', 'OCR', 'Low Complexity', 'Critical Priority'],
                purpose: `This agent automatically scans uploaded appraisal reports to detect "Subject To" conditions in the Reconciliation section on Page 2. It eliminates the need for manual PDF review and instantly flags loans requiring reinspection fees.`,
                prompt: `You are building a Document Analysis Agent for CMG Financial's Byte LOS system.

AGENT NAME: Appraisal Scanner Agent
TYPE: Document Analysis / OCR

OBJECTIVE:
Create an agent that monitors for new appraisal uploads and automatically extracts the Reconciliation section checkbox status from Page 2 of the Uniform Residential Appraisal Report (URAR/1004 form).

INPUT:
- Appraisal PDF document uploaded to Stored Documents (Category: PROP, Type: Appraisal Report)

EXTRACTION TARGET:
Page 2, Reconciliation Section - Four checkboxes:
1. "as is" - Property valued in current condition
2. "subject to completion per plans and specifications"
3. "subject to repairs or alterations"
4. "subject to inspection based on hypothetical condition"

LOGIC:
IF checkbox 1 ("as is") is marked:
  -> Return: { requiresReinspection: false, condition: "as_is" }

IF any of checkboxes 2, 3, or 4 are marked:
  -> Return: { requiresReinspection: true, condition: "[specific_condition]" }
  -> Trigger: Fee Auto-Add Agent

OUTPUT FORMAT:
{
  "loanNumber": "string",
  "appraisalDate": "date",
  "requiresReinspection": boolean,
  "condition": "as_is" | "subject_to_completion" | "subject_to_repairs" | "subject_to_inspection",
  "confidence": 0.0-1.0,
  "rawText": "extracted text from reconciliation section"
}

ERROR HANDLING:
- If OCR confidence < 85%: Flag for manual review
- If checkbox area unclear: Flag for manual review
- If document format unexpected: Log and alert`,
                integration: `INTEGRATION POINTS:

1. Document Upload Trigger
   - Monitor Stored Documents for new PROP/Appraisal uploads
   - Webhook or polling on document status change

2. OCR Service
   - AWS Textract or Azure Document Intelligence
   - Pre-configured for URAR form layout

3. Byte LOS API
   - Update loan record with scan results
   - Trigger downstream agents (Fee Auto-Add)

4. Notification Service
   - Alert DC if manual review required
   - Email or in-app notification

DEPLOYMENT:
- Serverless function (AWS Lambda / Azure Functions)
- Triggered by S3/Blob upload event
- Results stored in loan record metadata`
            },
            'fee-auto-add': {
                name: 'Fee Auto-Add Agent',
                tags: ['Data Entry', 'RPA', 'Low Complexity', 'High Priority'],
                purpose: `This agent automatically adds the Appraisal Reinspection Fee to Loan Estimate Page 2 when triggered by the Appraisal Scanner. It determines the correct regional pricing and handles the navigation and data entry automatically.`,
                prompt: `You are building a Data Entry Automation Agent for CMG Financial's Byte LOS system.

AGENT NAME: Fee Auto-Add Agent
TYPE: Data Entry / RPA Automation

OBJECTIVE:
When triggered by the Appraisal Scanner Agent (requiresReinspection: true), automatically navigate to Loan Estimate Page 2 and add the Appraisal Reinspection Fee with correct regional pricing.

TRIGGER:
- Appraisal Scanner returns { requiresReinspection: true }
- OR manual trigger by user

REGIONAL PRICING LOOKUP:
State/Region -> Fee Amount
--------------------------
Default      -> $175.00
CA, AZ, NV   -> $150.00
[Add other regional variations]

AUTOMATION STEPS:
1. Receive loan number from trigger
2. Open loan in Byte
3. Navigate: All Screens > Loan Estimate Page 2
4. Locate: Section B - Services You Cannot Shop For
5. Find row: "Appraisal Reinspection Fee"
6. Enter: Fee amount based on property state
7. Check: PPFC checkbox if required
8. Save changes

VALIDATION:
- Verify fee not already present (check Fee History first)
- Confirm property state is available for lookup
- Validate fee amount matches regional table

OUTPUT:
{
  "success": boolean,
  "loanNumber": "string",
  "feeAdded": number,
  "region": "string",
  "timestamp": "datetime",
  "nextAction": "COC_GENERATOR"
}`,
                integration: `INTEGRATION POINTS:

1. Appraisal Scanner Trigger
   - Subscribe to scanner output queue
   - Process requiresReinspection: true events

2. Byte LOS Navigation
   - RPA tool (UiPath/Blue Prism) or
   - Direct API if available

3. Regional Pricing Database
   - Maintain fee lookup table
   - Admin UI for updates

4. Audit Trail
   - Log all automated fee additions
   - Include before/after states

DEPLOYMENT:
- RPA bot on dedicated VM or
- API integration if Byte exposes endpoints
- Queue-based async processing`
            },
            'coc-generator': {
                name: 'COC Generator Agent',
                tags: ['Document Generation', 'Compliance', 'Medium Complexity', 'High Priority'],
                purpose: `This agent auto-populates the Changed Circumstances screen with standardized, TRID-compliant reason codes and detailed descriptions based on the fee change detected. Ensures consistent and compliant COC documentation.`,
                prompt: `You are building a Document Generation Agent for CMG Financial's Byte LOS system.

AGENT NAME: COC Generator Agent
TYPE: Document Generation / Compliance

OBJECTIVE:
Auto-populate the Changed Circumstances screen with standardized reason codes and detailed descriptions that comply with TRID requirements when an Appraisal Reinspection Fee is added.

TRIGGER:
- Fee Auto-Add Agent completes successfully
- OR manual trigger after fee addition

COC TEMPLATE DATA:

Date Of Change: [Current Date]
Delivery Date: [Current Date + 1 business day]
CoC Requested on CD: [Dropdown - select appropriate option]

Reason For Change (standardized):
"Appraisal Reinspection Fee Added"

Details of Change (template):
"Appraisal Reinspection Fee changed from $0.00 to $[AMOUNT] due to final inspection required. The subject property appraisal was completed subject to [CONDITION], requiring a reinspection upon completion of [SPECIFIC_REQUIREMENT]."

CONDITION MAPPING:
- subject_to_completion -> "completion per plans and specifications"
- subject_to_repairs -> "repairs or alterations being completed"
- subject_to_inspection -> "extraordinary assumption verification"

AUTOMATION STEPS:
1. Receive trigger with loan number and fee details
2. Navigate: All Screens > Changed Circumstances
3. Populate: Date Of Change = today
4. Populate: Reason For Change = template
5. Populate: Details of Change = generated text
6. Calculate: Delivery Date (next business day)
7. Save form

OUTPUT:
{
  "success": boolean,
  "loanNumber": "string",
  "cocDate": "date",
  "reason": "string",
  "details": "string",
  "deliveryDate": "date"
}`,
                integration: `INTEGRATION POINTS:

1. Fee Auto-Add Trigger
   - Chain from fee addition completion
   - Pass fee amount and condition type

2. Byte Changed Circumstances Screen
   - RPA navigation or API
   - Form field mapping

3. Business Day Calculator
   - Holiday calendar integration
   - Weekend handling

4. Compliance Validation
   - Verify TRID requirements met
   - Flag if disclosure timing at risk

DEPLOYMENT:
- Part of automated workflow chain
- Can run independently for manual triggers
- Audit logging for compliance tracking`
            },
            'pipeline-monitor': {
                name: 'Pipeline Monitor Agent',
                tags: ['Monitoring', 'Alerts', 'Low Complexity', 'Medium Priority'],
                purpose: `This agent monitors the Retail Disclosures Revised LEs Pipeline Report daily and sends automated alerts to Disclosure Coordinators when new loans appear with 1004D Req'd = Yes, ensuring no loans are missed.`,
                prompt: `You are building a Monitoring Agent for CMG Financial's Byte LOS system.

AGENT NAME: Pipeline Monitor Agent
TYPE: Monitoring / Alerting

OBJECTIVE:
Monitor the Retail Disclosures Revised LEs Pipeline Report on a scheduled basis and alert Disclosure Coordinators when new loans require 1004D processing.

SCHEDULE:
- Primary: Every 2 hours during business hours (7 AM - 6 PM)
- Secondary: Daily summary at 8 AM

DATA SOURCE:
- Retail Disclosures Revised LEs Pipeline Report
- Filter: 1004D Req'd = "Yes"
- Track: File Name, State, Disc Coordinator, CoC Start Date

MONITORING LOGIC:
1. Query pipeline report for 1004D Req'd = Yes
2. Compare against previous scan results
3. Identify NEW loans (not in previous scan)
4. Identify AGING loans (>24 hours without action)

ALERT CRITERIA:
- New Loan: Immediate alert to assigned DC
- Aging Loan: Escalation alert at 24h, 48h marks
- Daily Summary: Count of open items per DC

ALERT FORMAT:
Subject: [1004D Action Required] New Loan: [LOAN_NUMBER]

Body:
Loan: [FILE_NAME]
State: [STATE]
Disc Coordinator: [DC_NAME]
1004D Req'd: Yes
CoC Start Date: [DATE or "Not Started"]

Action Required: Verify Appraisal Reinspection Fee disclosure

[Link to loan in Byte]

OUTPUT:
{
  "scanTimestamp": "datetime",
  "newLoans": [array of loan objects],
  "agingLoans": [array of loan objects],
  "totalOpen": number,
  "alertsSent": number
}`,
                integration: `INTEGRATION POINTS:

1. Byte Pipeline Report
   - API query or scheduled report export
   - Parse CSV/JSON output

2. State Management
   - Store previous scan results
   - Track loan status changes

3. Email/Notification Service
   - SMTP for email alerts
   - MS Teams/Slack for instant messaging

4. Dashboard Integration
   - Feed data to operations dashboard
   - Track SLA compliance

DEPLOYMENT:
- Scheduled task (cron / Azure Logic Apps)
- Database for state persistence
- Configurable alert thresholds`
            }
        };

        function showAgentPrompt(agentKey) {
            const agent = agentPrompts[agentKey];
            if (!agent) return;

            document.getElementById('promptModalTitle').textContent = agent.name + ' - Build Prompt';
            document.getElementById('promptTags').innerHTML = agent.tags.map(tag =>
                `<span class="prompt-tag">${tag}</span>`
            ).join('');
            document.getElementById('promptPurpose').textContent = agent.purpose;
            document.getElementById('promptContent').textContent = agent.prompt;
            document.getElementById('promptIntegration').textContent = agent.integration;

            document.getElementById('promptModal').classList.add('show');
            document.body.style.overflow = 'hidden';
        }

        function closePromptModal() {
            document.getElementById('promptModal').classList.remove('show');
            document.body.style.overflow = '';
        }

        async function copyPromptToClipboard() {
            try {
                const content = document.getElementById('promptContent').textContent;
                await navigator.clipboard.writeText(content);
                const success = document.getElementById('copySuccess');
                success.style.display = 'block';
                setTimeout(() => { success.style.display = 'none'; }, 2000);
            } catch (e) { alert('Failed to copy.'); }
        }

        document.getElementById('promptModal').addEventListener('click', (e) => {
            if (e.target.id === 'promptModal') closePromptModal();
        });
    </script>
</body>
</html>
