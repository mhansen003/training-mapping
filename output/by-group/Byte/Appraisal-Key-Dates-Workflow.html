<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Byte Appraisal Key Dates - Process Workflow</title>
    <link href="https://fonts.googleapis.com/css2?family=Plus+Jakarta+Sans:wght@400;500;600;700;800&family=JetBrains+Mono:wght@400;500&display=swap" rel="stylesheet">
    <style>
        :root {
            --bg-primary: #0a0f1a;
            --bg-secondary: #111827;
            --bg-card: #1a2234;
            --accent-blue: #3b82f6;
            --accent-teal: #14b8a6;
            --accent-amber: #f59e0b;
            --accent-rose: #f43f5e;
            --accent-green: #22c55e;
            --accent-purple: #8b5cf6;
            --text-primary: #f1f5f9;
            --text-secondary: #94a3b8;
            --text-muted: #64748b;
            --border-subtle: rgba(255,255,255,0.08);
            --sidebar-width: 280px;
        }

        * { box-sizing: border-box; margin: 0; padding: 0; }
        html { scroll-behavior: smooth; }
        body {
            font-family: 'Plus Jakarta Sans', -apple-system, BlinkMacSystemFont, sans-serif;
            background: var(--bg-primary);
            color: var(--text-primary);
            min-height: 100vh;
        }

        /* Breadcrumb */
        .breadcrumb {
            background: linear-gradient(90deg, #0d1525 0%, #1a2234 100%);
            padding: 14px 25px;
            display: flex;
            align-items: center;
            gap: 12px;
            font-size: 0.95rem;
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            z-index: 1001;
            border-bottom: 1px solid var(--border-subtle);
        }

        .breadcrumb a {
            color: var(--text-secondary);
            text-decoration: none;
            font-weight: 600;
            padding: 8px 16px;
            background: rgba(255,255,255,0.05);
            border-radius: 8px;
            transition: all 0.2s;
            border: 1px solid var(--border-subtle);
        }

        .breadcrumb a:hover {
            background: rgba(59, 130, 246, 0.15);
            color: var(--accent-blue);
            border-color: rgba(59, 130, 246, 0.3);
        }

        .breadcrumb .separator { color: var(--text-muted); font-size: 1.2rem; }
        .breadcrumb .current { color: var(--accent-amber); font-weight: 600; padding: 8px 16px; }

        /* Sidebar */
        .sidebar {
            position: fixed;
            top: 54px;
            left: 0;
            width: var(--sidebar-width);
            height: calc(100vh - 54px);
            background: var(--bg-secondary);
            overflow-y: auto;
            z-index: 1000;
            border-right: 1px solid var(--border-subtle);
            display: flex;
            flex-direction: column;
        }

        .sidebar-header {
            padding: 25px 20px;
            background: rgba(0,0,0,0.3);
            border-bottom: 1px solid var(--border-subtle);
        }

        .sidebar-header h2 { color: var(--text-primary); font-size: 1.2rem; font-weight: 700; margin-bottom: 5px; }
        .sidebar-header p { color: var(--text-muted); font-size: 0.85rem; }

        /* Tab Switch */
        .sidebar-tabs {
            display: flex;
            border-bottom: 1px solid var(--border-subtle);
        }

        .sidebar-tab {
            flex: 1;
            padding: 14px 10px;
            text-align: center;
            font-size: 0.8rem;
            font-weight: 700;
            color: var(--text-muted);
            cursor: pointer;
            transition: all 0.2s;
            border-bottom: 3px solid transparent;
            background: none;
            border-left: none;
            border-right: none;
            border-top: none;
        }

        .sidebar-tab:hover { background: rgba(255,255,255,0.03); color: var(--text-secondary); }
        .sidebar-tab.active { color: var(--accent-blue); border-bottom-color: var(--accent-blue); background: rgba(59, 130, 246, 0.08); }
        .sidebar-tab.agent-tab.active { color: var(--accent-purple); border-bottom-color: var(--accent-purple); background: rgba(139, 92, 246, 0.08); }

        .sidebar-nav { padding: 15px 0; flex: 1; overflow-y: auto; }

        .nav-item {
            display: flex;
            align-items: center;
            gap: 12px;
            padding: 14px 20px;
            color: var(--text-secondary);
            text-decoration: none;
            border-left: 3px solid transparent;
            transition: all 0.2s ease;
            cursor: pointer;
        }

        .nav-item:hover { background: rgba(255,255,255,0.03); color: var(--text-primary); }
        .nav-item.active { background: rgba(59, 130, 246, 0.1); border-left-color: var(--accent-blue); color: var(--text-primary); }

        .nav-number {
            background: rgba(255,255,255,0.1);
            color: var(--text-secondary);
            width: 28px;
            height: 28px;
            border-radius: 8px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 700;
            font-size: 0.85rem;
            flex-shrink: 0;
        }

        .nav-item.active .nav-number { background: var(--accent-blue); color: white; }
        .nav-label { font-size: 0.95rem; font-weight: 500; }

        .sidebar-footer {
            padding: 20px;
            border-top: 1px solid var(--border-subtle);
            background: rgba(0,0,0,0.2);
        }

        .doc-btn {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
            width: 100%;
            padding: 14px 20px;
            background: linear-gradient(135deg, var(--accent-blue) 0%, var(--accent-teal) 100%);
            color: white;
            border: none;
            border-radius: 10px;
            font-weight: 600;
            cursor: pointer;
            transition: transform 0.2s, box-shadow 0.2s;
            text-decoration: none;
            font-size: 0.95rem;
        }

        .doc-btn:hover { transform: translateY(-2px); box-shadow: 0 8px 25px rgba(59, 130, 246, 0.3); }

        /* Main Content */
        .main-content { margin-left: var(--sidebar-width); padding: 80px 40px 40px 40px; }

        /* Tab Panels */
        .tab-panel { display: none; }
        .tab-panel.active { display: block; }

        .header {
            background: var(--bg-card);
            border: 1px solid var(--border-subtle);
            padding: 35px;
            border-radius: 16px;
            margin-bottom: 30px;
            position: relative;
            overflow: hidden;
        }

        .header::before {
            content: '';
            position: absolute;
            top: 0; left: 0; right: 0; bottom: 0;
            background:
                radial-gradient(ellipse at 20% 20%, rgba(59, 130, 246, 0.1) 0%, transparent 50%),
                radial-gradient(ellipse at 80% 80%, rgba(20, 184, 166, 0.08) 0%, transparent 50%);
            pointer-events: none;
        }

        .header h1 {
            font-size: 2.2rem;
            font-weight: 800;
            margin-bottom: 10px;
            position: relative;
            background: linear-gradient(135deg, var(--text-primary) 0%, var(--accent-blue) 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .header .subtitle { color: var(--text-secondary); font-size: 1.1rem; position: relative; }

        .header .meta { display: flex; gap: 15px; margin-top: 20px; flex-wrap: wrap; position: relative; }

        .header .meta-item {
            background: rgba(255,255,255,0.05);
            border: 1px solid var(--border-subtle);
            padding: 8px 16px;
            border-radius: 8px;
            font-size: 0.9rem;
            color: var(--text-secondary);
        }

        /* Legend */
        .legend {
            display: flex;
            flex-wrap: wrap;
            gap: 15px;
            padding: 18px 22px;
            background: var(--bg-card);
            border: 1px solid var(--border-subtle);
            border-radius: 12px;
            margin-bottom: 25px;
        }

        .legend-item { display: flex; align-items: center; gap: 8px; font-size: 0.85rem; color: var(--text-secondary); }
        .legend-color { width: 18px; height: 18px; border-radius: 4px; }

        /* Sections */
        .section {
            background: var(--bg-card);
            border: 1px solid var(--border-subtle);
            border-radius: 16px;
            margin-bottom: 25px;
            overflow: hidden;
            scroll-margin-top: 75px;
        }

        .section-header {
            background: linear-gradient(135deg, var(--bg-secondary) 0%, rgba(59, 130, 246, 0.1) 100%);
            border-bottom: 1px solid var(--border-subtle);
            padding: 22px 25px;
            display: flex;
            align-items: center;
            gap: 18px;
        }

        .section-number {
            background: linear-gradient(135deg, var(--accent-blue) 0%, var(--accent-teal) 100%);
            color: white;
            width: 48px;
            height: 48px;
            border-radius: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 800;
            font-size: 1.3rem;
            flex-shrink: 0;
        }

        .section-title h2 { font-size: 1.35rem; font-weight: 700; margin-bottom: 4px; color: var(--text-primary); }
        .section-title span { font-size: 0.9rem; color: var(--text-muted); }
        .section-content { padding: 28px; }

        /* Workflow Diagrams */
        .workflow-diagram {
            background: rgba(0,0,0,0.3);
            border: 1px solid var(--border-subtle);
            border-radius: 12px;
            padding: 28px;
            margin-bottom: 22px;
        }

        .flow-row { display: flex; align-items: center; justify-content: center; flex-wrap: wrap; gap: 12px; margin: 15px 0; }

        .flow-node {
            padding: 14px 22px;
            border-radius: 10px;
            text-align: center;
            font-size: 0.9rem;
            font-weight: 600;
            min-width: 150px;
            border: 1px solid var(--border-subtle);
        }

        .flow-node.start { background: linear-gradient(135deg, var(--accent-green) 0%, #16a34a 100%); color: white; border-radius: 25px; border: none; }
        .flow-node.action { background: linear-gradient(135deg, var(--accent-blue) 0%, #2563eb 100%); color: white; border: none; }
        .flow-node.decision { background: linear-gradient(135deg, var(--accent-amber) 0%, #d97706 100%); color: var(--bg-primary); border: none; }
        .flow-node.input { background: var(--bg-secondary); border: 2px solid var(--accent-blue); color: var(--text-primary); }
        .flow-node.output { background: linear-gradient(135deg, var(--accent-teal) 0%, #0d9488 100%); color: white; border: none; }
        .flow-node.exception { background: linear-gradient(135deg, var(--accent-rose) 0%, #dc2626 100%); color: white; border: none; }

        .flow-arrow { color: var(--accent-blue); font-size: 1.5rem; }
        .flow-arrow.down { transform: rotate(90deg); }

        .decision-branch { display: flex; gap: 40px; justify-content: center; margin: 20px 0; flex-wrap: wrap; }
        .branch { display: flex; flex-direction: column; align-items: center; gap: 10px; }

        .branch-label {
            background: var(--bg-secondary);
            border: 1px solid var(--border-subtle);
            padding: 6px 16px;
            border-radius: 20px;
            font-size: 0.8rem;
            font-weight: 700;
            color: var(--text-secondary);
        }

        /* Tables */
        .field-table { width: 100%; border-collapse: collapse; margin: 18px 0; }

        .field-table th {
            background: rgba(59, 130, 246, 0.15);
            color: var(--accent-blue);
            padding: 14px 18px;
            text-align: left;
            font-weight: 600;
            font-size: 0.9rem;
            text-transform: uppercase;
            letter-spacing: 0.05em;
            border-bottom: 1px solid var(--border-subtle);
        }

        .field-table td { padding: 14px 18px; border-bottom: 1px solid var(--border-subtle); color: var(--text-secondary); }
        .field-table tr:hover { background: rgba(255,255,255,0.02); }

        .badge { display: inline-block; padding: 4px 12px; border-radius: 6px; font-size: 0.75rem; font-weight: 700; text-transform: uppercase; letter-spacing: 0.05em; }
        .badge.processor-badge { background: rgba(59, 130, 246, 0.15); color: var(--accent-blue); }
        .badge.underwriter-badge { background: rgba(139, 92, 246, 0.15); color: var(--accent-purple); }
        .badge.isgn-badge { background: rgba(20, 184, 166, 0.15); color: var(--accent-teal); }
        .badge.required-badge { background: rgba(244, 63, 94, 0.15); color: var(--accent-rose); }
        .badge.calculated-badge { background: rgba(34, 197, 94, 0.15); color: var(--accent-green); }

        /* Info Boxes */
        .exception-box, .tip-box, .info-box, .warning-box {
            padding: 18px 22px;
            margin: 18px 0;
            border-radius: 0 10px 10px 0;
            border-left-width: 4px;
            border-left-style: solid;
        }

        .exception-box { background: rgba(244, 63, 94, 0.08); border-color: var(--accent-rose); border: 1px solid rgba(244, 63, 94, 0.2); border-left: 4px solid var(--accent-rose); }
        .exception-box h4 { color: var(--accent-rose); margin-bottom: 10px; font-size: 1rem; }
        .exception-box p, .exception-box li { color: var(--text-secondary); }

        .tip-box { background: rgba(34, 197, 94, 0.08); border-color: var(--accent-green); border: 1px solid rgba(34, 197, 94, 0.2); border-left: 4px solid var(--accent-green); }
        .tip-box h4 { color: var(--accent-green); margin-bottom: 10px; font-size: 1rem; }
        .tip-box p, .tip-box li { color: var(--text-secondary); }

        .info-box { background: rgba(59, 130, 246, 0.08); border-color: var(--accent-blue); border: 1px solid rgba(59, 130, 246, 0.2); border-left: 4px solid var(--accent-blue); }
        .info-box h4 { color: var(--accent-blue); margin-bottom: 10px; font-size: 1rem; }
        .info-box p, .info-box li { color: var(--text-secondary); }

        .warning-box { background: rgba(245, 158, 11, 0.08); border-color: var(--accent-amber); border: 1px solid rgba(245, 158, 11, 0.2); border-left: 4px solid var(--accent-amber); }
        .warning-box h4 { color: var(--accent-amber); margin-bottom: 10px; font-size: 1rem; }
        .warning-box p, .warning-box li { color: var(--text-secondary); }

        /* Responsibility Grid */
        .responsibility-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 18px;
            margin: 22px 0;
        }

        .responsibility-card {
            background: rgba(0,0,0,0.3);
            border: 1px solid var(--border-subtle);
            border-radius: 12px;
            padding: 22px;
            position: relative;
            overflow: hidden;
        }

        .responsibility-card::before {
            content: '';
            position: absolute;
            top: 0; left: 0; right: 0; height: 4px;
        }

        .responsibility-card.processor::before { background: linear-gradient(90deg, var(--accent-blue), var(--accent-teal)); }
        .responsibility-card.underwriter::before { background: linear-gradient(90deg, var(--accent-purple), var(--accent-rose)); }
        .responsibility-card.isgn::before { background: linear-gradient(90deg, var(--accent-teal), var(--accent-green)); }

        .responsibility-card h4 { color: var(--text-primary); margin-bottom: 12px; font-size: 1rem; }
        .responsibility-card ul { list-style: none; padding: 0; }
        .responsibility-card li { padding: 8px 0; border-bottom: 1px solid var(--border-subtle); color: var(--text-secondary); font-size: 0.9rem; display: flex; align-items: center; gap: 8px; }
        .responsibility-card li:last-child { border-bottom: none; }

        /* Summary Grid */
        .summary-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(180px, 1fr)); gap: 18px; margin: 22px 0; }

        .summary-card { background: rgba(0,0,0,0.3); border: 1px solid var(--border-subtle); border-radius: 12px; padding: 22px; text-align: center; }
        .summary-card h4 { color: var(--text-secondary); margin-bottom: 12px; font-size: 0.9rem; }
        .summary-card .value {
            font-size: 2.2rem;
            font-weight: 800;
            background: linear-gradient(135deg, var(--accent-blue) 0%, var(--accent-teal) 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }
        .summary-card .label { font-size: 0.85rem; color: var(--text-muted); margin-top: 8px; }

        /* Quick Reference */
        .quick-ref {
            background: linear-gradient(135deg, var(--bg-secondary) 0%, var(--bg-card) 100%);
            border: 1px solid var(--border-subtle);
            padding: 28px;
            border-radius: 16px;
            margin-top: 30px;
            font-family: 'JetBrains Mono', monospace;
            scroll-margin-top: 75px;
        }

        .quick-ref h3 { color: var(--accent-amber); margin-bottom: 18px; font-family: 'Plus Jakarta Sans', sans-serif; }
        .quick-ref pre { background: rgba(0,0,0,0.4); border: 1px solid var(--border-subtle); padding: 20px; border-radius: 10px; overflow-x: auto; font-size: 0.85rem; line-height: 1.7; color: var(--text-secondary); }

        /* ====== AGENT OPPORTUNITIES STYLES ====== */
        .agent-header {
            background: var(--bg-card);
            border: 1px solid var(--border-subtle);
            padding: 35px;
            border-radius: 16px;
            margin-bottom: 30px;
            position: relative;
            overflow: hidden;
        }

        .agent-header::before {
            content: '';
            position: absolute;
            top: 0; left: 0; right: 0; bottom: 0;
            background:
                radial-gradient(ellipse at 20% 20%, rgba(139, 92, 246, 0.12) 0%, transparent 50%),
                radial-gradient(ellipse at 80% 80%, rgba(245, 158, 11, 0.1) 0%, transparent 50%);
            pointer-events: none;
        }

        .agent-header h1 {
            font-size: 2.2rem;
            font-weight: 800;
            margin-bottom: 10px;
            position: relative;
            background: linear-gradient(135deg, var(--accent-purple) 0%, var(--accent-amber) 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .agent-header .subtitle { color: var(--text-secondary); font-size: 1.1rem; position: relative; }

        /* Heat Map */
        .heat-map-container { margin-bottom: 35px; }
        .heat-map-title { font-size: 1.3rem; font-weight: 700; color: var(--text-primary); margin-bottom: 20px; display: flex; align-items: center; gap: 12px; }

        .heat-map-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
        }

        .heat-item {
            background: var(--bg-card);
            border: 1px solid var(--border-subtle);
            border-radius: 12px;
            padding: 20px;
            position: relative;
            overflow: hidden;
            transition: transform 0.2s, box-shadow 0.2s;
            cursor: pointer;
        }

        .heat-item:hover { transform: translateY(-3px); box-shadow: 0 10px 30px rgba(0,0,0,0.3); }
        .heat-item:active { transform: scale(0.98); }

        .heat-item::before {
            content: '';
            position: absolute;
            top: 0; left: 0; right: 0; height: 4px;
        }

        .heat-item.critical::before { background: linear-gradient(90deg, #ef4444, #f97316); }
        .heat-item.high::before { background: linear-gradient(90deg, #f97316, #eab308); }
        .heat-item.medium::before { background: linear-gradient(90deg, #eab308, #22c55e); }
        .heat-item.low::before { background: linear-gradient(90deg, #22c55e, #14b8a6); }

        .heat-score {
            position: absolute;
            top: 15px;
            right: 15px;
            font-size: 1.8rem;
            font-weight: 800;
        }

        .heat-item.critical .heat-score { color: #ef4444; }
        .heat-item.high .heat-score { color: #f97316; }
        .heat-item.medium .heat-score { color: #eab308; }
        .heat-item.low .heat-score { color: #22c55e; }

        .heat-name { font-size: 1rem; font-weight: 700; color: var(--text-primary); margin-bottom: 6px; padding-right: 50px; }
        .heat-desc { font-size: 0.85rem; color: var(--text-muted); margin-bottom: 12px; }

        .heat-metrics { display: flex; gap: 15px; margin-top: 12px; }
        .heat-metric { font-size: 0.75rem; color: var(--text-muted); }
        .heat-metric span { color: var(--text-secondary); font-weight: 600; }

        /* Agent Cards */
        .agent-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(380px, 1fr)); gap: 25px; margin-bottom: 35px; }

        .agent-card {
            background: var(--bg-card);
            border: 1px solid var(--border-subtle);
            border-radius: 16px;
            overflow: hidden;
            transition: transform 0.2s, box-shadow 0.2s;
        }

        .agent-card:hover { transform: translateY(-5px); box-shadow: 0 15px 50px rgba(0,0,0,0.3); }

        .agent-card.highlight {
            animation: highlightPulse 2s ease;
            box-shadow: 0 0 0 3px var(--accent-purple), 0 15px 50px rgba(139, 92, 246, 0.4);
        }

        @keyframes highlightPulse {
            0% { box-shadow: 0 0 0 3px var(--accent-purple), 0 15px 50px rgba(139, 92, 246, 0.6); }
            50% { box-shadow: 0 0 0 6px rgba(139, 92, 246, 0.5), 0 15px 50px rgba(139, 92, 246, 0.3); }
            100% { box-shadow: 0 0 0 0px transparent, 0 15px 50px rgba(0,0,0,0.3); }
        }

        .agent-card-header {
            padding: 22px;
            display: flex;
            align-items: flex-start;
            gap: 18px;
            border-bottom: 1px solid var(--border-subtle);
        }

        .agent-icon {
            width: 55px;
            height: 55px;
            background: linear-gradient(135deg, var(--accent-purple) 0%, var(--accent-blue) 100%);
            border-radius: 14px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.6rem;
            flex-shrink: 0;
        }

        .agent-info { flex: 1; }
        .agent-name { font-size: 1.15rem; font-weight: 700; color: var(--text-primary); margin-bottom: 5px; }
        .agent-type { font-size: 0.8rem; color: var(--accent-purple); font-weight: 600; text-transform: uppercase; letter-spacing: 0.05em; }

        .agent-priority {
            padding: 6px 12px;
            border-radius: 20px;
            font-size: 0.75rem;
            font-weight: 700;
            text-transform: uppercase;
        }

        .agent-priority.critical { background: rgba(239, 68, 68, 0.15); color: #ef4444; }
        .agent-priority.high { background: rgba(249, 115, 22, 0.15); color: #f97316; }
        .agent-priority.medium { background: rgba(234, 179, 8, 0.15); color: #eab308; }
        .agent-priority.low { background: rgba(34, 197, 94, 0.15); color: #22c55e; }

        .agent-card-body { padding: 22px; }
        .agent-description { font-size: 0.95rem; color: var(--text-secondary); line-height: 1.6; margin-bottom: 20px; }

        .agent-flow {
            background: rgba(0,0,0,0.3);
            border: 1px solid var(--border-subtle);
            border-radius: 10px;
            padding: 18px;
            margin-bottom: 20px;
        }

        .agent-flow-title { font-size: 0.85rem; color: var(--text-muted); margin-bottom: 12px; font-weight: 600; text-transform: uppercase; letter-spacing: 0.05em; }

        .agent-flow-diagram { display: flex; align-items: center; flex-wrap: wrap; gap: 8px; justify-content: center; }

        .agent-step {
            background: linear-gradient(135deg, var(--accent-purple) 0%, var(--accent-blue) 100%);
            color: white;
            padding: 8px 14px;
            border-radius: 6px;
            font-size: 0.8rem;
            font-weight: 600;
            white-space: nowrap;
        }

        .agent-arrow { color: var(--accent-purple); font-size: 1.2rem; }

        .agent-stats { display: grid; grid-template-columns: repeat(3, 1fr); gap: 12px; }

        .agent-stat {
            background: rgba(0,0,0,0.2);
            border-radius: 8px;
            padding: 12px;
            text-align: center;
        }

        .agent-stat-value {
            font-size: 1.3rem;
            font-weight: 800;
            background: linear-gradient(135deg, var(--accent-purple) 0%, var(--accent-amber) 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .agent-stat-label { font-size: 0.7rem; color: var(--text-muted); text-transform: uppercase; letter-spacing: 0.05em; margin-top: 4px; }

        .agent-prompt-btn {
            width: 100%;
            margin-top: 18px;
            padding: 14px 20px;
            background: linear-gradient(135deg, rgba(139, 92, 246, 0.2) 0%, rgba(59, 130, 246, 0.2) 100%);
            border: 1px solid rgba(139, 92, 246, 0.4);
            border-radius: 10px;
            color: var(--accent-purple);
            font-weight: 700;
            cursor: pointer;
            transition: all 0.2s;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
            font-size: 0.9rem;
        }

        .agent-prompt-btn:hover {
            background: linear-gradient(135deg, rgba(139, 92, 246, 0.3) 0%, rgba(59, 130, 246, 0.3) 100%);
            border-color: var(--accent-purple);
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(139, 92, 246, 0.25);
        }

        /* Summary Stats */
        .agent-summary {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin-bottom: 35px;
        }

        .agent-summary-card {
            background: var(--bg-card);
            border: 1px solid var(--border-subtle);
            border-radius: 14px;
            padding: 25px;
            text-align: center;
        }

        .agent-summary-value {
            font-size: 2.5rem;
            font-weight: 800;
            background: linear-gradient(135deg, var(--accent-purple) 0%, var(--accent-amber) 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .agent-summary-label { font-size: 0.9rem; color: var(--text-muted); margin-top: 8px; }

        /* Heat Map Legend */
        .heat-legend {
            display: flex;
            gap: 25px;
            padding: 18px 22px;
            background: var(--bg-card);
            border: 1px solid var(--border-subtle);
            border-radius: 12px;
            margin-bottom: 25px;
            flex-wrap: wrap;
        }

        .heat-legend-item { display: flex; align-items: center; gap: 10px; font-size: 0.9rem; color: var(--text-secondary); }
        .heat-legend-color { width: 24px; height: 24px; border-radius: 6px; }

        /* Modal */
        .modal-overlay {
            display: none;
            position: fixed;
            top: 0; left: 0; right: 0; bottom: 0;
            background: rgba(10, 15, 26, 0.9);
            z-index: 2000;
            justify-content: center;
            align-items: center;
            padding: 20px;
            backdrop-filter: blur(5px);
        }

        .modal-overlay.show { display: flex; }

        .modal {
            background: var(--bg-card);
            border: 1px solid var(--border-subtle);
            border-radius: 16px;
            width: 100%;
            max-width: 950px;
            max-height: 90vh;
            display: flex;
            flex-direction: column;
            box-shadow: 0 25px 80px rgba(0,0,0,0.5);
        }

        .modal-header {
            background: linear-gradient(135deg, var(--accent-blue) 0%, var(--accent-teal) 100%);
            color: white;
            padding: 22px 28px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            border-radius: 16px 16px 0 0;
        }

        .modal-header h3 { font-size: 1.25rem; font-weight: 700; }
        .modal-actions { display: flex; gap: 12px; }

        .modal-btn {
            padding: 10px 18px;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-weight: 700;
            transition: transform 0.2s;
            font-size: 0.9rem;
        }

        .modal-btn:hover { transform: scale(1.05); }
        .modal-btn.copy { background: white; color: var(--accent-blue); }
        .modal-btn.close { background: rgba(255,255,255,0.2); color: white; }

        .modal-body { padding: 28px; overflow-y: auto; flex: 1; }

        .modal-body pre {
            background: rgba(0,0,0,0.3);
            border: 1px solid var(--border-subtle);
            padding: 22px;
            border-radius: 10px;
            font-family: 'JetBrains Mono', monospace;
            font-size: 0.9rem;
            line-height: 1.7;
            white-space: pre-wrap;
            word-wrap: break-word;
            color: var(--text-secondary);
        }

        .copy-success {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: var(--accent-green);
            color: white;
            padding: 18px 35px;
            border-radius: 10px;
            font-weight: 700;
            z-index: 3000;
            display: none;
            animation: fadeInOut 2s ease;
        }

        @keyframes fadeInOut { 0%, 100% { opacity: 0; } 10%, 90% { opacity: 1; } }

        /* Prompt Modal Styles */
        .prompt-modal .modal { max-width: 800px; }
        .prompt-modal .modal-header { background: linear-gradient(135deg, var(--accent-purple) 0%, var(--accent-blue) 100%); }

        .prompt-section { margin-bottom: 25px; }
        .prompt-section h4 { color: var(--accent-purple); font-size: 1rem; margin-bottom: 12px; display: flex; align-items: center; gap: 8px; }

        .prompt-box {
            background: rgba(0,0,0,0.4);
            border: 1px solid var(--border-subtle);
            border-radius: 10px;
            padding: 20px;
            font-family: 'JetBrains Mono', monospace;
            font-size: 0.85rem;
            line-height: 1.7;
            color: var(--text-secondary);
            white-space: pre-wrap;
            word-wrap: break-word;
        }

        .prompt-tags { display: flex; gap: 10px; flex-wrap: wrap; margin-bottom: 20px; }
        .prompt-tag { background: rgba(139, 92, 246, 0.15); color: var(--accent-purple); padding: 6px 14px; border-radius: 20px; font-size: 0.8rem; font-weight: 600; }

        @media (max-width: 900px) {
            .sidebar { display: none; }
            .main-content { margin-left: 0; padding: 75px 20px 30px 20px; }
            .agent-grid { grid-template-columns: 1fr; }
        }
            .breadcrumb-logo-link { display: flex; align-items: center; padding: 4px 8px; background: rgba(255,255,255,0.08); border-radius: 8px; border: 1px solid rgba(255,255,255,0.12); transition: all 0.2s; }
        .breadcrumb-logo-link:hover { background: rgba(255,255,255,0.15); }
        .breadcrumb-logo { height: 28px; width: auto; }
    </style>
</head>
<body>
    <!-- Breadcrumb -->
    <nav class="breadcrumb">
        <a href="../../index.html" class="breadcrumb-logo-link"><img src="../../images/clear-ai-logo.png" alt="Clear AI" class="breadcrumb-logo"></a>
        <a href="../../index.html">Portal Home</a>
        <span class="separator">></span>
        <a href="./index.html">Byte</a>
        <span class="separator">></span>
        <span class="current">Appraisal Key Dates</span>
    </nav>

    <!-- Fixed Sidebar -->
    <aside class="sidebar">
        <div class="sidebar-header">
            <h2>Appraisal Key Dates</h2>
            <p>Operations Workflow Guide</p>
        </div>

        <!-- Tab Switcher -->
        <div class="sidebar-tabs">
            <button class="sidebar-tab active" onclick="switchTab('workflow')">Workflow</button>
            <button class="sidebar-tab agent-tab" onclick="switchTab('agents')">AI Agents</button>
        </div>

        <!-- Workflow Navigation -->
        <nav class="sidebar-nav" id="workflow-nav">
            <a href="#section-1" class="nav-item active">
                <span class="nav-number">1</span>
                <span class="nav-label">Overview</span>
            </a>
            <a href="#section-2" class="nav-item">
                <span class="nav-number">2</span>
                <span class="nav-label">Order Out Dates</span>
            </a>
            <a href="#section-3" class="nav-item">
                <span class="nav-number">3</span>
                <span class="nav-label">Appraisal Info Screen</span>
            </a>
            <a href="#section-4" class="nav-item">
                <span class="nav-number">4</span>
                <span class="nav-label">Property Details</span>
            </a>
            <a href="#section-5" class="nav-item">
                <span class="nav-number">5</span>
                <span class="nav-label">Appraisal Details</span>
            </a>
            <a href="#section-6" class="nav-item">
                <span class="nav-number">6</span>
                <span class="nav-label">VA Appraisals</span>
            </a>
            <a href="#section-7" class="nav-item">
                <span class="nav-number">7</span>
                <span class="nav-label">Responsibilities</span>
            </a>
            <a href="#quick-ref" class="nav-item">
                <span class="nav-number">*</span>
                <span class="nav-label">Quick Reference</span>
            </a>
        </nav>

        <!-- Agent Navigation -->
        <nav class="sidebar-nav" id="agents-nav" style="display: none;">
            <a href="#agent-summary" class="nav-item active">
                <span class="nav-number">S</span>
                <span class="nav-label">Summary</span>
            </a>
            <a href="#agent-heatmap" class="nav-item">
                <span class="nav-number">H</span>
                <span class="nav-label">Heat Map</span>
            </a>
            <a href="#agent-details" class="nav-item">
                <span class="nav-number">A</span>
                <span class="nav-label">Agent Details</span>
            </a>
        </nav>

        <div class="sidebar-footer">
            <button class="doc-btn" onclick="openDocModal()">
                View Workflow Markdown
            </button>
        </div>
    </aside>

    <!-- Main Content -->
    <main class="main-content">

        <!-- ==================== WORKFLOW TAB ==================== -->
        <div id="workflow-panel" class="tab-panel active">
            <!-- Header -->
            <div class="header">
                <h1>Appraisal Key Dates for Operations</h1>
                <p class="subtitle">Comprehensive Guide to Appraisal Date Tracking in Byte</p>
                <div class="meta">
                    <span class="meta-item">System: Byte LOS</span>
                    <span class="meta-item">Roles: Processor, Underwriter, ISGN</span>
                    <span class="meta-item">Updated: 2/29/2024</span>
                    <span class="meta-item">Support: 888-AID-4-CMG</span>
                </div>
            </div>

            <!-- Legend -->
            <div class="legend">
                <div class="legend-item"><div class="legend-color" style="background: linear-gradient(135deg, #3b82f6, #14b8a6);"></div><span>Processor</span></div>
                <div class="legend-item"><div class="legend-color" style="background: linear-gradient(135deg, #8b5cf6, #f43f5e);"></div><span>Underwriter</span></div>
                <div class="legend-item"><div class="legend-color" style="background: linear-gradient(135deg, #14b8a6, #22c55e);"></div><span>ISGN (Auto)</span></div>
                <div class="legend-item"><div class="legend-color" style="background: linear-gradient(135deg, #f59e0b, #d97706);"></div><span>Decision Point</span></div>
                <div class="legend-item"><div class="legend-color" style="background: linear-gradient(135deg, #f43f5e, #dc2626);"></div><span>Critical</span></div>
            </div>

            <!-- Section 1: Overview -->
            <section id="section-1" class="section">
                <div class="section-header">
                    <div class="section-number">1</div>
                    <div class="section-title"><h2>Overview & Purpose</h2><span>Why appraisal dates matter</span></div>
                </div>
                <div class="section-content">
                    <div class="summary-grid">
                        <div class="summary-card"><h4>Critical Dates</h4><div class="value">2</div><div class="label">Ordered & Received</div></div>
                        <div class="summary-card"><h4>Tracked Fields</h4><div class="value">15+</div><div class="label">Appraisal Info Screen</div></div>
                        <div class="summary-card"><h4>Stakeholders</h4><div class="value">3</div><div class="label">Processor, UW, ISGN</div></div>
                    </div>

                    <div class="info-box">
                        <h4>Why Appraisal Dates Matter</h4>
                        <ul style="margin-left: 20px; margin-top: 10px;">
                            <li>Status updates and pipeline tracking</li>
                            <li>Delivery monitoring and vendor timing assessment</li>
                            <li>Required for Clear To Close on the loan</li>
                            <li>Notification to accounting for invoice payment</li>
                        </ul>
                    </div>

                    <div class="workflow-diagram">
                        <h3 style="text-align: center; margin-bottom: 22px; color: var(--accent-blue);">Appraisal Lifecycle Flow</h3>
                        <div class="flow-row">
                            <div class="flow-node start">Appraisal Ordered</div>
                            <span class="flow-arrow">-></span>
                            <div class="flow-node action">ISGN Processing</div>
                            <span class="flow-arrow">-></span>
                            <div class="flow-node action">Appraisal Received</div>
                            <span class="flow-arrow">-></span>
                            <div class="flow-node output">Delivered to Borrower</div>
                        </div>
                        <div class="flow-row">
                            <span class="flow-arrow down">|</span>
                        </div>
                        <div class="flow-row">
                            <div class="flow-node decision">UW Review</div>
                            <span class="flow-arrow">-></span>
                            <div class="flow-node output">Appraisal Approved</div>
                            <span class="flow-arrow">-></span>
                            <div class="flow-node start">Clear to Close</div>
                        </div>
                    </div>
                </div>
            </section>

            <!-- Section 2: Order Out Dates -->
            <section id="section-2" class="section">
                <div class="section-header">
                    <div class="section-number">2</div>
                    <div class="section-title"><h2>Appraisal Order Out Dates</h2><span>Critical dates for pipeline tracking</span></div>
                </div>
                <div class="section-content">
                    <div class="exception-box">
                        <h4>Critical Requirement</h4>
                        <p>Two appraisal dates must be accurately entered on each loan for reporting: <strong>Appraisal Ordered</strong> and <strong>Appraisal Received</strong>. Click <strong>Edit Order Out</strong> to modify each date.</p>
                    </div>

                    <div class="workflow-diagram">
                        <h3 style="text-align: center; margin-bottom: 22px; color: var(--accent-blue);">Where to Enter Dates</h3>
                        <div class="flow-row">
                            <div class="flow-node input">Option 1: Appraisal Info Screen</div>
                            <span class="flow-arrow">-></span>
                            <div class="flow-node action">Edit Order Out</div>
                        </div>
                        <div class="flow-row" style="margin-top: 10px;">
                            <span style="color: var(--text-muted); font-weight: 600;">OR</span>
                        </div>
                        <div class="flow-row">
                            <div class="flow-node input">Option 2: Processing Log</div>
                            <span class="flow-arrow">-></span>
                            <div class="flow-node action">Add Order Outs</div>
                        </div>
                    </div>

                    <div class="warning-box">
                        <h4>Do NOT Use Add Predefined Items</h4>
                        <p>The generic appraisal option in <strong>Processing Log -> Add Predefined Items</strong> does <em>not</em> track the appraisal. Always use <strong>Add Order Outs</strong> for accurate pipeline tracking.</p>
                    </div>

                    <table class="field-table">
                        <thead>
                            <tr>
                                <th>Field</th>
                                <th>Responsibility</th>
                                <th>Description</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td><strong style="color: var(--text-primary);">Appraisal Ordered</strong></td>
                                <td><span class="badge processor-badge">Processor</span></td>
                                <td>Date appraisal was ordered from AMC/appraiser</td>
                            </tr>
                            <tr>
                                <td><strong style="color: var(--text-primary);">Appraisal Received</strong></td>
                                <td><span class="badge processor-badge">Processor</span></td>
                                <td>Date appraisal report was received</td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </section>

            <!-- Section 3: Appraisal Info Screen -->
            <section id="section-3" class="section">
                <div class="section-header">
                    <div class="section-number">3</div>
                    <div class="section-title"><h2>Appraisal Info Screen Fields</h2><span>Invoice approval and delivery tracking</span></div>
                </div>
                <div class="section-content">
                    <div class="tip-box">
                        <h4>ISGN Automation</h4>
                        <p>ISGN completes many fields automatically on all GDMS orders. Exceptions: VA appraisals, transferred appraisals from other lenders, and employee loans are not accessible by ISGN.</p>
                    </div>

                    <table class="field-table">
                        <thead>
                            <tr>
                                <th>Field</th>
                                <th>Responsibility</th>
                                <th>Description</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td><strong style="color: var(--text-primary);">Approved to Invoice Appraisal</strong></td>
                                <td><span class="badge isgn-badge">ISGN</span></td>
                                <td>Date appraisal is dated/report date</td>
                            </tr>
                            <tr>
                                <td><strong style="color: var(--text-primary);">Approved to Invoice Appraisal Rush Fee</strong></td>
                                <td><span class="badge required-badge">Sales Mgr Approval</span></td>
                                <td>Must be approved by a Sales Manager</td>
                            </tr>
                            <tr>
                                <td><strong style="color: var(--text-primary);">Approved to Invoice Final Inspection (1004D)</strong></td>
                                <td><span class="badge required-badge">Sales Mgr Approval</span></td>
                                <td>Must be approved by a Sales Manager</td>
                            </tr>
                            <tr>
                                <td><strong style="color: var(--text-primary);">1004D/Reinspection Needed</strong></td>
                                <td><span class="badge isgn-badge">ISGN</span></td>
                                <td>Checked by ISGN; triggers redisclosure of reinspection fee by disclosure team. Team unchecks once complete.</td>
                            </tr>
                            <tr>
                                <td><strong style="color: var(--text-primary);">Appraisal Complete</strong></td>
                                <td><span class="badge isgn-badge">ISGN</span></td>
                                <td>Date appraisal is dated/report date</td>
                            </tr>
                            <tr>
                                <td><strong style="color: var(--text-primary);">Appraisal Delivered</strong></td>
                                <td><span class="badge isgn-badge">ISGN</span></td>
                                <td>Date appraisal was delivered to borrower. Must be 3+ days prior to closing (email/in-person) or follow mailbox rule.</td>
                            </tr>
                            <tr>
                                <td><strong style="color: var(--text-primary);">Delivery Method</strong></td>
                                <td><span class="badge isgn-badge">ISGN</span></td>
                                <td>How appraisal was delivered to borrower (Email, Mail, Hand Delivered)</td>
                            </tr>
                            <tr>
                                <td><strong style="color: var(--text-primary);">Received by Borrower</strong></td>
                                <td><span class="badge calculated-badge">Calculated</span></td>
                                <td>Based on mailbox rule or actual receipt date if emailed/hand delivered</td>
                            </tr>
                            <tr>
                                <td><strong style="color: var(--text-primary);">Timing Waiver Date</strong></td>
                                <td><span class="badge isgn-badge">ISGN</span></td>
                                <td>Date borrower returned fully executed Appraisal Time Waiver Request</td>
                            </tr>
                        </tbody>
                    </table>

                    <div class="info-box">
                        <h4>Appraisal Delivery Timing Rules</h4>
                        <ul style="margin-left: 20px; margin-top: 10px;">
                            <li><strong>Email/In-Person:</strong> Must be delivered 3+ days prior to closing</li>
                            <li><strong>Mail:</strong> Follow the mailbox rule for receipt calculation</li>
                            <li><strong>Timing Waiver:</strong> Required if delivery timing cannot be met</li>
                        </ul>
                    </div>
                </div>
            </section>

            <!-- Section 4: Property Details -->
            <section id="section-4" class="section">
                <div class="section-header">
                    <div class="section-number">4</div>
                    <div class="section-title"><h2>Property Structure & Age Information</h2><span>Required for investor purchase</span></div>
                </div>
                <div class="section-content">
                    <div class="exception-box">
                        <h4>Investor Requirement</h4>
                        <p>The <strong>Property Structure Details</strong> and <strong>Property Age Information</strong> sections must be completed for investor purchase. This information can be found on the first three pages of the appraisal report.</p>
                    </div>

                    <div class="responsibility-grid">
                        <div class="responsibility-card processor">
                            <h4>Property Structure Details</h4>
                            <ul>
                                <li>1. Property Type (SFR, PUD, Condo, etc.)</li>
                                <li>2. Construction Type (Existing, New, etc.)</li>
                                <li>3. Stories</li>
                                <li>4. No Units</li>
                                <li>5. Square Feet</li>
                                <li>6. Bedrooms Unit 1</li>
                            </ul>
                        </div>
                        <div class="responsibility-card processor">
                            <h4>Property Age Information</h4>
                            <ul>
                                <li>7. Remaining Economic Life</li>
                                <li>8. Year Built</li>
                                <li>9. Property Age</li>
                            </ul>
                        </div>
                    </div>

                    <div class="tip-box">
                        <h4>Where to Find This Information</h4>
                        <p>All Property Structure and Age information is located on <strong>Pages 1-3</strong> of the appraisal report. Look for:</p>
                        <ul style="margin-left: 20px; margin-top: 10px;">
                            <li><strong>Page 1:</strong> Property details, subject section</li>
                            <li><strong>Page 2:</strong> Quality of Construction, Actual Age, Condition</li>
                            <li><strong>Page 3:</strong> Estimated Remaining Economic Life (HUD and VA only)</li>
                        </ul>
                    </div>
                </div>
            </section>

            <!-- Section 5: Appraisal Details -->
            <section id="section-5" class="section">
                <div class="section-header">
                    <div class="section-number">5</div>
                    <div class="section-title"><h2>Appraisal Details Section</h2><span>UCDP, valuation method, and waivers</span></div>
                </div>
                <div class="section-content">
                    <table class="field-table">
                        <thead>
                            <tr>
                                <th>Field</th>
                                <th>Responsibility</th>
                                <th>Description</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td><strong style="color: var(--text-primary);">UCDP Document ID</strong></td>
                                <td><span class="badge processor-badge">Processor</span></td>
                                <td>Found on the SSR report received with the appraisal</td>
                            </tr>
                            <tr>
                                <td><strong style="color: var(--text-primary);">Valuation Method</strong></td>
                                <td><span class="badge processor-badge">Processor</span></td>
                                <td>Select appropriate appraisal type. If waived, select "None"</td>
                            </tr>
                            <tr>
                                <td><strong style="color: var(--text-primary);">Appraisal Waiver</strong></td>
                                <td><span class="badge processor-badge">Processor</span></td>
                                <td>Check when PIW granted through AUS or for products with no appraisal required (FHA Streamline, VA IRRRL)</td>
                            </tr>
                            <tr>
                                <td><strong style="color: var(--text-primary);">Brokered loan - No CMG appraisal</strong></td>
                                <td><span class="badge processor-badge">Processor</span></td>
                                <td>For Brokered loans only when CMG is not obtaining appraisal. Removes loan from Appraisal Tracking Report.</td>
                            </tr>
                            <tr>
                                <td><strong style="color: var(--text-primary);">Valuation Form</strong></td>
                                <td><span class="badge processor-badge">Processor</span></td>
                                <td>Select the form the appraiser used (form numbers vary by property type)</td>
                            </tr>
                            <tr>
                                <td><strong style="color: var(--text-primary);">AVM Model Type</strong></td>
                                <td><span class="badge processor-badge">Processor</span></td>
                                <td>Select appropriate AVM used (if applicable)</td>
                            </tr>
                            <tr>
                                <td><strong style="color: var(--text-primary);">Investor Collateral Program</strong></td>
                                <td><span class="badge processor-badge">Post-Closing</span></td>
                                <td>Selected by Post-Closing team</td>
                            </tr>
                            <tr>
                                <td><strong style="color: var(--text-primary);">COVID 19 Desktop</strong></td>
                                <td><span class="badge underwriter-badge">Underwriter</span></td>
                                <td>Selected by Underwriter as required</td>
                            </tr>
                            <tr>
                                <td><strong style="color: var(--text-primary);">Property Valuation Effective Date</strong></td>
                                <td><span class="badge processor-badge">Processor</span></td>
                                <td>Effective date of appraisal found on bottom of page 2</td>
                            </tr>
                            <tr>
                                <td><strong style="color: var(--text-primary);">Appraisal Approved by Underwriting</strong></td>
                                <td><span class="badge underwriter-badge">Underwriter</span></td>
                                <td>Date added once appraisal is approved by Underwriter</td>
                            </tr>
                            <tr>
                                <td><strong style="color: var(--text-primary);">Timing Waiver Requested</strong></td>
                                <td><span class="badge processor-badge">Processor</span></td>
                                <td>Completed by person sending Timing Waiver Request to Borrower</td>
                            </tr>
                            <tr>
                                <td><strong style="color: var(--text-primary);">Appraisal Type</strong></td>
                                <td><span class="badge processor-badge">Processor</span></td>
                                <td>Select appropriate type. If waived, select "No Appraisal"</td>
                            </tr>
                            <tr>
                                <td><strong style="color: var(--text-primary);">Appraisal Form No</strong></td>
                                <td><span class="badge processor-badge">Processor</span></td>
                                <td>Input Fannie Mae form number (e.g., 1004, 1025, 2055)</td>
                            </tr>
                        </tbody>
                    </table>

                    <div class="info-box">
                        <h4>Common Appraisal Form Numbers</h4>
                        <ul style="margin-left: 20px; margin-top: 10px;">
                            <li><strong>1004:</strong> Uniform Residential Appraisal Report (Single Family)</li>
                            <li><strong>1025:</strong> Small Residential Income Property (2-4 Units)</li>
                            <li><strong>2055:</strong> Exterior-Only Inspection</li>
                            <li><strong>1073:</strong> Individual Condo Unit Appraisal</li>
                            <li><strong>1004D:</strong> Appraisal Update/Completion Report</li>
                        </ul>
                    </div>
                </div>
            </section>

            <!-- Section 6: VA Appraisals -->
            <section id="section-6" class="section">
                <div class="section-header">
                    <div class="section-number">6</div>
                    <div class="section-title"><h2>VA Appraisals</h2><span>Special tracking for VA loans</span></div>
                </div>
                <div class="section-content">
                    <div class="warning-box">
                        <h4>VA Appraisal Exception</h4>
                        <p>VA appraisals and transferred appraisals from other lenders are <strong>not</strong> completed by ISGN. These require manual entry by the Processor and Underwriter.</p>
                    </div>

                    <table class="field-table">
                        <thead>
                            <tr>
                                <th>Field</th>
                                <th>Responsibility</th>
                                <th>Description</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td><strong style="color: var(--text-primary);">VA1004D Requested</strong></td>
                                <td><span class="badge processor-badge">Processor</span></td>
                                <td>Input for tracking of VA final inspection order</td>
                            </tr>
                            <tr>
                                <td><strong style="color: var(--text-primary);">VA1004D Received</strong></td>
                                <td><span class="badge processor-badge">Processor</span></td>
                                <td>Input for tracking of VA final inspection receipt</td>
                            </tr>
                            <tr>
                                <td><strong style="color: var(--text-primary);">NOV Assigned</strong></td>
                                <td><span class="badge underwriter-badge">Underwriter</span></td>
                                <td>Used when a different Underwriter is reviewing the Notice of Value</td>
                            </tr>
                            <tr>
                                <td><strong style="color: var(--text-primary);">NOV Underwriter</strong></td>
                                <td><span class="badge underwriter-badge">Underwriter</span></td>
                                <td>Underwriter name that completes the review</td>
                            </tr>
                            <tr>
                                <td><strong style="color: var(--text-primary);">Lender SAR ID Number</strong></td>
                                <td><span class="badge underwriter-badge">Underwriter</span></td>
                                <td>Underwriter SAR number</td>
                            </tr>
                            <tr>
                                <td><strong style="color: var(--text-primary);">SAR Issue Date</strong></td>
                                <td><span class="badge underwriter-badge">Underwriter</span></td>
                                <td>Entered by Underwriter</td>
                            </tr>
                            <tr>
                                <td><strong style="color: var(--text-primary);">NOV Sent To Borrower(s)</strong></td>
                                <td><span class="badge processor-badge">Processor</span></td>
                                <td>Entered by person sending NOV and Appraisal to Borrower</td>
                            </tr>
                            <tr>
                                <td><strong style="color: var(--text-primary);">Appraisal Docs Expire</strong></td>
                                <td><span class="badge underwriter-badge">Underwriter</span></td>
                                <td>Entered in Status, Appraisal Info, or Underwriting Screens</td>
                            </tr>
                        </tbody>
                    </table>

                    <div class="workflow-diagram">
                        <h3 style="text-align: center; margin-bottom: 22px; color: var(--accent-blue);">VA Appraisal Flow</h3>
                        <div class="flow-row">
                            <div class="flow-node action">VA1004D Requested</div>
                            <span class="flow-arrow">-></span>
                            <div class="flow-node action">VA1004D Received</div>
                            <span class="flow-arrow">-></span>
                            <div class="flow-node decision">NOV Review</div>
                        </div>
                        <div class="flow-row">
                            <span class="flow-arrow down">|</span>
                        </div>
                        <div class="flow-row">
                            <div class="flow-node output">NOV Sent to Borrower</div>
                            <span class="flow-arrow">-></span>
                            <div class="flow-node start">Complete</div>
                        </div>
                    </div>
                </div>
            </section>

            <!-- Section 7: Responsibilities -->
            <section id="section-7" class="section">
                <div class="section-header">
                    <div class="section-number">7</div>
                    <div class="section-title"><h2>Role Responsibilities Summary</h2><span>Who is responsible for what</span></div>
                </div>
                <div class="section-content">
                    <div class="exception-box">
                        <h4>Processor Critical Responsibility</h4>
                        <p>ISGN receives reporting to complete many pieces of the Appraisal Info Screen and timing may be delayed. <strong>It is the Processor's responsibility to ensure all fields not specifically noted for the Underwriter are complete prior to underwriting review.</strong></p>
                    </div>

                    <div class="responsibility-grid">
                        <div class="responsibility-card processor">
                            <h4>Processor</h4>
                            <ul>
                                <li>Appraisal Ordered/Received dates</li>
                                <li>UCDP Document ID</li>
                                <li>Valuation Method & Form</li>
                                <li>Appraisal Waiver checkbox</li>
                                <li>Property Structure Details</li>
                                <li>Property Age Information</li>
                                <li>VA1004D Requested/Received</li>
                                <li>NOV Sent to Borrower</li>
                                <li>Timing Waiver Requested</li>
                            </ul>
                        </div>
                        <div class="responsibility-card underwriter">
                            <h4>Underwriter</h4>
                            <ul>
                                <li>COVID 19 Desktop selection</li>
                                <li>Appraisal Approved by UW date</li>
                                <li>NOV Assigned/Underwriter</li>
                                <li>Lender SAR ID Number</li>
                                <li>SAR Issue Date</li>
                                <li>Appraisal Docs Expire</li>
                            </ul>
                        </div>
                        <div class="responsibility-card isgn">
                            <h4>ISGN (Automated)</h4>
                            <ul>
                                <li>Approved to Invoice fields</li>
                                <li>1004D/Reinspection Needed</li>
                                <li>Appraisal Complete</li>
                                <li>Appraisal Delivered</li>
                                <li>Delivery Method</li>
                                <li>Timing Waiver Date</li>
                            </ul>
                        </div>
                    </div>

                    <div class="info-box">
                        <h4>ISGN Exceptions</h4>
                        <p>ISGN does <strong>NOT</strong> complete fields for:</p>
                        <ul style="margin-left: 20px; margin-top: 10px;">
                            <li>VA appraisals</li>
                            <li>Transferred appraisals from other lenders</li>
                            <li>Employee loans</li>
                        </ul>
                    </div>
                </div>
            </section>

            <!-- Quick Reference -->
            <section id="quick-ref" class="quick-ref">
                <h3>Quick Reference Card</h3>
                <pre>
CRITICAL DATES (Must Enter for Every Loan):
- Appraisal Ordered: Date order placed with AMC
- Appraisal Received: Date report received

WHERE TO ENTER DATES:
1. Appraisal Info Screen -> Edit Order Out
2. Processing Log -> Add Order Outs
** DO NOT use Add Predefined Items - does not track appraisal **

DELIVERY TIMING:
- Email/In-Person: 3+ days before closing
- Mail: Follow mailbox rule
- Exception: Use Timing Waiver

PROPERTY INFO (Pages 1-3 of Appraisal):
Structure: Type, Construction, Stories, Units, SqFt, Bedrooms
Age: Remaining Economic Life, Year Built, Property Age

VA APPRAISALS (Manual Entry Required):
- VA1004D Requested/Received (Processor)
- NOV fields (Underwriter)
- SAR ID/Issue Date (Underwriter)

NEED HELP? CALL BYTE SUPPORT: 888-AID-4-CMG
                </pre>
            </section>
        </div>

        <!-- ==================== AGENT OPPORTUNITIES TAB ==================== -->
        <div id="agents-panel" class="tab-panel">
            <!-- Header -->
            <div class="agent-header">
                <h1>AI Agent Opportunities</h1>
                <p class="subtitle">Automation Analysis for Appraisal Key Dates Workflow</p>
                <div class="meta">
                    <span class="meta-item">7 Process Steps Analyzed</span>
                    <span class="meta-item">4 Agent Candidates Identified</span>
                    <span class="meta-item">Est. 45% Time Savings</span>
                </div>
            </div>

            <!-- Summary Stats -->
            <div class="agent-summary" id="agent-summary">
                <div class="agent-summary-card">
                    <div class="agent-summary-value">4</div>
                    <div class="agent-summary-label">Agent Candidates</div>
                </div>
                <div class="agent-summary-card">
                    <div class="agent-summary-value">2</div>
                    <div class="agent-summary-label">High Priority</div>
                </div>
                <div class="agent-summary-card">
                    <div class="agent-summary-value">45%</div>
                    <div class="agent-summary-label">Time Savings</div>
                </div>
                <div class="agent-summary-card">
                    <div class="agent-summary-value">80%</div>
                    <div class="agent-summary-label">Automation Potential</div>
                </div>
            </div>

            <!-- Heat Map Legend -->
            <div class="heat-legend" id="agent-heatmap">
                <div class="heat-legend-item"><div class="heat-legend-color" style="background: linear-gradient(135deg, #ef4444, #f97316);"></div><span><strong>Critical (90-100)</strong> - Immediate ROI</span></div>
                <div class="heat-legend-item"><div class="heat-legend-color" style="background: linear-gradient(135deg, #f97316, #eab308);"></div><span><strong>High (70-89)</strong> - Strong candidate</span></div>
                <div class="heat-legend-item"><div class="heat-legend-color" style="background: linear-gradient(135deg, #eab308, #22c55e);"></div><span><strong>Medium (50-69)</strong> - Consider</span></div>
                <div class="heat-legend-item"><div class="heat-legend-color" style="background: linear-gradient(135deg, #22c55e, #14b8a6);"></div><span><strong>Low (0-49)</strong> - Future phase</span></div>
            </div>

            <!-- Heat Map Grid -->
            <div class="heat-map-container">
                <div class="heat-map-title">Automation Priority Heat Map <span style="font-size: 0.8rem; font-weight: 400; color: var(--text-muted);">(Click to jump to agent)</span></div>
                <div class="heat-map-grid">
                    <div class="heat-item critical" onclick="scrollToAgent('agent-extraction')" title="Click to view agent details">
                        <div class="heat-score">92</div>
                        <div class="heat-name">Appraisal Data Extraction</div>
                        <div class="heat-desc">Auto-extract property details from PDF</div>
                        <div class="heat-metrics">
                            <div class="heat-metric">Effort: <span>Medium</span></div>
                            <div class="heat-metric">Impact: <span>High</span></div>
                            <div class="heat-metric">Step: <span>4</span></div>
                        </div>
                    </div>
                    <div class="heat-item high" onclick="scrollToAgent('agent-tracking')" title="Click to view agent details">
                        <div class="heat-score">85</div>
                        <div class="heat-name">Delivery Timing Monitor</div>
                        <div class="heat-desc">Alert on delivery timing compliance</div>
                        <div class="heat-metrics">
                            <div class="heat-metric">Effort: <span>Low</span></div>
                            <div class="heat-metric">Impact: <span>High</span></div>
                            <div class="heat-metric">Step: <span>3</span></div>
                        </div>
                    </div>
                    <div class="heat-item high" onclick="scrollToAgent('agent-validation')" title="Click to view agent details">
                        <div class="heat-score">78</div>
                        <div class="heat-name">Field Completion Validator</div>
                        <div class="heat-desc">Verify all required fields before UW</div>
                        <div class="heat-metrics">
                            <div class="heat-metric">Effort: <span>Low</span></div>
                            <div class="heat-metric">Impact: <span>Medium</span></div>
                            <div class="heat-metric">Step: <span>7</span></div>
                        </div>
                    </div>
                    <div class="heat-item medium" onclick="scrollToAgent('agent-expiration')" title="Click to view agent details">
                        <div class="heat-score">65</div>
                        <div class="heat-name">Expiration Date Tracker</div>
                        <div class="heat-desc">Monitor appraisal expiration dates</div>
                        <div class="heat-metrics">
                            <div class="heat-metric">Effort: <span>Low</span></div>
                            <div class="heat-metric">Impact: <span>Medium</span></div>
                            <div class="heat-metric">Step: <span>6</span></div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Agent Details -->
            <h2 style="font-size: 1.4rem; margin: 35px 0 22px; color: var(--text-primary);" id="agent-details">Agent Specifications</h2>

            <div class="agent-grid">
                <!-- Agent 1: Appraisal Data Extraction -->
                <div class="agent-card" id="agent-extraction">
                    <div class="agent-card-header">
                        <div class="agent-icon"></div>
                        <div class="agent-info">
                            <div class="agent-name">Appraisal Data Extraction Agent</div>
                            <div class="agent-type">Document Processing Agent</div>
                        </div>
                        <span class="agent-priority critical">Critical</span>
                    </div>
                    <div class="agent-card-body">
                        <p class="agent-description">Automatically extracts property structure details, age information, UCDP ID, and valuation data from appraisal PDFs. Populates Byte fields without manual data entry.</p>
                        <div class="agent-flow">
                            <div class="agent-flow-title">Agent Flow</div>
                            <div class="agent-flow-diagram">
                                <div class="agent-step">PDF Upload</div>
                                <span class="agent-arrow">-></span>
                                <div class="agent-step">OCR/Parse</div>
                                <span class="agent-arrow">-></span>
                                <div class="agent-step">Extract Fields</div>
                                <span class="agent-arrow">-></span>
                                <div class="agent-step">Auto-Fill Byte</div>
                            </div>
                        </div>
                        <div class="agent-stats">
                            <div class="agent-stat"><div class="agent-stat-value">8min</div><div class="agent-stat-label">Time Saved</div></div>
                            <div class="agent-stat"><div class="agent-stat-value">95%</div><div class="agent-stat-label">Accuracy</div></div>
                            <div class="agent-stat"><div class="agent-stat-value">Med</div><div class="agent-stat-label">Complexity</div></div>
                        </div>
                        <button class="agent-prompt-btn" onclick="showAgentPrompt('extraction')">
                            View AI Prompt to Build This Agent
                        </button>
                    </div>
                </div>

                <!-- Agent 2: Delivery Timing Monitor -->
                <div class="agent-card" id="agent-tracking">
                    <div class="agent-card-header">
                        <div class="agent-icon"></div>
                        <div class="agent-info">
                            <div class="agent-name">Delivery Timing Monitor</div>
                            <div class="agent-type">Compliance Monitoring Agent</div>
                        </div>
                        <span class="agent-priority high">High</span>
                    </div>
                    <div class="agent-card-body">
                        <p class="agent-description">Monitors appraisal delivery dates against closing dates to ensure 3-day compliance. Alerts when timing waiver may be needed or when delivery deadline approaches.</p>
                        <div class="agent-flow">
                            <div class="agent-flow-title">Agent Flow</div>
                            <div class="agent-flow-diagram">
                                <div class="agent-step">Closing Date</div>
                                <span class="agent-arrow">-></span>
                                <div class="agent-step">Calculate Deadline</div>
                                <span class="agent-arrow">-></span>
                                <div class="agent-step">Monitor Status</div>
                                <span class="agent-arrow">-></span>
                                <div class="agent-step">Alert</div>
                            </div>
                        </div>
                        <div class="agent-stats">
                            <div class="agent-stat"><div class="agent-stat-value">100%</div><div class="agent-stat-label">Compliance</div></div>
                            <div class="agent-stat"><div class="agent-stat-value">24/7</div><div class="agent-stat-label">Monitoring</div></div>
                            <div class="agent-stat"><div class="agent-stat-value">Low</div><div class="agent-stat-label">Complexity</div></div>
                        </div>
                        <button class="agent-prompt-btn" onclick="showAgentPrompt('tracking')">
                            View AI Prompt to Build This Agent
                        </button>
                    </div>
                </div>

                <!-- Agent 3: Field Completion Validator -->
                <div class="agent-card" id="agent-validation">
                    <div class="agent-card-header">
                        <div class="agent-icon"></div>
                        <div class="agent-info">
                            <div class="agent-name">Field Completion Validator</div>
                            <div class="agent-type">QC Validation Agent</div>
                        </div>
                        <span class="agent-priority high">High</span>
                    </div>
                    <div class="agent-card-body">
                        <p class="agent-description">Validates that all Processor-required appraisal fields are complete before loan is submitted to Underwriting. Prevents delays and condition loops.</p>
                        <div class="agent-flow">
                            <div class="agent-flow-title">Agent Flow</div>
                            <div class="agent-flow-diagram">
                                <div class="agent-step">Loan Queue</div>
                                <span class="agent-arrow">-></span>
                                <div class="agent-step">Check Fields</div>
                                <span class="agent-arrow">-></span>
                                <div class="agent-step">Flag Missing</div>
                                <span class="agent-arrow">-></span>
                                <div class="agent-step">Notify Processor</div>
                            </div>
                        </div>
                        <div class="agent-stats">
                            <div class="agent-stat"><div class="agent-stat-value">15</div><div class="agent-stat-label">Fields Checked</div></div>
                            <div class="agent-stat"><div class="agent-stat-value">-30%</div><div class="agent-stat-label">Conditions</div></div>
                            <div class="agent-stat"><div class="agent-stat-value">Low</div><div class="agent-stat-label">Complexity</div></div>
                        </div>
                        <button class="agent-prompt-btn" onclick="showAgentPrompt('validation')">
                            View AI Prompt to Build This Agent
                        </button>
                    </div>
                </div>

                <!-- Agent 4: Expiration Date Tracker -->
                <div class="agent-card" id="agent-expiration">
                    <div class="agent-card-header">
                        <div class="agent-icon"></div>
                        <div class="agent-info">
                            <div class="agent-name">Expiration Date Tracker</div>
                            <div class="agent-type">Timeline Monitoring Agent</div>
                        </div>
                        <span class="agent-priority medium">Medium</span>
                    </div>
                    <div class="agent-card-body">
                        <p class="agent-description">Tracks appraisal expiration dates and alerts teams when appraisals are approaching expiration. Prevents last-minute scrambles for updates or recertifications.</p>
                        <div class="agent-flow">
                            <div class="agent-flow-title">Agent Flow</div>
                            <div class="agent-flow-diagram">
                                <div class="agent-step">Appraisal Date</div>
                                <span class="agent-arrow">-></span>
                                <div class="agent-step">Calculate Expiry</div>
                                <span class="agent-arrow">-></span>
                                <div class="agent-step">Daily Check</div>
                                <span class="agent-arrow">-></span>
                                <div class="agent-step">Alert at 30/15/7 Days</div>
                            </div>
                        </div>
                        <div class="agent-stats">
                            <div class="agent-stat"><div class="agent-stat-value">30d</div><div class="agent-stat-label">Early Warning</div></div>
                            <div class="agent-stat"><div class="agent-stat-value">-50%</div><div class="agent-stat-label">Expired Appraisals</div></div>
                            <div class="agent-stat"><div class="agent-stat-value">Low</div><div class="agent-stat-label">Complexity</div></div>
                        </div>
                        <button class="agent-prompt-btn" onclick="showAgentPrompt('expiration')">
                            View AI Prompt to Build This Agent
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </main>

    <!-- Documentation Modal -->
    <div class="modal-overlay" id="docModal">
        <div class="modal">
            <div class="modal-header">
                <h3>Appraisal Key Dates - Workflow Markdown</h3>
                <div class="modal-actions">
                    <button class="modal-btn copy" onclick="copyToClipboard()">Copy</button>
                    <button class="modal-btn close" onclick="closeDocModal()">Close</button>
                </div>
            </div>
            <div class="modal-body">
                <pre id="docContent"># Appraisal Key Dates for Operations

## Overview
Two appraisal dates must be accurately entered on each loan for reporting:
- Appraisal Ordered
- Appraisal Received

## Critical Fields

### Order Out Dates
- **Appraisal Ordered** - Processor responsibility
- **Appraisal Received** - Processor responsibility

### Appraisal Info Screen
- Approved to Invoice Appraisal (ISGN)
- Approved to Invoice Rush Fee (Sales Mgr Approval)
- 1004D/Reinspection Needed (ISGN)
- Appraisal Complete (ISGN)
- Appraisal Delivered (ISGN)
- Delivery Method (ISGN)
- Received by Borrower (Calculated)
- Timing Waiver Date (ISGN)

### Property Details (Processor - Pages 1-3)
1. Property Type
2. Construction Type
3. Stories
4. No Units
5. Square Feet
6. Bedrooms Unit 1
7. Remaining Economic Life
8. Year Built
9. Property Age

### Appraisal Details
- UCDP Document ID (Processor)
- Valuation Method (Processor)
- Appraisal Waiver (Processor)
- Valuation Form (Processor)
- AVM Model Type (Processor)
- COVID 19 Desktop (Underwriter)
- Property Valuation Effective Date (Processor)
- Appraisal Approved by Underwriting (Underwriter)

### VA Appraisals
- VA1004D Requested/Received (Processor)
- NOV Assigned/Underwriter (Underwriter)
- Lender SAR ID Number (Underwriter)
- SAR Issue Date (Underwriter)
- NOV Sent To Borrower (Processor)
- Appraisal Docs Expire (Underwriter)

## Key Rules
- Delivery must be 3+ days before closing (email/in-person)
- Follow mailbox rule for mailed appraisals
- ISGN does NOT complete VA, transferred, or employee loan appraisals

## Support
BYTE SUPPORT: 888-AID-4-CMG</pre>
            </div>
        </div>
    </div>

    <div class="copy-success" id="copySuccess">Copied to clipboard!</div>

    <!-- AI Prompt Modal -->
    <div class="modal-overlay prompt-modal" id="promptModal">
        <div class="modal">
            <div class="modal-header">
                <h3 id="promptModalTitle">AI Agent Build Prompt</h3>
                <div class="modal-actions">
                    <button class="modal-btn copy" onclick="copyPromptToClipboard()">Copy Prompt</button>
                    <button class="modal-btn close" onclick="closePromptModal()">Close</button>
                </div>
            </div>
            <div class="modal-body">
                <div class="prompt-tags" id="promptTags"></div>
                <div class="prompt-section">
                    <h4>Agent Purpose</h4>
                    <div class="prompt-box" id="promptPurpose"></div>
                </div>
                <div class="prompt-section">
                    <h4>Full Build Prompt</h4>
                    <div class="prompt-box" id="promptContent"></div>
                </div>
                <div class="prompt-section">
                    <h4>Integration Points</h4>
                    <div class="prompt-box" id="promptIntegration"></div>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Scroll spy with click debounce
        let isScrolling = false;
        let scrollTimeout = null;

        // Tab switching
        function switchTab(tab) {
            document.querySelectorAll('.sidebar-tab').forEach(t => t.classList.remove('active'));
            document.querySelectorAll('.tab-panel').forEach(p => p.classList.remove('active'));

            if (tab === 'workflow') {
                document.querySelector('.sidebar-tab:not(.agent-tab)').classList.add('active');
                document.getElementById('workflow-panel').classList.add('active');
                document.getElementById('workflow-nav').style.display = 'block';
                document.getElementById('agents-nav').style.display = 'none';
            } else {
                document.querySelector('.sidebar-tab.agent-tab').classList.add('active');
                document.getElementById('agents-panel').classList.add('active');
                document.getElementById('workflow-nav').style.display = 'none';
                document.getElementById('agents-nav').style.display = 'block';
            }

            window.scrollTo(0, 0);
        }

        // Improved scroll spy with click debounce
        const sections = document.querySelectorAll('.section, .quick-ref');
        const navItems = document.querySelectorAll('#workflow-nav .nav-item');

        function updateActiveNav() {
            if (isScrolling) return;

            let current = '';
            sections.forEach(section => {
                const sectionTop = section.offsetTop - 100;
                if (window.scrollY >= sectionTop) current = section.getAttribute('id');
            });
            navItems.forEach(item => {
                item.classList.remove('active');
                if (item.getAttribute('href') === '#' + current) item.classList.add('active');
            });
        }

        // Handle nav clicks with debounce
        navItems.forEach(item => {
            item.addEventListener('click', function(e) {
                isScrolling = true;

                // Clear any existing timeout
                if (scrollTimeout) clearTimeout(scrollTimeout);

                // Set timeout to re-enable scroll spy after 1000ms
                scrollTimeout = setTimeout(() => {
                    isScrolling = false;
                    updateActiveNav();
                }, 1000);

                // Immediately update active state
                navItems.forEach(nav => nav.classList.remove('active'));
                this.classList.add('active');
            });
        });

        window.addEventListener('scroll', updateActiveNav);

        // Modal
        function openDocModal() {
            document.getElementById('docModal').classList.add('show');
            document.body.style.overflow = 'hidden';
        }

        function closeDocModal() {
            document.getElementById('docModal').classList.remove('show');
            document.body.style.overflow = '';
        }

        async function copyToClipboard() {
            try {
                await navigator.clipboard.writeText(document.getElementById('docContent').textContent);
                const success = document.getElementById('copySuccess');
                success.style.display = 'block';
                setTimeout(() => { success.style.display = 'none'; }, 2000);
            } catch (e) { alert('Failed to copy.'); }
        }

        document.addEventListener('keydown', (e) => { if (e.key === 'Escape') { closeDocModal(); closePromptModal(); } });
        document.getElementById('docModal').addEventListener('click', (e) => { if (e.target.id === 'docModal') closeDocModal(); });

        document.addEventListener('DOMContentLoaded', () => { updateActiveNav(); });

        // ====== AGENT PROMPT SYSTEM ======
        const agentPrompts = {
            extraction: {
                name: 'Appraisal Data Extraction Agent',
                tags: ['Document Processing', 'OCR', 'Medium Complexity', 'Critical Priority'],
                purpose: `This agent automatically extracts property structure details, age information, UCDP Document ID, and valuation data from appraisal PDF reports. It populates Byte appraisal fields without manual data entry, reducing processing time by 8+ minutes per loan.`,
                prompt: `You are building a Document Processing Agent for CMG Financial's Byte LOS system.

AGENT NAME: Appraisal Data Extraction Agent
TYPE: Document Processing / OCR / Field Extraction

OBJECTIVE:
Create an agent that parses appraisal PDF reports and automatically extracts key data points to populate the Appraisal Info Screen in Byte, eliminating manual data entry for Processors.

INPUT:
- Appraisal PDF document (typically 20-40 pages)
- Loan number for Byte field mapping

TARGET EXTRACTION FIELDS:

FROM PAGE 1 (Subject Section):
- Property Type (SFR, PUD, Condo, etc.)
- Construction Type (Existing, New, Proposed)
- Stories
- Number of Units
- Square Feet (GLA)
- Bedrooms Unit 1
- Property Address (for verification)

FROM PAGE 2 (Quality/Age Section):
- Quality of Construction (C1-C6)
- Actual Age
- Condition (Q1-Q6)
- Property Valuation Effective Date (bottom of page)

FROM PAGE 3 (HUD/VA Only):
- Estimated Remaining Economic Life

FROM SSR REPORT (if attached):
- UCDP Document ID

EXTRACTION LOGIC:
1. Use OCR to convert PDF to searchable text
2. Identify form type (1004, 1025, 1073, etc.)
3. Apply form-specific extraction templates
4. Validate extracted values against expected ranges
5. Flag low-confidence extractions for human review

OUTPUT FORMAT:
{
  "loanNumber": "1234567890",
  "extractedFields": {
    "propertyType": { "value": "PUD", "confidence": 0.95, "page": 1 },
    "constructionType": { "value": "Existing", "confidence": 0.98, "page": 1 },
    "stories": { "value": "1.5", "confidence": 0.92, "page": 1 },
    "units": { "value": "1", "confidence": 0.99, "page": 1 },
    "squareFeet": { "value": "3706", "confidence": 0.97, "page": 1 },
    "bedrooms": { "value": "4", "confidence": 0.96, "page": 1 },
    "yearBuilt": { "value": "2012", "confidence": 0.99, "page": 2 },
    "remainingEconomicLife": { "value": "60", "confidence": 0.94, "page": 3 },
    "ucdpDocumentId": { "value": "11018C34HD", "confidence": 0.99, "page": "SSR" },
    "effectiveDate": { "value": "2024-02-15", "confidence": 0.97, "page": 2 }
  },
  "formType": "1004",
  "needsReview": ["stories"],
  "processingTime": "4.2s"
}

VALIDATION RULES:
- Square Feet: 100 - 50,000
- Year Built: 1800 - current year + 2
- Bedrooms: 0 - 20
- Stories: 1 - 5
- Economic Life: 0 - 100 years
- UCDP ID: Alphanumeric, 10-15 characters`,
                integration: `INTEGRATION POINTS:

1. Document Upload Trigger
   - Monitor Byte document upload events
   - Trigger on new appraisal PDF receipt
   - Or: Manual trigger from Appraisal Info Screen

2. Byte API/RPA Integration
   - Use Byte API (if available) for field population
   - Or: RPA automation to fill screen fields
   - Support both GDMS and non-GDMS workflows

3. OCR Service
   - AWS Textract or Azure Form Recognizer
   - Pre-trained on appraisal form layouts
   - Support for multiple form types (1004, 1025, 1073, 2055)

4. Quality Control
   - Present extracted values for Processor confirmation
   - Highlight low-confidence fields in amber
   - Allow one-click corrections
   - Learn from corrections to improve model

5. Audit Trail
   - Log all extractions with confidence scores
   - Track source page numbers
   - Maintain original PDF reference

DEPLOYMENT:
- Chrome extension for Processor workstations
- Or: Server-side processing triggered by GDMS
- Response time target: < 10 seconds per appraisal`
            },
            tracking: {
                name: 'Delivery Timing Monitor',
                tags: ['Compliance', 'Monitoring', 'Low Complexity', 'High Priority'],
                purpose: `This agent monitors appraisal delivery dates against closing dates to ensure TRID 3-day compliance. It alerts Processors when timing waivers may be needed or when delivery deadlines approach, preventing closing delays.`,
                prompt: `You are building a Compliance Monitoring Agent for CMG Financial's Byte LOS system.

AGENT NAME: Delivery Timing Monitor
TYPE: Real-time Monitoring / Compliance Alert

OBJECTIVE:
Create an agent that tracks appraisal delivery timing against closing dates and ensures compliance with the 3-day delivery rule. Alert teams when waivers are needed or deadlines approach.

COMPLIANCE RULES:

1. EMAIL/IN-PERSON DELIVERY
   - Appraisal must be delivered 3+ business days before closing
   - "Received by Borrower" date must be >= Closing Date - 3 business days

2. MAIL DELIVERY (Mailbox Rule)
   - Add 3 days to delivery date for receipt calculation
   - Total lead time: 6+ business days before closing

3. TIMING WAIVER
   - Required if delivery timing cannot be met
   - Must be executed by borrower before closing
   - Allows closing within 3-day window

MONITORING LOGIC:

Daily Pipeline Scan:
FOR each loan with appraisal received:
  closingDate = loan.estimatedClosingDate
  deliveryDate = loan.appraisalDeliveredDate
  deliveryMethod = loan.deliveryMethod

  IF deliveryMethod == "Email" OR deliveryMethod == "Hand Delivered":
    requiredDeliveryDate = closingDate - 3 business days
  ELSE IF deliveryMethod == "Mail":
    requiredDeliveryDate = closingDate - 6 business days

  daysRemaining = requiredDeliveryDate - today

  IF appraisal NOT delivered AND daysRemaining <= 5:
    ALERT: "Appraisal delivery deadline approaching"

  IF appraisal delivered AND deliveryDate > requiredDeliveryDate:
    ALERT: "Timing Waiver Required - delivery past deadline"

  IF daysRemaining <= 0 AND no timing waiver:
    ALERT CRITICAL: "Cannot close - timing compliance issue"

ALERT LEVELS:
- GREEN: 5+ days remaining, on track
- YELLOW: 3-5 days remaining, needs attention
- ORANGE: 1-2 days remaining, urgent action needed
- RED: Past deadline, waiver required or cannot close

NOTIFICATION FORMAT:
{
  "alertLevel": "ORANGE",
  "loanNumber": "1234567890",
  "borrowerName": "John Smith",
  "closingDate": "2024-03-15",
  "deliveryDeadline": "2024-03-11",
  "daysRemaining": 2,
  "appraisalStatus": "Received but not delivered",
  "action": "Deliver appraisal today or request Timing Waiver",
  "processor": "Jane Doe",
  "processorEmail": "jdoe@cmgfi.com"
}`,
                integration: `INTEGRATION POINTS:

1. Byte Data Access
   - Read Appraisal Info Screen fields
   - Read Closing Date from loan record
   - Monitor for field updates in real-time

2. Alert Channels
   - Email to assigned Processor
   - Byte task/alert creation
   - Optional: SMS for critical alerts
   - Optional: Slack/Teams notification

3. Dashboard Integration
   - Pipeline view with compliance status
   - Color-coded indicators (green/yellow/orange/red)
   - Drill-down to affected loans

4. Reporting
   - Daily compliance summary email
   - Weekly metrics on timing compliance
   - Track waiver usage trends

5. Business Day Calendar
   - Maintain federal holiday calendar
   - Account for company-specific closures
   - Handle weekend calculations

SCALABILITY:
- Process 5,000+ loans daily
- Alert delivery within 60 seconds of threshold breach
- Support multiple time zones for branch offices`
            },
            validation: {
                name: 'Field Completion Validator',
                tags: ['QC', 'Validation', 'Low Complexity', 'High Priority'],
                purpose: `This agent validates that all Processor-required appraisal fields are complete before a loan is submitted to Underwriting. It prevents delays and condition loops by catching missing data early in the process.`,
                prompt: `You are building a QC Validation Agent for CMG Financial's Byte LOS system.

AGENT NAME: Field Completion Validator
TYPE: Quality Control / Pre-Submission Check

OBJECTIVE:
Create an agent that validates all required appraisal fields are complete before a loan moves to Underwriting, ensuring Processors have fulfilled their responsibilities per the Appraisal Key Dates policy.

VALIDATION CHECKLIST:

CRITICAL FIELDS (Block if missing):
[ ] Appraisal Ordered date
[ ] Appraisal Received date
[ ] UCDP Document ID
[ ] Valuation Method selected
[ ] Valuation Form selected (with form number)
[ ] Property Valuation Effective Date

PROPERTY STRUCTURE (Required for investor):
[ ] Property Type
[ ] Construction Type
[ ] Stories
[ ] No Units
[ ] Square Feet
[ ] Bedrooms Unit 1

PROPERTY AGE (Required for investor):
[ ] Remaining Economic Life
[ ] Year Built
[ ] Property Age

CONDITIONAL FIELDS:
IF Appraisal Waiver = Yes:
  - Valuation Method = "None" or "PIW"
  - Skip property structure validation

IF Brokered Loan = Yes:
  - "Brokered loan - No CMG appraisal" checkbox should be checked
  - Skip most validations

IF Loan Type = VA:
  [ ] VA1004D Requested (if applicable)
  [ ] VA1004D Received (if applicable)
  [ ] NOV Sent To Borrower

VALIDATION OUTPUT:
{
  "loanNumber": "1234567890",
  "validationStatus": "INCOMPLETE",
  "missingCritical": [
    { "field": "UCDP Document ID", "screen": "Appraisal Details" },
    { "field": "Property Valuation Effective Date", "screen": "Appraisal Details" }
  ],
  "missingProperty": [
    { "field": "Remaining Economic Life", "screen": "Property Age Information" }
  ],
  "warnings": [
    { "field": "Square Feet", "value": "0", "message": "Value seems incorrect" }
  ],
  "score": 78,
  "readyForUW": false,
  "processor": "Jane Doe"
}

TRIGGER POINTS:
1. When loan status changes to "Ready for UW"
2. Manual validation request from Processor
3. Daily batch validation of pipeline
4. Pre-submission gate in workflow`,
                integration: `INTEGRATION POINTS:

1. Byte Field Access
   - Read all Appraisal Info Screen fields
   - Access loan type for conditional logic
   - Check current loan status

2. Workflow Gate
   - Block status change if validation fails
   - Require override with reason for exceptions
   - Log all validations and overrides

3. Processor Notification
   - Send validation results to Processor
   - Include direct links to screens with missing fields
   - Priority-sort missing fields

4. Reporting Dashboard
   - Track validation pass rates by Processor
   - Identify common missing fields
   - Measure time to complete after validation fail

5. Training Integration
   - Link missing field alerts to training materials
   - Track repeat issues for targeted coaching

IMPLEMENTATION:
- Run as pre-submission check (blocking)
- Daily batch scan of pipeline (advisory)
- On-demand validation button in Byte
- Response time: < 2 seconds per loan`
            },
            expiration: {
                name: 'Expiration Date Tracker',
                tags: ['Monitoring', 'Timeline', 'Low Complexity', 'Medium Priority'],
                purpose: `This agent tracks appraisal expiration dates and alerts teams when appraisals are approaching expiration. It prevents last-minute scrambles for updates, recertifications, or new appraisals.`,
                prompt: `You are building a Timeline Monitoring Agent for CMG Financial's Byte LOS system.

AGENT NAME: Expiration Date Tracker
TYPE: Timeline Monitoring / Proactive Alert

OBJECTIVE:
Create an agent that tracks appraisal expiration dates across the pipeline and provides early warnings to prevent expired appraisals from blocking closings.

EXPIRATION RULES:

CONVENTIONAL LOANS:
- Appraisal valid for 120 days from effective date
- Update (1004D) extends 120 days from update date
- Maximum age: 12 months from original effective date

FHA LOANS:
- Appraisal valid for 120 days
- Extension available up to 240 days
- Requirements vary by program

VA LOANS:
- Appraisal valid for 6 months from effective date
- Extensions require VA approval

ALERT THRESHOLDS:
30 days before expiration: INFO - "Appraisal expiring soon"
15 days before expiration: WARNING - "Schedule update/recert"
7 days before expiration: URGENT - "Immediate action required"
0 days: CRITICAL - "Appraisal expired - cannot close"

MONITORING LOGIC:

Daily Pipeline Scan:
FOR each loan with active appraisal:
  effectiveDate = loan.propertyValuationEffectiveDate
  loanType = loan.loanType

  IF loanType == "Conventional":
    expirationDate = effectiveDate + 120 days
    maxDate = effectiveDate + 365 days
  ELSE IF loanType == "FHA":
    expirationDate = effectiveDate + 120 days
  ELSE IF loanType == "VA":
    expirationDate = effectiveDate + 180 days

  daysToExpiration = expirationDate - today

  IF daysToExpiration <= 30:
    CREATE alert with appropriate level
    NOTIFY processor and loan officer

TRACKING DATA:
{
  "loanNumber": "1234567890",
  "appraisalEffectiveDate": "2024-01-15",
  "loanType": "Conventional",
  "expirationDate": "2024-05-14",
  "daysRemaining": 25,
  "alertLevel": "INFO",
  "estimatedClosingDate": "2024-05-20",
  "riskAssessment": "HIGH - closing after expiration",
  "recommendedAction": "Order 1004D update before 2024-05-01",
  "processor": "Jane Doe",
  "loanOfficer": "John Smith"
}`,
                integration: `INTEGRATION POINTS:

1. Byte Data Source
   - Property Valuation Effective Date
   - Loan Type (Conv, FHA, VA, USDA)
   - Appraisal Docs Expire field (if set by UW)
   - Estimated Closing Date

2. Alert Delivery
   - Email alerts at threshold crossings
   - Daily digest for Processor/LO teams
   - Byte task creation for urgent items
   - Pipeline dashboard indicator

3. Calendar Integration
   - Add expiration dates to loan timeline
   - Block closing calendar if appraisal expired
   - Calculate optimal order date for updates

4. Reporting
   - Weekly expiration forecast report
   - Track loans closed within 7 days of expiration
   - Measure update order lead times
   - Alert response time metrics

5. Vendor Integration
   - Auto-suggest update order when threshold hit
   - Pre-populate order with original appraisal details
   - Track update turnaround times by vendor

SCALABILITY:
- Monitor 10,000+ active loans
- Daily batch processing overnight
- Real-time alerts within 5 minutes of threshold
- Historical tracking for compliance audits`
            }
        };

        // Scroll to agent card and highlight
        function scrollToAgent(agentId) {
            const agentCard = document.getElementById(agentId);
            if (agentCard) {
                document.querySelectorAll('.agent-card.highlight').forEach(card => {
                    card.classList.remove('highlight');
                });

                agentCard.scrollIntoView({ behavior: 'smooth', block: 'center' });

                setTimeout(() => {
                    agentCard.classList.add('highlight');
                }, 300);

                setTimeout(() => {
                    agentCard.classList.remove('highlight');
                }, 2500);
            }
        }

        // Show agent prompt modal
        let currentPromptContent = '';

        function showAgentPrompt(agentKey) {
            const agent = agentPrompts[agentKey];
            if (!agent) return;

            document.getElementById('promptModalTitle').textContent = `${agent.name} - Build Prompt`;

            const tagsHtml = agent.tags.map(tag => `<span class="prompt-tag">${tag}</span>`).join('');
            document.getElementById('promptTags').innerHTML = tagsHtml;

            document.getElementById('promptPurpose').textContent = agent.purpose;
            document.getElementById('promptContent').textContent = agent.prompt;
            document.getElementById('promptIntegration').textContent = agent.integration;

            currentPromptContent = `# ${agent.name}\n\n## Purpose\n${agent.purpose}\n\n## Build Prompt\n${agent.prompt}\n\n## Integration Points\n${agent.integration}`;

            document.getElementById('promptModal').classList.add('show');
            document.body.style.overflow = 'hidden';
        }

        function closePromptModal() {
            document.getElementById('promptModal').classList.remove('show');
            document.body.style.overflow = '';
        }

        async function copyPromptToClipboard() {
            try {
                await navigator.clipboard.writeText(currentPromptContent);
                const success = document.getElementById('copySuccess');
                success.style.display = 'block';
                setTimeout(() => { success.style.display = 'none'; }, 2000);
            } catch (e) {
                alert('Failed to copy prompt.');
            }
        }

        document.getElementById('promptModal').addEventListener('click', (e) => {
            if (e.target.id === 'promptModal') closePromptModal();
        });
    </script>
</body>
</html>
