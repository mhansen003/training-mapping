<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Byte Details of Transaction (DOT) - Process Workflow</title>
    <link href="https://fonts.googleapis.com/css2?family=Plus+Jakarta+Sans:wght@400;500;600;700;800&family=JetBrains+Mono:wght@400;500&display=swap" rel="stylesheet">
    <style>
        :root {
            --bg-primary: #0a0f1a;
            --bg-secondary: #111827;
            --bg-card: #1a2234;
            --accent-blue: #3b82f6;
            --accent-teal: #14b8a6;
            --accent-amber: #f59e0b;
            --accent-rose: #f43f5e;
            --accent-green: #22c55e;
            --accent-purple: #8b5cf6;
            --text-primary: #f1f5f9;
            --text-secondary: #94a3b8;
            --text-muted: #64748b;
            --border-subtle: rgba(255,255,255,0.08);
            --sidebar-width: 280px;
        }

        * { box-sizing: border-box; margin: 0; padding: 0; }
        html { scroll-behavior: smooth; }
        body {
            font-family: 'Plus Jakarta Sans', -apple-system, BlinkMacSystemFont, sans-serif;
            background: var(--bg-primary);
            color: var(--text-primary);
            min-height: 100vh;
        }

        /* Breadcrumb */
        .breadcrumb {
            background: linear-gradient(90deg, #0d1525 0%, #1a2234 100%);
            padding: 14px 25px;
            display: flex;
            align-items: center;
            gap: 12px;
            font-size: 0.95rem;
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            z-index: 1001;
            border-bottom: 1px solid var(--border-subtle);
        }

        .breadcrumb a {
            color: var(--text-secondary);
            text-decoration: none;
            font-weight: 600;
            padding: 8px 16px;
            background: rgba(255,255,255,0.05);
            border-radius: 8px;
            transition: all 0.2s;
            border: 1px solid var(--border-subtle);
        }

        .breadcrumb a:hover {
            background: rgba(59, 130, 246, 0.15);
            color: var(--accent-blue);
            border-color: rgba(59, 130, 246, 0.3);
        }

        .breadcrumb .separator { color: var(--text-muted); font-size: 1.2rem; }
        .breadcrumb .current { color: var(--accent-amber); font-weight: 600; padding: 8px 16px; }

        /* Sidebar */
        .sidebar {
            position: fixed;
            top: 54px;
            left: 0;
            width: var(--sidebar-width);
            height: calc(100vh - 54px);
            background: var(--bg-secondary);
            overflow-y: auto;
            z-index: 1000;
            border-right: 1px solid var(--border-subtle);
            display: flex;
            flex-direction: column;
        }

        .sidebar-header {
            padding: 25px 20px;
            background: rgba(0,0,0,0.3);
            border-bottom: 1px solid var(--border-subtle);
        }

        .sidebar-header h2 { color: var(--text-primary); font-size: 1.2rem; font-weight: 700; margin-bottom: 5px; }
        .sidebar-header p { color: var(--text-muted); font-size: 0.85rem; }

        /* Tab Switch */
        .sidebar-tabs {
            display: flex;
            border-bottom: 1px solid var(--border-subtle);
        }

        .sidebar-tab {
            flex: 1;
            padding: 14px 10px;
            text-align: center;
            font-size: 0.8rem;
            font-weight: 700;
            color: var(--text-muted);
            cursor: pointer;
            transition: all 0.2s;
            border-bottom: 3px solid transparent;
            background: none;
            border-left: none;
            border-right: none;
            border-top: none;
        }

        .sidebar-tab:hover { background: rgba(255,255,255,0.03); color: var(--text-secondary); }
        .sidebar-tab.active { color: var(--accent-blue); border-bottom-color: var(--accent-blue); background: rgba(59, 130, 246, 0.08); }
        .sidebar-tab.agent-tab.active { color: var(--accent-purple); border-bottom-color: var(--accent-purple); background: rgba(139, 92, 246, 0.08); }

        .sidebar-nav { padding: 15px 0; flex: 1; overflow-y: auto; }

        .nav-item {
            display: flex;
            align-items: center;
            gap: 12px;
            padding: 14px 20px;
            color: var(--text-secondary);
            text-decoration: none;
            border-left: 3px solid transparent;
            transition: all 0.2s ease;
            cursor: pointer;
        }

        .nav-item:hover { background: rgba(255,255,255,0.03); color: var(--text-primary); }
        .nav-item.active { background: rgba(59, 130, 246, 0.1); border-left-color: var(--accent-blue); color: var(--text-primary); }

        .nav-number {
            background: rgba(255,255,255,0.1);
            color: var(--text-secondary);
            width: 28px;
            height: 28px;
            border-radius: 8px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 700;
            font-size: 0.85rem;
            flex-shrink: 0;
        }

        .nav-item.active .nav-number { background: var(--accent-blue); color: white; }
        .nav-label { font-size: 0.95rem; font-weight: 500; }

        .sidebar-footer {
            padding: 20px;
            border-top: 1px solid var(--border-subtle);
            background: rgba(0,0,0,0.2);
        }

        .doc-btn {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
            width: 100%;
            padding: 14px 20px;
            background: linear-gradient(135deg, var(--accent-blue) 0%, var(--accent-teal) 100%);
            color: white;
            border: none;
            border-radius: 10px;
            font-weight: 600;
            cursor: pointer;
            transition: transform 0.2s, box-shadow 0.2s;
            text-decoration: none;
            font-size: 0.95rem;
        }

        .doc-btn:hover { transform: translateY(-2px); box-shadow: 0 8px 25px rgba(59, 130, 246, 0.3); }

        /* Main Content */
        .main-content { margin-left: var(--sidebar-width); padding: 80px 40px 40px 40px; }

        /* Tab Panels */
        .tab-panel { display: none; }
        .tab-panel.active { display: block; }

        .header {
            background: var(--bg-card);
            border: 1px solid var(--border-subtle);
            padding: 35px;
            border-radius: 16px;
            margin-bottom: 30px;
            position: relative;
            overflow: hidden;
        }

        .header::before {
            content: '';
            position: absolute;
            top: 0; left: 0; right: 0; bottom: 0;
            background:
                radial-gradient(ellipse at 20% 20%, rgba(59, 130, 246, 0.1) 0%, transparent 50%),
                radial-gradient(ellipse at 80% 80%, rgba(20, 184, 166, 0.08) 0%, transparent 50%);
            pointer-events: none;
        }

        .header h1 {
            font-size: 2.2rem;
            font-weight: 800;
            margin-bottom: 10px;
            position: relative;
            background: linear-gradient(135deg, var(--text-primary) 0%, var(--accent-blue) 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .header .subtitle { color: var(--text-secondary); font-size: 1.1rem; position: relative; }

        .header .meta { display: flex; gap: 15px; margin-top: 20px; flex-wrap: wrap; position: relative; }

        .header .meta-item {
            background: rgba(255,255,255,0.05);
            border: 1px solid var(--border-subtle);
            padding: 8px 16px;
            border-radius: 8px;
            font-size: 0.9rem;
            color: var(--text-secondary);
        }

        /* Legend */
        .legend {
            display: flex;
            flex-wrap: wrap;
            gap: 15px;
            padding: 18px 22px;
            background: var(--bg-card);
            border: 1px solid var(--border-subtle);
            border-radius: 12px;
            margin-bottom: 25px;
        }

        .legend-item { display: flex; align-items: center; gap: 8px; font-size: 0.85rem; color: var(--text-secondary); }
        .legend-color { width: 18px; height: 18px; border-radius: 4px; }

        /* Sections */
        .section {
            background: var(--bg-card);
            border: 1px solid var(--border-subtle);
            border-radius: 16px;
            margin-bottom: 25px;
            overflow: hidden;
            scroll-margin-top: 75px;
        }

        .section-header {
            background: linear-gradient(135deg, var(--bg-secondary) 0%, rgba(59, 130, 246, 0.1) 100%);
            border-bottom: 1px solid var(--border-subtle);
            padding: 22px 25px;
            display: flex;
            align-items: center;
            gap: 18px;
        }

        .section-number {
            background: linear-gradient(135deg, var(--accent-blue) 0%, var(--accent-teal) 100%);
            color: white;
            width: 48px;
            height: 48px;
            border-radius: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 800;
            font-size: 1.3rem;
            flex-shrink: 0;
        }

        .section-title h2 { font-size: 1.35rem; font-weight: 700; margin-bottom: 4px; color: var(--text-primary); }
        .section-title span { font-size: 0.9rem; color: var(--text-muted); }
        .section-content { padding: 28px; }

        /* Workflow Diagrams */
        .workflow-diagram {
            background: rgba(0,0,0,0.3);
            border: 1px solid var(--border-subtle);
            border-radius: 12px;
            padding: 28px;
            margin-bottom: 22px;
        }

        .flow-row { display: flex; align-items: center; justify-content: center; flex-wrap: wrap; gap: 12px; margin: 15px 0; }

        .flow-node {
            padding: 14px 22px;
            border-radius: 10px;
            text-align: center;
            font-size: 0.9rem;
            font-weight: 600;
            min-width: 150px;
            border: 1px solid var(--border-subtle);
        }

        .flow-node.start { background: linear-gradient(135deg, var(--accent-green) 0%, #16a34a 100%); color: white; border-radius: 25px; border: none; }
        .flow-node.action { background: linear-gradient(135deg, var(--accent-blue) 0%, #2563eb 100%); color: white; border: none; }
        .flow-node.decision { background: linear-gradient(135deg, var(--accent-amber) 0%, #d97706 100%); color: var(--bg-primary); border: none; }
        .flow-node.input { background: var(--bg-secondary); border: 2px solid var(--accent-blue); color: var(--text-primary); }
        .flow-node.output { background: linear-gradient(135deg, var(--accent-teal) 0%, #0d9488 100%); color: white; border: none; }
        .flow-node.exception { background: linear-gradient(135deg, var(--accent-rose) 0%, #dc2626 100%); color: white; border: none; }

        .flow-arrow { color: var(--accent-blue); font-size: 1.5rem; }
        .flow-arrow.down { transform: rotate(90deg); }

        .decision-branch { display: flex; gap: 40px; justify-content: center; margin: 20px 0; flex-wrap: wrap; }
        .branch { display: flex; flex-direction: column; align-items: center; gap: 10px; }

        .branch-label {
            background: var(--bg-secondary);
            border: 1px solid var(--border-subtle);
            padding: 6px 16px;
            border-radius: 20px;
            font-size: 0.8rem;
            font-weight: 700;
            color: var(--text-secondary);
        }

        /* Tables */
        .field-table { width: 100%; border-collapse: collapse; margin: 18px 0; }

        .field-table th {
            background: rgba(59, 130, 246, 0.15);
            color: var(--accent-blue);
            padding: 14px 18px;
            text-align: left;
            font-weight: 600;
            font-size: 0.9rem;
            text-transform: uppercase;
            letter-spacing: 0.05em;
            border-bottom: 1px solid var(--border-subtle);
        }

        .field-table td { padding: 14px 18px; border-bottom: 1px solid var(--border-subtle); color: var(--text-secondary); }
        .field-table tr:hover { background: rgba(255,255,255,0.02); }

        .badge { display: inline-block; padding: 4px 12px; border-radius: 6px; font-size: 0.75rem; font-weight: 700; text-transform: uppercase; letter-spacing: 0.05em; }
        .badge.required-badge { background: rgba(244, 63, 94, 0.15); color: var(--accent-rose); }
        .badge.optional-badge { background: rgba(34, 197, 94, 0.15); color: var(--accent-green); }
        .badge.calculated-badge { background: rgba(59, 130, 246, 0.15); color: var(--accent-blue); }

        /* Info Boxes */
        .exception-box, .tip-box, .info-box {
            padding: 18px 22px;
            margin: 18px 0;
            border-radius: 0 10px 10px 0;
            border-left-width: 4px;
            border-left-style: solid;
        }

        .exception-box { background: rgba(244, 63, 94, 0.08); border-color: var(--accent-rose); border: 1px solid rgba(244, 63, 94, 0.2); border-left: 4px solid var(--accent-rose); }
        .exception-box h4 { color: var(--accent-rose); margin-bottom: 10px; font-size: 1rem; }
        .exception-box p, .exception-box li { color: var(--text-secondary); }

        .tip-box { background: rgba(34, 197, 94, 0.08); border-color: var(--accent-green); border: 1px solid rgba(34, 197, 94, 0.2); border-left: 4px solid var(--accent-green); }
        .tip-box h4 { color: var(--accent-green); margin-bottom: 10px; font-size: 1rem; }
        .tip-box p, .tip-box li { color: var(--text-secondary); }

        .info-box { background: rgba(59, 130, 246, 0.08); border-color: var(--accent-blue); border: 1px solid rgba(59, 130, 246, 0.2); border-left: 4px solid var(--accent-blue); }
        .info-box h4 { color: var(--accent-blue); margin-bottom: 10px; font-size: 1rem; }
        .info-box p, .info-box li { color: var(--text-secondary); }

        /* Decision Tree */
        .decision-tree {
            background: rgba(0,0,0,0.2);
            border: 1px solid var(--border-subtle);
            border-radius: 12px;
            padding: 22px;
            margin: 22px 0;
        }

        .decision-tree h3 { color: var(--accent-blue); margin-bottom: 18px; padding-bottom: 12px; border-bottom: 1px solid var(--border-subtle); font-size: 1.1rem; }

        .tree-node { margin-left: 20px; padding: 12px; border-left: 2px solid var(--accent-teal); position: relative; color: var(--text-secondary); }
        .tree-node::before { content: ''; position: absolute; left: -2px; top: 22px; width: 15px; height: 2px; background: var(--accent-teal); }
        .tree-node.level-1 { margin-left: 0; border-left: none; }
        .tree-node.level-1::before { display: none; }

        .tree-label { background: var(--accent-amber); color: var(--bg-primary); padding: 6px 14px; border-radius: 6px; font-weight: 700; display: inline-block; margin-bottom: 6px; font-size: 0.9rem; }

        /* Summary Grid */
        .summary-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(180px, 1fr)); gap: 18px; margin: 22px 0; }

        .summary-card { background: rgba(0,0,0,0.3); border: 1px solid var(--border-subtle); border-radius: 12px; padding: 22px; text-align: center; }
        .summary-card h4 { color: var(--text-secondary); margin-bottom: 12px; font-size: 0.9rem; }
        .summary-card .value {
            font-size: 2.2rem;
            font-weight: 800;
            background: linear-gradient(135deg, var(--accent-blue) 0%, var(--accent-teal) 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }
        .summary-card .label { font-size: 0.85rem; color: var(--text-muted); margin-top: 8px; }

        /* MI Comparison Cards */
        .mi-comparison { display: grid; grid-template-columns: repeat(auto-fit, minmax(280px, 1fr)); gap: 20px; margin: 22px 0; }

        .mi-card { background: rgba(0,0,0,0.2); border: 1px solid var(--border-subtle); border-radius: 12px; overflow: hidden; }
        .mi-card-header { background: linear-gradient(135deg, var(--accent-blue) 0%, var(--accent-teal) 100%); color: white; padding: 18px; text-align: center; }
        .mi-card-header h4 { font-size: 1.05rem; }
        .mi-card-body { padding: 22px; }
        .mi-card ul { list-style: none; padding: 0; }
        .mi-card li { padding: 10px 0; border-bottom: 1px solid var(--border-subtle); display: flex; align-items: center; gap: 12px; color: var(--text-secondary); font-size: 0.95rem; }
        .mi-card li:last-child { border-bottom: none; }
        .check-icon { color: var(--accent-green); font-weight: bold; }
        .x-icon { color: var(--accent-rose); font-weight: bold; }

        /* Quick Reference */
        .quick-ref {
            background: linear-gradient(135deg, var(--bg-secondary) 0%, var(--bg-card) 100%);
            border: 1px solid var(--border-subtle);
            padding: 28px;
            border-radius: 16px;
            margin-top: 30px;
            font-family: 'JetBrains Mono', monospace;
        }

        .quick-ref h3 { color: var(--accent-amber); margin-bottom: 18px; font-family: 'Plus Jakarta Sans', sans-serif; }
        .quick-ref pre { background: rgba(0,0,0,0.4); border: 1px solid var(--border-subtle); padding: 20px; border-radius: 10px; overflow-x: auto; font-size: 0.85rem; line-height: 1.7; color: var(--text-secondary); }

        /* ====== AGENT OPPORTUNITIES STYLES ====== */
        .agent-header {
            background: var(--bg-card);
            border: 1px solid var(--border-subtle);
            padding: 35px;
            border-radius: 16px;
            margin-bottom: 30px;
            position: relative;
            overflow: hidden;
        }

        .agent-header::before {
            content: '';
            position: absolute;
            top: 0; left: 0; right: 0; bottom: 0;
            background:
                radial-gradient(ellipse at 20% 20%, rgba(139, 92, 246, 0.12) 0%, transparent 50%),
                radial-gradient(ellipse at 80% 80%, rgba(245, 158, 11, 0.1) 0%, transparent 50%);
            pointer-events: none;
        }

        .agent-header h1 {
            font-size: 2.2rem;
            font-weight: 800;
            margin-bottom: 10px;
            position: relative;
            background: linear-gradient(135deg, var(--accent-purple) 0%, var(--accent-amber) 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .agent-header .subtitle { color: var(--text-secondary); font-size: 1.1rem; position: relative; }

        /* Heat Map */
        .heat-map-container { margin-bottom: 35px; }
        .heat-map-title { font-size: 1.3rem; font-weight: 700; color: var(--text-primary); margin-bottom: 20px; display: flex; align-items: center; gap: 12px; }

        .heat-map-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
        }

        .heat-item {
            background: var(--bg-card);
            border: 1px solid var(--border-subtle);
            border-radius: 12px;
            padding: 20px;
            position: relative;
            overflow: hidden;
            transition: transform 0.2s, box-shadow 0.2s;
            cursor: pointer;
        }

        .heat-item:hover { transform: translateY(-3px); box-shadow: 0 10px 30px rgba(0,0,0,0.3); }
        .heat-item:active { transform: scale(0.98); }

        .heat-item::before {
            content: '';
            position: absolute;
            top: 0; left: 0; right: 0; height: 4px;
        }

        .heat-item.critical::before { background: linear-gradient(90deg, #ef4444, #f97316); }
        .heat-item.high::before { background: linear-gradient(90deg, #f97316, #eab308); }
        .heat-item.medium::before { background: linear-gradient(90deg, #eab308, #22c55e); }
        .heat-item.low::before { background: linear-gradient(90deg, #22c55e, #14b8a6); }

        .heat-score {
            position: absolute;
            top: 15px;
            right: 15px;
            font-size: 1.8rem;
            font-weight: 800;
        }

        .heat-item.critical .heat-score { color: #ef4444; }
        .heat-item.high .heat-score { color: #f97316; }
        .heat-item.medium .heat-score { color: #eab308; }
        .heat-item.low .heat-score { color: #22c55e; }

        .heat-name { font-size: 1rem; font-weight: 700; color: var(--text-primary); margin-bottom: 6px; padding-right: 50px; }
        .heat-desc { font-size: 0.85rem; color: var(--text-muted); margin-bottom: 12px; }

        .heat-metrics { display: flex; gap: 15px; margin-top: 12px; }
        .heat-metric { font-size: 0.75rem; color: var(--text-muted); }
        .heat-metric span { color: var(--text-secondary); font-weight: 600; }

        /* Agent Cards */
        .agent-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(380px, 1fr)); gap: 25px; margin-bottom: 35px; }

        .agent-card {
            background: var(--bg-card);
            border: 1px solid var(--border-subtle);
            border-radius: 16px;
            overflow: hidden;
            transition: transform 0.2s, box-shadow 0.2s;
        }

        .agent-card:hover { transform: translateY(-5px); box-shadow: 0 15px 50px rgba(0,0,0,0.3); }

        .agent-card.highlight {
            animation: highlightPulse 2s ease;
            box-shadow: 0 0 0 3px var(--accent-purple), 0 15px 50px rgba(139, 92, 246, 0.4);
        }

        @keyframes highlightPulse {
            0% { box-shadow: 0 0 0 3px var(--accent-purple), 0 15px 50px rgba(139, 92, 246, 0.6); }
            50% { box-shadow: 0 0 0 6px rgba(139, 92, 246, 0.5), 0 15px 50px rgba(139, 92, 246, 0.3); }
            100% { box-shadow: 0 0 0 0px transparent, 0 15px 50px rgba(0,0,0,0.3); }
        }

        .agent-card-header {
            padding: 22px;
            display: flex;
            align-items: flex-start;
            gap: 18px;
            border-bottom: 1px solid var(--border-subtle);
        }

        .agent-icon {
            width: 55px;
            height: 55px;
            background: linear-gradient(135deg, var(--accent-purple) 0%, var(--accent-blue) 100%);
            border-radius: 14px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.6rem;
            flex-shrink: 0;
        }

        .agent-info { flex: 1; }
        .agent-name { font-size: 1.15rem; font-weight: 700; color: var(--text-primary); margin-bottom: 5px; }
        .agent-type { font-size: 0.8rem; color: var(--accent-purple); font-weight: 600; text-transform: uppercase; letter-spacing: 0.05em; }

        .agent-priority {
            padding: 6px 12px;
            border-radius: 20px;
            font-size: 0.75rem;
            font-weight: 700;
            text-transform: uppercase;
        }

        .agent-priority.critical { background: rgba(239, 68, 68, 0.15); color: #ef4444; }
        .agent-priority.high { background: rgba(249, 115, 22, 0.15); color: #f97316; }
        .agent-priority.medium { background: rgba(234, 179, 8, 0.15); color: #eab308; }
        .agent-priority.low { background: rgba(34, 197, 94, 0.15); color: #22c55e; }

        .agent-card-body { padding: 22px; }
        .agent-description { font-size: 0.95rem; color: var(--text-secondary); line-height: 1.6; margin-bottom: 20px; }

        .agent-flow {
            background: rgba(0,0,0,0.3);
            border: 1px solid var(--border-subtle);
            border-radius: 10px;
            padding: 18px;
            margin-bottom: 20px;
        }

        .agent-flow-title { font-size: 0.85rem; color: var(--text-muted); margin-bottom: 12px; font-weight: 600; text-transform: uppercase; letter-spacing: 0.05em; }

        .agent-flow-diagram { display: flex; align-items: center; flex-wrap: wrap; gap: 8px; justify-content: center; }

        .agent-step {
            background: linear-gradient(135deg, var(--accent-purple) 0%, var(--accent-blue) 100%);
            color: white;
            padding: 8px 14px;
            border-radius: 6px;
            font-size: 0.8rem;
            font-weight: 600;
            white-space: nowrap;
        }

        .agent-arrow { color: var(--accent-purple); font-size: 1.2rem; }

        .agent-stats { display: grid; grid-template-columns: repeat(3, 1fr); gap: 12px; }

        .agent-stat {
            background: rgba(0,0,0,0.2);
            border-radius: 8px;
            padding: 12px;
            text-align: center;
        }

        .agent-stat-value {
            font-size: 1.3rem;
            font-weight: 800;
            background: linear-gradient(135deg, var(--accent-purple) 0%, var(--accent-amber) 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .agent-stat-label { font-size: 0.7rem; color: var(--text-muted); text-transform: uppercase; letter-spacing: 0.05em; margin-top: 4px; }

        .agent-prompt-btn {
            width: 100%;
            margin-top: 18px;
            padding: 14px 20px;
            background: linear-gradient(135deg, rgba(139, 92, 246, 0.2) 0%, rgba(59, 130, 246, 0.2) 100%);
            border: 1px solid rgba(139, 92, 246, 0.4);
            border-radius: 10px;
            color: var(--accent-purple);
            font-weight: 700;
            cursor: pointer;
            transition: all 0.2s;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
            font-size: 0.9rem;
        }

        .agent-prompt-btn:hover {
            background: linear-gradient(135deg, rgba(139, 92, 246, 0.3) 0%, rgba(59, 130, 246, 0.3) 100%);
            border-color: var(--accent-purple);
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(139, 92, 246, 0.25);
        }

        /* Summary Stats */
        .agent-summary {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin-bottom: 35px;
        }

        .agent-summary-card {
            background: var(--bg-card);
            border: 1px solid var(--border-subtle);
            border-radius: 14px;
            padding: 25px;
            text-align: center;
        }

        .agent-summary-value {
            font-size: 2.5rem;
            font-weight: 800;
            background: linear-gradient(135deg, var(--accent-purple) 0%, var(--accent-amber) 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .agent-summary-label { font-size: 0.9rem; color: var(--text-muted); margin-top: 8px; }

        /* Heat Map Legend */
        .heat-legend {
            display: flex;
            gap: 25px;
            padding: 18px 22px;
            background: var(--bg-card);
            border: 1px solid var(--border-subtle);
            border-radius: 12px;
            margin-bottom: 25px;
            flex-wrap: wrap;
        }

        .heat-legend-item { display: flex; align-items: center; gap: 10px; font-size: 0.9rem; color: var(--text-secondary); }
        .heat-legend-color { width: 24px; height: 24px; border-radius: 6px; }

        /* Modal */
        .modal-overlay {
            display: none;
            position: fixed;
            top: 0; left: 0; right: 0; bottom: 0;
            background: rgba(10, 15, 26, 0.9);
            z-index: 2000;
            justify-content: center;
            align-items: center;
            padding: 20px;
            backdrop-filter: blur(5px);
        }

        .modal-overlay.show { display: flex; }

        .modal {
            background: var(--bg-card);
            border: 1px solid var(--border-subtle);
            border-radius: 16px;
            width: 100%;
            max-width: 950px;
            max-height: 90vh;
            display: flex;
            flex-direction: column;
            box-shadow: 0 25px 80px rgba(0,0,0,0.5);
        }

        .modal-header {
            background: linear-gradient(135deg, var(--accent-blue) 0%, var(--accent-teal) 100%);
            color: white;
            padding: 22px 28px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            border-radius: 16px 16px 0 0;
        }

        .modal-header h3 { font-size: 1.25rem; font-weight: 700; }
        .modal-actions { display: flex; gap: 12px; }

        .modal-btn {
            padding: 10px 18px;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-weight: 700;
            transition: transform 0.2s;
            font-size: 0.9rem;
        }

        .modal-btn:hover { transform: scale(1.05); }
        .modal-btn.copy { background: white; color: var(--accent-blue); }
        .modal-btn.close { background: rgba(255,255,255,0.2); color: white; }

        .modal-body { padding: 28px; overflow-y: auto; flex: 1; }

        .modal-body pre {
            background: rgba(0,0,0,0.3);
            border: 1px solid var(--border-subtle);
            padding: 22px;
            border-radius: 10px;
            font-family: 'JetBrains Mono', monospace;
            font-size: 0.9rem;
            line-height: 1.7;
            white-space: pre-wrap;
            word-wrap: break-word;
            color: var(--text-secondary);
        }

        .copy-success {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: var(--accent-green);
            color: white;
            padding: 18px 35px;
            border-radius: 10px;
            font-weight: 700;
            z-index: 3000;
            display: none;
            animation: fadeInOut 2s ease;
        }

        @keyframes fadeInOut { 0%, 100% { opacity: 0; } 10%, 90% { opacity: 1; } }

        /* Prompt Modal */
        .prompt-modal .modal { max-width: 800px; }
        .prompt-modal .modal-header { background: linear-gradient(135deg, var(--accent-purple) 0%, var(--accent-blue) 100%); }

        .prompt-section { margin-bottom: 25px; }
        .prompt-section h4 { color: var(--accent-purple); font-size: 1rem; margin-bottom: 12px; display: flex; align-items: center; gap: 8px; }

        .prompt-box {
            background: rgba(0,0,0,0.4);
            border: 1px solid var(--border-subtle);
            border-radius: 10px;
            padding: 20px;
            font-family: 'JetBrains Mono', monospace;
            font-size: 0.85rem;
            line-height: 1.7;
            color: var(--text-secondary);
            white-space: pre-wrap;
            word-wrap: break-word;
        }

        .prompt-tags { display: flex; gap: 10px; flex-wrap: wrap; margin-bottom: 20px; }
        .prompt-tag { background: rgba(139, 92, 246, 0.15); color: var(--accent-purple); padding: 6px 14px; border-radius: 20px; font-size: 0.8rem; font-weight: 600; }

        @media (max-width: 900px) {
            .sidebar { display: none; }
            .main-content { margin-left: 0; padding: 75px 20px 30px 20px; }
            .agent-grid { grid-template-columns: 1fr; }
        }
            .breadcrumb-logo-link { display: flex; align-items: center; padding: 4px 8px; background: rgba(255,255,255,0.08); border-radius: 8px; border: 1px solid rgba(255,255,255,0.12); transition: all 0.2s; }
        .breadcrumb-logo-link:hover { background: rgba(255,255,255,0.15); }
        .breadcrumb-logo { height: 28px; width: auto; }
    </style>
</head>
<body>
    <!-- Breadcrumb -->
    <nav class="breadcrumb">
        <a href="../../index.html" class="breadcrumb-logo-link"><img src="../../images/clear-ai-logo.png" alt="Clear AI" class="breadcrumb-logo"></a>
        <a href="../../index.html">Portal Home</a>
        <span class="separator">></span>
        <a href="./index.html">Byte</a>
        <span class="separator">></span>
        <span class="current">Details of Transaction</span>
    </nav>

    <!-- Fixed Sidebar -->
    <aside class="sidebar">
        <div class="sidebar-header">
            <h2>Details of Transaction</h2>
            <p>Interactive Workflow Guide</p>
        </div>

        <!-- Tab Switcher -->
        <div class="sidebar-tabs">
            <button class="sidebar-tab active" onclick="switchTab('workflow')">Workflow</button>
            <button class="sidebar-tab agent-tab" onclick="switchTab('agents')">AI Agents</button>
        </div>

        <!-- Workflow Navigation -->
        <nav class="sidebar-nav" id="workflow-nav">
            <a href="#section-0" class="nav-item active">
                <span class="nav-number">0</span>
                <span class="nav-label">Overview</span>
            </a>
            <a href="#section-1" class="nav-item">
                <span class="nav-number">1</span>
                <span class="nav-label">Review Prelim CD</span>
            </a>
            <a href="#section-2" class="nav-item">
                <span class="nav-number">2</span>
                <span class="nav-label">DU Processing</span>
            </a>
            <a href="#section-3" class="nav-item">
                <span class="nav-number">3</span>
                <span class="nav-label">LP Validation</span>
            </a>
            <a href="#section-4" class="nav-item">
                <span class="nav-number">4</span>
                <span class="nav-label">Underwriting</span>
            </a>
            <a href="#section-5" class="nav-item">
                <span class="nav-number">5</span>
                <span class="nav-label">Closing</span>
            </a>
            <a href="#quick-ref" class="nav-item">
                <span class="nav-number">*</span>
                <span class="nav-label">Quick Reference</span>
            </a>
        </nav>

        <!-- Agent Navigation -->
        <nav class="sidebar-nav" id="agents-nav" style="display: none;">
            <a href="#agent-summary" class="nav-item active">
                <span class="nav-number">S</span>
                <span class="nav-label">Summary</span>
            </a>
            <a href="#agent-heatmap" class="nav-item">
                <span class="nav-number">H</span>
                <span class="nav-label">Heat Map</span>
            </a>
            <a href="#agent-details" class="nav-item">
                <span class="nav-number">A</span>
                <span class="nav-label">Agent Details</span>
            </a>
        </nav>

        <div class="sidebar-footer">
            <button class="doc-btn" onclick="openDocModal()">
                View Workflow Markdown
            </button>
        </div>
    </aside>

    <!-- Main Content -->
    <main class="main-content">

        <!-- ==================== WORKFLOW TAB ==================== -->
        <div id="workflow-panel" class="tab-panel active">
            <!-- Header -->
            <div class="header">
                <h1>Updating the Details of Transaction (DOT)</h1>
                <p class="subtitle">Add credits/charges to DOT when borrower is short funds to close</p>
                <div class="meta">
                    <span class="meta-item">System: Byte</span>
                    <span class="meta-item">Role: Processor / Closer / Underwriter</span>
                    <span class="meta-item">Updated: April 18, 2023</span>
                    <span class="meta-item">Trigger: AUS shows short funds to close</span>
                </div>
            </div>

            <!-- Legend -->
            <div class="legend">
                <div class="legend-item"><div class="legend-color" style="background: linear-gradient(135deg, #22c55e, #16a34a);"></div><span>Start/End</span></div>
                <div class="legend-item"><div class="legend-color" style="background: linear-gradient(135deg, #3b82f6, #2563eb);"></div><span>Action Step</span></div>
                <div class="legend-item"><div class="legend-color" style="background: linear-gradient(135deg, #f59e0b, #d97706);"></div><span>Decision Point</span></div>
                <div class="legend-item"><div class="legend-color" style="background: #111827; border: 2px solid #3b82f6;"></div><span>User Input</span></div>
                <div class="legend-item"><div class="legend-color" style="background: linear-gradient(135deg, #f43f5e, #dc2626);"></div><span>Exception</span></div>
                <div class="legend-item"><div class="legend-color" style="background: linear-gradient(135deg, #14b8a6, #0d9488);"></div><span>Output</span></div>
            </div>

            <!-- Section 0: Overview -->
            <section id="section-0" class="section">
                <div class="section-header">
                    <div class="section-number">0</div>
                    <div class="section-title"><h2>When to Update DOT</h2><span>Understanding the trigger conditions</span></div>
                </div>
                <div class="section-content">
                    <div class="info-box">
                        <h4>Purpose</h4>
                        <p>When AUS is showing a borrower's verified assets are short or cash to close is tight, there may be additional credits or charges that we can add to the Details Of Transaction (DOT) to correct this. Credits/charges must be added to the DOT for AUS to include them.</p>
                    </div>

                    <div class="summary-grid">
                        <div class="summary-card">
                            <h4>Primary Trigger</h4>
                            <div class="value" style="font-size: 1.5rem;">Short Funds</div>
                            <div class="label">AUS shows borrower short to close</div>
                        </div>
                        <div class="summary-card">
                            <h4>Source Document</h4>
                            <div class="value" style="font-size: 1.5rem;">CD Pg 3</div>
                            <div class="label">Preliminary Closing Disclosure</div>
                        </div>
                        <div class="summary-card">
                            <h4>AUS Systems</h4>
                            <div class="value" style="font-size: 1.5rem;">DU/LP</div>
                            <div class="label">Different processes for each</div>
                        </div>
                    </div>

                    <div class="exception-box">
                        <h4>Important Limitation</h4>
                        <p>This process should <strong>only be completed when the borrower is short funds to close</strong>. It does not need to be completed on every transaction. Processors may be limited to updates at certain statuses - please work with the Processing Manager if you are unable to update due to status.</p>
                    </div>

                    <div class="decision-tree">
                        <h3>AUS Type Decision</h3>
                        <div class="tree-node level-1">
                            <span class="tree-label">Which AUS?</span>
                        </div>
                        <div class="tree-node">
                            <span class="tree-label" style="background: var(--accent-blue); color: white;">Desktop Underwriter (DU)</span> - Add credits to URLA Lender Loan Info > Details Of Transaction line M
                        </div>
                        <div class="tree-node">
                            <span class="tree-label" style="background: var(--accent-teal); color: white;">Loan Product Advisor (LP)</span> - Cannot add additional CD credits to URLA; use Loan Estimate Page 2 fee editing method
                        </div>
                    </div>
                </div>
            </section>

            <!-- Section 1: Review Prelim CD -->
            <section id="section-1" class="section">
                <div class="section-header">
                    <div class="section-number">1</div>
                    <div class="section-title"><h2>Review Preliminary CD</h2><span>Identify additional credits or charges</span></div>
                </div>
                <div class="section-content">
                    <div class="workflow-diagram">
                        <div class="flow-row">
                            <div class="flow-node start">Start: AUS Short</div>
                            <span class="flow-arrow">-></span>
                            <div class="flow-node action">Request Prelim CD from Title</div>
                            <span class="flow-arrow">-></span>
                            <div class="flow-node action">Review CD Page 3</div>
                        </div>
                    </div>

                    <table class="field-table">
                        <thead>
                            <tr>
                                <th>Credit/Charge Type</th>
                                <th>Location on CD</th>
                                <th>Common Examples</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td><strong style="color: var(--text-primary);">Closing Disc Pg 3 Credits</strong></td>
                                <td>Section L</td>
                                <td>Tax prorations, Texas option fee, Owner's title policy credit</td>
                            </tr>
                            <tr>
                                <td><strong style="color: var(--text-primary);">Seller Credits</strong></td>
                                <td>Section L</td>
                                <td>Seller concessions, repair credits</td>
                            </tr>
                            <tr>
                                <td><strong style="color: var(--text-primary);">Other Purchase Credits</strong></td>
                                <td>Section L</td>
                                <td>Earnest money, lump sum lender credit</td>
                            </tr>
                        </tbody>
                    </table>

                    <div class="tip-box">
                        <h4>Pro Tip</h4>
                        <p>Look for any items that show on CD page 3 Section L as credits that reduce the bottom line. These can be added to the DOT to help the borrower's funds to close calculation.</p>
                    </div>
                </div>
            </section>

            <!-- Section 2: DU Processing -->
            <section id="section-2" class="section">
                <div class="section-header">
                    <div class="section-number">2</div>
                    <div class="section-title"><h2>Processing for DU</h2><span>Add credits via URLA Lender Loan Info</span></div>
                </div>
                <div class="section-content">
                    <div class="workflow-diagram">
                        <h3 style="text-align: center; margin-bottom: 22px; color: var(--accent-blue);">DU Credit Entry Flow</h3>
                        <div class="flow-row">
                            <div class="flow-node action">Access URLA Lender Loan Info</div>
                        </div>
                        <div class="flow-row"><span class="flow-arrow down">v</span></div>
                        <div class="flow-row">
                            <div class="flow-node action">Click Details Of Transaction Line M: Other Credits</div>
                        </div>
                        <div class="flow-row"><span class="flow-arrow down">v</span></div>
                        <div class="flow-row">
                            <div class="flow-node input">Add Credit Line Items</div>
                        </div>
                        <div class="flow-row"><span class="flow-arrow down">v</span></div>
                        <div class="flow-row">
                            <div class="flow-node action">Select "Omit from Other Assets"</div>
                        </div>
                        <div class="flow-row"><span class="flow-arrow down">v</span></div>
                        <div class="flow-row">
                            <div class="flow-node output">Re-run AUS Findings</div>
                        </div>
                    </div>

                    <table class="field-table">
                        <thead>
                            <tr>
                                <th>Field</th>
                                <th>Action</th>
                                <th>Example</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td><strong style="color: var(--text-primary);">Type</strong></td>
                                <td>Select "Other" from dropdown</td>
                                <td>Other</td>
                            </tr>
                            <tr>
                                <td><strong style="color: var(--text-primary);">Description</strong></td>
                                <td>Override to input credit/charge type</td>
                                <td>Tax Prorations</td>
                            </tr>
                            <tr>
                                <td><strong style="color: var(--text-primary);">Amount</strong></td>
                                <td>Enter the credit/charge amount</td>
                                <td>$250.00</td>
                            </tr>
                            <tr>
                                <td><strong style="color: var(--text-primary);">Source</strong></td>
                                <td>Select appropriate source</td>
                                <td>Property Seller</td>
                            </tr>
                            <tr>
                                <td><strong style="color: var(--text-primary);">Omit from Other Assets</strong></td>
                                <td><span class="badge required-badge">Required</span> Select this checkbox</td>
                                <td>Checked</td>
                            </tr>
                        </tbody>
                    </table>

                    <div class="info-box">
                        <h4>Important Note</h4>
                        <p>You will see the credit listed in both the DOT and on the Loan Application, but this is okay. <strong>This does not impact the bottom line twice.</strong> The DOT only feeds to the AUS Findings. The Closer will add the credit/charge to the CD later in the process.</p>
                    </div>

                    <div class="tip-box">
                        <h4>Verification Step</h4>
                        <p>After adding credits, re-run AUS Findings and confirm the cash to close has been updated and is no longer showing short funds to close.</p>
                    </div>
                </div>
            </section>

            <!-- Section 3: LP Validation Error -->
            <section id="section-3" class="section">
                <div class="section-header">
                    <div class="section-number">3</div>
                    <div class="section-title"><h2>Loan Product Advisor (LP) Validation</h2><span>Alternative method for LP loans</span></div>
                </div>
                <div class="section-content">
                    <div class="exception-box">
                        <h4>LP Limitation</h4>
                        <p><strong>LP cannot have additional CD credits added to the URLA.</strong> Use the following process for pro-rations, Texas option fee, Owner's title policy credit, and other items that show on CD page 3 Section L as credits that reduce the bottom line.</p>
                    </div>

                    <div class="workflow-diagram">
                        <h3 style="text-align: center; margin-bottom: 22px; color: var(--accent-blue);">LP Alternative Method Flow</h3>
                        <div class="flow-row">
                            <div class="flow-node action">Navigate to URLA Borrower Info</div>
                            <span class="flow-arrow">-></span>
                            <div class="flow-node action">Click Assets Tab</div>
                        </div>
                        <div class="flow-row"><span class="flow-arrow down">v</span></div>
                        <div class="flow-row">
                            <div class="flow-node exception">Remove Other Asset from "Other Assets You Have" table</div>
                        </div>
                        <div class="flow-row"><span class="flow-arrow down">v</span></div>
                        <div class="flow-row">
                            <div class="flow-node action">Navigate to Loan Estimate - Page 2</div>
                        </div>
                        <div class="flow-row"><span class="flow-arrow down">v</span></div>
                        <div class="flow-row">
                            <div class="flow-node action">Locate Fee Other Party is Paying</div>
                            <span class="flow-arrow">-></span>
                            <div class="flow-node input">Click Edit Next to Fee Name</div>
                        </div>
                        <div class="flow-row"><span class="flow-arrow down">v</span></div>
                        <div class="flow-row">
                            <div class="flow-node input">Update Fee Payment Details</div>
                            <span class="flow-arrow">-></span>
                            <div class="flow-node output">Re-run AUS Findings</div>
                        </div>
                    </div>

                    <table class="field-table">
                        <thead>
                            <tr>
                                <th>Step</th>
                                <th>Field/Action</th>
                                <th>Details</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td><strong style="color: var(--text-primary);">1</strong></td>
                                <td>Remove from Paid by Borrower</td>
                                <td>Clear the borrower payment amount</td>
                            </tr>
                            <tr>
                                <td><strong style="color: var(--text-primary);">2</strong></td>
                                <td>Paid by Dropdown</td>
                                <td>Select who is paying the fee (e.g., Seller)</td>
                            </tr>
                            <tr>
                                <td><strong style="color: var(--text-primary);">3</strong></td>
                                <td>Amount</td>
                                <td>Insert amount being paid by other party</td>
                            </tr>
                            <tr>
                                <td><strong style="color: var(--text-primary);">4</strong></td>
                                <td>Confirm</td>
                                <td>Click OK to save changes</td>
                            </tr>
                        </tbody>
                    </table>

                    <div class="mi-comparison">
                        <div class="mi-card">
                            <div class="mi-card-header"><h4>DU Method</h4></div>
                            <div class="mi-card-body">
                                <ul>
                                    <li><span class="check-icon">Y</span> Add credits directly to DOT Line M</li>
                                    <li><span class="check-icon">Y</span> Use Other Purchase Credits section</li>
                                    <li><span class="check-icon">Y</span> Select "Omit from Other Assets"</li>
                                    <li><span class="check-icon">Y</span> Straightforward entry process</li>
                                </ul>
                            </div>
                        </div>
                        <div class="mi-card">
                            <div class="mi-card-header"><h4>LP Method</h4></div>
                            <div class="mi-card-body">
                                <ul>
                                    <li><span class="x-icon">X</span> Cannot add credits to URLA DOT</li>
                                    <li><span class="check-icon">Y</span> Use Loan Estimate Page 2 instead</li>
                                    <li><span class="check-icon">Y</span> Edit fee payment source</li>
                                    <li><span class="check-icon">Y</span> Reassign fee to other party</li>
                                </ul>
                            </div>
                        </div>
                    </div>
                </div>
            </section>

            <!-- Section 4: Underwriting -->
            <section id="section-4" class="section">
                <div class="section-header">
                    <div class="section-number">4</div>
                    <div class="section-title"><h2>Underwriting Steps</h2><span>Post-processing verification and conditions</span></div>
                </div>
                <div class="section-content">
                    <div class="workflow-diagram">
                        <div class="flow-row">
                            <div class="flow-node action">Submit to Underwriting</div>
                            <span class="flow-arrow">-></span>
                            <div class="flow-node decision">Review Updated Cash to Close</div>
                            <span class="flow-arrow">-></span>
                            <div class="flow-node action">Review AUS Findings</div>
                        </div>
                        <div class="flow-row"><span class="flow-arrow down">v</span></div>
                        <div class="flow-row">
                            <div class="flow-node output">At Loan Approval: Complete CLSNG 866</div>
                        </div>
                    </div>

                    <div class="info-box">
                        <h4>Condition CLSNG 866</h4>
                        <p>At loan approval, the Underwriter must complete the <strong>cash to close minimum</strong> in condition CLSNG 866. This condition specifies the maximum cash to close amount that has been verified.</p>
                    </div>

                    <table class="field-table">
                        <thead>
                            <tr>
                                <th>Condition</th>
                                <th>Timing</th>
                                <th>Description</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td><strong style="color: var(--text-primary);">CLSNG 866</strong></td>
                                <td>Loan Approval</td>
                                <td>Cash To Close Cannot Exceed $[amount] Verified Or Return To UW To Verify Additional Assets And Acceptable Source</td>
                            </tr>
                        </tbody>
                    </table>

                    <div class="tip-box">
                        <h4>Clear to Close Verification</h4>
                        <p>Validate the cash to close is accurate at clear to close. Ensure the final figures align with the CLSNG 866 condition before proceeding.</p>
                    </div>
                </div>
            </section>

            <!-- Section 5: Closing -->
            <section id="section-5" class="section">
                <div class="section-header">
                    <div class="section-number">5</div>
                    <div class="section-title"><h2>Closing Process</h2><span>Final CD updates and verification</span></div>
                </div>
                <div class="section-content">
                    <div class="workflow-diagram">
                        <div class="flow-row">
                            <div class="flow-node action">Update Closing Disc Pg 3</div>
                            <span class="flow-arrow">-></span>
                            <div class="flow-node action">Add Credits/Charges from Prelim CD</div>
                        </div>
                        <div class="flow-row"><span class="flow-arrow down">v</span></div>
                        <div class="flow-row">
                            <div class="flow-node decision">Cash to Close Meets CLSNG 866?</div>
                        </div>
                        <div class="decision-branch">
                            <div class="branch">
                                <span class="branch-label">YES</span>
                                <span class="flow-arrow down">v</span>
                                <div class="flow-node output">Proceed to Closing</div>
                            </div>
                            <div class="branch">
                                <span class="branch-label">NO</span>
                                <span class="flow-arrow down">v</span>
                                <div class="flow-node exception">Contact Underwriting for Update</div>
                            </div>
                        </div>
                    </div>

                    <table class="field-table">
                        <thead>
                            <tr>
                                <th>Closing Disc Page 3 Fields</th>
                                <th>Description</th>
                                <th>Example Value</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td><strong style="color: var(--text-primary);">L. Paid by or on Behalf of...</strong></td>
                                <td>Total credits section</td>
                                <td>$298,250.00</td>
                            </tr>
                            <tr>
                                <td><strong style="color: var(--text-primary);">01. Deposit (Earnest Money)</strong></td>
                                <td>Earnest money deposit</td>
                                <td>$500.00</td>
                            </tr>
                            <tr>
                                <td><strong style="color: var(--text-primary);">02. Loan Amount</strong></td>
                                <td>Principal loan amount</td>
                                <td>$297,500.00</td>
                            </tr>
                            <tr>
                                <td><strong style="color: var(--text-primary);">04-11. Other Credits</strong></td>
                                <td>Additional credits section</td>
                                <td>Tax Prorations: $250.00</td>
                            </tr>
                        </tbody>
                    </table>

                    <div class="info-box">
                        <h4>Calculation Verification</h4>
                        <p>Confirm the final Cash to Close calculation on CD Page 3:</p>
                        <ul style="margin-top: 10px; margin-left: 20px;">
                            <li>Total Due from Borrower at Closing (K)</li>
                            <li>Less: Total Paid Already by or on Behalf of... (L)</li>
                            <li>Equals: Cash to Close (From/To Borrower)</li>
                        </ul>
                    </div>

                    <div class="exception-box">
                        <h4>If Cash to Close Does Not Match</h4>
                        <p>If the Cash to Close from borrower does not meet the CLSNG 866 condition, reach out to Underwriting immediately to get the condition updated before proceeding with closing.</p>
                    </div>
                </div>
            </section>

            <!-- Quick Reference -->
            <section id="quick-ref" class="quick-ref">
                <h3>Quick Reference Card</h3>
                <pre>
TRIGGER: AUS shows borrower short funds to close

DOCUMENT SOURCE: Preliminary CD from Title Company - Page 3, Section L

DU PROCESS:
  1. URLA Lender Loan Info > Details Of Transaction Line M: Other Credits
  2. Add credit: Type=Other, Description=[credit type], Amount, Source
  3. CHECK "Omit from Other Assets"
  4. Re-run AUS Findings

LP PROCESS (Different - Cannot use URLA):
  1. URLA Borrower Info > Assets Tab > Remove Other Asset
  2. Loan Estimate - Page 2 > Locate fee > Click Edit
  3. Remove from Paid by Borrower
  4. Select who is paying (Paid by dropdown)
  5. Enter amount > OK
  6. Re-run AUS Findings

UNDERWRITING:
  - At approval: Complete CLSNG 866 with cash to close minimum
  - At CTC: Validate cash to close is accurate

CLOSING:
  - Update Closing Disc Pg 3 with credits/charges
  - Verify Cash to Close meets CLSNG 866
  - If not: Contact Underwriting for condition update

KEY SCREENS:
  - URLA Lender Loan Info (DU)
  - URLA Borrower Info > Assets (LP)
  - Loan Estimate - Page 2 (LP)
  - Closing Disc Page 3 (Closing)
  - Retail CD Request (Processing)
                </pre>
            </section>
        </div>

        <!-- ==================== AGENT OPPORTUNITIES TAB ==================== -->
        <div id="agents-panel" class="tab-panel">
            <!-- Header -->
            <div class="agent-header">
                <h1>AI Agent Opportunities</h1>
                <p class="subtitle">Automation Analysis for Details of Transaction Workflow</p>
                <div class="meta">
                    <span class="meta-item">6 Process Steps Analyzed</span>
                    <span class="meta-item">4 Agent Candidates Identified</span>
                    <span class="meta-item">Est. 45% Time Savings</span>
                </div>
            </div>

            <!-- Summary Stats -->
            <div class="agent-summary" id="agent-summary">
                <div class="agent-summary-card">
                    <div class="agent-summary-value">4</div>
                    <div class="agent-summary-label">Agent Candidates</div>
                </div>
                <div class="agent-summary-card">
                    <div class="agent-summary-value">2</div>
                    <div class="agent-summary-label">High Priority</div>
                </div>
                <div class="agent-summary-card">
                    <div class="agent-summary-value">45%</div>
                    <div class="agent-summary-label">Time Savings</div>
                </div>
                <div class="agent-summary-card">
                    <div class="agent-summary-value">80%</div>
                    <div class="agent-summary-label">Automation Potential</div>
                </div>
            </div>

            <!-- Heat Map Legend -->
            <div class="heat-legend" id="agent-heatmap">
                <div class="heat-legend-item"><div class="heat-legend-color" style="background: linear-gradient(135deg, #ef4444, #f97316);"></div><span><strong>Critical (90-100)</strong> - Immediate ROI</span></div>
                <div class="heat-legend-item"><div class="heat-legend-color" style="background: linear-gradient(135deg, #f97316, #eab308);"></div><span><strong>High (70-89)</strong> - Strong candidate</span></div>
                <div class="heat-legend-item"><div class="heat-legend-color" style="background: linear-gradient(135deg, #eab308, #22c55e);"></div><span><strong>Medium (50-69)</strong> - Consider</span></div>
                <div class="heat-legend-item"><div class="heat-legend-color" style="background: linear-gradient(135deg, #22c55e, #14b8a6);"></div><span><strong>Low (0-49)</strong> - Future phase</span></div>
            </div>

            <!-- Heat Map Grid -->
            <div class="heat-map-container">
                <div class="heat-map-title">Automation Priority Heat Map <span style="font-size: 0.8rem; font-weight: 400; color: var(--text-muted);">(Click to jump to agent)</span></div>
                <div class="heat-map-grid">
                    <div class="heat-item critical" onclick="scrollToAgent('agent-cd-scanner')" title="Click to view agent details">
                        <div class="heat-score">92</div>
                        <div class="heat-name">CD Credit Scanner</div>
                        <div class="heat-desc">Auto-extract credits from Prelim CD</div>
                        <div class="heat-metrics">
                            <div class="heat-metric">Effort: <span>Medium</span></div>
                            <div class="heat-metric">Impact: <span>High</span></div>
                            <div class="heat-metric">Step: <span>1</span></div>
                        </div>
                    </div>
                    <div class="heat-item high" onclick="scrollToAgent('agent-aus-monitor')" title="Click to view agent details">
                        <div class="heat-score">85</div>
                        <div class="heat-name">AUS Funds Monitor</div>
                        <div class="heat-desc">Alert when borrower is short to close</div>
                        <div class="heat-metrics">
                            <div class="heat-metric">Effort: <span>Low</span></div>
                            <div class="heat-metric">Impact: <span>High</span></div>
                            <div class="heat-metric">Step: <span>0</span></div>
                        </div>
                    </div>
                    <div class="heat-item high" onclick="scrollToAgent('agent-dot-autofill')" title="Click to view agent details">
                        <div class="heat-score">78</div>
                        <div class="heat-name">DOT Auto-Populate</div>
                        <div class="heat-desc">Auto-fill DOT fields from extracted data</div>
                        <div class="heat-metrics">
                            <div class="heat-metric">Effort: <span>Medium</span></div>
                            <div class="heat-metric">Impact: <span>High</span></div>
                            <div class="heat-metric">Step: <span>2</span></div>
                        </div>
                    </div>
                    <div class="heat-item medium" onclick="scrollToAgent('agent-clsng-validator')" title="Click to view agent details">
                        <div class="heat-score">65</div>
                        <div class="heat-name">CLSNG 866 Validator</div>
                        <div class="heat-desc">Verify cash to close meets condition</div>
                        <div class="heat-metrics">
                            <div class="heat-metric">Effort: <span>Low</span></div>
                            <div class="heat-metric">Impact: <span>Medium</span></div>
                            <div class="heat-metric">Step: <span>5</span></div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Agent Details -->
            <h2 style="font-size: 1.4rem; margin: 35px 0 22px; color: var(--text-primary);" id="agent-details">Agent Specifications</h2>

            <div class="agent-grid">
                <!-- Agent 1: CD Credit Scanner -->
                <div class="agent-card" id="agent-cd-scanner">
                    <div class="agent-card-header">
                        <div class="agent-icon">S</div>
                        <div class="agent-info">
                            <div class="agent-name">CD Credit Scanner Agent</div>
                            <div class="agent-type">Document Processing Agent</div>
                        </div>
                        <span class="agent-priority critical">Critical</span>
                    </div>
                    <div class="agent-card-body">
                        <p class="agent-description">Automatically scans preliminary Closing Disclosures to extract credits and charges from Page 3, Section L. Uses OCR and document understanding to identify tax prorations, earnest money, seller credits, and other items that can be added to the DOT.</p>
                        <div class="agent-flow">
                            <div class="agent-flow-title">Agent Flow</div>
                            <div class="agent-flow-diagram">
                                <div class="agent-step">Receive CD PDF</div>
                                <span class="agent-arrow">-></span>
                                <div class="agent-step">OCR Page 3</div>
                                <span class="agent-arrow">-></span>
                                <div class="agent-step">Extract Credits</div>
                                <span class="agent-arrow">-></span>
                                <div class="agent-step">Return Structured Data</div>
                            </div>
                        </div>
                        <div class="agent-stats">
                            <div class="agent-stat"><div class="agent-stat-value">5min</div><div class="agent-stat-label">Time Saved</div></div>
                            <div class="agent-stat"><div class="agent-stat-value">98%</div><div class="agent-stat-label">Accuracy</div></div>
                            <div class="agent-stat"><div class="agent-stat-value">Med</div><div class="agent-stat-label">Complexity</div></div>
                        </div>
                        <button class="agent-prompt-btn" onclick="showAgentPrompt('cdscanner')">
                            View AI Prompt to Build This Agent
                        </button>
                    </div>
                </div>

                <!-- Agent 2: AUS Funds Monitor -->
                <div class="agent-card" id="agent-aus-monitor">
                    <div class="agent-card-header">
                        <div class="agent-icon">M</div>
                        <div class="agent-info">
                            <div class="agent-name">AUS Funds Monitor Agent</div>
                            <div class="agent-type">Monitoring Agent</div>
                        </div>
                        <span class="agent-priority high">High</span>
                    </div>
                    <div class="agent-card-body">
                        <p class="agent-description">Monitors AUS submissions and automatically alerts processors when a borrower shows short funds to close. Triggers the DOT update workflow and suggests potential credit sources based on loan type and transaction details.</p>
                        <div class="agent-flow">
                            <div class="agent-flow-title">Agent Flow</div>
                            <div class="agent-flow-diagram">
                                <div class="agent-step">Monitor AUS</div>
                                <span class="agent-arrow">-></span>
                                <div class="agent-step">Detect Short Funds</div>
                                <span class="agent-arrow">-></span>
                                <div class="agent-step">Alert Processor</div>
                                <span class="agent-arrow">-></span>
                                <div class="agent-step">Suggest Actions</div>
                            </div>
                        </div>
                        <div class="agent-stats">
                            <div class="agent-stat"><div class="agent-stat-value">24/7</div><div class="agent-stat-label">Monitoring</div></div>
                            <div class="agent-stat"><div class="agent-stat-value">-2hr</div><div class="agent-stat-label">Response Time</div></div>
                            <div class="agent-stat"><div class="agent-stat-value">Low</div><div class="agent-stat-label">Complexity</div></div>
                        </div>
                        <button class="agent-prompt-btn" onclick="showAgentPrompt('ausmonitor')">
                            View AI Prompt to Build This Agent
                        </button>
                    </div>
                </div>

                <!-- Agent 3: DOT Auto-Populate -->
                <div class="agent-card" id="agent-dot-autofill">
                    <div class="agent-card-header">
                        <div class="agent-icon">A</div>
                        <div class="agent-info">
                            <div class="agent-name">DOT Auto-Populate Agent</div>
                            <div class="agent-type">Data Entry Agent</div>
                        </div>
                        <span class="agent-priority high">High</span>
                    </div>
                    <div class="agent-card-body">
                        <p class="agent-description">Takes extracted credit data and automatically populates the Details of Transaction screen in Byte. Detects whether the loan is DU or LP and applies the correct entry method. Pre-fills Type, Description, Amount, and Source fields.</p>
                        <div class="agent-flow">
                            <div class="agent-flow-title">Agent Flow</div>
                            <div class="agent-flow-diagram">
                                <div class="agent-step">Receive Credits</div>
                                <span class="agent-arrow">-></span>
                                <div class="agent-step">Detect AUS Type</div>
                                <span class="agent-arrow">-></span>
                                <div class="agent-step">Navigate to Screen</div>
                                <span class="agent-arrow">-></span>
                                <div class="agent-step">Auto-Fill Fields</div>
                            </div>
                        </div>
                        <div class="agent-stats">
                            <div class="agent-stat"><div class="agent-stat-value">3min</div><div class="agent-stat-label">Time Saved</div></div>
                            <div class="agent-stat"><div class="agent-stat-value">100%</div><div class="agent-stat-label">Accuracy</div></div>
                            <div class="agent-stat"><div class="agent-stat-value">Med</div><div class="agent-stat-label">Complexity</div></div>
                        </div>
                        <button class="agent-prompt-btn" onclick="showAgentPrompt('dotautofill')">
                            View AI Prompt to Build This Agent
                        </button>
                    </div>
                </div>

                <!-- Agent 4: CLSNG 866 Validator -->
                <div class="agent-card" id="agent-clsng-validator">
                    <div class="agent-card-header">
                        <div class="agent-icon">V</div>
                        <div class="agent-info">
                            <div class="agent-name">CLSNG 866 Validator Agent</div>
                            <div class="agent-type">Validation Agent</div>
                        </div>
                        <span class="agent-priority medium">Medium</span>
                    </div>
                    <div class="agent-card-body">
                        <p class="agent-description">Automatically compares the Cash to Close amount from the final CD against the CLSNG 866 condition. Alerts closers if there's a discrepancy and auto-generates a request to Underwriting if the condition needs to be updated.</p>
                        <div class="agent-flow">
                            <div class="agent-flow-title">Agent Flow</div>
                            <div class="agent-flow-diagram">
                                <div class="agent-step">Read CLSNG 866</div>
                                <span class="agent-arrow">-></span>
                                <div class="agent-step">Compare to CD</div>
                                <span class="agent-arrow">-></span>
                                <div class="agent-step">Validate Match</div>
                                <span class="agent-arrow">-></span>
                                <div class="agent-step">Alert/Approve</div>
                            </div>
                        </div>
                        <div class="agent-stats">
                            <div class="agent-stat"><div class="agent-stat-value">2min</div><div class="agent-stat-label">Time Saved</div></div>
                            <div class="agent-stat"><div class="agent-stat-value">0</div><div class="agent-stat-label">Errors</div></div>
                            <div class="agent-stat"><div class="agent-stat-value">Low</div><div class="agent-stat-label">Complexity</div></div>
                        </div>
                        <button class="agent-prompt-btn" onclick="showAgentPrompt('clsngvalidator')">
                            View AI Prompt to Build This Agent
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </main>

    <!-- Documentation Modal -->
    <div class="modal-overlay" id="docModal">
        <div class="modal">
            <div class="modal-header">
                <h3>Details of Transaction - Workflow Markdown</h3>
                <div class="modal-actions">
                    <button class="modal-btn copy" onclick="copyToClipboard()">Copy</button>
                    <button class="modal-btn close" onclick="closeDocModal()">X Close</button>
                </div>
            </div>
            <div class="modal-body">
                <pre id="docContent"># UPDATING THE DETAILS OF TRANSACTION (DOT)

## Overview
When AUS is showing a borrower's verified assets are short or cash to close is tight, there may be additional credits or charges that can be added to the Details Of Transaction (DOT) to correct this.

## When to Use
- Only when borrower is short funds to close
- Does NOT need to be completed on every transaction
- Processors may be limited to updates at certain statuses

## Source Document
Check the Preliminary Closing Disclosure from title company - Page 3, Section L

## PROCESSING FOR DU

### Steps:
1. Review preliminary CD from title company to locate additional credits/charges (CD Page 3)
2. Access the URLA Lender Loan Info screen
3. Click on Details Of Transaction line M: Other Credits
4. Add credit/charge line items to the Other Purchase Credits section:
   - Select "Other" in the Type dropdown
   - Override the Description to input the credit/charge type
   - Complete the Amount and Source
   - Click OK
5. Select "Omit from Other Assets" (IMPORTANT)
6. Re-run AUS Findings
7. Confirm cash to close has been updated and is no longer short

### Note
You will see the credit listed in both the DOT and on the Loan Application, but this is okay. This does not impact the bottom line twice. The DOT only feeds to the AUS Findings.

## LOAN PRODUCT ADVISOR (LP) VALIDATION ERROR

**IMPORTANT: LP cannot have additional CD credits added to the URLA.**

### Alternative Process for LP:
1. Navigate to URLA Borrower Info screen
2. Click the Assets tab
3. Remove the Other asset listed in the "Other Assets You Have" table
4. Navigate to Loan Estimate - Page 2 screen
5. Locate the fee that other party is paying
6. Click Edit next to the fee name
7. Remove fee from Paid by Borrower box
8. Select who is paying the fee from the Paid by dropdown
9. Insert amount that is being paid by other party
10. Click OK
11. Re-run AUS Findings

## UNDERWRITING

1. At loan approval, complete the cash to close minimum in condition CLSNG 866
2. Validate the cash to close is accurate at clear to close

## CLOSING

1. Update Closing Disc Pg 3 with credits or charges from the prelim CD as normal
2. Confirm the Cash to Close from borrower meets CLSNG 866 condition
3. If not meeting condition, reach out to Underwriting to get the condition updated

## Key Condition
**CLSNG 866**: Cash To Close Cannot Exceed $[amount] Verified Or Return To UW To Verify Additional Assets And Acceptable Source

---
*Updated: 4/18/2023*</pre>
            </div>
        </div>
    </div>

    <div class="copy-success" id="copySuccess">Copied to clipboard!</div>

    <!-- AI Prompt Modal -->
    <div class="modal-overlay prompt-modal" id="promptModal">
        <div class="modal">
            <div class="modal-header">
                <h3 id="promptModalTitle">AI Agent Build Prompt</h3>
                <div class="modal-actions">
                    <button class="modal-btn copy" onclick="copyPromptToClipboard()">Copy Prompt</button>
                    <button class="modal-btn close" onclick="closePromptModal()">X Close</button>
                </div>
            </div>
            <div class="modal-body">
                <div class="prompt-tags" id="promptTags"></div>
                <div class="prompt-section">
                    <h4>Agent Purpose</h4>
                    <div class="prompt-box" id="promptPurpose"></div>
                </div>
                <div class="prompt-section">
                    <h4>Full Build Prompt</h4>
                    <div class="prompt-box" id="promptContent"></div>
                </div>
                <div class="prompt-section">
                    <h4>Integration Points</h4>
                    <div class="prompt-box" id="promptIntegration"></div>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Scroll spy state management
        let isScrolling = false;
        let scrollTimeout = null;

        // Tab switching
        function switchTab(tab) {
            document.querySelectorAll('.sidebar-tab').forEach(t => t.classList.remove('active'));
            document.querySelectorAll('.tab-panel').forEach(p => p.classList.remove('active'));

            if (tab === 'workflow') {
                document.querySelector('.sidebar-tab:not(.agent-tab)').classList.add('active');
                document.getElementById('workflow-panel').classList.add('active');
                document.getElementById('workflow-nav').style.display = 'block';
                document.getElementById('agents-nav').style.display = 'none';
            } else {
                document.querySelector('.sidebar-tab.agent-tab').classList.add('active');
                document.getElementById('agents-panel').classList.add('active');
                document.getElementById('workflow-nav').style.display = 'none';
                document.getElementById('agents-nav').style.display = 'block';
            }

            window.scrollTo(0, 0);
        }

        // Scroll spy with isScrolling flag and 1000ms timeout
        const sections = document.querySelectorAll('.section, .quick-ref');
        const navItems = document.querySelectorAll('#workflow-nav .nav-item');

        function updateActiveNav() {
            if (isScrolling) return;

            let current = '';
            sections.forEach(section => {
                const sectionTop = section.offsetTop - 100;
                if (window.scrollY >= sectionTop) current = section.getAttribute('id');
            });
            navItems.forEach(item => {
                item.classList.remove('active');
                if (item.getAttribute('href') === '#' + current) item.classList.add('active');
            });
        }

        // Nav item click handler with isScrolling flag
        navItems.forEach(item => {
            item.addEventListener('click', function(e) {
                e.preventDefault();
                isScrolling = true;

                // Clear any existing timeout
                if (scrollTimeout) clearTimeout(scrollTimeout);

                // Update active state immediately
                navItems.forEach(nav => nav.classList.remove('active'));
                this.classList.add('active');

                // Scroll to section
                const targetId = this.getAttribute('href').substring(1);
                const targetSection = document.getElementById(targetId);
                if (targetSection) {
                    targetSection.scrollIntoView({ behavior: 'smooth' });
                }

                // Reset isScrolling after 1000ms
                scrollTimeout = setTimeout(() => {
                    isScrolling = false;
                }, 1000);
            });
        });

        window.addEventListener('scroll', updateActiveNav);

        // Modal functions
        function openDocModal() {
            document.getElementById('docModal').classList.add('show');
            document.body.style.overflow = 'hidden';
        }

        function closeDocModal() {
            document.getElementById('docModal').classList.remove('show');
            document.body.style.overflow = '';
        }

        async function copyToClipboard() {
            try {
                const content = document.getElementById('docContent').textContent;
                await navigator.clipboard.writeText(content);
                const success = document.getElementById('copySuccess');
                success.style.display = 'block';
                setTimeout(() => { success.style.display = 'none'; }, 2000);
            } catch (e) { alert('Failed to copy.'); }
        }

        document.addEventListener('keydown', (e) => { if (e.key === 'Escape') { closeDocModal(); closePromptModal(); } });
        document.getElementById('docModal').addEventListener('click', (e) => { if (e.target.id === 'docModal') closeDocModal(); });

        document.addEventListener('DOMContentLoaded', () => { updateActiveNav(); });

        // ====== AGENT PROMPT SYSTEM ======
        const agentPrompts = {
            cdscanner: {
                name: 'CD Credit Scanner Agent',
                tags: ['Document Processing', 'OCR', 'Medium Complexity', 'Critical Priority'],
                purpose: `This agent automatically scans preliminary Closing Disclosures (CDs) from title companies to extract credits and charges from Page 3, Section L. It uses OCR and document understanding to identify tax prorations, earnest money, seller credits, and other items that can be added to the Details of Transaction.`,
                prompt: `You are building a Document Processing Agent for CMG Financial's Byte LOS system.

AGENT NAME: CD Credit Scanner Agent
TYPE: Document Processing / OCR / Data Extraction

OBJECTIVE:
Create an agent that processes preliminary Closing Disclosure PDFs from title companies and extracts all credits and charges from Page 3, Section L that can be used to update the Details of Transaction.

INPUT:
- Preliminary Closing Disclosure PDF (from title company)
- Loan number for reference

EXTRACTION TARGETS (CD Page 3, Section L):
1. Deposit (Earnest Money)
2. Loan Amount
3. Existing Loan(s) Assumed or Taken Subject To
4. Seller Credit
5. Other Credits (lines 04-11):
   - Tax Prorations
   - Texas Option Fee (if applicable)
   - Owner's Title Policy Credit
   - HOA Prorations
   - Utility Prorations
   - Any other Section L credits

OCR PROCESSING STEPS:
1. Receive CD PDF document
2. Navigate to Page 3
3. Locate Section L: "Paid Already by or on Behalf of Borrower at Closing"
4. Extract each line item with:
   - Line number
   - Description
   - Amount
   - Payee/Source (if listed)

OUTPUT FORMAT:
{
  "loanNumber": "12345678",
  "documentDate": "2026-01-15",
  "pageProcessed": 3,
  "sectionL_Credits": [
    {
      "lineNumber": "01",
      "description": "Deposit (Earnest Money)",
      "amount": 500.00,
      "source": "Borrower"
    },
    {
      "lineNumber": "08",
      "description": "Tax Prorations",
      "amount": 250.00,
      "source": "Property Seller"
    }
  ],
  "totalCredits": 750.00,
  "extractionConfidence": 0.98,
  "flaggedItems": []
}

VALIDATION RULES:
- All amounts must be positive numbers
- Descriptions must match standard CD terminology
- Flag any items that appear unusual or require manual review
- Cross-reference total with Section L summary line`,
                integration: `INTEGRATION POINTS:

1. Document Intake
   - Monitor Byte stored documents folder for new CD uploads
   - Accept manual upload via processor interface
   - Support PDF, TIFF, and image formats

2. OCR Engine
   - Use Azure Form Recognizer or AWS Textract
   - Pre-trained on CFPB Closing Disclosure format
   - Confidence threshold: 95% for auto-processing

3. Byte Integration
   - Pass extracted data to DOT Auto-Populate Agent
   - Store extraction results in loan file
   - Log all extractions for audit trail

4. Error Handling
   - Queue low-confidence extractions for manual review
   - Alert processor if document quality is poor
   - Retry with enhanced processing if first pass fails

DEPLOYMENT:
- Cloud function triggered by document upload
- Response time target: < 30 seconds
- Support batch processing for multiple CDs`
            },
            ausmonitor: {
                name: 'AUS Funds Monitor Agent',
                tags: ['Monitoring', 'Alerts', 'Low Complexity', 'High Priority'],
                purpose: `This agent monitors AUS (DU/LP) submissions and automatically alerts processors when a borrower shows short funds to close. It triggers the DOT update workflow and suggests potential credit sources based on loan type and transaction details.`,
                prompt: `You are building a Monitoring Agent for CMG Financial's Byte LOS system.

AGENT NAME: AUS Funds Monitor Agent
TYPE: Real-time Monitoring / Alert System

OBJECTIVE:
Create an agent that monitors AUS findings (Desktop Underwriter and Loan Product Advisor) and automatically detects when a borrower is showing short funds to close, triggering alerts and suggesting remediation actions.

MONITORING TRIGGERS:

1. SHORT FUNDS ALERT
   Trigger when:
   - AUS findings show "Cash to Close" is negative
   - Or verified assets < required funds to close
   - Or AUS returns asset verification warning

   Alert Message:
   "ALERT: Loan #[number] - Borrower [Name] is showing SHORT FUNDS TO CLOSE
   Deficit: $[amount]
   AUS Type: [DU/LP]
   Suggested Action: Review Prelim CD for additional credits
   [View Loan] [Request Prelim CD] [Start DOT Update]"

2. ASSET VERIFICATION WARNING
   Trigger when:
   - AUS returns message about insufficient verified assets
   - Cash reserves fall below program minimum

3. FUNDS IMPROVEMENT NOTIFICATION
   Trigger when:
   - Previously short loan now shows adequate funds
   - After DOT update, confirm funds are sufficient

MONITORING DATA:
{
  "loanNumber": "12345678",
  "borrowerName": "John Smith",
  "ausType": "DU",
  "ausSubmissionDate": "2026-01-15T10:30:00Z",
  "cashToClose": -2500.00,
  "verifiedAssets": 45000.00,
  "requiredFunds": 47500.00,
  "deficit": 2500.00,
  "alertSent": true,
  "processorId": "PROC-5678",
  "suggestedActions": [
    "Request preliminary CD from title",
    "Review for tax prorations",
    "Check for seller credits"
  ]
}

DETECTION LOGIC:
IF ausFindings.cashToClose < 0
   OR ausFindings.verifiedAssets < ausFindings.requiredFunds
THEN
   triggerShortFundsAlert()
   identifyAUSType()
   suggestRemediationActions()`,
                integration: `INTEGRATION POINTS:

1. AUS Submission Webhook
   - Subscribe to Byte AUS submission events
   - Monitor both DU and LP responses
   - Parse AUS findings XML/JSON

2. Alert Channels
   - Byte task queue notification
   - Email to assigned processor
   - Dashboard alert widget
   - Optional: SMS for urgent cases

3. Workflow Triggers
   - Auto-create task: "Request Prelim CD from Title"
   - Queue loan for DOT review
   - Link to DOT update instructions based on AUS type

4. Reporting
   - Track short funds frequency by processor
   - Measure time to resolution
   - Identify common credit sources used

SCALABILITY:
- Process 1000+ AUS submissions per hour
- Real-time alerting (< 60 second latency)
- Support multiple notification preferences per user`
            },
            dotautofill: {
                name: 'DOT Auto-Populate Agent',
                tags: ['Data Entry', 'Automation', 'Medium Complexity', 'High Priority'],
                purpose: `This agent takes extracted credit data from the CD Scanner Agent and automatically populates the Details of Transaction screen in Byte. It detects whether the loan is DU or LP and applies the correct entry method, pre-filling Type, Description, Amount, and Source fields.`,
                prompt: `You are building a Data Entry Automation Agent for CMG Financial's Byte LOS system.

AGENT NAME: DOT Auto-Populate Agent
TYPE: RPA / Form Automation / Data Entry

OBJECTIVE:
Create an agent that receives extracted credit data and automatically populates the correct screens in Byte based on the AUS type (DU vs LP), following the appropriate workflow for each.

INPUT:
{
  "loanNumber": "12345678",
  "ausType": "DU",  // or "LP"
  "credits": [
    {
      "description": "Tax Prorations",
      "amount": 250.00,
      "source": "Property Seller",
      "type": "Other"
    }
  ]
}

DU WORKFLOW AUTOMATION:
1. Navigate to: URLA Lender Loan Info screen
2. Click: Details Of Transaction line M - Other Credits
3. For each credit:
   a. Click Add button in Other Purchase Credits section
   b. Set Type dropdown = "Other"
   c. Override Description = [credit description]
   d. Enter Amount = [amount]
   e. Set Source = [source]
   f. CHECK "Omit from Other Assets" checkbox
   g. Click OK
4. Save changes
5. Return confirmation with entered values

LP WORKFLOW AUTOMATION (Different Process):
1. Navigate to: URLA Borrower Info screen
2. Click Assets tab
3. Remove any "Other" asset from "Other Assets You Have" table
4. Navigate to: Loan Estimate - Page 2 screen
5. For each credit:
   a. Locate the fee being paid by other party
   b. Click Edit next to fee name
   c. Remove amount from "Paid by Borrower" field
   d. Select payer from "Paid by" dropdown
   e. Enter amount being paid
   f. Click OK
6. Save changes
7. Return confirmation

FIELD MAPPING:
Credit Data -> Byte Field (DU)
description -> Description (override)
amount -> Amount
source -> Source dropdown
"Other" -> Type dropdown
TRUE -> Omit from Other Assets

Credit Data -> Byte Field (LP)
description -> Fee identification
amount -> Other party payment amount
source -> Paid by dropdown selection

OUTPUT:
{
  "success": true,
  "loanNumber": "12345678",
  "ausType": "DU",
  "creditsEntered": 2,
  "totalAmount": 750.00,
  "screensUpdated": ["URLA Lender Loan Info"],
  "timestamp": "2026-01-15T11:45:00Z",
  "nextStep": "Re-run AUS Findings"
}`,
                integration: `INTEGRATION POINTS:

1. Byte LOS API/UI Automation
   - Direct API calls if available
   - Or: UI automation via Selenium/Playwright
   - Or: RPA platform (UiPath, Blue Prism)

2. Input Sources
   - Receive data from CD Credit Scanner Agent
   - Accept manual entry from processor interface
   - Support bulk processing

3. Validation
   - Verify loan exists and is accessible
   - Confirm user has edit permissions
   - Check for existing credits to avoid duplicates

4. Post-Entry Actions
   - Trigger AUS re-submission
   - Update loan timeline/notes
   - Notify processor of completion

5. Error Recovery
   - Screenshot on failure
   - Rollback partial entries
   - Queue for manual intervention

SECURITY:
- Use processor's credentials for audit trail
- Log all field changes
- Respect Byte permission levels`
            },
            clsngvalidator: {
                name: 'CLSNG 866 Validator Agent',
                tags: ['Validation', 'Compliance', 'Low Complexity', 'Medium Priority'],
                purpose: `This agent automatically compares the Cash to Close amount from the final Closing Disclosure against the CLSNG 866 condition set at loan approval. It alerts closers if there is a discrepancy and can auto-generate a request to Underwriting if the condition needs to be updated.`,
                prompt: `You are building a Validation Agent for CMG Financial's Byte LOS system.

AGENT NAME: CLSNG 866 Validator Agent
TYPE: Compliance Validation / Condition Monitoring

OBJECTIVE:
Create an agent that validates the Cash to Close figure on the final Closing Disclosure against the CLSNG 866 condition and alerts the appropriate parties if there's a discrepancy.

VALIDATION LOGIC:

1. EXTRACT CLSNG 866 CONDITION
   - Parse condition text: "Cash To Close Cannot Exceed $[amount]"
   - Extract maximum allowed cash to close amount
   - Note any additional requirements (asset verification, etc.)

2. EXTRACT FINAL CD CASH TO CLOSE
   - Read Closing Disc Page 3
   - Calculate: Total Due (K) - Total Paid (L) = Cash to Close
   - Handle both "From Borrower" and "To Borrower" scenarios

3. COMPARE VALUES
   IF finalCD.cashToClose <= clsng866.maxAmount THEN
      status = "PASS"
      message = "Cash to close within approved limits"
   ELSE
      status = "FAIL"
      deficit = finalCD.cashToClose - clsng866.maxAmount
      message = "Cash to close exceeds CLSNG 866 by $" + deficit

4. GENERATE ALERTS/ACTIONS

VALIDATION OUTPUT:
{
  "loanNumber": "12345678",
  "validationDate": "2026-01-15",
  "clsng866": {
    "conditionId": "CLSNG 866",
    "maxCashToClose": 54600.77,
    "conditionText": "Cash To Close Cannot Exceed $54,600.77..."
  },
  "finalCD": {
    "totalDueFromBorrower": 352850.77,
    "totalPaidOnBehalf": 298250.00,
    "cashToClose": 54600.77,
    "direction": "From Borrower"
  },
  "validation": {
    "status": "PASS",
    "difference": 0.00,
    "message": "Cash to close matches CLSNG 866 exactly"
  },
  "nextAction": "Proceed to closing"
}

FAILURE SCENARIOS:
1. Cash to close exceeds condition -> Alert closer, draft UW request
2. Condition not found -> Alert UW to add condition
3. CD not finalized -> Wait and re-check
4. Calculation discrepancy -> Flag for manual review`,
                integration: `INTEGRATION POINTS:

1. Byte Conditions Screen
   - Read CLSNG 866 condition text
   - Parse amount from condition wording
   - Track condition status (PTF, waived, etc.)

2. Closing Disclosure Screen
   - Read final CD Page 3 calculations
   - Support multiple CD revisions
   - Use most recent disclosed figures

3. Alert System
   - Notify closer of validation result
   - Escalate failures to Underwriting queue
   - Auto-generate condition update request

4. Workflow Integration
   - Block closing submission if validation fails
   - Add validation timestamp to loan file
   - Support re-validation after updates

AUTO-GENERATED UW REQUEST (on failure):
Subject: CLSNG 866 Update Required - Loan #[number]
Body:
The final Cash to Close ($[amount]) exceeds the current
CLSNG 866 condition ($[limit]) by $[difference].

Please review and update the condition or verify
additional assets to support the higher cash to close.

Loan: [number]
Borrower: [name]
Final Cash to Close: $[amount]
Current Condition Limit: $[limit]
Difference: $[difference]

COMPLIANCE:
- Log all validations for audit
- Track validation pass/fail rates
- Report on common discrepancy causes`
            }
        };

        // Scroll to agent card and highlight
        function scrollToAgent(agentId) {
            const agentCard = document.getElementById(agentId);
            if (agentCard) {
                document.querySelectorAll('.agent-card.highlight').forEach(card => {
                    card.classList.remove('highlight');
                });

                agentCard.scrollIntoView({ behavior: 'smooth', block: 'center' });

                setTimeout(() => {
                    agentCard.classList.add('highlight');
                }, 300);

                setTimeout(() => {
                    agentCard.classList.remove('highlight');
                }, 2500);
            }
        }

        // Show agent prompt modal
        let currentPromptContent = '';

        function showAgentPrompt(agentKey) {
            const agent = agentPrompts[agentKey];
            if (!agent) return;

            document.getElementById('promptModalTitle').textContent = agent.name + ' - Build Prompt';

            const tagsHtml = agent.tags.map(tag => '<span class="prompt-tag">' + tag + '</span>').join('');
            document.getElementById('promptTags').innerHTML = tagsHtml;

            document.getElementById('promptPurpose').textContent = agent.purpose;
            document.getElementById('promptContent').textContent = agent.prompt;
            document.getElementById('promptIntegration').textContent = agent.integration;

            currentPromptContent = '# ' + agent.name + '\n\n## Purpose\n' + agent.purpose + '\n\n## Build Prompt\n' + agent.prompt + '\n\n## Integration Points\n' + agent.integration;

            document.getElementById('promptModal').classList.add('show');
            document.body.style.overflow = 'hidden';
        }

        function closePromptModal() {
            document.getElementById('promptModal').classList.remove('show');
            document.body.style.overflow = '';
        }

        async function copyPromptToClipboard() {
            try {
                await navigator.clipboard.writeText(currentPromptContent);
                const success = document.getElementById('copySuccess');
                success.style.display = 'block';
                setTimeout(() => { success.style.display = 'none'; }, 2000);
            } catch (e) {
                alert('Failed to copy prompt.');
            }
        }

        document.getElementById('promptModal').addEventListener('click', (e) => {
            if (e.target.id === 'promptModal') closePromptModal();
        });
    </script>
</body>
</html>
