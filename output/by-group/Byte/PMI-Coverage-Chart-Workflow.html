<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Byte PMI Coverage Chart - Process Workflow</title>
    <link href="https://fonts.googleapis.com/css2?family=Plus+Jakarta+Sans:wght@400;500;600;700;800&family=JetBrains+Mono:wght@400;500&display=swap" rel="stylesheet">
    <style>
        :root {
            --bg-primary: #0a0f1a;
            --bg-secondary: #111827;
            --bg-card: #1a2234;
            --accent-blue: #3b82f6;
            --accent-teal: #14b8a6;
            --accent-amber: #f59e0b;
            --accent-rose: #f43f5e;
            --accent-green: #22c55e;
            --accent-purple: #8b5cf6;
            --text-primary: #f1f5f9;
            --text-secondary: #94a3b8;
            --text-muted: #64748b;
            --border-subtle: rgba(255,255,255,0.08);
            --sidebar-width: 280px;
        }

        * { box-sizing: border-box; margin: 0; padding: 0; }
        html { scroll-behavior: smooth; }
        body {
            font-family: 'Plus Jakarta Sans', -apple-system, BlinkMacSystemFont, sans-serif;
            background: var(--bg-primary);
            color: var(--text-primary);
            min-height: 100vh;
        }

        /* Breadcrumb */
        .breadcrumb {
            background: linear-gradient(90deg, #0d1525 0%, #1a2234 100%);
            padding: 14px 25px;
            display: flex;
            align-items: center;
            gap: 12px;
            font-size: 0.95rem;
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            z-index: 1001;
            border-bottom: 1px solid var(--border-subtle);
        }

        .breadcrumb a {
            color: var(--text-secondary);
            text-decoration: none;
            font-weight: 600;
            padding: 8px 16px;
            background: rgba(255,255,255,0.05);
            border-radius: 8px;
            transition: all 0.2s;
            border: 1px solid var(--border-subtle);
        }

        .breadcrumb a:hover {
            background: rgba(59, 130, 246, 0.15);
            color: var(--accent-blue);
            border-color: rgba(59, 130, 246, 0.3);
        }

        .breadcrumb .separator { color: var(--text-muted); font-size: 1.2rem; }
        .breadcrumb .current { color: var(--accent-amber); font-weight: 600; padding: 8px 16px; }

        /* Sidebar */
        .sidebar {
            position: fixed;
            top: 54px;
            left: 0;
            width: var(--sidebar-width);
            height: calc(100vh - 54px);
            background: var(--bg-secondary);
            overflow-y: auto;
            z-index: 1000;
            border-right: 1px solid var(--border-subtle);
            display: flex;
            flex-direction: column;
        }

        .sidebar-header {
            padding: 25px 20px;
            background: rgba(0,0,0,0.3);
            border-bottom: 1px solid var(--border-subtle);
        }

        .sidebar-header h2 { color: var(--text-primary); font-size: 1.2rem; font-weight: 700; margin-bottom: 5px; }
        .sidebar-header p { color: var(--text-muted); font-size: 0.85rem; }

        /* Tab Switch */
        .sidebar-tabs {
            display: flex;
            border-bottom: 1px solid var(--border-subtle);
        }

        .sidebar-tab {
            flex: 1;
            padding: 14px 10px;
            text-align: center;
            font-size: 0.8rem;
            font-weight: 700;
            color: var(--text-muted);
            cursor: pointer;
            transition: all 0.2s;
            border-bottom: 3px solid transparent;
            background: none;
            border-left: none;
            border-right: none;
            border-top: none;
        }

        .sidebar-tab:hover { background: rgba(255,255,255,0.03); color: var(--text-secondary); }
        .sidebar-tab.active { color: var(--accent-blue); border-bottom-color: var(--accent-blue); background: rgba(59, 130, 246, 0.08); }
        .sidebar-tab.agent-tab.active { color: var(--accent-purple); border-bottom-color: var(--accent-purple); background: rgba(139, 92, 246, 0.08); }

        .sidebar-nav { padding: 15px 0; flex: 1; overflow-y: auto; }

        .nav-item {
            display: flex;
            align-items: center;
            gap: 12px;
            padding: 14px 20px;
            color: var(--text-secondary);
            text-decoration: none;
            border-left: 3px solid transparent;
            transition: all 0.2s ease;
            cursor: pointer;
        }

        .nav-item:hover { background: rgba(255,255,255,0.03); color: var(--text-primary); }
        .nav-item.active { background: rgba(59, 130, 246, 0.1); border-left-color: var(--accent-blue); color: var(--text-primary); }

        .nav-number {
            background: rgba(255,255,255,0.1);
            color: var(--text-secondary);
            width: 28px;
            height: 28px;
            border-radius: 8px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 700;
            font-size: 0.85rem;
            flex-shrink: 0;
        }

        .nav-item.active .nav-number { background: var(--accent-blue); color: white; }
        .nav-label { font-size: 0.95rem; font-weight: 500; }

        .sidebar-footer {
            padding: 20px;
            border-top: 1px solid var(--border-subtle);
            background: rgba(0,0,0,0.2);
        }

        .doc-btn {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
            width: 100%;
            padding: 14px 20px;
            background: linear-gradient(135deg, var(--accent-blue) 0%, var(--accent-teal) 100%);
            color: white;
            border: none;
            border-radius: 10px;
            font-weight: 600;
            cursor: pointer;
            transition: transform 0.2s, box-shadow 0.2s;
            text-decoration: none;
            font-size: 0.95rem;
        }

        .doc-btn:hover { transform: translateY(-2px); box-shadow: 0 8px 25px rgba(59, 130, 246, 0.3); }

        /* Main Content */
        .main-content { margin-left: var(--sidebar-width); padding: 80px 40px 40px 40px; }

        /* Tab Panels */
        .tab-panel { display: none; }
        .tab-panel.active { display: block; }

        .header {
            background: var(--bg-card);
            border: 1px solid var(--border-subtle);
            padding: 35px;
            border-radius: 16px;
            margin-bottom: 30px;
            position: relative;
            overflow: hidden;
        }

        .header::before {
            content: '';
            position: absolute;
            top: 0; left: 0; right: 0; bottom: 0;
            background:
                radial-gradient(ellipse at 20% 20%, rgba(59, 130, 246, 0.1) 0%, transparent 50%),
                radial-gradient(ellipse at 80% 80%, rgba(20, 184, 166, 0.08) 0%, transparent 50%);
            pointer-events: none;
        }

        .header h1 {
            font-size: 2.2rem;
            font-weight: 800;
            margin-bottom: 10px;
            position: relative;
            background: linear-gradient(135deg, var(--text-primary) 0%, var(--accent-blue) 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .header .subtitle { color: var(--text-secondary); font-size: 1.1rem; position: relative; }

        .header .meta { display: flex; gap: 15px; margin-top: 20px; flex-wrap: wrap; position: relative; }

        .header .meta-item {
            background: rgba(255,255,255,0.05);
            border: 1px solid var(--border-subtle);
            padding: 8px 16px;
            border-radius: 8px;
            font-size: 0.9rem;
            color: var(--text-secondary);
        }

        /* Legend */
        .legend {
            display: flex;
            flex-wrap: wrap;
            gap: 15px;
            padding: 18px 22px;
            background: var(--bg-card);
            border: 1px solid var(--border-subtle);
            border-radius: 12px;
            margin-bottom: 25px;
        }

        .legend-item { display: flex; align-items: center; gap: 8px; font-size: 0.85rem; color: var(--text-secondary); }
        .legend-color { width: 18px; height: 18px; border-radius: 4px; }

        /* Sections */
        .section {
            background: var(--bg-card);
            border: 1px solid var(--border-subtle);
            border-radius: 16px;
            margin-bottom: 25px;
            overflow: hidden;
            scroll-margin-top: 75px;
        }

        .section-header {
            background: linear-gradient(135deg, var(--bg-secondary) 0%, rgba(59, 130, 246, 0.1) 100%);
            border-bottom: 1px solid var(--border-subtle);
            padding: 22px 25px;
            display: flex;
            align-items: center;
            gap: 18px;
        }

        .section-number {
            background: linear-gradient(135deg, var(--accent-blue) 0%, var(--accent-teal) 100%);
            color: white;
            width: 48px;
            height: 48px;
            border-radius: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 800;
            font-size: 1.3rem;
            flex-shrink: 0;
        }

        .section-title h2 { font-size: 1.35rem; font-weight: 700; margin-bottom: 4px; color: var(--text-primary); }
        .section-title span { font-size: 0.9rem; color: var(--text-muted); }
        .section-content { padding: 28px; }

        /* Workflow Diagrams */
        .workflow-diagram {
            background: rgba(0,0,0,0.3);
            border: 1px solid var(--border-subtle);
            border-radius: 12px;
            padding: 28px;
            margin-bottom: 22px;
        }

        .flow-row { display: flex; align-items: center; justify-content: center; flex-wrap: wrap; gap: 12px; margin: 15px 0; }

        .flow-node {
            padding: 14px 22px;
            border-radius: 10px;
            text-align: center;
            font-size: 0.9rem;
            font-weight: 600;
            min-width: 150px;
            border: 1px solid var(--border-subtle);
        }

        .flow-node.start { background: linear-gradient(135deg, var(--accent-green) 0%, #16a34a 100%); color: white; border-radius: 25px; border: none; }
        .flow-node.action { background: linear-gradient(135deg, var(--accent-blue) 0%, #2563eb 100%); color: white; border: none; }
        .flow-node.decision { background: linear-gradient(135deg, var(--accent-amber) 0%, #d97706 100%); color: var(--bg-primary); border: none; }
        .flow-node.input { background: var(--bg-secondary); border: 2px solid var(--accent-blue); color: var(--text-primary); }
        .flow-node.output { background: linear-gradient(135deg, var(--accent-teal) 0%, #0d9488 100%); color: white; border: none; }
        .flow-node.exception { background: linear-gradient(135deg, var(--accent-rose) 0%, #dc2626 100%); color: white; border: none; }

        .flow-arrow { color: var(--accent-blue); font-size: 1.5rem; }
        .flow-arrow.down { transform: rotate(90deg); }

        .decision-branch { display: flex; gap: 40px; justify-content: center; margin: 20px 0; flex-wrap: wrap; }
        .branch { display: flex; flex-direction: column; align-items: center; gap: 10px; }

        .branch-label {
            background: var(--bg-secondary);
            border: 1px solid var(--border-subtle);
            padding: 6px 16px;
            border-radius: 20px;
            font-size: 0.8rem;
            font-weight: 700;
            color: var(--text-secondary);
        }

        /* Tables */
        .field-table { width: 100%; border-collapse: collapse; margin: 18px 0; }

        .field-table th {
            background: rgba(59, 130, 246, 0.15);
            color: var(--accent-blue);
            padding: 14px 18px;
            text-align: left;
            font-weight: 600;
            font-size: 0.9rem;
            text-transform: uppercase;
            letter-spacing: 0.05em;
            border-bottom: 1px solid var(--border-subtle);
        }

        .field-table td { padding: 14px 18px; border-bottom: 1px solid var(--border-subtle); color: var(--text-secondary); }
        .field-table tr:hover { background: rgba(255,255,255,0.02); }

        .badge { display: inline-block; padding: 4px 12px; border-radius: 6px; font-size: 0.75rem; font-weight: 700; text-transform: uppercase; letter-spacing: 0.05em; }
        .badge.required-badge { background: rgba(244, 63, 94, 0.15); color: var(--accent-rose); }
        .badge.optional-badge { background: rgba(34, 197, 94, 0.15); color: var(--accent-green); }
        .badge.calculated-badge { background: rgba(59, 130, 246, 0.15); color: var(--accent-blue); }

        /* Info Boxes */
        .exception-box, .tip-box, .info-box {
            padding: 18px 22px;
            margin: 18px 0;
            border-radius: 0 10px 10px 0;
            border-left-width: 4px;
            border-left-style: solid;
        }

        .exception-box { background: rgba(244, 63, 94, 0.08); border-color: var(--accent-rose); border: 1px solid rgba(244, 63, 94, 0.2); border-left: 4px solid var(--accent-rose); }
        .exception-box h4 { color: var(--accent-rose); margin-bottom: 10px; font-size: 1rem; }
        .exception-box p, .exception-box li { color: var(--text-secondary); }

        .tip-box { background: rgba(34, 197, 94, 0.08); border-color: var(--accent-green); border: 1px solid rgba(34, 197, 94, 0.2); border-left: 4px solid var(--accent-green); }
        .tip-box h4 { color: var(--accent-green); margin-bottom: 10px; font-size: 1rem; }
        .tip-box p, .tip-box li { color: var(--text-secondary); }

        .info-box { background: rgba(59, 130, 246, 0.08); border-color: var(--accent-blue); border: 1px solid rgba(59, 130, 246, 0.2); border-left: 4px solid var(--accent-blue); }
        .info-box h4 { color: var(--accent-blue); margin-bottom: 10px; font-size: 1rem; }
        .info-box p, .info-box li { color: var(--text-secondary); }

        /* Decision Tree */
        .decision-tree {
            background: rgba(0,0,0,0.2);
            border: 1px solid var(--border-subtle);
            border-radius: 12px;
            padding: 22px;
            margin: 22px 0;
        }

        .decision-tree h3 { color: var(--accent-blue); margin-bottom: 18px; padding-bottom: 12px; border-bottom: 1px solid var(--border-subtle); font-size: 1.1rem; }

        .tree-node { margin-left: 20px; padding: 12px; border-left: 2px solid var(--accent-teal); position: relative; color: var(--text-secondary); }
        .tree-node::before { content: ''; position: absolute; left: -2px; top: 22px; width: 15px; height: 2px; background: var(--accent-teal); }
        .tree-node.level-1 { margin-left: 0; border-left: none; }
        .tree-node.level-1::before { display: none; }

        .tree-label { background: var(--accent-amber); color: var(--bg-primary); padding: 6px 14px; border-radius: 6px; font-weight: 700; display: inline-block; margin-bottom: 6px; font-size: 0.9rem; }

        /* Summary Grid */
        .summary-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(180px, 1fr)); gap: 18px; margin: 22px 0; }

        .summary-card { background: rgba(0,0,0,0.3); border: 1px solid var(--border-subtle); border-radius: 12px; padding: 22px; text-align: center; }
        .summary-card h4 { color: var(--text-secondary); margin-bottom: 12px; font-size: 0.9rem; }
        .summary-card .value {
            font-size: 2.2rem;
            font-weight: 800;
            background: linear-gradient(135deg, var(--accent-blue) 0%, var(--accent-teal) 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }
        .summary-card .label { font-size: 0.85rem; color: var(--text-muted); margin-top: 8px; }

        /* MI Comparison Cards */
        .mi-comparison { display: grid; grid-template-columns: repeat(auto-fit, minmax(280px, 1fr)); gap: 20px; margin: 22px 0; }

        .mi-card { background: rgba(0,0,0,0.2); border: 1px solid var(--border-subtle); border-radius: 12px; overflow: hidden; }
        .mi-card-header { background: linear-gradient(135deg, var(--accent-blue) 0%, var(--accent-teal) 100%); color: white; padding: 18px; text-align: center; }
        .mi-card-header h4 { font-size: 1.05rem; }
        .mi-card-body { padding: 22px; }
        .mi-card ul { list-style: none; padding: 0; }
        .mi-card li { padding: 10px 0; border-bottom: 1px solid var(--border-subtle); display: flex; align-items: center; gap: 12px; color: var(--text-secondary); font-size: 0.95rem; }
        .mi-card li:last-child { border-bottom: none; }
        .check-icon { color: var(--accent-green); font-weight: bold; }
        .x-icon { color: var(--accent-rose); font-weight: bold; }

        /* Quick Reference */
        .quick-ref {
            background: linear-gradient(135deg, var(--bg-secondary) 0%, var(--bg-card) 100%);
            border: 1px solid var(--border-subtle);
            padding: 28px;
            border-radius: 16px;
            margin-top: 30px;
            font-family: 'JetBrains Mono', monospace;
        }

        .quick-ref h3 { color: var(--accent-amber); margin-bottom: 18px; font-family: 'Plus Jakarta Sans', sans-serif; }
        .quick-ref pre { background: rgba(0,0,0,0.4); border: 1px solid var(--border-subtle); padding: 20px; border-radius: 10px; overflow-x: auto; font-size: 0.85rem; line-height: 1.7; color: var(--text-secondary); }

        /* ====== AGENT OPPORTUNITIES STYLES ====== */
        .agent-header {
            background: var(--bg-card);
            border: 1px solid var(--border-subtle);
            padding: 35px;
            border-radius: 16px;
            margin-bottom: 30px;
            position: relative;
            overflow: hidden;
        }

        .agent-header::before {
            content: '';
            position: absolute;
            top: 0; left: 0; right: 0; bottom: 0;
            background:
                radial-gradient(ellipse at 20% 20%, rgba(139, 92, 246, 0.12) 0%, transparent 50%),
                radial-gradient(ellipse at 80% 80%, rgba(245, 158, 11, 0.1) 0%, transparent 50%);
            pointer-events: none;
        }

        .agent-header h1 {
            font-size: 2.2rem;
            font-weight: 800;
            margin-bottom: 10px;
            position: relative;
            background: linear-gradient(135deg, var(--accent-purple) 0%, var(--accent-amber) 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .agent-header .subtitle { color: var(--text-secondary); font-size: 1.1rem; position: relative; }

        /* Heat Map */
        .heat-map-container { margin-bottom: 35px; }
        .heat-map-title { font-size: 1.3rem; font-weight: 700; color: var(--text-primary); margin-bottom: 20px; display: flex; align-items: center; gap: 12px; }

        .heat-map-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
        }

        .heat-item {
            background: var(--bg-card);
            border: 1px solid var(--border-subtle);
            border-radius: 12px;
            padding: 20px;
            position: relative;
            overflow: hidden;
            transition: transform 0.2s, box-shadow 0.2s;
            cursor: pointer;
        }

        .heat-item:hover { transform: translateY(-3px); box-shadow: 0 10px 30px rgba(0,0,0,0.3); }
        .heat-item:active { transform: scale(0.98); }

        .heat-item::before {
            content: '';
            position: absolute;
            top: 0; left: 0; right: 0; height: 4px;
        }

        .heat-item.critical::before { background: linear-gradient(90deg, #ef4444, #f97316); }
        .heat-item.high::before { background: linear-gradient(90deg, #f97316, #eab308); }
        .heat-item.medium::before { background: linear-gradient(90deg, #eab308, #22c55e); }
        .heat-item.low::before { background: linear-gradient(90deg, #22c55e, #14b8a6); }

        .heat-score {
            position: absolute;
            top: 15px;
            right: 15px;
            font-size: 1.8rem;
            font-weight: 800;
        }

        .heat-item.critical .heat-score { color: #ef4444; }
        .heat-item.high .heat-score { color: #f97316; }
        .heat-item.medium .heat-score { color: #eab308; }
        .heat-item.low .heat-score { color: #22c55e; }

        .heat-name { font-size: 1rem; font-weight: 700; color: var(--text-primary); margin-bottom: 6px; padding-right: 50px; }
        .heat-desc { font-size: 0.85rem; color: var(--text-muted); margin-bottom: 12px; }

        .heat-metrics { display: flex; gap: 15px; margin-top: 12px; }
        .heat-metric { font-size: 0.75rem; color: var(--text-muted); }
        .heat-metric span { color: var(--text-secondary); font-weight: 600; }

        /* Agent Cards */
        .agent-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(380px, 1fr)); gap: 25px; margin-bottom: 35px; }

        .agent-card {
            background: var(--bg-card);
            border: 1px solid var(--border-subtle);
            border-radius: 16px;
            overflow: hidden;
            transition: transform 0.2s, box-shadow 0.2s;
        }

        .agent-card:hover { transform: translateY(-5px); box-shadow: 0 15px 50px rgba(0,0,0,0.3); }

        .agent-card.highlight {
            animation: highlightPulse 2s ease;
            box-shadow: 0 0 0 3px var(--accent-purple), 0 15px 50px rgba(139, 92, 246, 0.4);
        }

        @keyframes highlightPulse {
            0% { box-shadow: 0 0 0 3px var(--accent-purple), 0 15px 50px rgba(139, 92, 246, 0.6); }
            50% { box-shadow: 0 0 0 6px rgba(139, 92, 246, 0.5), 0 15px 50px rgba(139, 92, 246, 0.3); }
            100% { box-shadow: 0 0 0 0px transparent, 0 15px 50px rgba(0,0,0,0.3); }
        }

        .agent-card-header {
            padding: 22px;
            display: flex;
            align-items: flex-start;
            gap: 18px;
            border-bottom: 1px solid var(--border-subtle);
        }

        .agent-icon {
            width: 55px;
            height: 55px;
            background: linear-gradient(135deg, var(--accent-purple) 0%, var(--accent-blue) 100%);
            border-radius: 14px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.6rem;
            flex-shrink: 0;
        }

        .agent-info { flex: 1; }
        .agent-name { font-size: 1.15rem; font-weight: 700; color: var(--text-primary); margin-bottom: 5px; }
        .agent-type { font-size: 0.8rem; color: var(--accent-purple); font-weight: 600; text-transform: uppercase; letter-spacing: 0.05em; }

        .agent-priority {
            padding: 6px 12px;
            border-radius: 20px;
            font-size: 0.75rem;
            font-weight: 700;
            text-transform: uppercase;
        }

        .agent-priority.critical { background: rgba(239, 68, 68, 0.15); color: #ef4444; }
        .agent-priority.high { background: rgba(249, 115, 22, 0.15); color: #f97316; }
        .agent-priority.medium { background: rgba(234, 179, 8, 0.15); color: #eab308; }
        .agent-priority.low { background: rgba(34, 197, 94, 0.15); color: #22c55e; }

        .agent-card-body { padding: 22px; }
        .agent-description { font-size: 0.95rem; color: var(--text-secondary); line-height: 1.6; margin-bottom: 20px; }

        .agent-flow {
            background: rgba(0,0,0,0.3);
            border: 1px solid var(--border-subtle);
            border-radius: 10px;
            padding: 18px;
            margin-bottom: 20px;
        }

        .agent-flow-title { font-size: 0.85rem; color: var(--text-muted); margin-bottom: 12px; font-weight: 600; text-transform: uppercase; letter-spacing: 0.05em; }

        .agent-flow-diagram { display: flex; align-items: center; flex-wrap: wrap; gap: 8px; justify-content: center; }

        .agent-step {
            background: linear-gradient(135deg, var(--accent-purple) 0%, var(--accent-blue) 100%);
            color: white;
            padding: 8px 14px;
            border-radius: 6px;
            font-size: 0.8rem;
            font-weight: 600;
            white-space: nowrap;
        }

        .agent-arrow { color: var(--accent-purple); font-size: 1.2rem; }

        .agent-stats { display: grid; grid-template-columns: repeat(3, 1fr); gap: 12px; }

        .agent-stat {
            background: rgba(0,0,0,0.2);
            border-radius: 8px;
            padding: 12px;
            text-align: center;
        }

        .agent-stat-value {
            font-size: 1.3rem;
            font-weight: 800;
            background: linear-gradient(135deg, var(--accent-purple) 0%, var(--accent-amber) 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .agent-stat-label { font-size: 0.7rem; color: var(--text-muted); text-transform: uppercase; letter-spacing: 0.05em; margin-top: 4px; }

        .agent-prompt-btn {
            width: 100%;
            margin-top: 18px;
            padding: 14px 20px;
            background: linear-gradient(135deg, rgba(139, 92, 246, 0.2) 0%, rgba(59, 130, 246, 0.2) 100%);
            border: 1px solid rgba(139, 92, 246, 0.4);
            border-radius: 10px;
            color: var(--accent-purple);
            font-weight: 700;
            cursor: pointer;
            transition: all 0.2s;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
            font-size: 0.9rem;
        }

        .agent-prompt-btn:hover {
            background: linear-gradient(135deg, rgba(139, 92, 246, 0.3) 0%, rgba(59, 130, 246, 0.3) 100%);
            border-color: var(--accent-purple);
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(139, 92, 246, 0.25);
        }

        /* Summary Stats */
        .agent-summary {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin-bottom: 35px;
        }

        .agent-summary-card {
            background: var(--bg-card);
            border: 1px solid var(--border-subtle);
            border-radius: 14px;
            padding: 25px;
            text-align: center;
        }

        .agent-summary-value {
            font-size: 2.5rem;
            font-weight: 800;
            background: linear-gradient(135deg, var(--accent-purple) 0%, var(--accent-amber) 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .agent-summary-label { font-size: 0.9rem; color: var(--text-muted); margin-top: 8px; }

        /* Heat Map Legend */
        .heat-legend {
            display: flex;
            gap: 25px;
            padding: 18px 22px;
            background: var(--bg-card);
            border: 1px solid var(--border-subtle);
            border-radius: 12px;
            margin-bottom: 25px;
            flex-wrap: wrap;
        }

        .heat-legend-item { display: flex; align-items: center; gap: 10px; font-size: 0.9rem; color: var(--text-secondary); }
        .heat-legend-color { width: 24px; height: 24px; border-radius: 6px; }

        /* Modal */
        .modal-overlay {
            display: none;
            position: fixed;
            top: 0; left: 0; right: 0; bottom: 0;
            background: rgba(10, 15, 26, 0.9);
            z-index: 2000;
            justify-content: center;
            align-items: center;
            padding: 20px;
            backdrop-filter: blur(5px);
        }

        .modal-overlay.show { display: flex; }

        .modal {
            background: var(--bg-card);
            border: 1px solid var(--border-subtle);
            border-radius: 16px;
            width: 100%;
            max-width: 950px;
            max-height: 90vh;
            display: flex;
            flex-direction: column;
            box-shadow: 0 25px 80px rgba(0,0,0,0.5);
        }

        .modal-header {
            background: linear-gradient(135deg, var(--accent-blue) 0%, var(--accent-teal) 100%);
            color: white;
            padding: 22px 28px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            border-radius: 16px 16px 0 0;
        }

        .modal-header h3 { font-size: 1.25rem; font-weight: 700; }
        .modal-actions { display: flex; gap: 12px; }

        .modal-btn {
            padding: 10px 18px;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-weight: 700;
            transition: transform 0.2s;
            font-size: 0.9rem;
        }

        .modal-btn:hover { transform: scale(1.05); }
        .modal-btn.copy { background: white; color: var(--accent-blue); }
        .modal-btn.close { background: rgba(255,255,255,0.2); color: white; }

        .modal-body { padding: 28px; overflow-y: auto; flex: 1; }

        .modal-body pre {
            background: rgba(0,0,0,0.3);
            border: 1px solid var(--border-subtle);
            padding: 22px;
            border-radius: 10px;
            font-family: 'JetBrains Mono', monospace;
            font-size: 0.9rem;
            line-height: 1.7;
            white-space: pre-wrap;
            word-wrap: break-word;
            color: var(--text-secondary);
        }

        .copy-success {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: var(--accent-green);
            color: white;
            padding: 18px 35px;
            border-radius: 10px;
            font-weight: 700;
            z-index: 3000;
            display: none;
            animation: fadeInOut 2s ease;
        }

        @keyframes fadeInOut { 0%, 100% { opacity: 0; } 10%, 90% { opacity: 1; } }

        /* Prompt Modal Styles */
        .prompt-modal .modal { max-width: 800px; }
        .prompt-modal .modal-header { background: linear-gradient(135deg, var(--accent-purple) 0%, var(--accent-blue) 100%); }

        .prompt-section { margin-bottom: 25px; }
        .prompt-section h4 { color: var(--accent-purple); font-size: 1rem; margin-bottom: 12px; display: flex; align-items: center; gap: 8px; }

        .prompt-box {
            background: rgba(0,0,0,0.4);
            border: 1px solid var(--border-subtle);
            border-radius: 10px;
            padding: 20px;
            font-family: 'JetBrains Mono', monospace;
            font-size: 0.85rem;
            line-height: 1.7;
            color: var(--text-secondary);
            white-space: pre-wrap;
            word-wrap: break-word;
        }

        .prompt-tags { display: flex; gap: 10px; flex-wrap: wrap; margin-bottom: 20px; }
        .prompt-tag { background: rgba(139, 92, 246, 0.15); color: var(--accent-purple); padding: 6px 14px; border-radius: 20px; font-size: 0.8rem; font-weight: 600; }

        @media (max-width: 900px) {
            .sidebar { display: none; }
            .main-content { margin-left: 0; padding: 75px 20px 30px 20px; }
            .agent-grid { grid-template-columns: 1fr; }
        }
            .breadcrumb-logo-link { display: flex; align-items: center; padding: 4px 8px; background: rgba(255,255,255,0.08); border-radius: 8px; border: 1px solid rgba(255,255,255,0.12); transition: all 0.2s; }
        .breadcrumb-logo-link:hover { background: rgba(255,255,255,0.15); }
        .breadcrumb-logo { height: 28px; width: auto; }
    </style>
</head>
<body>
    <!-- Breadcrumb -->
    <nav class="breadcrumb">
        <a href="../../index.html" class="breadcrumb-logo-link"><img src="../../images/clear-ai-logo.png" alt="Clear AI" class="breadcrumb-logo"></a>
        <a href="../../index.html">Portal Home</a>
        <span class="separator">></span>
        <a href="./index.html">Byte</a>
        <span class="separator">></span>
        <span class="current">PMI Coverage Chart</span>
    </nav>

    <!-- Fixed Sidebar -->
    <aside class="sidebar">
        <div class="sidebar-header">
            <h2>PMI Coverage Chart</h2>
            <p>Interactive Workflow Guide</p>
        </div>

        <!-- Tab Switcher -->
        <div class="sidebar-tabs">
            <button class="sidebar-tab active" onclick="switchTab('workflow')">Workflow</button>
            <button class="sidebar-tab agent-tab" onclick="switchTab('agents')">AI Agents</button>
        </div>

        <!-- Workflow Navigation -->
        <nav class="sidebar-nav" id="workflow-nav">
            <a href="#section-0" class="nav-item active">
                <span class="nav-number">0</span>
                <span class="nav-label">Overview</span>
            </a>
            <a href="#section-1" class="nav-item">
                <span class="nav-number">1</span>
                <span class="nav-label">Standard Coverage</span>
            </a>
            <a href="#section-2" class="nav-item">
                <span class="nav-number">2</span>
                <span class="nav-label">Fixed < 20 Years</span>
            </a>
            <a href="#section-3" class="nav-item">
                <span class="nav-number">3</span>
                <span class="nav-label">Fixed > 20 Years/ARM</span>
            </a>
            <a href="#section-4" class="nav-item">
                <span class="nav-number">4</span>
                <span class="nav-label">Manufactured Homes</span>
            </a>
            <a href="#section-5" class="nav-item">
                <span class="nav-number">5</span>
                <span class="nav-label">Special Programs</span>
            </a>
            <a href="#quick-ref" class="nav-item">
                <span class="nav-number">*</span>
                <span class="nav-label">Quick Reference</span>
            </a>
        </nav>

        <!-- Agent Navigation -->
        <nav class="sidebar-nav" id="agents-nav" style="display: none;">
            <a href="#agent-summary" class="nav-item active">
                <span class="nav-number">S</span>
                <span class="nav-label">Summary</span>
            </a>
            <a href="#agent-heatmap" class="nav-item">
                <span class="nav-number">H</span>
                <span class="nav-label">Heat Map</span>
            </a>
            <a href="#agent-details" class="nav-item">
                <span class="nav-number">A</span>
                <span class="nav-label">Agent Details</span>
            </a>
        </nav>

        <div class="sidebar-footer">
            <button class="doc-btn" onclick="openDocModal()">
                View Workflow Markdown
            </button>
        </div>
    </aside>

    <!-- Main Content -->
    <main class="main-content">

        <!-- ==================== WORKFLOW TAB ==================== -->
        <div id="workflow-panel" class="tab-panel active">
            <!-- Header -->
            <div class="header">
                <h1>PMI Coverage Chart</h1>
                <p class="subtitle">Private Mortgage Insurance Coverage Requirements by LTV and Product Type</p>
                <div class="meta">
                    <span class="meta-item">System: Byte</span>
                    <span class="meta-item">Role: Processor / Underwriter</span>
                    <span class="meta-item">Updated: Jan 27, 2026</span>
                    <span class="meta-item">Duration: Reference Guide</span>
                </div>
            </div>

            <!-- Legend -->
            <div class="legend">
                <div class="legend-item"><div class="legend-color" style="background: linear-gradient(135deg, #22c55e, #16a34a);"></div><span>Start/End</span></div>
                <div class="legend-item"><div class="legend-color" style="background: linear-gradient(135deg, #3b82f6, #2563eb);"></div><span>Action Step</span></div>
                <div class="legend-item"><div class="legend-color" style="background: linear-gradient(135deg, #f59e0b, #d97706);"></div><span>Decision Point</span></div>
                <div class="legend-item"><div class="legend-color" style="background: #111827; border: 2px solid #3b82f6;"></div><span>User Input</span></div>
                <div class="legend-item"><div class="legend-color" style="background: linear-gradient(135deg, #f43f5e, #dc2626);"></div><span>Exception</span></div>
                <div class="legend-item"><div class="legend-color" style="background: linear-gradient(135deg, #14b8a6, #0d9488);"></div><span>Output</span></div>
            </div>

            <!-- Section 0: Overview -->
            <section id="section-0" class="section">
                <div class="section-header">
                    <div class="section-number">0</div>
                    <div class="section-title"><h2>PMI Coverage Overview</h2><span>Understanding MI Standard Coverage Requirements</span></div>
                </div>
                <div class="section-content">
                    <div class="workflow-diagram">
                        <div class="flow-row">
                            <div class="flow-node start">Start: LTV > 80%</div>
                            <span class="flow-arrow">-></span>
                            <div class="flow-node decision">Loan Type?</div>
                        </div>
                        <div class="decision-branch">
                            <div class="branch">
                                <span class="branch-label">Conventional</span>
                                <span class="flow-arrow down">v</span>
                                <div class="flow-node action">PMI Required</div>
                            </div>
                            <div class="branch">
                                <span class="branch-label">Government</span>
                                <span class="flow-arrow down">v</span>
                                <div class="flow-node output">MIP/Funding Fee</div>
                            </div>
                        </div>
                    </div>

                    <div class="summary-grid">
                        <div class="summary-card">
                            <h4>LTV Ranges</h4>
                            <div class="value">4</div>
                            <div class="label">Coverage tiers defined</div>
                        </div>
                        <div class="summary-card">
                            <h4>Coverage Range</h4>
                            <div class="value">6-35%</div>
                            <div class="label">Based on LTV and term</div>
                        </div>
                        <div class="summary-card">
                            <h4>Max LTV</h4>
                            <div class="value">97%</div>
                            <div class="label">With appropriate MI</div>
                        </div>
                    </div>

                    <div class="info-box">
                        <h4>Key Principle</h4>
                        <p>PMI coverage percentage increases as LTV increases. Higher risk (higher LTV) requires more coverage to protect the lender against potential loss.</p>
                    </div>

                    <div class="tip-box">
                        <h4>Pro Tip</h4>
                        <p>Coverage requirements differ based on loan term (under/over 20 years) and property type (standard vs manufactured homes). Always verify which chart applies to your scenario.</p>
                    </div>
                </div>
            </section>

            <!-- Section 1: Standard Coverage -->
            <section id="section-1" class="section">
                <div class="section-header">
                    <div class="section-number">1</div>
                    <div class="section-title"><h2>MI Standard Coverage</h2><span>Non-Manufactured Home Properties</span></div>
                </div>
                <div class="section-content">
                    <div class="workflow-diagram">
                        <h3 style="text-align: center; margin-bottom: 22px; color: var(--accent-blue);">Coverage Selection Flow</h3>
                        <div class="flow-row">
                            <div class="flow-node input">Enter Loan Details</div>
                        </div>
                        <div class="flow-row"><span class="flow-arrow down">v</span></div>
                        <div class="flow-row">
                            <div class="flow-node decision">Loan Term?</div>
                        </div>
                        <div class="decision-branch">
                            <div class="branch">
                                <span class="branch-label">< 20 Years</span>
                                <span class="flow-arrow down">v</span>
                                <div class="flow-node action">Lower Coverage</div>
                            </div>
                            <div class="branch">
                                <span class="branch-label">>= 20 Years or ARM</span>
                                <span class="flow-arrow down">v</span>
                                <div class="flow-node action">Higher Coverage</div>
                            </div>
                        </div>
                        <div class="flow-row"><span class="flow-arrow down">v</span></div>
                        <div class="flow-row">
                            <div class="flow-node output">Apply Coverage %</div>
                        </div>
                    </div>

                    <div class="mi-comparison">
                        <div class="mi-card">
                            <div class="mi-card-header"><h4>Fixed Rate < 20 Years</h4></div>
                            <div class="mi-card-body">
                                <ul>
                                    <li><span class="check-icon">*</span> 80.01-85% LTV = 6% coverage</li>
                                    <li><span class="check-icon">*</span> 85.01-90% LTV = 12% coverage</li>
                                    <li><span class="check-icon">*</span> 90.01-95% LTV = 25% coverage</li>
                                    <li><span class="check-icon">*</span> 95.01-97% LTV = 35% coverage</li>
                                </ul>
                            </div>
                        </div>
                        <div class="mi-card">
                            <div class="mi-card-header"><h4>Fixed > 20 Years / ARM</h4></div>
                            <div class="mi-card-body">
                                <ul>
                                    <li><span class="check-icon">*</span> 80.01-85% LTV = 12% coverage</li>
                                    <li><span class="check-icon">*</span> 85.01-90% LTV = 25% coverage</li>
                                    <li><span class="check-icon">*</span> 90.01-95% LTV = 30% coverage</li>
                                    <li><span class="check-icon">*</span> 95.01-97% LTV = 35% coverage</li>
                                </ul>
                            </div>
                        </div>
                    </div>

                    <div class="exception-box">
                        <h4>Important Note</h4>
                        <p>ARM loans always use the higher coverage tier (same as Fixed Rate > 20 Years) regardless of actual term length due to increased rate risk.</p>
                    </div>
                </div>
            </section>

            <!-- Section 2: Fixed < 20 Years -->
            <section id="section-2" class="section">
                <div class="section-header">
                    <div class="section-number">2</div>
                    <div class="section-title"><h2>Fixed Rate Term < 20 Years</h2><span>Lower coverage requirements for shorter terms</span></div>
                </div>
                <div class="section-content">
                    <table class="field-table">
                        <thead>
                            <tr>
                                <th>LTV Range</th>
                                <th>Coverage Required</th>
                                <th>Risk Level</th>
                                <th>Notes</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td><strong style="color: var(--text-primary);">80.01% - 85.00%</strong></td>
                                <td><span class="badge calculated-badge">6%</span></td>
                                <td>Low</td>
                                <td>Minimum PMI coverage tier</td>
                            </tr>
                            <tr>
                                <td><strong style="color: var(--text-primary);">85.01% - 90.00%</strong></td>
                                <td><span class="badge calculated-badge">12%</span></td>
                                <td>Moderate</td>
                                <td>Standard coverage level</td>
                            </tr>
                            <tr>
                                <td><strong style="color: var(--text-primary);">90.01% - 95.00%</strong></td>
                                <td><span class="badge calculated-badge">25%</span></td>
                                <td>Elevated</td>
                                <td>High LTV coverage</td>
                            </tr>
                            <tr>
                                <td><strong style="color: var(--text-primary);">95.01% - 97.00%</strong></td>
                                <td><span class="badge required-badge">35%</span></td>
                                <td>High</td>
                                <td>Maximum coverage tier</td>
                            </tr>
                        </tbody>
                    </table>

                    <div class="tip-box">
                        <h4>Why Lower Coverage?</h4>
                        <p>Shorter loan terms have faster equity build-up through principal payments, reducing the lender's exposure to loss over time. This justifies lower MI coverage requirements.</p>
                    </div>

                    <div class="decision-tree">
                        <h3>Coverage Calculation Example</h3>
                        <div class="tree-node level-1">
                            <span class="tree-label">Scenario: 15-Year Fixed, 88% LTV</span>
                        </div>
                        <div class="tree-node">
                            LTV 88% falls in 85.01% - 90.00% range
                        </div>
                        <div class="tree-node">
                            Term < 20 years = Use left column
                        </div>
                        <div class="tree-node">
                            <strong style="color: var(--accent-green);">Result: 12% MI Coverage Required</strong>
                        </div>
                    </div>
                </div>
            </section>

            <!-- Section 3: Fixed > 20 Years / ARM -->
            <section id="section-3" class="section">
                <div class="section-header">
                    <div class="section-number">3</div>
                    <div class="section-title"><h2>Fixed Rate > 20 Years & ARM Loans</h2><span>Higher coverage for longer terms and adjustable rates</span></div>
                </div>
                <div class="section-content">
                    <table class="field-table">
                        <thead>
                            <tr>
                                <th>LTV Range</th>
                                <th>Coverage Required</th>
                                <th>Applies To</th>
                                <th>Notes</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td><strong style="color: var(--text-primary);">80.01% - 85.00%</strong></td>
                                <td><span class="badge calculated-badge">12%</span></td>
                                <td>30-Yr Fixed, 25-Yr Fixed, ARMs</td>
                                <td>2x coverage vs < 20 yr term</td>
                            </tr>
                            <tr>
                                <td><strong style="color: var(--text-primary);">85.01% - 90.00%</strong></td>
                                <td><span class="badge calculated-badge">25%</span></td>
                                <td>30-Yr Fixed, 25-Yr Fixed, ARMs</td>
                                <td>2x coverage vs < 20 yr term</td>
                            </tr>
                            <tr>
                                <td><strong style="color: var(--text-primary);">90.01% - 95.00%</strong></td>
                                <td><span class="badge required-badge">30%</span></td>
                                <td>30-Yr Fixed, 25-Yr Fixed, ARMs</td>
                                <td>Higher risk tier</td>
                            </tr>
                            <tr>
                                <td><strong style="color: var(--text-primary);">95.01% - 97.00%</strong></td>
                                <td><span class="badge required-badge">35%</span></td>
                                <td>30-Yr Fixed, 25-Yr Fixed, ARMs</td>
                                <td>Maximum - same as < 20 yr</td>
                            </tr>
                        </tbody>
                    </table>

                    <div class="exception-box">
                        <h4>ARM Loan Rule</h4>
                        <p><strong>ALL ARM loans</strong> use these higher coverage percentages regardless of the initial fixed period (5/1 ARM, 7/1 ARM, 10/1 ARM, etc.). The rate adjustment risk requires additional protection.</p>
                    </div>

                    <div class="workflow-diagram">
                        <h3 style="text-align: center; margin-bottom: 22px; color: var(--accent-blue);">Quick Comparison: Same LTV, Different Terms</h3>
                        <div class="flow-row">
                            <div class="flow-node input">LTV: 87%</div>
                        </div>
                        <div class="decision-branch">
                            <div class="branch">
                                <span class="branch-label">15-Year Fixed</span>
                                <span class="flow-arrow down">v</span>
                                <div class="flow-node action">12% Coverage</div>
                            </div>
                            <div class="branch">
                                <span class="branch-label">30-Year Fixed</span>
                                <span class="flow-arrow down">v</span>
                                <div class="flow-node output">25% Coverage</div>
                            </div>
                            <div class="branch">
                                <span class="branch-label">5/1 ARM</span>
                                <span class="flow-arrow down">v</span>
                                <div class="flow-node output">25% Coverage</div>
                            </div>
                        </div>
                    </div>
                </div>
            </section>

            <!-- Section 4: Manufactured Homes -->
            <section id="section-4" class="section">
                <div class="section-header">
                    <div class="section-number">4</div>
                    <div class="section-title"><h2>Manufactured Homes</h2><span>Special coverage requirements for manufactured housing</span></div>
                </div>
                <div class="section-content">
                    <table class="field-table">
                        <thead>
                            <tr>
                                <th>Transaction Type</th>
                                <th>80.01-85%</th>
                                <th>85.01-90%</th>
                                <th>90.01-95%</th>
                                <th>95.01-97%</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td><strong style="color: var(--text-primary);">Fixed Rate, ARM, All Terms</strong></td>
                                <td><span class="badge calculated-badge">12%</span></td>
                                <td><span class="badge calculated-badge">25%</span></td>
                                <td><span class="badge required-badge">30%</span></td>
                                <td><span class="badge required-badge">N/A</span></td>
                            </tr>
                            <tr>
                                <td><strong style="color: var(--text-primary);">HomeReady & Home Possible*</strong></td>
                                <td><span class="badge calculated-badge">12%</span></td>
                                <td><span class="badge calculated-badge">25%</span></td>
                                <td><span class="badge optional-badge">25%</span></td>
                                <td><span class="badge required-badge">N/A</span></td>
                            </tr>
                        </tbody>
                    </table>

                    <div class="exception-box">
                        <h4>95.01-97% LTV Not Available</h4>
                        <p>Manufactured homes are <strong>NOT eligible</strong> for LTV above 95%. Maximum LTV for manufactured housing is capped at 95.00%.</p>
                    </div>

                    <div class="info-box">
                        <h4>HomeReady / Home Possible Advantage</h4>
                        <p>At the 90.01-95% LTV tier, HomeReady and Home Possible programs require only <strong>25%</strong> coverage vs <strong>30%</strong> for standard transactions - a 5% coverage reduction that translates to lower MI premiums for eligible borrowers.</p>
                    </div>

                    <div class="tip-box">
                        <h4>*Program Eligibility</h4>
                        <p>Refer to HomeReady & Home Possible matrices for complete eligibility requirements including income limits, property location, and first-time homebuyer status.</p>
                    </div>

                    <div class="decision-tree">
                        <h3>Manufactured Home Coverage Decision</h3>
                        <div class="tree-node level-1">
                            <span class="tree-label">Is Property a Manufactured Home?</span>
                        </div>
                        <div class="tree-node">
                            <span class="tree-label" style="background: var(--accent-green); color: white;">YES</span> -> Use Manufactured Home chart (no term distinction)
                        </div>
                        <div class="tree-node">
                            <span class="tree-label" style="background: var(--text-muted); color: white;">NO</span> -> Use Standard Coverage chart (term matters)
                        </div>
                    </div>
                </div>
            </section>

            <!-- Section 5: Special Programs -->
            <section id="section-5" class="section">
                <div class="section-header">
                    <div class="section-number">5</div>
                    <div class="section-title"><h2>Special Program Considerations</h2><span>HomeReady, Home Possible, and other programs</span></div>
                </div>
                <div class="section-content">
                    <div class="mi-comparison">
                        <div class="mi-card">
                            <div class="mi-card-header"><h4>HomeReady (Fannie Mae)</h4></div>
                            <div class="mi-card-body">
                                <ul>
                                    <li><span class="check-icon">*</span> Income limits apply (AMI-based)</li>
                                    <li><span class="check-icon">*</span> Reduced MI for manufactured homes</li>
                                    <li><span class="check-icon">*</span> 97% LTV allowed (non-mfg)</li>
                                    <li><span class="check-icon">*</span> Homebuyer education may be required</li>
                                </ul>
                            </div>
                        </div>
                        <div class="mi-card">
                            <div class="mi-card-header"><h4>Home Possible (Freddie Mac)</h4></div>
                            <div class="mi-card-body">
                                <ul>
                                    <li><span class="check-icon">*</span> Income limits apply (AMI-based)</li>
                                    <li><span class="check-icon">*</span> Reduced MI for manufactured homes</li>
                                    <li><span class="check-icon">*</span> 97% LTV allowed (non-mfg)</li>
                                    <li><span class="check-icon">*</span> First-time buyer focus</li>
                                </ul>
                            </div>
                        </div>
                    </div>

                    <div class="workflow-diagram">
                        <h3 style="text-align: center; margin-bottom: 22px; color: var(--accent-blue);">Program Selection Flow</h3>
                        <div class="flow-row">
                            <div class="flow-node start">Start</div>
                            <span class="flow-arrow">-></span>
                            <div class="flow-node decision">Income Eligible?</div>
                        </div>
                        <div class="decision-branch">
                            <div class="branch">
                                <span class="branch-label">Yes (< AMI limit)</span>
                                <span class="flow-arrow down">v</span>
                                <div class="flow-node action">Consider HomeReady/HP</div>
                            </div>
                            <div class="branch">
                                <span class="branch-label">No (> AMI limit)</span>
                                <span class="flow-arrow down">v</span>
                                <div class="flow-node output">Standard Conventional</div>
                            </div>
                        </div>
                    </div>

                    <div class="info-box">
                        <h4>When to Use Special Programs</h4>
                        <p>HomeReady and Home Possible can provide MI savings on manufactured homes at 90.01-95% LTV. Always check eligibility when processing loans in this LTV range for manufactured housing.</p>
                    </div>
                </div>
            </section>

            <!-- Quick Reference -->
            <section id="quick-ref" class="quick-ref">
                <h3>Quick Reference Card</h3>
                <pre>
PMI COVERAGE CHART - QUICK REFERENCE
====================================

STANDARD PROPERTIES (Non-Manufactured)
--------------------------------------
LTV Range        | Fixed < 20yr | Fixed >= 20yr & ARM
-----------------+--------------+--------------------
80.01% - 85.00%  |     6%       |       12%
85.01% - 90.00%  |    12%       |       25%
90.01% - 95.00%  |    25%       |       30%
95.01% - 97.00%  |    35%       |       35%

MANUFACTURED HOMES
------------------
LTV Range        | Standard     | HomeReady/HP
-----------------+--------------+--------------
80.01% - 85.00%  |    12%       |     12%
85.01% - 90.00%  |    25%       |     25%
90.01% - 95.00%  |    30%       |     25%  <-- SAVINGS
95.01% - 97.00%  |    N/A       |     N/A

KEY RULES:
* ARM loans ALWAYS use higher coverage tier
* Manufactured homes MAX LTV = 95%
* HomeReady/HP require income eligibility
* Coverage % = portion of loan insured
                </pre>
            </section>
        </div>

        <!-- ==================== AGENT OPPORTUNITIES TAB ==================== -->
        <div id="agents-panel" class="tab-panel">
            <!-- Header -->
            <div class="agent-header">
                <h1>AI Agent Opportunities</h1>
                <p class="subtitle">Automation Analysis for PMI Coverage Workflow</p>
                <div class="meta">
                    <span class="meta-item">6 Process Steps Analyzed</span>
                    <span class="meta-item">4 Agent Candidates Identified</span>
                    <span class="meta-item">Est. 60% Time Savings</span>
                </div>
            </div>

            <!-- Summary Stats -->
            <div class="agent-summary" id="agent-summary">
                <div class="agent-summary-card">
                    <div class="agent-summary-value">4</div>
                    <div class="agent-summary-label">Agent Candidates</div>
                </div>
                <div class="agent-summary-card">
                    <div class="agent-summary-value">2</div>
                    <div class="agent-summary-label">High Priority</div>
                </div>
                <div class="agent-summary-card">
                    <div class="agent-summary-value">60%</div>
                    <div class="agent-summary-label">Time Savings</div>
                </div>
                <div class="agent-summary-card">
                    <div class="agent-summary-value">90%</div>
                    <div class="agent-summary-label">Automation Potential</div>
                </div>
            </div>

            <!-- Heat Map Legend -->
            <div class="heat-legend" id="agent-heatmap">
                <div class="heat-legend-item"><div class="heat-legend-color" style="background: linear-gradient(135deg, #ef4444, #f97316);"></div><span><strong>Critical (90-100)</strong> - Immediate ROI</span></div>
                <div class="heat-legend-item"><div class="heat-legend-color" style="background: linear-gradient(135deg, #f97316, #eab308);"></div><span><strong>High (70-89)</strong> - Strong candidate</span></div>
                <div class="heat-legend-item"><div class="heat-legend-color" style="background: linear-gradient(135deg, #eab308, #22c55e);"></div><span><strong>Medium (50-69)</strong> - Consider</span></div>
                <div class="heat-legend-item"><div class="heat-legend-color" style="background: linear-gradient(135deg, #22c55e, #14b8a6);"></div><span><strong>Low (0-49)</strong> - Future phase</span></div>
            </div>

            <!-- Heat Map Grid -->
            <div class="heat-map-container">
                <div class="heat-map-title">Automation Priority Heat Map <span style="font-size: 0.8rem; font-weight: 400; color: var(--text-muted);">(Click to jump to agent)</span></div>
                <div class="heat-map-grid">
                    <div class="heat-item critical" onclick="scrollToAgent('agent-coverage-calc')" title="Click to view agent details">
                        <div class="heat-score">95</div>
                        <div class="heat-name">PMI Coverage Calculator</div>
                        <div class="heat-desc">Auto-determine coverage % from loan data</div>
                        <div class="heat-metrics">
                            <div class="heat-metric">Effort: <span>Low</span></div>
                            <div class="heat-metric">Impact: <span>High</span></div>
                            <div class="heat-metric">Step: <span>1-4</span></div>
                        </div>
                    </div>
                    <div class="heat-item high" onclick="scrollToAgent('agent-program-selector')" title="Click to view agent details">
                        <div class="heat-score">85</div>
                        <div class="heat-name">Program Eligibility Agent</div>
                        <div class="heat-desc">Identify HomeReady/HP savings opportunities</div>
                        <div class="heat-metrics">
                            <div class="heat-metric">Effort: <span>Medium</span></div>
                            <div class="heat-metric">Impact: <span>High</span></div>
                            <div class="heat-metric">Step: <span>5</span></div>
                        </div>
                    </div>
                    <div class="heat-item high" onclick="scrollToAgent('agent-validation')" title="Click to view agent details">
                        <div class="heat-score">78</div>
                        <div class="heat-name">MI Validation Agent</div>
                        <div class="heat-desc">Verify correct coverage is ordered</div>
                        <div class="heat-metrics">
                            <div class="heat-metric">Effort: <span>Low</span></div>
                            <div class="heat-metric">Impact: <span>Medium</span></div>
                            <div class="heat-metric">Step: <span>All</span></div>
                        </div>
                    </div>
                    <div class="heat-item medium" onclick="scrollToAgent('agent-cost-compare')" title="Click to view agent details">
                        <div class="heat-score">62</div>
                        <div class="heat-name">MI Cost Comparison</div>
                        <div class="heat-desc">Compare provider rates at each coverage level</div>
                        <div class="heat-metrics">
                            <div class="heat-metric">Effort: <span>Medium</span></div>
                            <div class="heat-metric">Impact: <span>Medium</span></div>
                            <div class="heat-metric">Step: <span>Post</span></div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Agent Details -->
            <h2 style="font-size: 1.4rem; margin: 35px 0 22px; color: var(--text-primary);" id="agent-details">Agent Specifications</h2>

            <div class="agent-grid">
                <!-- Agent 1: PMI Coverage Calculator -->
                <div class="agent-card" id="agent-coverage-calc">
                    <div class="agent-card-header">
                        <div class="agent-icon">%</div>
                        <div class="agent-info">
                            <div class="agent-name">PMI Coverage Calculator Agent</div>
                            <div class="agent-type">Rules Engine Agent</div>
                        </div>
                        <span class="agent-priority critical">Critical</span>
                    </div>
                    <div class="agent-card-body">
                        <p class="agent-description">Automatically calculates the required PMI coverage percentage based on LTV, loan term, rate type, and property type. Eliminates manual chart lookups and reduces errors in coverage determination.</p>
                        <div class="agent-flow">
                            <div class="agent-flow-title">Agent Flow</div>
                            <div class="agent-flow-diagram">
                                <div class="agent-step">Extract Loan Data</div>
                                <span class="agent-arrow">-></span>
                                <div class="agent-step">Classify Scenario</div>
                                <span class="agent-arrow">-></span>
                                <div class="agent-step">Apply Rules</div>
                                <span class="agent-arrow">-></span>
                                <div class="agent-step">Output Coverage</div>
                            </div>
                        </div>
                        <div class="agent-stats">
                            <div class="agent-stat"><div class="agent-stat-value">2min</div><div class="agent-stat-label">Time Saved</div></div>
                            <div class="agent-stat"><div class="agent-stat-value">99%</div><div class="agent-stat-label">Accuracy</div></div>
                            <div class="agent-stat"><div class="agent-stat-value">Low</div><div class="agent-stat-label">Complexity</div></div>
                        </div>
                        <button class="agent-prompt-btn" onclick="showAgentPrompt('coverage')">
                            View AI Prompt to Build This Agent
                        </button>
                    </div>
                </div>

                <!-- Agent 2: Program Eligibility -->
                <div class="agent-card" id="agent-program-selector">
                    <div class="agent-card-header">
                        <div class="agent-icon">$</div>
                        <div class="agent-info">
                            <div class="agent-name">Program Eligibility Agent</div>
                            <div class="agent-type">Decision Support Agent</div>
                        </div>
                        <span class="agent-priority high">High</span>
                    </div>
                    <div class="agent-card-body">
                        <p class="agent-description">Analyzes borrower income and property details to identify eligibility for HomeReady or Home Possible programs that may offer reduced MI coverage, especially beneficial for manufactured homes at 90-95% LTV.</p>
                        <div class="agent-flow">
                            <div class="agent-flow-title">Agent Flow</div>
                            <div class="agent-flow-diagram">
                                <div class="agent-step">Check Income/AMI</div>
                                <span class="agent-arrow">-></span>
                                <div class="agent-step">Verify Property</div>
                                <span class="agent-arrow">-></span>
                                <div class="agent-step">Calculate Savings</div>
                                <span class="agent-arrow">-></span>
                                <div class="agent-step">Recommend</div>
                            </div>
                        </div>
                        <div class="agent-stats">
                            <div class="agent-stat"><div class="agent-stat-value">$150</div><div class="agent-stat-label">Avg Savings</div></div>
                            <div class="agent-stat"><div class="agent-stat-value">92%</div><div class="agent-stat-label">Detect Rate</div></div>
                            <div class="agent-stat"><div class="agent-stat-value">Med</div><div class="agent-stat-label">Complexity</div></div>
                        </div>
                        <button class="agent-prompt-btn" onclick="showAgentPrompt('program')">
                            View AI Prompt to Build This Agent
                        </button>
                    </div>
                </div>

                <!-- Agent 3: MI Validation -->
                <div class="agent-card" id="agent-validation">
                    <div class="agent-card-header">
                        <div class="agent-icon">!</div>
                        <div class="agent-info">
                            <div class="agent-name">MI Validation Agent</div>
                            <div class="agent-type">Quality Control Agent</div>
                        </div>
                        <span class="agent-priority high">High</span>
                    </div>
                    <div class="agent-card-body">
                        <p class="agent-description">Validates that the MI coverage ordered matches the required coverage per guidelines. Flags discrepancies before submission, preventing costly re-orders and delays.</p>
                        <div class="agent-flow">
                            <div class="agent-flow-title">Agent Flow</div>
                            <div class="agent-flow-diagram">
                                <div class="agent-step">Read MI Cert</div>
                                <span class="agent-arrow">-></span>
                                <div class="agent-step">Calc Required</div>
                                <span class="agent-arrow">-></span>
                                <div class="agent-step">Compare</div>
                                <span class="agent-arrow">-></span>
                                <div class="agent-step">Alert/Pass</div>
                            </div>
                        </div>
                        <div class="agent-stats">
                            <div class="agent-stat"><div class="agent-stat-value">3day</div><div class="agent-stat-label">Delay Saved</div></div>
                            <div class="agent-stat"><div class="agent-stat-value">100%</div><div class="agent-stat-label">Coverage</div></div>
                            <div class="agent-stat"><div class="agent-stat-value">Low</div><div class="agent-stat-label">Complexity</div></div>
                        </div>
                        <button class="agent-prompt-btn" onclick="showAgentPrompt('validation')">
                            View AI Prompt to Build This Agent
                        </button>
                    </div>
                </div>

                <!-- Agent 4: Cost Comparison -->
                <div class="agent-card" id="agent-cost-compare">
                    <div class="agent-card-header">
                        <div class="agent-icon">~</div>
                        <div class="agent-info">
                            <div class="agent-name">MI Cost Comparison Agent</div>
                            <div class="agent-type">Analysis Agent</div>
                        </div>
                        <span class="agent-priority medium">Medium</span>
                    </div>
                    <div class="agent-card-body">
                        <p class="agent-description">Compares MI premium rates across providers (MGIC, Radian, Essent, etc.) at the determined coverage level to identify the lowest cost option for the borrower.</p>
                        <div class="agent-flow">
                            <div class="agent-flow-title">Agent Flow</div>
                            <div class="agent-flow-diagram">
                                <div class="agent-step">Get Coverage %</div>
                                <span class="agent-arrow">-></span>
                                <div class="agent-step">Query Providers</div>
                                <span class="agent-arrow">-></span>
                                <div class="agent-step">Rank Options</div>
                                <span class="agent-arrow">-></span>
                                <div class="agent-step">Present Best</div>
                            </div>
                        </div>
                        <div class="agent-stats">
                            <div class="agent-stat"><div class="agent-stat-value">$200</div><div class="agent-stat-label">Avg Savings</div></div>
                            <div class="agent-stat"><div class="agent-stat-value">6</div><div class="agent-stat-label">Providers</div></div>
                            <div class="agent-stat"><div class="agent-stat-value">Med</div><div class="agent-stat-label">Complexity</div></div>
                        </div>
                        <button class="agent-prompt-btn" onclick="showAgentPrompt('cost')">
                            View AI Prompt to Build This Agent
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </main>

    <!-- Documentation Modal -->
    <div class="modal-overlay" id="docModal">
        <div class="modal">
            <div class="modal-header">
                <h3>PMI Coverage Chart - Workflow Markdown</h3>
                <div class="modal-actions">
                    <button class="modal-btn copy" onclick="copyToClipboard()">Copy</button>
                    <button class="modal-btn close" onclick="closeDocModal()">Close</button>
                </div>
            </div>
            <div class="modal-body">
                <pre id="docContent"># PMI Coverage Chart

## MI Standard Coverage - Other than Manufactured Homes

### Fixed Rate Term < 20 Years
| LTV Range | Coverage |
|-----------|----------|
| 80.01% - 85% | 6% |
| 85.01% - 90% | 12% |
| 90.01% - 95% | 25% |
| 95.01% - 97% | 35% |

### Fixed Rate Term > 20 Years & ARM Loans
| LTV Range | Coverage |
|-----------|----------|
| 80.01% - 85% | 12% |
| 85.01% - 90% | 25% |
| 90.01% - 95% | 30% |
| 95.01% - 97% | 35% |

## Manufactured Homes

| Transaction Type | 80.01-85% | 85.01-90% | 90.01-95% | 95.01-97% |
|-----------------|-----------|-----------|-----------|-----------|
| Fixed Rate, ARM, All Terms | 12% | 25% | 30% | n/a |
| HomeReady & Home Possible* | 12% | 25% | 25% | n/a |

*Refer to HomeReady & Home Possible matrices for additional eligibility items

## Key Rules
- ARM loans always use the higher coverage tier (>= 20 year rates)
- Manufactured homes have max LTV of 95%
- HomeReady/Home Possible can reduce coverage at 90-95% LTV for manufactured homes</pre>
            </div>
        </div>
    </div>

    <div class="copy-success" id="copySuccess">Copied to clipboard!</div>

    <!-- AI Prompt Modal -->
    <div class="modal-overlay prompt-modal" id="promptModal">
        <div class="modal">
            <div class="modal-header">
                <h3 id="promptModalTitle">AI Agent Build Prompt</h3>
                <div class="modal-actions">
                    <button class="modal-btn copy" onclick="copyPromptToClipboard()">Copy Prompt</button>
                    <button class="modal-btn close" onclick="closePromptModal()">Close</button>
                </div>
            </div>
            <div class="modal-body">
                <div class="prompt-tags" id="promptTags"></div>
                <div class="prompt-section">
                    <h4>Agent Purpose</h4>
                    <div class="prompt-box" id="promptPurpose"></div>
                </div>
                <div class="prompt-section">
                    <h4>Full Build Prompt</h4>
                    <div class="prompt-box" id="promptContent"></div>
                </div>
                <div class="prompt-section">
                    <h4>Integration Points</h4>
                    <div class="prompt-box" id="promptIntegration"></div>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Tab switching
        function switchTab(tab) {
            document.querySelectorAll('.sidebar-tab').forEach(t => t.classList.remove('active'));
            document.querySelectorAll('.tab-panel').forEach(p => p.classList.remove('active'));

            if (tab === 'workflow') {
                document.querySelector('.sidebar-tab:not(.agent-tab)').classList.add('active');
                document.getElementById('workflow-panel').classList.add('active');
                document.getElementById('workflow-nav').style.display = 'block';
                document.getElementById('agents-nav').style.display = 'none';
            } else {
                document.querySelector('.sidebar-tab.agent-tab').classList.add('active');
                document.getElementById('agents-panel').classList.add('active');
                document.getElementById('workflow-nav').style.display = 'none';
                document.getElementById('agents-nav').style.display = 'block';
            }

            window.scrollTo(0, 0);
        }

        // Scroll spy with isScrolling flag and timeout
        const sections = document.querySelectorAll('.section, .quick-ref');
        const navItems = document.querySelectorAll('#workflow-nav .nav-item');
        let isScrolling = false;
        let scrollTimeout;

        function updateActiveNav() {
            if (isScrolling) return;

            let current = '';
            sections.forEach(section => {
                const sectionTop = section.offsetTop - 100;
                if (window.scrollY >= sectionTop) current = section.getAttribute('id');
            });
            navItems.forEach(item => {
                item.classList.remove('active');
                if (item.getAttribute('href') === '#' + current) item.classList.add('active');
            });
        }

        // Handle nav clicks with scroll lock
        navItems.forEach(item => {
            item.addEventListener('click', function(e) {
                isScrolling = true;
                clearTimeout(scrollTimeout);

                // Update active state immediately
                navItems.forEach(nav => nav.classList.remove('active'));
                this.classList.add('active');

                // Reset scroll lock after 1000ms
                scrollTimeout = setTimeout(() => {
                    isScrolling = false;
                }, 1000);
            });
        });

        window.addEventListener('scroll', updateActiveNav);

        // Modal functions
        function openDocModal() {
            document.getElementById('docModal').classList.add('show');
            document.body.style.overflow = 'hidden';
        }

        function closeDocModal() {
            document.getElementById('docModal').classList.remove('show');
            document.body.style.overflow = '';
        }

        async function copyToClipboard() {
            try {
                const content = document.getElementById('docContent').textContent;
                await navigator.clipboard.writeText(content);
                const success = document.getElementById('copySuccess');
                success.style.display = 'block';
                setTimeout(() => { success.style.display = 'none'; }, 2000);
            } catch (e) { alert('Failed to copy.'); }
        }

        document.addEventListener('keydown', (e) => { if (e.key === 'Escape') { closeDocModal(); closePromptModal(); } });
        document.getElementById('docModal').addEventListener('click', (e) => { if (e.target.id === 'docModal') closeDocModal(); });

        document.addEventListener('DOMContentLoaded', () => { updateActiveNav(); });

        // Agent Prompt System
        const agentPrompts = {
            coverage: {
                name: 'PMI Coverage Calculator Agent',
                tags: ['Rules Engine', 'Automation', 'Low Complexity', 'Critical Priority'],
                purpose: `This agent automatically determines the required PMI coverage percentage by analyzing the loan's LTV ratio, term length, rate type (fixed vs ARM), and property type (standard vs manufactured). It eliminates manual chart lookups and ensures accurate coverage determination every time.`,
                prompt: `You are building a Rules Engine Agent for CMG Financial's Byte LOS system.

AGENT NAME: PMI Coverage Calculator Agent
TYPE: Rules Engine / Lookup Automation

OBJECTIVE:
Create an agent that automatically calculates the required PMI coverage percentage based on loan parameters, eliminating manual chart lookups.

INPUT PARAMETERS:
1. Loan Data (from Byte)
   - LTV Ratio (calculated or entered)
   - Loan Term (in years)
   - Rate Type (Fixed or ARM)
   - Property Type (Standard, Condo, Manufactured)

DECISION LOGIC:

Step 1: Classify Property Type
IF Property Type = "Manufactured Home" THEN
    Use MANUFACTURED_HOME_TABLE
ELSE
    Use STANDARD_TABLE

Step 2: Classify Loan Type (Standard Properties Only)
IF Rate Type = "ARM" THEN
    Use HIGHER_COVERAGE column
ELSE IF Loan Term >= 20 THEN
    Use HIGHER_COVERAGE column
ELSE
    Use LOWER_COVERAGE column

Step 3: Lookup Coverage by LTV

STANDARD_TABLE:
LTV Range        | LOWER (<20yr Fixed) | HIGHER (>=20yr/ARM)
-----------------+---------------------+--------------------
80.01% - 85.00%  |         6%          |        12%
85.01% - 90.00%  |        12%          |        25%
90.01% - 95.00%  |        25%          |        30%
95.01% - 97.00%  |        35%          |        35%

MANUFACTURED_HOME_TABLE:
LTV Range        | Standard | HomeReady/HP
-----------------+----------+-------------
80.01% - 85.00%  |    12%   |     12%
85.01% - 90.00%  |    25%   |     25%
90.01% - 95.00%  |    30%   |     25%
95.01% - 97.00%  |   N/A    |     N/A

OUTPUT FORMAT:
{
  "requiredCoverage": 25,
  "coverageUnit": "percent",
  "tableUsed": "STANDARD_HIGHER",
  "ltvRange": "85.01% - 90.00%",
  "reasoning": "30-year fixed at 87% LTV requires 25% coverage",
  "warnings": [],
  "alternatePrograms": []
}

EDGE CASES:
- LTV <= 80%: Return "PMI Not Required"
- LTV > 97%: Return error "LTV exceeds maximum"
- Manufactured + LTV > 95%: Return error "Max LTV for manufactured is 95%"`,
                integration: `INTEGRATION POINTS:
1. Byte LOS API
   - Read loan data from active file
   - Trigger on LTV calculation or term change
   - Populate MI coverage field

2. Workflow Automation
   - Auto-run when loan moves to Processing
   - Include in pre-submission checklist
   - Log all calculations for audit

3. User Interface
   - Display calculated coverage in MI section
   - Show "why" explanation on hover
   - Allow manual override with reason capture`
            },
            program: {
                name: 'Program Eligibility Agent',
                tags: ['Decision Support', 'Cost Savings', 'Medium Complexity', 'High Priority'],
                purpose: `This agent identifies when borrowers may be eligible for HomeReady or Home Possible programs that offer reduced MI coverage requirements, particularly valuable for manufactured homes at 90-95% LTV where coverage drops from 30% to 25%.`,
                prompt: `You are building a Decision Support Agent for CMG Financial's Byte LOS system.

AGENT NAME: Program Eligibility Agent
TYPE: Decision Support / Savings Identification

OBJECTIVE:
Identify loans where HomeReady or Home Possible programs could reduce MI coverage requirements, saving borrowers money on premiums.

INPUT PARAMETERS:
1. Borrower Data
   - Household Income
   - Property Address (for AMI lookup)
   - First-time Homebuyer Status

2. Property Data
   - Property Type
   - Census Tract

3. Loan Data
   - LTV Ratio
   - Current Program Selected

ELIGIBILITY RULES:

HomeReady (Fannie Mae):
- Income <= 80% of Area Median Income (AMI)
- OR Property in low-income census tract
- Homebuyer education required for first-time buyers

Home Possible (Freddie Mac):
- Income <= 80% of AMI
- At least one borrower must be first-time buyer OR
- Property in underserved area

SAVINGS CALCULATION:

For Manufactured Homes at 90.01-95% LTV:
- Standard Coverage: 30%
- HomeReady/HP Coverage: 25%
- Coverage Reduction: 5 percentage points

Estimated Premium Savings:
Monthly = (Loan Amount x 0.05 x MI Rate) / 12

RECOMMENDATION OUTPUT:
{
  "eligiblePrograms": ["HomeReady", "Home Possible"],
  "currentProgram": "Conventional",
  "coverageReduction": "30% -> 25%",
  "estimatedMonthlySavings": 45.00,
  "estimatedAnnualSavings": 540.00,
  "requirements": [
    "Complete homebuyer education course",
    "Verify income below 80% AMI for zip 90210"
  ],
  "recommendation": "Switch to HomeReady for $540/year MI savings"
}

TRIGGER CONDITIONS:
- Manufactured home at 90-95% LTV
- Any loan where income appears below AMI
- First-time homebuyer flag is set`,
                integration: `INTEGRATION POINTS:
1. Income Verification
   - Pull AMI limits from FFIEC database
   - Compare borrower income to limits
   - Handle multiple borrower scenarios

2. Byte LOS Integration
   - Flag eligible loans in pipeline
   - Add savings estimate to loan summary
   - Track conversion rate of recommendations

3. LO Notification
   - Alert LO when savings opportunity found
   - Provide script for borrower conversation
   - Track if recommendation was accepted`
            },
            validation: {
                name: 'MI Validation Agent',
                tags: ['Quality Control', 'Error Prevention', 'Low Complexity', 'High Priority'],
                purpose: `This agent compares the MI coverage ordered from the provider against the required coverage per guidelines, flagging any discrepancies before loan submission to prevent costly re-orders and processing delays.`,
                prompt: `You are building a Quality Control Agent for CMG Financial's Byte LOS system.

AGENT NAME: MI Validation Agent
TYPE: Quality Control / Pre-Submission Check

OBJECTIVE:
Validate that the MI certificate coverage matches the required coverage based on loan parameters, preventing submission errors.

INPUT DATA:
1. MI Certificate Data
   - Provider Name
   - Coverage Percentage
   - Certificate Number
   - Effective Date

2. Loan Parameters
   - LTV (as calculated)
   - Loan Term
   - Rate Type
   - Property Type

VALIDATION LOGIC:

Step 1: Calculate Required Coverage
   Use PMI Coverage Calculator logic

Step 2: Compare to Certificate
   IF Certificate Coverage >= Required Coverage THEN
       STATUS = "PASS"
   ELSE IF Certificate Coverage < Required Coverage THEN
       STATUS = "FAIL - INSUFFICIENT COVERAGE"

Step 3: Additional Checks
   - Certificate date not expired
   - Certificate loan amount matches
   - Certificate LTV matches actual LTV

OUTPUT FORMAT:
{
  "validationStatus": "PASS" | "FAIL",
  "requiredCoverage": 25,
  "orderedCoverage": 25,
  "coverageMatch": true,
  "issues": [],
  "recommendations": [],
  "certificateDetails": {
    "provider": "MGIC",
    "certNumber": "MI-2026-123456",
    "expiresOn": "2026-03-15"
  }
}

FAILURE SCENARIOS:
1. Coverage Too Low
   Issue: "Certificate shows 12% coverage but 25% required for 87% LTV"
   Action: "Re-order MI certificate with correct coverage"

2. LTV Mismatch
   Issue: "Certificate LTV (85%) does not match loan LTV (87%)"
   Action: "Verify appraisal value and re-order if needed"

3. Expired Certificate
   Issue: "MI certificate expired on 2026-01-15"
   Action: "Request updated certificate from provider"`,
                integration: `INTEGRATION POINTS:
1. Document Recognition
   - Parse MI certificates (PDF/image)
   - Extract coverage %, LTV, loan amount
   - OCR for non-standard formats

2. Pre-Submission Gate
   - Block submission if validation fails
   - Require manager override for exceptions
   - Log all validation results

3. Workflow Triggers
   - Run when MI cert uploaded
   - Run before submission milestone
   - Run when LTV changes post-cert`
            },
            cost: {
                name: 'MI Cost Comparison Agent',
                tags: ['Cost Analysis', 'Provider Comparison', 'Medium Complexity', 'Medium Priority'],
                purpose: `This agent compares MI premium rates across all available providers at the determined coverage level, identifying the lowest cost option and presenting a ranked comparison to help borrowers save money.`,
                prompt: `You are building a Cost Analysis Agent for CMG Financial's Byte LOS system.

AGENT NAME: MI Cost Comparison Agent
TYPE: Provider Analysis / Cost Optimization

OBJECTIVE:
Compare MI premium rates across providers at the required coverage level to identify the lowest cost option for the borrower.

INPUT PARAMETERS:
1. Loan Profile
   - Loan Amount
   - LTV Ratio
   - FICO Score (representative)
   - Property Type
   - Occupancy Type

2. Coverage Requirement
   - Required Coverage % (from calculator)
   - Payment Type (Monthly, Single, Split)

PROVIDERS TO COMPARE:
1. MGIC
2. Radian
3. Essent
4. National MI
5. Genworth
6. Arch MI

RATE LOOKUP LOGIC:
For each provider:
   Rate = GetRate(Provider, LTV, FICO, Coverage, PaymentType)
   MonthlyPremium = (LoanAmount x Rate) / 12
   AnnualPremium = LoanAmount x Rate

COMPARISON OUTPUT:
{
  "loanAmount": 400000,
  "requiredCoverage": 25,
  "ficoUsed": 720,
  "comparison": [
    {
      "rank": 1,
      "provider": "Essent",
      "annualRate": 0.0052,
      "monthlyPremium": 173.33,
      "annualPremium": 2080.00,
      "savingsVsHighest": 320.00
    },
    {
      "rank": 2,
      "provider": "MGIC",
      "annualRate": 0.0055,
      "monthlyPremium": 183.33,
      "annualPremium": 2200.00,
      "savingsVsHighest": 200.00
    },
    // ... more providers
  ],
  "recommendation": "Essent offers lowest rate at $173.33/month",
  "potentialSavings": "Save $26.67/month vs highest quote"
}

PAYMENT TYPE ANALYSIS:
Also calculate:
- Single Premium (upfront, may be financed)
- Split Premium (partial upfront + monthly)
- Lender-Paid vs Borrower-Paid options`,
                integration: `INTEGRATION POINTS:
1. Rate API Connections
   - MGIC RateStar API
   - Radian Rate Finder
   - Essent EssentEdge
   - Real-time rate queries

2. BestX Integration
   - Pull quotes from BestX when available
   - Compare to manual lookups
   - Track quote accuracy over time

3. Presentation Layer
   - Show comparison table in Byte
   - Allow one-click order from lowest
   - Generate borrower-facing comparison PDF`
            }
        };

        // Scroll to agent card and highlight
        function scrollToAgent(agentId) {
            const agentCard = document.getElementById(agentId);
            if (agentCard) {
                document.querySelectorAll('.agent-card.highlight').forEach(card => {
                    card.classList.remove('highlight');
                });

                agentCard.scrollIntoView({ behavior: 'smooth', block: 'center' });

                setTimeout(() => {
                    agentCard.classList.add('highlight');
                }, 300);

                setTimeout(() => {
                    agentCard.classList.remove('highlight');
                }, 2500);
            }
        }

        // Show agent prompt modal
        let currentPromptContent = '';

        function showAgentPrompt(agentKey) {
            const agent = agentPrompts[agentKey];
            if (!agent) return;

            document.getElementById('promptModalTitle').textContent = agent.name + ' - Build Prompt';

            const tagsHtml = agent.tags.map(tag => '<span class="prompt-tag">' + tag + '</span>').join('');
            document.getElementById('promptTags').innerHTML = tagsHtml;

            document.getElementById('promptPurpose').textContent = agent.purpose;
            document.getElementById('promptContent').textContent = agent.prompt;
            document.getElementById('promptIntegration').textContent = agent.integration;

            currentPromptContent = '# ' + agent.name + '\n\n## Purpose\n' + agent.purpose + '\n\n## Build Prompt\n' + agent.prompt + '\n\n## Integration Points\n' + agent.integration;

            document.getElementById('promptModal').classList.add('show');
            document.body.style.overflow = 'hidden';
        }

        function closePromptModal() {
            document.getElementById('promptModal').classList.remove('show');
            document.body.style.overflow = '';
        }

        async function copyPromptToClipboard() {
            try {
                await navigator.clipboard.writeText(currentPromptContent);
                const success = document.getElementById('copySuccess');
                success.style.display = 'block';
                setTimeout(() => { success.style.display = 'none'; }, 2000);
            } catch (e) {
                alert('Failed to copy prompt.');
            }
        }

        document.getElementById('promptModal').addEventListener('click', (e) => {
            if (e.target.id === 'promptModal') closePromptModal();
        });
    </script>
</body>
</html>
