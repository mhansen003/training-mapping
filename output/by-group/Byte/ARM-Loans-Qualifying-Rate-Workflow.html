<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ARM Loans - Qualifying Rates & Plan Codes in Byte</title>
    <link href="https://fonts.googleapis.com/css2?family=Plus+Jakarta+Sans:wght@400;500;600;700;800&family=JetBrains+Mono:wght@400;500&display=swap" rel="stylesheet">
    <style>
        :root {
            --bg-primary: #0a0f1a;
            --bg-secondary: #111827;
            --bg-card: #1a2234;
            --accent-blue: #3b82f6;
            --accent-teal: #14b8a6;
            --accent-amber: #f59e0b;
            --accent-rose: #f43f5e;
            --accent-green: #22c55e;
            --accent-purple: #8b5cf6;
            --text-primary: #f1f5f9;
            --text-secondary: #94a3b8;
            --text-muted: #64748b;
            --border-subtle: rgba(255,255,255,0.08);
            --sidebar-width: 280px;
        }

        * { box-sizing: border-box; margin: 0; padding: 0; }
        html { scroll-behavior: smooth; }
        body {
            font-family: 'Plus Jakarta Sans', -apple-system, BlinkMacSystemFont, sans-serif;
            background: var(--bg-primary);
            color: var(--text-primary);
            min-height: 100vh;
        }

        /* Breadcrumb */
        .breadcrumb {
            background: linear-gradient(90deg, #0d1525 0%, #1a2234 100%);
            padding: 14px 25px;
            display: flex;
            align-items: center;
            gap: 12px;
            font-size: 0.95rem;
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            z-index: 1001;
            border-bottom: 1px solid var(--border-subtle);
        }

        .breadcrumb a {
            color: var(--text-secondary);
            text-decoration: none;
            font-weight: 600;
            padding: 8px 16px;
            background: rgba(255,255,255,0.05);
            border-radius: 8px;
            transition: all 0.2s;
            border: 1px solid var(--border-subtle);
        }

        .breadcrumb a:hover {
            background: rgba(59, 130, 246, 0.15);
            color: var(--accent-blue);
            border-color: rgba(59, 130, 246, 0.3);
        }

        .breadcrumb .separator { color: var(--text-muted); font-size: 1.2rem; }
        .breadcrumb .current { color: var(--accent-amber); font-weight: 600; padding: 8px 16px; }

        /* Sidebar */
        .sidebar {
            position: fixed;
            top: 54px;
            left: 0;
            width: var(--sidebar-width);
            height: calc(100vh - 54px);
            background: var(--bg-secondary);
            overflow-y: auto;
            z-index: 1000;
            border-right: 1px solid var(--border-subtle);
            display: flex;
            flex-direction: column;
        }

        .sidebar-header {
            padding: 25px 20px;
            background: rgba(0,0,0,0.3);
            border-bottom: 1px solid var(--border-subtle);
        }

        .sidebar-header h2 { color: var(--text-primary); font-size: 1.2rem; font-weight: 700; margin-bottom: 5px; }
        .sidebar-header p { color: var(--text-muted); font-size: 0.85rem; }

        /* Tab Switch */
        .sidebar-tabs {
            display: flex;
            border-bottom: 1px solid var(--border-subtle);
        }

        .sidebar-tab {
            flex: 1;
            padding: 14px 10px;
            text-align: center;
            font-size: 0.8rem;
            font-weight: 700;
            color: var(--text-muted);
            cursor: pointer;
            transition: all 0.2s;
            border-bottom: 3px solid transparent;
            background: none;
            border-left: none;
            border-right: none;
            border-top: none;
        }

        .sidebar-tab:hover { background: rgba(255,255,255,0.03); color: var(--text-secondary); }
        .sidebar-tab.active { color: var(--accent-blue); border-bottom-color: var(--accent-blue); background: rgba(59, 130, 246, 0.08); }
        .sidebar-tab.agent-tab.active { color: var(--accent-purple); border-bottom-color: var(--accent-purple); background: rgba(139, 92, 246, 0.08); }

        .sidebar-nav { padding: 15px 0; flex: 1; overflow-y: auto; }

        .nav-item {
            display: flex;
            align-items: center;
            gap: 12px;
            padding: 14px 20px;
            color: var(--text-secondary);
            text-decoration: none;
            border-left: 3px solid transparent;
            transition: all 0.2s ease;
            cursor: pointer;
        }

        .nav-item:hover { background: rgba(255,255,255,0.03); color: var(--text-primary); }
        .nav-item.active { background: rgba(59, 130, 246, 0.1); border-left-color: var(--accent-blue); color: var(--text-primary); }

        .nav-number {
            background: rgba(255,255,255,0.1);
            color: var(--text-secondary);
            width: 28px;
            height: 28px;
            border-radius: 8px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 700;
            font-size: 0.85rem;
            flex-shrink: 0;
        }

        .nav-item.active .nav-number { background: var(--accent-blue); color: white; }
        .nav-label { font-size: 0.95rem; font-weight: 500; }

        .sidebar-footer {
            padding: 20px;
            border-top: 1px solid var(--border-subtle);
            background: rgba(0,0,0,0.2);
        }

        .doc-btn {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
            width: 100%;
            padding: 14px 20px;
            background: linear-gradient(135deg, var(--accent-blue) 0%, var(--accent-teal) 100%);
            color: white;
            border: none;
            border-radius: 10px;
            font-weight: 600;
            cursor: pointer;
            transition: transform 0.2s, box-shadow 0.2s;
            text-decoration: none;
            font-size: 0.95rem;
        }

        .doc-btn:hover { transform: translateY(-2px); box-shadow: 0 8px 25px rgba(59, 130, 246, 0.3); }

        /* Main Content */
        .main-content { margin-left: var(--sidebar-width); padding: 80px 40px 40px 40px; }

        /* Tab Panels */
        .tab-panel { display: none; }
        .tab-panel.active { display: block; }

        .header {
            background: var(--bg-card);
            border: 1px solid var(--border-subtle);
            padding: 35px;
            border-radius: 16px;
            margin-bottom: 30px;
            position: relative;
            overflow: hidden;
        }

        .header::before {
            content: '';
            position: absolute;
            top: 0; left: 0; right: 0; bottom: 0;
            background:
                radial-gradient(ellipse at 20% 20%, rgba(59, 130, 246, 0.1) 0%, transparent 50%),
                radial-gradient(ellipse at 80% 80%, rgba(20, 184, 166, 0.08) 0%, transparent 50%);
            pointer-events: none;
        }

        .header h1 {
            font-size: 2.2rem;
            font-weight: 800;
            margin-bottom: 10px;
            position: relative;
            background: linear-gradient(135deg, var(--text-primary) 0%, var(--accent-blue) 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .header .subtitle { color: var(--text-secondary); font-size: 1.1rem; position: relative; }

        .header .meta { display: flex; gap: 15px; margin-top: 20px; flex-wrap: wrap; position: relative; }

        .header .meta-item {
            background: rgba(255,255,255,0.05);
            border: 1px solid var(--border-subtle);
            padding: 8px 16px;
            border-radius: 8px;
            font-size: 0.9rem;
            color: var(--text-secondary);
        }

        /* Legend */
        .legend {
            display: flex;
            flex-wrap: wrap;
            gap: 15px;
            padding: 18px 22px;
            background: var(--bg-card);
            border: 1px solid var(--border-subtle);
            border-radius: 12px;
            margin-bottom: 25px;
        }

        .legend-item { display: flex; align-items: center; gap: 8px; font-size: 0.85rem; color: var(--text-secondary); }
        .legend-color { width: 18px; height: 18px; border-radius: 4px; }

        /* Sections */
        .section {
            background: var(--bg-card);
            border: 1px solid var(--border-subtle);
            border-radius: 16px;
            margin-bottom: 25px;
            overflow: hidden;
            scroll-margin-top: 75px;
        }

        .section-header {
            background: linear-gradient(135deg, var(--bg-secondary) 0%, rgba(59, 130, 246, 0.1) 100%);
            border-bottom: 1px solid var(--border-subtle);
            padding: 22px 25px;
            display: flex;
            align-items: center;
            gap: 18px;
        }

        .section-number {
            background: linear-gradient(135deg, var(--accent-blue) 0%, var(--accent-teal) 100%);
            color: white;
            width: 48px;
            height: 48px;
            border-radius: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 800;
            font-size: 1.3rem;
            flex-shrink: 0;
        }

        .section-title h2 { font-size: 1.35rem; font-weight: 700; margin-bottom: 4px; color: var(--text-primary); }
        .section-title span { font-size: 0.9rem; color: var(--text-muted); }
        .section-content { padding: 28px; }

        /* Workflow Diagrams */
        .workflow-diagram {
            background: rgba(0,0,0,0.3);
            border: 1px solid var(--border-subtle);
            border-radius: 12px;
            padding: 28px;
            margin-bottom: 22px;
        }

        .flow-row { display: flex; align-items: center; justify-content: center; flex-wrap: wrap; gap: 12px; margin: 15px 0; }

        .flow-node {
            padding: 14px 22px;
            border-radius: 10px;
            text-align: center;
            font-size: 0.9rem;
            font-weight: 600;
            min-width: 150px;
            border: 1px solid var(--border-subtle);
        }

        .flow-node.start { background: linear-gradient(135deg, var(--accent-green) 0%, #16a34a 100%); color: white; border-radius: 25px; border: none; }
        .flow-node.action { background: linear-gradient(135deg, var(--accent-blue) 0%, #2563eb 100%); color: white; border: none; }
        .flow-node.decision { background: linear-gradient(135deg, var(--accent-amber) 0%, #d97706 100%); color: var(--bg-primary); border: none; }
        .flow-node.input { background: var(--bg-secondary); border: 2px solid var(--accent-blue); color: var(--text-primary); }
        .flow-node.output { background: linear-gradient(135deg, var(--accent-teal) 0%, #0d9488 100%); color: white; border: none; }
        .flow-node.exception { background: linear-gradient(135deg, var(--accent-rose) 0%, #dc2626 100%); color: white; border: none; }

        .flow-arrow { color: var(--accent-blue); font-size: 1.5rem; }
        .flow-arrow.down { transform: rotate(90deg); }

        .decision-branch { display: flex; gap: 40px; justify-content: center; margin: 20px 0; flex-wrap: wrap; }
        .branch { display: flex; flex-direction: column; align-items: center; gap: 10px; }

        .branch-label {
            background: var(--bg-secondary);
            border: 1px solid var(--border-subtle);
            padding: 6px 16px;
            border-radius: 20px;
            font-size: 0.8rem;
            font-weight: 700;
            color: var(--text-secondary);
        }

        /* Tables */
        .field-table { width: 100%; border-collapse: collapse; margin: 18px 0; }

        .field-table th {
            background: rgba(59, 130, 246, 0.15);
            color: var(--accent-blue);
            padding: 14px 18px;
            text-align: left;
            font-weight: 600;
            font-size: 0.9rem;
            text-transform: uppercase;
            letter-spacing: 0.05em;
            border-bottom: 1px solid var(--border-subtle);
        }

        .field-table td { padding: 14px 18px; border-bottom: 1px solid var(--border-subtle); color: var(--text-secondary); }
        .field-table tr:hover { background: rgba(255,255,255,0.02); }

        .badge { display: inline-block; padding: 4px 12px; border-radius: 6px; font-size: 0.75rem; font-weight: 700; text-transform: uppercase; letter-spacing: 0.05em; }
        .badge.required-badge { background: rgba(244, 63, 94, 0.15); color: var(--accent-rose); }
        .badge.optional-badge { background: rgba(34, 197, 94, 0.15); color: var(--accent-green); }
        .badge.calculated-badge { background: rgba(59, 130, 246, 0.15); color: var(--accent-blue); }

        /* Info Boxes */
        .exception-box, .tip-box, .info-box, .warning-box {
            padding: 18px 22px;
            margin: 18px 0;
            border-radius: 0 10px 10px 0;
            border-left-width: 4px;
            border-left-style: solid;
        }

        .exception-box { background: rgba(244, 63, 94, 0.08); border-color: var(--accent-rose); border: 1px solid rgba(244, 63, 94, 0.2); border-left: 4px solid var(--accent-rose); }
        .exception-box h4 { color: var(--accent-rose); margin-bottom: 10px; font-size: 1rem; }
        .exception-box p, .exception-box li { color: var(--text-secondary); }

        .tip-box { background: rgba(34, 197, 94, 0.08); border-color: var(--accent-green); border: 1px solid rgba(34, 197, 94, 0.2); border-left: 4px solid var(--accent-green); }
        .tip-box h4 { color: var(--accent-green); margin-bottom: 10px; font-size: 1rem; }
        .tip-box p, .tip-box li { color: var(--text-secondary); }

        .info-box { background: rgba(59, 130, 246, 0.08); border-color: var(--accent-blue); border: 1px solid rgba(59, 130, 246, 0.2); border-left: 4px solid var(--accent-blue); }
        .info-box h4 { color: var(--accent-blue); margin-bottom: 10px; font-size: 1rem; }
        .info-box p, .info-box li { color: var(--text-secondary); }

        .warning-box { background: rgba(245, 158, 11, 0.08); border-color: var(--accent-amber); border: 1px solid rgba(245, 158, 11, 0.2); border-left: 4px solid var(--accent-amber); }
        .warning-box h4 { color: var(--accent-amber); margin-bottom: 10px; font-size: 1rem; }
        .warning-box p, .warning-box li { color: var(--text-secondary); }

        /* Decision Tree */
        .decision-tree {
            background: rgba(0,0,0,0.2);
            border: 1px solid var(--border-subtle);
            border-radius: 12px;
            padding: 22px;
            margin: 22px 0;
        }

        .decision-tree h3 { color: var(--accent-blue); margin-bottom: 18px; padding-bottom: 12px; border-bottom: 1px solid var(--border-subtle); font-size: 1.1rem; }

        .tree-node { margin-left: 20px; padding: 12px; border-left: 2px solid var(--accent-teal); position: relative; color: var(--text-secondary); }
        .tree-node::before { content: ''; position: absolute; left: -2px; top: 22px; width: 15px; height: 2px; background: var(--accent-teal); }
        .tree-node.level-1 { margin-left: 0; border-left: none; }
        .tree-node.level-1::before { display: none; }

        .tree-label { background: var(--accent-amber); color: var(--bg-primary); padding: 6px 14px; border-radius: 6px; font-weight: 700; display: inline-block; margin-bottom: 6px; font-size: 0.9rem; }

        /* Summary Grid */
        .summary-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(180px, 1fr)); gap: 18px; margin: 22px 0; }

        .summary-card { background: rgba(0,0,0,0.3); border: 1px solid var(--border-subtle); border-radius: 12px; padding: 22px; text-align: center; }
        .summary-card h4 { color: var(--text-secondary); margin-bottom: 12px; font-size: 0.9rem; }
        .summary-card .value {
            font-size: 2.2rem;
            font-weight: 800;
            background: linear-gradient(135deg, var(--accent-blue) 0%, var(--accent-teal) 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }
        .summary-card .label { font-size: 0.85rem; color: var(--text-muted); margin-top: 8px; }

        /* Comparison Cards */
        .mi-comparison { display: grid; grid-template-columns: repeat(auto-fit, minmax(280px, 1fr)); gap: 20px; margin: 22px 0; }

        .mi-card { background: rgba(0,0,0,0.2); border: 1px solid var(--border-subtle); border-radius: 12px; overflow: hidden; }
        .mi-card-header { background: linear-gradient(135deg, var(--accent-blue) 0%, var(--accent-teal) 100%); color: white; padding: 18px; text-align: center; }
        .mi-card-header h4 { font-size: 1.05rem; }
        .mi-card-body { padding: 22px; }
        .mi-card ul { list-style: none; padding: 0; }
        .mi-card li { padding: 10px 0; border-bottom: 1px solid var(--border-subtle); display: flex; align-items: center; gap: 12px; color: var(--text-secondary); font-size: 0.95rem; }
        .mi-card li:last-child { border-bottom: none; }
        .check-icon { color: var(--accent-green); font-weight: bold; }
        .x-icon { color: var(--accent-rose); font-weight: bold; }

        /* Quick Reference */
        .quick-ref {
            background: linear-gradient(135deg, var(--bg-secondary) 0%, var(--bg-card) 100%);
            border: 1px solid var(--border-subtle);
            padding: 28px;
            border-radius: 16px;
            margin-top: 30px;
            font-family: 'JetBrains Mono', monospace;
            scroll-margin-top: 75px;
        }

        .quick-ref h3 { color: var(--accent-amber); margin-bottom: 18px; font-family: 'Plus Jakarta Sans', sans-serif; }
        .quick-ref pre { background: rgba(0,0,0,0.4); border: 1px solid var(--border-subtle); padding: 20px; border-radius: 10px; overflow-x: auto; font-size: 0.85rem; line-height: 1.7; color: var(--text-secondary); }

        /* ====== AGENT OPPORTUNITIES STYLES ====== */
        .agent-header {
            background: var(--bg-card);
            border: 1px solid var(--border-subtle);
            padding: 35px;
            border-radius: 16px;
            margin-bottom: 30px;
            position: relative;
            overflow: hidden;
        }

        .agent-header::before {
            content: '';
            position: absolute;
            top: 0; left: 0; right: 0; bottom: 0;
            background:
                radial-gradient(ellipse at 20% 20%, rgba(139, 92, 246, 0.12) 0%, transparent 50%),
                radial-gradient(ellipse at 80% 80%, rgba(245, 158, 11, 0.1) 0%, transparent 50%);
            pointer-events: none;
        }

        .agent-header h1 {
            font-size: 2.2rem;
            font-weight: 800;
            margin-bottom: 10px;
            position: relative;
            background: linear-gradient(135deg, var(--accent-purple) 0%, var(--accent-amber) 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .agent-header .subtitle { color: var(--text-secondary); font-size: 1.1rem; position: relative; }

        /* Heat Map */
        .heat-map-container { margin-bottom: 35px; }
        .heat-map-title { font-size: 1.3rem; font-weight: 700; color: var(--text-primary); margin-bottom: 20px; display: flex; align-items: center; gap: 12px; }

        .heat-map-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
        }

        .heat-item {
            background: var(--bg-card);
            border: 1px solid var(--border-subtle);
            border-radius: 12px;
            padding: 20px;
            position: relative;
            overflow: hidden;
            transition: transform 0.2s, box-shadow 0.2s;
            cursor: pointer;
        }

        .heat-item:hover { transform: translateY(-3px); box-shadow: 0 10px 30px rgba(0,0,0,0.3); }
        .heat-item:active { transform: scale(0.98); }

        .heat-item::before {
            content: '';
            position: absolute;
            top: 0; left: 0; right: 0; height: 4px;
        }

        .heat-item.critical::before { background: linear-gradient(90deg, #ef4444, #f97316); }
        .heat-item.high::before { background: linear-gradient(90deg, #f97316, #eab308); }
        .heat-item.medium::before { background: linear-gradient(90deg, #eab308, #22c55e); }
        .heat-item.low::before { background: linear-gradient(90deg, #22c55e, #14b8a6); }

        .heat-score {
            position: absolute;
            top: 15px;
            right: 15px;
            font-size: 1.8rem;
            font-weight: 800;
        }

        .heat-item.critical .heat-score { color: #ef4444; }
        .heat-item.high .heat-score { color: #f97316; }
        .heat-item.medium .heat-score { color: #eab308; }
        .heat-item.low .heat-score { color: #22c55e; }

        .heat-name { font-size: 1rem; font-weight: 700; color: var(--text-primary); margin-bottom: 6px; padding-right: 50px; }
        .heat-desc { font-size: 0.85rem; color: var(--text-muted); margin-bottom: 12px; }

        .heat-metrics { display: flex; gap: 15px; margin-top: 12px; }
        .heat-metric { font-size: 0.75rem; color: var(--text-muted); }
        .heat-metric span { color: var(--text-secondary); font-weight: 600; }

        /* Agent Cards */
        .agent-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(380px, 1fr)); gap: 25px; margin-bottom: 35px; }

        .agent-card {
            background: var(--bg-card);
            border: 1px solid var(--border-subtle);
            border-radius: 16px;
            overflow: hidden;
            transition: transform 0.2s, box-shadow 0.2s;
        }

        .agent-card:hover { transform: translateY(-5px); box-shadow: 0 15px 50px rgba(0,0,0,0.3); }

        .agent-card.highlight {
            animation: highlightPulse 2s ease;
            box-shadow: 0 0 0 3px var(--accent-purple), 0 15px 50px rgba(139, 92, 246, 0.4);
        }

        @keyframes highlightPulse {
            0% { box-shadow: 0 0 0 3px var(--accent-purple), 0 15px 50px rgba(139, 92, 246, 0.6); }
            50% { box-shadow: 0 0 0 6px rgba(139, 92, 246, 0.5), 0 15px 50px rgba(139, 92, 246, 0.3); }
            100% { box-shadow: 0 0 0 0px transparent, 0 15px 50px rgba(0,0,0,0.3); }
        }

        .agent-card-header {
            padding: 22px;
            display: flex;
            align-items: flex-start;
            gap: 18px;
            border-bottom: 1px solid var(--border-subtle);
        }

        .agent-icon {
            width: 55px;
            height: 55px;
            background: linear-gradient(135deg, var(--accent-purple) 0%, var(--accent-blue) 100%);
            border-radius: 14px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.6rem;
            flex-shrink: 0;
        }

        .agent-info { flex: 1; }
        .agent-name { font-size: 1.15rem; font-weight: 700; color: var(--text-primary); margin-bottom: 5px; }
        .agent-type { font-size: 0.8rem; color: var(--accent-purple); font-weight: 600; text-transform: uppercase; letter-spacing: 0.05em; }

        .agent-priority {
            padding: 6px 12px;
            border-radius: 20px;
            font-size: 0.75rem;
            font-weight: 700;
            text-transform: uppercase;
        }

        .agent-priority.critical { background: rgba(239, 68, 68, 0.15); color: #ef4444; }
        .agent-priority.high { background: rgba(249, 115, 22, 0.15); color: #f97316; }
        .agent-priority.medium { background: rgba(234, 179, 8, 0.15); color: #eab308; }
        .agent-priority.low { background: rgba(34, 197, 94, 0.15); color: #22c55e; }

        .agent-card-body { padding: 22px; }
        .agent-description { font-size: 0.95rem; color: var(--text-secondary); line-height: 1.6; margin-bottom: 20px; }

        .agent-flow {
            background: rgba(0,0,0,0.3);
            border: 1px solid var(--border-subtle);
            border-radius: 10px;
            padding: 18px;
            margin-bottom: 20px;
        }

        .agent-flow-title { font-size: 0.85rem; color: var(--text-muted); margin-bottom: 12px; font-weight: 600; text-transform: uppercase; letter-spacing: 0.05em; }

        .agent-flow-diagram { display: flex; align-items: center; flex-wrap: wrap; gap: 8px; justify-content: center; }

        .agent-step {
            background: linear-gradient(135deg, var(--accent-purple) 0%, var(--accent-blue) 100%);
            color: white;
            padding: 8px 14px;
            border-radius: 6px;
            font-size: 0.8rem;
            font-weight: 600;
            white-space: nowrap;
        }

        .agent-arrow { color: var(--accent-purple); font-size: 1.2rem; }

        .agent-stats { display: grid; grid-template-columns: repeat(3, 1fr); gap: 12px; }

        .agent-stat {
            background: rgba(0,0,0,0.2);
            border-radius: 8px;
            padding: 12px;
            text-align: center;
        }

        .agent-stat-value {
            font-size: 1.3rem;
            font-weight: 800;
            background: linear-gradient(135deg, var(--accent-purple) 0%, var(--accent-amber) 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .agent-stat-label { font-size: 0.7rem; color: var(--text-muted); text-transform: uppercase; letter-spacing: 0.05em; margin-top: 4px; }

        .agent-prompt-btn {
            width: 100%;
            margin-top: 18px;
            padding: 14px 20px;
            background: linear-gradient(135deg, rgba(139, 92, 246, 0.2) 0%, rgba(59, 130, 246, 0.2) 100%);
            border: 1px solid rgba(139, 92, 246, 0.4);
            border-radius: 10px;
            color: var(--accent-purple);
            font-weight: 700;
            cursor: pointer;
            transition: all 0.2s;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
            font-size: 0.9rem;
        }

        .agent-prompt-btn:hover {
            background: linear-gradient(135deg, rgba(139, 92, 246, 0.3) 0%, rgba(59, 130, 246, 0.3) 100%);
            border-color: var(--accent-purple);
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(139, 92, 246, 0.25);
        }

        /* Summary Stats */
        .agent-summary {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin-bottom: 35px;
        }

        .agent-summary-card {
            background: var(--bg-card);
            border: 1px solid var(--border-subtle);
            border-radius: 14px;
            padding: 25px;
            text-align: center;
        }

        .agent-summary-value {
            font-size: 2.5rem;
            font-weight: 800;
            background: linear-gradient(135deg, var(--accent-purple) 0%, var(--accent-amber) 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .agent-summary-label { font-size: 0.9rem; color: var(--text-muted); margin-top: 8px; }

        /* Heat Map Legend */
        .heat-legend {
            display: flex;
            gap: 25px;
            padding: 18px 22px;
            background: var(--bg-card);
            border: 1px solid var(--border-subtle);
            border-radius: 12px;
            margin-bottom: 25px;
            flex-wrap: wrap;
        }

        .heat-legend-item { display: flex; align-items: center; gap: 10px; font-size: 0.9rem; color: var(--text-secondary); }
        .heat-legend-color { width: 24px; height: 24px; border-radius: 6px; }

        /* Modal */
        .modal-overlay {
            display: none;
            position: fixed;
            top: 0; left: 0; right: 0; bottom: 0;
            background: rgba(10, 15, 26, 0.9);
            z-index: 2000;
            justify-content: center;
            align-items: center;
            padding: 20px;
            backdrop-filter: blur(5px);
        }

        .modal-overlay.show { display: flex; }

        .modal {
            background: var(--bg-card);
            border: 1px solid var(--border-subtle);
            border-radius: 16px;
            width: 100%;
            max-width: 950px;
            max-height: 90vh;
            display: flex;
            flex-direction: column;
            box-shadow: 0 25px 80px rgba(0,0,0,0.5);
        }

        .modal-header {
            background: linear-gradient(135deg, var(--accent-blue) 0%, var(--accent-teal) 100%);
            color: white;
            padding: 22px 28px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            border-radius: 16px 16px 0 0;
        }

        .modal-header h3 { font-size: 1.25rem; font-weight: 700; }
        .modal-actions { display: flex; gap: 12px; }

        .modal-btn {
            padding: 10px 18px;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-weight: 700;
            transition: transform 0.2s;
            font-size: 0.9rem;
        }

        .modal-btn:hover { transform: scale(1.05); }
        .modal-btn.copy { background: white; color: var(--accent-blue); }
        .modal-btn.close { background: rgba(255,255,255,0.2); color: white; }

        .modal-body { padding: 28px; overflow-y: auto; flex: 1; }

        .modal-body pre {
            background: rgba(0,0,0,0.3);
            border: 1px solid var(--border-subtle);
            padding: 22px;
            border-radius: 10px;
            font-family: 'JetBrains Mono', monospace;
            font-size: 0.9rem;
            line-height: 1.7;
            white-space: pre-wrap;
            word-wrap: break-word;
            color: var(--text-secondary);
        }

        .copy-success {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: var(--accent-green);
            color: white;
            padding: 18px 35px;
            border-radius: 10px;
            font-weight: 700;
            z-index: 3000;
            display: none;
            animation: fadeInOut 2s ease;
        }

        @keyframes fadeInOut { 0%, 100% { opacity: 0; } 10%, 90% { opacity: 1; } }

        /* Prompt Modal */
        .prompt-modal .modal { max-width: 800px; }
        .prompt-modal .modal-header { background: linear-gradient(135deg, var(--accent-purple) 0%, var(--accent-blue) 100%); }

        .prompt-section { margin-bottom: 25px; }
        .prompt-section h4 { color: var(--accent-purple); font-size: 1rem; margin-bottom: 12px; display: flex; align-items: center; gap: 8px; }

        .prompt-box {
            background: rgba(0,0,0,0.4);
            border: 1px solid var(--border-subtle);
            border-radius: 10px;
            padding: 20px;
            font-family: 'JetBrains Mono', monospace;
            font-size: 0.85rem;
            line-height: 1.7;
            color: var(--text-secondary);
            white-space: pre-wrap;
            word-wrap: break-word;
        }

        .prompt-tags { display: flex; gap: 10px; flex-wrap: wrap; margin-bottom: 20px; }
        .prompt-tag { background: rgba(139, 92, 246, 0.15); color: var(--accent-purple); padding: 6px 14px; border-radius: 20px; font-size: 0.8rem; font-weight: 600; }

        @media (max-width: 900px) {
            .sidebar { display: none; }
            .main-content { margin-left: 0; padding: 75px 20px 30px 20px; }
            .agent-grid { grid-template-columns: 1fr; }
        }
            .breadcrumb-logo-link { display: flex; align-items: center; padding: 4px 8px; background: rgba(255,255,255,0.08); border-radius: 8px; border: 1px solid rgba(255,255,255,0.12); transition: all 0.2s; }
        .breadcrumb-logo-link:hover { background: rgba(255,255,255,0.15); }
        .breadcrumb-logo { height: 28px; width: auto; }
    </style>
</head>
<body>
    <!-- Breadcrumb -->
    <nav class="breadcrumb">
        <a href="../../index.html" class="breadcrumb-logo-link"><img src="../../images/clear-ai-logo.png" alt="Clear AI" class="breadcrumb-logo"></a>
        <a href="../../index.html">Portal Home</a>
        <span class="separator">></span>
        <a href="./index.html">Byte</a>
        <span class="separator">></span>
        <span class="current">ARM Loans - Qualifying Rates & Plan Codes</span>
    </nav>

    <!-- Fixed Sidebar -->
    <aside class="sidebar">
        <div class="sidebar-header">
            <h2>ARM Qualifying Rates</h2>
            <p>Interactive Workflow Guide</p>
        </div>

        <!-- Tab Switcher -->
        <div class="sidebar-tabs">
            <button class="sidebar-tab active" onclick="switchTab('workflow')">Workflow</button>
            <button class="sidebar-tab agent-tab" onclick="switchTab('agents')">AI Agents</button>
        </div>

        <!-- Workflow Navigation -->
        <nav class="sidebar-nav" id="workflow-nav">
            <a href="#section-1" class="nav-item active">
                <span class="nav-number">1</span>
                <span class="nav-label">Overview</span>
            </a>
            <a href="#section-2" class="nav-item">
                <span class="nav-number">2</span>
                <span class="nav-label">Open 1008 Transmittal</span>
            </a>
            <a href="#section-3" class="nav-item">
                <span class="nav-number">3</span>
                <span class="nav-label">Select Qual Rate Option</span>
            </a>
            <a href="#section-4" class="nav-item">
                <span class="nav-number">4</span>
                <span class="nav-label">Rounding Rules</span>
            </a>
            <a href="#section-5" class="nav-item">
                <span class="nav-number">5</span>
                <span class="nav-label">Amortization Settings</span>
            </a>
            <a href="#section-6" class="nav-item">
                <span class="nav-number">6</span>
                <span class="nav-label">ARM Plan Codes</span>
            </a>
            <a href="#section-7" class="nav-item">
                <span class="nav-number">7</span>
                <span class="nav-label">DU Configuration</span>
            </a>
            <a href="#quick-ref" class="nav-item">
                <span class="nav-number">*</span>
                <span class="nav-label">Quick Reference</span>
            </a>
        </nav>

        <!-- Agent Navigation -->
        <nav class="sidebar-nav" id="agents-nav" style="display: none;">
            <a href="#agent-summary" class="nav-item active">
                <span class="nav-number">S</span>
                <span class="nav-label">Summary</span>
            </a>
            <a href="#agent-heatmap" class="nav-item">
                <span class="nav-number">H</span>
                <span class="nav-label">Heat Map</span>
            </a>
            <a href="#agent-details" class="nav-item">
                <span class="nav-number">A</span>
                <span class="nav-label">Agent Details</span>
            </a>
        </nav>

        <div class="sidebar-footer">
            <button class="doc-btn" onclick="openDocModal()">
                View Workflow Markdown
            </button>
        </div>
    </aside>

    <!-- Main Content -->
    <main class="main-content">

        <!-- ==================== WORKFLOW TAB ==================== -->
        <div id="workflow-panel" class="tab-panel active">
            <!-- Header -->
            <div class="header">
                <h1>ARM Loans - Qualifying Rates & Plan Codes</h1>
                <p class="subtitle">Configure ARM products correctly in Byte for accurate AUS processing</p>
                <div class="meta">
                    <span class="meta-item">System: Byte LOS</span>
                    <span class="meta-item">Roles: Processor, Underwriter</span>
                    <span class="meta-item">Updated: Feb 10, 2023</span>
                    <span class="meta-item">Duration: 5-10 min</span>
                </div>
            </div>

            <!-- Legend -->
            <div class="legend">
                <div class="legend-item"><div class="legend-color" style="background: linear-gradient(135deg, #22c55e, #16a34a);"></div><span>Start/End</span></div>
                <div class="legend-item"><div class="legend-color" style="background: linear-gradient(135deg, #3b82f6, #2563eb);"></div><span>Action Step</span></div>
                <div class="legend-item"><div class="legend-color" style="background: linear-gradient(135deg, #f59e0b, #d97706);"></div><span>Decision Point</span></div>
                <div class="legend-item"><div class="legend-color" style="background: #111827; border: 2px solid #3b82f6;"></div><span>User Input</span></div>
                <div class="legend-item"><div class="legend-color" style="background: linear-gradient(135deg, #f43f5e, #dc2626);"></div><span>Exception</span></div>
                <div class="legend-item"><div class="legend-color" style="background: linear-gradient(135deg, #14b8a6, #0d9488);"></div><span>Output</span></div>
            </div>

            <!-- Section 1: Overview -->
            <section id="section-1" class="section">
                <div class="section-header">
                    <div class="section-number">1</div>
                    <div class="section-title"><h2>ARM Qualifying Rate Overview</h2><span>Understanding the Qual Rate purpose and responsibilities</span></div>
                </div>
                <div class="section-content">
                    <div class="info-box">
                        <h4>What is the Qualifying Rate?</h4>
                        <p>The <strong>Qual Rate</strong> (Qualifying Rate) is used for ARM programs to determine the <strong>highest Principal and Interest payment</strong> that can increase for qualifying purposes. This rate must be identified when an ARM product is selected in Byte.</p>
                    </div>

                    <div class="summary-grid">
                        <div class="summary-card">
                            <h4>Processor Duty</h4>
                            <div class="value" style="font-size: 1rem; background: none; color: var(--accent-blue); -webkit-text-fill-color: var(--accent-blue);">Set Before AUS</div>
                            <div class="label">Prior to running AUS & submitting to UW</div>
                        </div>
                        <div class="summary-card">
                            <h4>Underwriter Duty</h4>
                            <div class="value" style="font-size: 1rem; background: none; color: var(--accent-teal); -webkit-text-fill-color: var(--accent-teal);">Validate</div>
                            <div class="label">At Approved and Clear To Close</div>
                        </div>
                        <div class="summary-card">
                            <h4>Common Options</h4>
                            <div class="value" style="font-size: 1rem; background: none; color: var(--accent-amber); -webkit-text-fill-color: var(--accent-amber);">Rate+2%</div>
                            <div class="label">Or Fully Indexed Rate</div>
                        </div>
                    </div>

                    <div class="workflow-diagram">
                        <h3 style="text-align: center; margin-bottom: 22px; color: var(--accent-blue);">Process Flow Overview</h3>
                        <div class="flow-row">
                            <div class="flow-node start">ARM Product Selected</div>
                            <span class="flow-arrow">-></span>
                            <div class="flow-node action">Open 1008 Transmittal</div>
                            <span class="flow-arrow">-></span>
                            <div class="flow-node action">Set Qual Rate</div>
                            <span class="flow-arrow">-></span>
                            <div class="flow-node action">Set Amortization</div>
                            <span class="flow-arrow">-></span>
                            <div class="flow-node output">Run AUS</div>
                        </div>
                    </div>
                </div>
            </section>

            <!-- Section 2: Open 1008 Transmittal -->
            <section id="section-2" class="section">
                <div class="section-header">
                    <div class="section-number">2</div>
                    <div class="section-title"><h2>Open 1008 Transmittal Screen</h2><span>Navigate to the Qualifying Rate field in Byte</span></div>
                </div>
                <div class="section-content">
                    <div class="workflow-diagram">
                        <div class="flow-row">
                            <div class="flow-node start">Start</div>
                            <span class="flow-arrow">-></span>
                            <div class="flow-node action">Open Byte Loan File</div>
                            <span class="flow-arrow">-></span>
                            <div class="flow-node action">Navigate to 1008 Transmittal Screen</div>
                            <span class="flow-arrow">-></span>
                            <div class="flow-node input">Click Qualifying Rate Amount</div>
                        </div>
                    </div>

                    <div class="tip-box">
                        <h4>Pro Tip</h4>
                        <p>The 1008 Transmittal Screen contains key underwriting information including LTV ratios, income details, and qualifying ratios. The Qualifying Rate field is located in the Qualifying Ratios section.</p>
                    </div>

                    <table class="field-table">
                        <thead>
                            <tr>
                                <th>Screen Section</th>
                                <th>Key Fields</th>
                                <th>Purpose</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td><strong style="color: var(--text-primary);">Underwriting Information</strong></td>
                                <td>Underwriter Name, Appraiser Info</td>
                                <td>Personnel assignments</td>
                            </tr>
                            <tr>
                                <td><strong style="color: var(--text-primary);">Stable Monthly Income</strong></td>
                                <td>Borrower 1-4, Other, Total Income</td>
                                <td>Income qualification</td>
                            </tr>
                            <tr>
                                <td><strong style="color: var(--text-primary);">LTV Ratios</strong></td>
                                <td>LTV, CLTV/TLTV, HCLTV/HTLTV</td>
                                <td>Loan-to-value calculations</td>
                            </tr>
                            <tr>
                                <td><strong style="color: var(--text-primary);">Qualifying Ratios</strong></td>
                                <td>Housing/Income, Total Obligations/Income</td>
                                <td>DTI calculations</td>
                            </tr>
                            <tr>
                                <td><strong style="color: var(--accent-blue);">Qualifying Rate</strong></td>
                                <td><span class="badge required-badge">Required for ARM</span></td>
                                <td>ARM payment qualification</td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </section>

            <!-- Section 3: Select Qual Rate Option -->
            <section id="section-3" class="section">
                <div class="section-header">
                    <div class="section-number">3</div>
                    <div class="section-title"><h2>Select Qualifying Rate Option</h2><span>Choose the appropriate Qual Rate based on guidelines</span></div>
                </div>
                <div class="section-content">
                    <div class="workflow-diagram">
                        <div class="flow-row">
                            <div class="flow-node input">Click Qualifying Rate</div>
                            <span class="flow-arrow">-></span>
                            <div class="flow-node output">Qualifying Options Window Opens</div>
                        </div>
                    </div>

                    <div class="info-box">
                        <h4>Qualifying Rate Options Available</h4>
                        <p>Select the appropriate option from the <strong>Qual Rate Option</strong> dropdown based on your product guidelines:</p>
                    </div>

                    <table class="field-table">
                        <thead>
                            <tr>
                                <th>Qual Rate Option</th>
                                <th>Description</th>
                                <th>When to Use</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td><strong style="color: var(--text-primary);">Note Rate</strong></td>
                                <td>Uses the actual note rate</td>
                                <td>Per specific guidelines</td>
                            </tr>
                            <tr>
                                <td><strong style="color: var(--text-primary);">Max Rate in First 5 Years</strong></td>
                                <td>Maximum rate possible in first 5 years</td>
                                <td>Some ARM products</td>
                            </tr>
                            <tr>
                                <td><strong style="color: var(--accent-blue);">Rate+2 or Rounded Fully Indexed Rate</strong></td>
                                <td>Higher of Note Rate + 2% or Fully Indexed (rounded)</td>
                                <td>Fannie Mae & Freddie Mac</td>
                            </tr>
                            <tr>
                                <td><strong style="color: var(--text-primary);">Rate or Rounded Fully Indexed Rate</strong></td>
                                <td>Higher of Note Rate or Fully Indexed (rounded)</td>
                                <td>7/6 and 10/6 SOFR ARMs</td>
                            </tr>
                            <tr>
                                <td><strong style="color: var(--text-primary);">Rate+2 or Unrounded Fully Indexed Rate</strong></td>
                                <td>Higher of Note Rate + 2% or Fully Indexed (unrounded)</td>
                                <td>Jumbo, FHA, VA loans</td>
                            </tr>
                            <tr>
                                <td><strong style="color: var(--text-primary);">Rate or Unrounded Fully Indexed Rate</strong></td>
                                <td>Higher of Note Rate or Fully Indexed (unrounded)</td>
                                <td>Per specific guidelines</td>
                            </tr>
                            <tr>
                                <td><strong style="color: var(--text-primary);">Rate+1</strong></td>
                                <td>Note Rate + 1%</td>
                                <td>Interest-only loans (no effect on non-IO)</td>
                            </tr>
                        </tbody>
                    </table>

                    <div class="decision-tree">
                        <h3>Qualifying Rate Decision Guide (SOFR ARMs)</h3>
                        <div class="tree-node level-1">
                            <span class="tree-label">Fully Amortizing</span>
                        </div>
                        <div class="tree-node">
                            <strong style="color: var(--accent-blue);">5yr/6m SOFR ARM:</strong> Qualify at higher of Note Rate + 2% OR Fully Indexed Rate
                        </div>
                        <div class="tree-node">
                            <strong style="color: var(--accent-teal);">7yr/6m and 10yr/6m SOFR ARMs:</strong> Qualify at higher of Note Rate OR Fully Indexed Rate
                        </div>
                        <div class="tree-node level-1" style="margin-top: 15px;">
                            <span class="tree-label" style="background: var(--accent-purple);">Interest Only</span>
                        </div>
                        <div class="tree-node">
                            <strong style="color: var(--accent-blue);">5yr/6m SOFR ARMs (IO):</strong> Qualify at fully amortizing (PITI) based on 20-year amortizing term at higher of Note Rate + 2% OR Fully Indexed Rate
                        </div>
                        <div class="tree-node">
                            <strong style="color: var(--accent-teal);">7yr/6m and 10yr/6m SOFR ARMs (IO):</strong> Qualify at fully amortizing (PITI) based on 20-year amortizing term at higher of Fully Indexed Rate OR Note Rate
                        </div>
                    </div>
                </div>
            </section>

            <!-- Section 4: Rounding Rules -->
            <section id="section-4" class="section">
                <div class="section-header">
                    <div class="section-number">4</div>
                    <div class="section-title"><h2>Rounding Rules by Loan Type</h2><span>Critical distinction for rate calculation accuracy</span></div>
                </div>
                <div class="section-content">
                    <div class="mi-comparison">
                        <div class="mi-card">
                            <div class="mi-card-header">
                                <h4>ROUNDED Rates</h4>
                            </div>
                            <div class="mi-card-body">
                                <ul>
                                    <li><span class="check-icon">*</span> Fannie Mae Loans</li>
                                    <li><span class="check-icon">*</span> Freddie Mac Loans</li>
                                </ul>
                                <p style="margin-top: 15px; font-size: 0.85rem; color: var(--text-muted);">Use "Rate+2 or <strong>Rounded</strong> Fully Indexed Rate" or similar rounded options</p>
                            </div>
                        </div>
                        <div class="mi-card">
                            <div class="mi-card-header" style="background: linear-gradient(135deg, var(--accent-amber) 0%, #d97706 100%);">
                                <h4>UNROUNDED Rates</h4>
                            </div>
                            <div class="mi-card-body">
                                <ul>
                                    <li><span class="check-icon">*</span> Jumbo Loans</li>
                                    <li><span class="check-icon">*</span> FHA Loans</li>
                                    <li><span class="check-icon">*</span> VA Loans</li>
                                </ul>
                                <p style="margin-top: 15px; font-size: 0.85rem; color: var(--text-muted);">Use "Rate+2 or <strong>Unrounded</strong> Fully Indexed Rate" or similar unrounded options</p>
                            </div>
                        </div>
                    </div>

                    <div class="exception-box">
                        <h4>Critical Reminder</h4>
                        <p>Always review the specific product guidelines to confirm the correct rounding rule. Incorrect rounding selection can affect qualification calculations and cause AUS discrepancies.</p>
                    </div>
                </div>
            </section>

            <!-- Section 5: Amortization Settings -->
            <section id="section-5" class="section">
                <div class="section-header">
                    <div class="section-number">5</div>
                    <div class="section-title"><h2>Configure Amortization Settings</h2><span>Set the Interest Only Qualifying Payment Option</span></div>
                </div>
                <div class="section-content">
                    <div class="workflow-diagram">
                        <div class="flow-row">
                            <div class="flow-node action">In Qualifying Options Window</div>
                            <span class="flow-arrow">-></span>
                            <div class="flow-node input">Select Amortization Dropdown</div>
                            <span class="flow-arrow">-></span>
                            <div class="flow-node decision">Review Guidelines</div>
                            <span class="flow-arrow">-></span>
                            <div class="flow-node output">Select Appropriate Option</div>
                        </div>
                    </div>

                    <div class="info-box">
                        <h4>Interest Only Qualifying Payment Option</h4>
                        <p>This option determines how the qualifying payment is calculated on interest-only loans. <strong>This option has no effect on loans without an interest-only component.</strong></p>
                    </div>

                    <table class="field-table">
                        <thead>
                            <tr>
                                <th>Amortization Option</th>
                                <th>Description</th>
                                <th>Usage</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td><strong style="color: var(--accent-green);">Amortizing Over Full Term</strong></td>
                                <td>Calculates payment amortized over the full loan term</td>
                                <td><span class="badge optional-badge">Most Common</span></td>
                            </tr>
                            <tr>
                                <td><strong style="color: var(--text-primary);">Default</strong></td>
                                <td>System default calculation</td>
                                <td>When no specific requirement</td>
                            </tr>
                            <tr>
                                <td><strong style="color: var(--text-primary);">Amortizing Over Non Interest Only Term</strong></td>
                                <td>Calculates payment over remaining term after IO period</td>
                                <td>Specific guideline requirements</td>
                            </tr>
                            <tr>
                                <td><strong style="color: var(--text-primary);">Interest Only</strong></td>
                                <td>Calculates interest-only payment</td>
                                <td>Specific guideline requirements</td>
                            </tr>
                        </tbody>
                    </table>

                    <div class="tip-box">
                        <h4>Final Step: Update Qualifying Rate Dropdown</h4>
                        <p>After configuring the Qual Rate Option and Amortization, update the <strong>Qualifying Rate</strong> dropdown in the main 1008 screen to <strong>"Rate Used For Qualifying"</strong>. This ensures the calculated rate is used for qualification.</p>
                    </div>
                </div>
            </section>

            <!-- Section 6: ARM Plan Codes -->
            <section id="section-6" class="section">
                <div class="section-header">
                    <div class="section-number">6</div>
                    <div class="section-title"><h2>Fannie Mae ARM Plan Codes</h2><span>Required for Desktop Underwriter (DU) processing</span></div>
                </div>
                <div class="section-content">
                    <div class="info-box">
                        <h4>ARM Plan Number Importance</h4>
                        <p>When running <strong>Desktop Underwriter (DU)</strong>, Underwriters must confirm the correct <strong>Fannie Mae ARM Plan Number</strong> is selected. When an ARM plan code is populated, DU processes the loan using the correct qual rate.</p>
                    </div>

                    <table class="field-table">
                        <thead>
                            <tr>
                                <th>Plan Number</th>
                                <th>ARM Type</th>
                                <th>Index</th>
                                <th>ARM Plan Initial</th>
                                <th>Periodic Change</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td><strong style="color: var(--accent-blue);">4926</strong></td>
                                <td>Fully Amortizing Conv ARM (up to 30 yr)</td>
                                <td>30-Day Avg SOFR</td>
                                <td>19-42 / 6</td>
                                <td>+/- 2% / +/- 1%</td>
                            </tr>
                            <tr>
                                <td><strong style="color: var(--accent-blue);">4927</strong></td>
                                <td>Fully Amortizing Conv ARM (up to 30 yr)</td>
                                <td>30-Day Avg SOFR</td>
                                <td>43-66 / 6</td>
                                <td>+/- 2% / +/- 1%</td>
                            </tr>
                            <tr>
                                <td><strong style="color: var(--accent-amber);">4927 Texas 50(a)(6)</strong></td>
                                <td>Texas Home Equity</td>
                                <td>30-Day Avg SOFR</td>
                                <td>43-66 / 6</td>
                                <td>+/- 2% / +/- 1%</td>
                            </tr>
                            <tr>
                                <td><strong style="color: var(--accent-blue);">4928</strong></td>
                                <td>Fully Amortizing Conv ARM (up to 30 yr)</td>
                                <td>30-Day Avg SOFR</td>
                                <td>67-90 / 6</td>
                                <td>+/- 5% / +/- 1%</td>
                            </tr>
                            <tr>
                                <td><strong style="color: var(--accent-amber);">4928 Texas 50(a)(6)</strong></td>
                                <td>Texas Home Equity</td>
                                <td>30-Day Avg SOFR</td>
                                <td>67-90 / 6</td>
                                <td>+/- 5% / +/- 1%</td>
                            </tr>
                            <tr>
                                <td><strong style="color: var(--accent-blue);">4929</strong></td>
                                <td>Fully Amortizing Conv ARM (up to 30 yr)</td>
                                <td>30-Day Avg SOFR</td>
                                <td>91-150 / 6</td>
                                <td>+/- 5% / +/- 1%</td>
                            </tr>
                            <tr>
                                <td><strong style="color: var(--accent-amber);">4929 Texas 50(a)(6)</strong></td>
                                <td>Texas Home Equity</td>
                                <td>30-Day Avg SOFR</td>
                                <td>91-150 / 6</td>
                                <td>+/- 5% / +/- 1%</td>
                            </tr>
                        </tbody>
                    </table>

                    <div class="warning-box">
                        <h4>Important Notes</h4>
                        <ul style="margin-top: 10px; margin-left: 20px;">
                            <li style="margin-bottom: 8px;"><strong>Freddie Mac loans do NOT require an ARM Plan code</strong></li>
                            <li style="margin-bottom: 8px;">Guidelines are subject to change - always verify with the Fannie Mae Qualifying Rate Requirements chart</li>
                            <li style="margin-bottom: 8px;">Refer to the <strong>Qual Rate Defaults for Byte</strong> cheat sheet for details on Qualifying Rates and ARM Plan codes</li>
                        </ul>
                    </div>

                    <div class="tip-box">
                        <h4>Report Discrepancies</h4>
                        <p>Please notify the Training Team at <strong>training@cmgfi.com</strong> if any discrepancies exist between the Qual Rate Defaults for Byte cheat sheet and the Fannie Mae Qualifying Rate Requirements chart.</p>
                    </div>
                </div>
            </section>

            <!-- Section 7: DU Configuration -->
            <section id="section-7" class="section">
                <div class="section-header">
                    <div class="section-number">7</div>
                    <div class="section-title"><h2>Configure DU XIS Screen</h2><span>Select ARM Plan Number for Desktop Underwriter</span></div>
                </div>
                <div class="section-content">
                    <div class="workflow-diagram">
                        <h3 style="text-align: center; margin-bottom: 22px; color: var(--accent-blue);">DU ARM Plan Configuration</h3>
                        <div class="flow-row">
                            <div class="flow-node start">Start</div>
                            <span class="flow-arrow">-></span>
                            <div class="flow-node action">Open Fannie Mae Screen</div>
                            <span class="flow-arrow">-></span>
                            <div class="flow-node action">Choose DU XIS</div>
                        </div>
                        <div class="flow-row">
                            <span class="flow-arrow" style="transform: rotate(90deg);">|</span>
                        </div>
                        <div class="flow-row">
                            <div class="flow-node input">Select ARM Plan Number Dropdown</div>
                            <span class="flow-arrow">-></span>
                            <div class="flow-node decision">Reference Guidelines</div>
                            <span class="flow-arrow">-></span>
                            <div class="flow-node output">Select Correct Plan Code</div>
                        </div>
                    </div>

                    <div class="info-box">
                        <h4>Available ARM Plan Options in Byte</h4>
                        <p>The Fannie Mae Arm Plan Number dropdown includes numerous options. Common selections include:</p>
                    </div>

                    <table class="field-table">
                        <thead>
                            <tr>
                                <th>Plan Code</th>
                                <th>Description</th>
                                <th>Usage</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td><strong style="color: var(--text-primary);">2722 - 2729</strong></td>
                                <td>WSJ LIBOR Convertible / Standard</td>
                                <td>Legacy LIBOR products</td>
                            </tr>
                            <tr>
                                <td><strong style="color: var(--text-primary);">3549 - 3552</strong></td>
                                <td>FHA ARM Treasury-based</td>
                                <td>FHA ARM products</td>
                            </tr>
                            <tr>
                                <td><strong style="color: var(--accent-blue);">4926 - 4929</strong></td>
                                <td>SOFR-based ARM Plans</td>
                                <td><span class="badge required-badge">Current Standard</span></td>
                            </tr>
                            <tr>
                                <td><strong style="color: var(--text-primary);">FM GENERIC</strong></td>
                                <td>Generic Fannie Mae plans (1 YR, 3 YR, 5 YR, 7 YR, 10 YR)</td>
                                <td>Various ARM terms</td>
                            </tr>
                            <tr>
                                <td><strong style="color: var(--text-primary);">VA 1 YR ARM / VA HYBRID ARM</strong></td>
                                <td>VA-specific ARM products</td>
                                <td>VA loans</td>
                            </tr>
                            <tr>
                                <td><strong style="color: var(--text-primary);">LENDER ARM PLAN</strong></td>
                                <td>Custom lender-defined ARM</td>
                                <td>Proprietary products</td>
                            </tr>
                        </tbody>
                    </table>

                    <div class="exception-box">
                        <h4>Non-Fannie Mae ARMs</h4>
                        <p>For loans that are adjustable but are <strong>not part of the Fannie Mae listing</strong> (like Jumbo or private investors), review the <strong>investor guidelines</strong> for the selection if applicable.</p>
                    </div>
                </div>
            </section>

            <!-- Section 8: View Maximum Payment -->
            <section id="section-8" class="section">
                <div class="section-header">
                    <div class="section-number">8</div>
                    <div class="section-title"><h2>Verify Maximum Payment</h2><span>Confirm ARM payment projections in disclosure screens</span></div>
                </div>
                <div class="section-content">
                    <div class="info-box">
                        <h4>Where to View Maximum Payment</h4>
                        <p>The maximum payment is shown in different screens based on the loan type:</p>
                    </div>

                    <div class="mi-comparison">
                        <div class="mi-card">
                            <div class="mi-card-header">
                                <h4>Loan Estimate Page 3</h4>
                            </div>
                            <div class="mi-card-body">
                                <ul>
                                    <li><span class="check-icon">*</span> Payment Calculation section</li>
                                    <li><span class="check-icon">*</span> Shows Years 1-7, Year 8, Year 9, Years 10-30</li>
                                    <li><span class="check-icon">*</span> Min/Max Principal & Interest ranges</li>
                                    <li><span class="check-icon">*</span> Estimated Total Monthly Payment</li>
                                </ul>
                            </div>
                        </div>
                        <div class="mi-card">
                            <div class="mi-card-header" style="background: linear-gradient(135deg, var(--accent-teal) 0%, #0d9488 100%);">
                                <h4>GFE 2010 Pages 1 and 3 (HELOC)</h4>
                            </div>
                            <div class="mi-card-body">
                                <ul>
                                    <li><span class="check-icon">*</span> Interest rate rise maximum</li>
                                    <li><span class="check-icon">*</span> First change timing and amount</li>
                                    <li><span class="check-icon">*</span> Maximum P&I payment ever</li>
                                    <li><span class="check-icon">*</span> Balance rise limits</li>
                                </ul>
                            </div>
                        </div>
                    </div>
                </div>
            </section>

            <!-- Quick Reference -->
            <section id="quick-ref" class="quick-ref">
                <h3>Quick Reference Card</h3>
                <pre>
ARM QUALIFYING RATES IN BYTE - QUICK GUIDE
==========================================

PROCESSOR TASKS (Before AUS):
1. Open 1008 Transmittal Screen
2. Click Qualifying Rate amount
3. Select Qual Rate Option from dropdown
4. Set Amortization (if Interest-Only)
5. Update Qualifying Rate to "Rate Used For Qualifying"

ROUNDING RULES:
* ROUNDED: Fannie Mae, Freddie Mac
* UNROUNDED: Jumbo, FHA, VA

COMMON QUAL RATE OPTIONS:
* 5/6 SOFR: Rate+2% or Fully Indexed
* 7/6 & 10/6 SOFR: Note Rate or Fully Indexed

FANNIE MAE ARM PLAN CODES (SOFR):
* 4926: 19-42 month initial, 6mo adjust
* 4927: 43-66 month initial, 6mo adjust
* 4928: 67-90 month initial, 6mo adjust
* 4929: 91-150 month initial, 6mo adjust

UNDERWRITER VALIDATION:
* Verify at Approved status
* Verify at Clear To Close
* Confirm DU ARM Plan Number is correct

NOTE: Freddie Mac does NOT require ARM Plan codes

CONTACT: training@cmgfi.com for discrepancies
                </pre>
            </section>
        </div>

        <!-- ==================== AGENT OPPORTUNITIES TAB ==================== -->
        <div id="agents-panel" class="tab-panel">
            <!-- Header -->
            <div class="agent-header">
                <h1>AI Agent Opportunities</h1>
                <p class="subtitle">Automation Analysis for ARM Qualifying Rate Configuration</p>
                <div class="meta">
                    <span class="meta-item">8 Process Steps Analyzed</span>
                    <span class="meta-item">4 Agent Candidates Identified</span>
                    <span class="meta-item">Est. 60% Error Reduction</span>
                </div>
            </div>

            <!-- Summary Stats -->
            <div class="agent-summary" id="agent-summary">
                <div class="agent-summary-card">
                    <div class="agent-summary-value">4</div>
                    <div class="agent-summary-label">Agent Candidates</div>
                </div>
                <div class="agent-summary-card">
                    <div class="agent-summary-value">2</div>
                    <div class="agent-summary-label">High Priority</div>
                </div>
                <div class="agent-summary-card">
                    <div class="agent-summary-value">60%</div>
                    <div class="agent-summary-label">Error Reduction</div>
                </div>
                <div class="agent-summary-card">
                    <div class="agent-summary-value">75%</div>
                    <div class="agent-summary-label">Automation Potential</div>
                </div>
            </div>

            <!-- Heat Map Legend -->
            <div class="heat-legend" id="agent-heatmap">
                <div class="heat-legend-item"><div class="heat-legend-color" style="background: linear-gradient(135deg, #ef4444, #f97316);"></div><span><strong>Critical (90-100)</strong> - Immediate ROI</span></div>
                <div class="heat-legend-item"><div class="heat-legend-color" style="background: linear-gradient(135deg, #f97316, #eab308);"></div><span><strong>High (70-89)</strong> - Strong candidate</span></div>
                <div class="heat-legend-item"><div class="heat-legend-color" style="background: linear-gradient(135deg, #eab308, #22c55e);"></div><span><strong>Medium (50-69)</strong> - Consider</span></div>
                <div class="heat-legend-item"><div class="heat-legend-color" style="background: linear-gradient(135deg, #22c55e, #14b8a6);"></div><span><strong>Low (0-49)</strong> - Future phase</span></div>
            </div>

            <!-- Heat Map Grid -->
            <div class="heat-map-container">
                <div class="heat-map-title">Automation Priority Heat Map <span style="font-size: 0.8rem; font-weight: 400; color: var(--text-muted);">(Click to jump to agent)</span></div>
                <div class="heat-map-grid">
                    <div class="heat-item critical" onclick="scrollToAgent('agent-autoconfig')" title="Click to view agent details">
                        <div class="heat-score">92</div>
                        <div class="heat-name">ARM Auto-Configuration</div>
                        <div class="heat-desc">Auto-populate Qual Rate based on product</div>
                        <div class="heat-metrics">
                            <div class="heat-metric">Effort: <span>Medium</span></div>
                            <div class="heat-metric">Impact: <span>High</span></div>
                            <div class="heat-metric">Step: <span>3</span></div>
                        </div>
                    </div>
                    <div class="heat-item high" onclick="scrollToAgent('agent-plancode')" title="Click to view agent details">
                        <div class="heat-score">85</div>
                        <div class="heat-name">Plan Code Selector</div>
                        <div class="heat-desc">Recommend correct ARM Plan Code</div>
                        <div class="heat-metrics">
                            <div class="heat-metric">Effort: <span>Low</span></div>
                            <div class="heat-metric">Impact: <span>High</span></div>
                            <div class="heat-metric">Step: <span>6-7</span></div>
                        </div>
                    </div>
                    <div class="heat-item high" onclick="scrollToAgent('agent-validator')" title="Click to view agent details">
                        <div class="heat-score">78</div>
                        <div class="heat-name">ARM Validation Agent</div>
                        <div class="heat-desc">Pre-AUS validation of ARM settings</div>
                        <div class="heat-metrics">
                            <div class="heat-metric">Effort: <span>Medium</span></div>
                            <div class="heat-metric">Impact: <span>High</span></div>
                            <div class="heat-metric">Step: <span>All</span></div>
                        </div>
                    </div>
                    <div class="heat-item medium" onclick="scrollToAgent('agent-guideline')" title="Click to view agent details">
                        <div class="heat-score">65</div>
                        <div class="heat-name">Guideline Lookup</div>
                        <div class="heat-desc">Real-time guideline retrieval</div>
                        <div class="heat-metrics">
                            <div class="heat-metric">Effort: <span>High</span></div>
                            <div class="heat-metric">Impact: <span>Medium</span></div>
                            <div class="heat-metric">Step: <span>3,6</span></div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Agent Details -->
            <h2 style="font-size: 1.4rem; margin: 35px 0 22px; color: var(--text-primary);" id="agent-details">Agent Specifications</h2>

            <div class="agent-grid">
                <!-- Agent 1: ARM Auto-Configuration -->
                <div class="agent-card" id="agent-autoconfig">
                    <div class="agent-card-header">
                        <div class="agent-icon">G</div>
                        <div class="agent-info">
                            <div class="agent-name">ARM Auto-Configuration Agent</div>
                            <div class="agent-type">Rules Engine Agent</div>
                        </div>
                        <span class="agent-priority critical">Critical</span>
                    </div>
                    <div class="agent-card-body">
                        <p class="agent-description">Automatically configures the Qualifying Rate Option, Amortization, and Rounding based on the selected ARM product type, loan program, and investor. Eliminates manual lookup and reduces configuration errors by 90%.</p>
                        <div class="agent-flow">
                            <div class="agent-flow-title">Agent Flow</div>
                            <div class="agent-flow-diagram">
                                <div class="agent-step">Detect ARM Product</div>
                                <span class="agent-arrow">-></span>
                                <div class="agent-step">Identify Program</div>
                                <span class="agent-arrow">-></span>
                                <div class="agent-step">Apply Rules</div>
                                <span class="agent-arrow">-></span>
                                <div class="agent-step">Auto-Fill</div>
                            </div>
                        </div>
                        <div class="agent-stats">
                            <div class="agent-stat"><div class="agent-stat-value">5min</div><div class="agent-stat-label">Time Saved</div></div>
                            <div class="agent-stat"><div class="agent-stat-value">90%</div><div class="agent-stat-label">Error Reduction</div></div>
                            <div class="agent-stat"><div class="agent-stat-value">Med</div><div class="agent-stat-label">Complexity</div></div>
                        </div>
                        <button class="agent-prompt-btn" onclick="showAgentPrompt('autoconfig')">
                            View AI Prompt to Build This Agent
                        </button>
                    </div>
                </div>

                <!-- Agent 2: Plan Code Selector -->
                <div class="agent-card" id="agent-plancode">
                    <div class="agent-card-header">
                        <div class="agent-icon">#</div>
                        <div class="agent-info">
                            <div class="agent-name">Plan Code Selector Agent</div>
                            <div class="agent-type">Decision Support Agent</div>
                        </div>
                        <span class="agent-priority high">High</span>
                    </div>
                    <div class="agent-card-body">
                        <p class="agent-description">Analyzes ARM product parameters (initial period, adjustment frequency, index) and recommends the correct Fannie Mae ARM Plan Number. Includes validation against the current Fannie Mae ARM Matrix.</p>
                        <div class="agent-flow">
                            <div class="agent-flow-title">Agent Flow</div>
                            <div class="agent-flow-diagram">
                                <div class="agent-step">Read ARM Terms</div>
                                <span class="agent-arrow">-></span>
                                <div class="agent-step">Match Matrix</div>
                                <span class="agent-arrow">-></span>
                                <div class="agent-step">Verify Index</div>
                                <span class="agent-arrow">-></span>
                                <div class="agent-step">Recommend Code</div>
                            </div>
                        </div>
                        <div class="agent-stats">
                            <div class="agent-stat"><div class="agent-stat-value">3min</div><div class="agent-stat-label">Time Saved</div></div>
                            <div class="agent-stat"><div class="agent-stat-value">98%</div><div class="agent-stat-label">Accuracy</div></div>
                            <div class="agent-stat"><div class="agent-stat-value">Low</div><div class="agent-stat-label">Complexity</div></div>
                        </div>
                        <button class="agent-prompt-btn" onclick="showAgentPrompt('plancode')">
                            View AI Prompt to Build This Agent
                        </button>
                    </div>
                </div>

                <!-- Agent 3: ARM Validation Agent -->
                <div class="agent-card" id="agent-validator">
                    <div class="agent-card-header">
                        <div class="agent-icon">!</div>
                        <div class="agent-info">
                            <div class="agent-name">ARM Validation Agent</div>
                            <div class="agent-type">Quality Control Agent</div>
                        </div>
                        <span class="agent-priority high">High</span>
                    </div>
                    <div class="agent-card-body">
                        <p class="agent-description">Pre-AUS validation agent that checks all ARM configuration settings against product guidelines before submission. Catches misconfigurations that would cause AUS errors or underwriting delays.</p>
                        <div class="agent-flow">
                            <div class="agent-flow-title">Agent Flow</div>
                            <div class="agent-flow-diagram">
                                <div class="agent-step">Scan ARM Fields</div>
                                <span class="agent-arrow">-></span>
                                <div class="agent-step">Load Guidelines</div>
                                <span class="agent-arrow">-></span>
                                <div class="agent-step">Compare</div>
                                <span class="agent-arrow">-></span>
                                <div class="agent-step">Report Issues</div>
                            </div>
                        </div>
                        <div class="agent-stats">
                            <div class="agent-stat"><div class="agent-stat-value">Pre-AUS</div><div class="agent-stat-label">Timing</div></div>
                            <div class="agent-stat"><div class="agent-stat-value">-75%</div><div class="agent-stat-label">AUS Errors</div></div>
                            <div class="agent-stat"><div class="agent-stat-value">Med</div><div class="agent-stat-label">Complexity</div></div>
                        </div>
                        <button class="agent-prompt-btn" onclick="showAgentPrompt('validator')">
                            View AI Prompt to Build This Agent
                        </button>
                    </div>
                </div>

                <!-- Agent 4: Guideline Lookup -->
                <div class="agent-card" id="agent-guideline">
                    <div class="agent-card-header">
                        <div class="agent-icon">?</div>
                        <div class="agent-info">
                            <div class="agent-name">Guideline Lookup Agent</div>
                            <div class="agent-type">Knowledge Retrieval Agent</div>
                        </div>
                        <span class="agent-priority medium">Medium</span>
                    </div>
                    <div class="agent-card-body">
                        <p class="agent-description">Real-time guideline retrieval agent that fetches current Fannie Mae, Freddie Mac, and investor ARM qualification requirements. Keeps users informed of guideline changes without manual lookup.</p>
                        <div class="agent-flow">
                            <div class="agent-flow-title">Agent Flow</div>
                            <div class="agent-flow-diagram">
                                <div class="agent-step">Identify Product</div>
                                <span class="agent-arrow">-></span>
                                <div class="agent-step">Query Source</div>
                                <span class="agent-arrow">-></span>
                                <div class="agent-step">Parse Rules</div>
                                <span class="agent-arrow">-></span>
                                <div class="agent-step">Display</div>
                            </div>
                        </div>
                        <div class="agent-stats">
                            <div class="agent-stat"><div class="agent-stat-value">Real-time</div><div class="agent-stat-label">Updates</div></div>
                            <div class="agent-stat"><div class="agent-stat-value">100%</div><div class="agent-stat-label">Coverage</div></div>
                            <div class="agent-stat"><div class="agent-stat-value">High</div><div class="agent-stat-label">Complexity</div></div>
                        </div>
                        <button class="agent-prompt-btn" onclick="showAgentPrompt('guideline')">
                            View AI Prompt to Build This Agent
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </main>

    <!-- Documentation Modal -->
    <div class="modal-overlay" id="docModal">
        <div class="modal">
            <div class="modal-header">
                <h3>ARM Qualifying Rates - Workflow Markdown</h3>
                <div class="modal-actions">
                    <button class="modal-btn copy" onclick="copyToClipboard()">Copy</button>
                    <button class="modal-btn close" onclick="closeDocModal()">Close</button>
                </div>
            </div>
            <div class="modal-body">
                <pre id="docContent"># ARM Loans - Qualifying Rates & Plan Codes in Byte

## Overview
The Qual Rate (Qualifying Rate) is for ARM programs to determine the highest Principal and Interest payment can increase for qualifying purposes. The Qual Rate must be identified when an ARM product is selected in Byte.

## Responsibilities
- **Loan Processors**: Set before running AUS and submitting to Underwriting
- **Underwriters**: Validate at Approved and Clear To Close

## Step-by-Step Process

### Step 1: Open 1008 Transmittal Screen
1. Open the loan file in Byte
2. Navigate to the 1008 Transmittal Screen
3. Click the Qualifying Rate amount

### Step 2: Select Qualifying Rate Option
The Qualifying Options window opens. Select from:
- Note Rate
- Max Rate in First 5 Years
- Rate+2 or Rounded Fully Indexed Rate (Fannie/Freddie)
- Rate or Rounded Fully Indexed Rate
- Rate+2 or Unrounded Fully Indexed Rate (Jumbo, FHA, VA)
- Rate or Unrounded Fully Indexed Rate
- Rate+1 (Interest-only loans)

### Step 3: Rounding Rules
- **ROUNDED**: Fannie Mae & Freddie Mac loans
- **UNROUNDED**: Jumbo, FHA & VA loans

### Step 4: Set Amortization
Select from Interest Only Qualifying Payment Option dropdown:
- Amortizing Over Full Term (most common)
- Default
- Amortizing Over Non Interest Only Term
- Interest Only

### Step 5: Update Qualifying Rate Dropdown
Set to "Rate Used For Qualifying"

### Step 6: Select ARM Plan Code (for DU)
1. Open Fannie Mae Screen
2. Choose DU XIS
3. Select Fannie Mae Arm Plan Number dropdown
4. Choose plan based on guidelines

## Fannie Mae ARM Plan Codes (SOFR)
- 4926: 3/6 mos SOFR, 2/1/5 Caps
- 4927: 5/6mo SOFR, 2/1/5 Caps
- 4928: 7/6mo SOFR, 5/1/5 Caps
- 4929: 10/6mo SOFR, 5/1/5 Caps

## Notes
- Freddie Mac loans do NOT require ARM Plan code
- Always reference current Fannie Mae Qualifying Rate Requirements
- Contact training@cmgfi.com for discrepancies</pre>
            </div>
        </div>
    </div>

    <div class="copy-success" id="copySuccess">Copied to clipboard!</div>

    <!-- AI Prompt Modal -->
    <div class="modal-overlay prompt-modal" id="promptModal">
        <div class="modal">
            <div class="modal-header">
                <h3 id="promptModalTitle">AI Agent Build Prompt</h3>
                <div class="modal-actions">
                    <button class="modal-btn copy" onclick="copyPromptToClipboard()">Copy Prompt</button>
                    <button class="modal-btn close" onclick="closePromptModal()">Close</button>
                </div>
            </div>
            <div class="modal-body">
                <div class="prompt-tags" id="promptTags"></div>
                <div class="prompt-section">
                    <h4>Agent Purpose</h4>
                    <div class="prompt-box" id="promptPurpose"></div>
                </div>
                <div class="prompt-section">
                    <h4>Full Build Prompt</h4>
                    <div class="prompt-box" id="promptContent"></div>
                </div>
                <div class="prompt-section">
                    <h4>Integration Points</h4>
                    <div class="prompt-box" id="promptIntegration"></div>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Improved Scroll Spy with Click Debounce
        let isScrolling = false;
        let scrollTimeout = null;

        // Tab switching
        function switchTab(tab) {
            document.querySelectorAll('.sidebar-tab').forEach(t => t.classList.remove('active'));
            document.querySelectorAll('.tab-panel').forEach(p => p.classList.remove('active'));

            if (tab === 'workflow') {
                document.querySelector('.sidebar-tab:not(.agent-tab)').classList.add('active');
                document.getElementById('workflow-panel').classList.add('active');
                document.getElementById('workflow-nav').style.display = 'block';
                document.getElementById('agents-nav').style.display = 'none';
            } else {
                document.querySelector('.sidebar-tab.agent-tab').classList.add('active');
                document.getElementById('agents-panel').classList.add('active');
                document.getElementById('workflow-nav').style.display = 'none';
                document.getElementById('agents-nav').style.display = 'block';
            }

            window.scrollTo(0, 0);
        }

        // Scroll spy with debounce
        const sections = document.querySelectorAll('.section, .quick-ref');
        const navItems = document.querySelectorAll('#workflow-nav .nav-item');

        function updateActiveNav() {
            if (isScrolling) return;

            let current = '';
            sections.forEach(section => {
                const sectionTop = section.offsetTop - 100;
                if (window.scrollY >= sectionTop) current = section.getAttribute('id');
            });
            navItems.forEach(item => {
                item.classList.remove('active');
                if (item.getAttribute('href') === '#' + current) item.classList.add('active');
            });
        }

        // Add click handlers to nav items with debounce
        navItems.forEach(item => {
            item.addEventListener('click', function(e) {
                e.preventDefault();
                isScrolling = true;

                // Clear any existing timeout
                if (scrollTimeout) clearTimeout(scrollTimeout);

                // Get the target section
                const targetId = this.getAttribute('href').substring(1);
                const targetSection = document.getElementById(targetId);

                // Update active state immediately
                navItems.forEach(nav => nav.classList.remove('active'));
                this.classList.add('active');

                // Scroll to section
                if (targetSection) {
                    targetSection.scrollIntoView({ behavior: 'smooth' });
                }

                // Reset isScrolling after animation completes
                scrollTimeout = setTimeout(() => {
                    isScrolling = false;
                }, 1000);
            });
        });

        window.addEventListener('scroll', updateActiveNav);

        // Modal functions
        function openDocModal() {
            document.getElementById('docModal').classList.add('show');
            document.body.style.overflow = 'hidden';
        }

        function closeDocModal() {
            document.getElementById('docModal').classList.remove('show');
            document.body.style.overflow = '';
        }

        async function copyToClipboard() {
            try {
                await navigator.clipboard.writeText(document.getElementById('docContent').textContent);
                const success = document.getElementById('copySuccess');
                success.style.display = 'block';
                setTimeout(() => { success.style.display = 'none'; }, 2000);
            } catch (e) { alert('Failed to copy.'); }
        }

        document.addEventListener('keydown', (e) => {
            if (e.key === 'Escape') {
                closeDocModal();
                closePromptModal();
            }
        });

        document.getElementById('docModal').addEventListener('click', (e) => {
            if (e.target.id === 'docModal') closeDocModal();
        });

        document.addEventListener('DOMContentLoaded', () => { updateActiveNav(); });

        // ====== AGENT PROMPT SYSTEM ======
        const agentPrompts = {
            autoconfig: {
                name: 'ARM Auto-Configuration Agent',
                tags: ['Rules Engine', 'Auto-Fill', 'Medium Complexity', 'Critical Priority'],
                purpose: `This agent automatically configures ARM qualifying rate settings based on the selected product type, eliminating manual guideline lookup and reducing configuration errors by 90%.`,
                prompt: `You are building a Rules Engine Agent for CMG Financial's Byte LOS system.

AGENT NAME: ARM Auto-Configuration Agent
TYPE: Rules Engine / Auto-Fill

OBJECTIVE:
Create an agent that automatically populates the Qualifying Rate Option, Amortization setting, and Rounding preference when an ARM product is selected in Byte.

INPUT PARAMETERS:
1. Product Type (from Byte loan data)
   - 5/6 SOFR ARM, 7/6 SOFR ARM, 10/6 SOFR ARM
   - FHA ARM, VA ARM, Jumbo ARM
   - Interest-Only flag

2. Investor/Agency
   - Fannie Mae, Freddie Mac
   - Private Investor
   - Government (FHA, VA)

3. Loan Characteristics
   - Loan Amount (for conforming limits)
   - Property State (for Texas 50(a)(6) detection)

RULES ENGINE LOGIC:

IF product = "5/6 SOFR ARM" AND agency IN (Fannie, Freddie):
    qual_rate_option = "Rate+2 or Rounded Fully Indexed Rate"
    rounding = "Rounded"

IF product IN ("7/6 SOFR ARM", "10/6 SOFR ARM") AND agency IN (Fannie, Freddie):
    qual_rate_option = "Rate or Rounded Fully Indexed Rate"
    rounding = "Rounded"

IF agency IN ("FHA", "VA") OR product_type = "Jumbo":
    rounding = "Unrounded"
    qual_rate_option = "Rate+2 or Unrounded Fully Indexed Rate"

IF interest_only = true:
    amortization = "Amortizing Over Full Term" (20-year basis)
ELSE:
    amortization = "Amortizing Over Full Term"

IF state = "TX" AND loan_purpose = "Cash-Out Refi":
    flag_texas_50a6 = true
    use_texas_specific_plan_codes = true

OUTPUT:
{
    "qual_rate_option": "Rate+2 or Rounded Fully Indexed Rate",
    "amortization": "Amortizing Over Full Term",
    "rounding": "Rounded",
    "qualifying_rate_dropdown": "Rate Used For Qualifying",
    "confidence": 0.95,
    "warnings": [],
    "guideline_source": "Fannie Mae Selling Guide B5-7"
}`,
                integration: `INTEGRATION POINTS:

1. Byte LOS Integration
   - Hook into product selection event
   - Read loan data via Byte API/database
   - Write to 1008 Transmittal fields

2. Rules Repository
   - Store rules in configurable JSON/database
   - Allow Training team to update without code changes
   - Version control for audit trail

3. User Interface
   - Show "Auto-configured" indicator
   - Allow manual override with reason capture
   - Display guideline source for transparency

DEPLOYMENT:
- Byte plugin/extension
- Or: RPA automation on product selection
- Or: API middleware between Byte screens`
            },
            plancode: {
                name: 'Plan Code Selector Agent',
                tags: ['Decision Support', 'Lookup Table', 'Low Complexity', 'High Priority'],
                purpose: `This agent recommends the correct Fannie Mae ARM Plan Number by matching ARM product parameters against the current ARM Plan Matrix.`,
                prompt: `You are building a Decision Support Agent for CMG Financial's Byte LOS system.

AGENT NAME: Plan Code Selector Agent
TYPE: Lookup Table / Decision Support

OBJECTIVE:
Analyze ARM product parameters and recommend the correct Fannie Mae ARM Plan Number for DU submission.

INPUT PARAMETERS:
1. ARM Product Terms
   - Initial fixed period (months): 36, 60, 84, 120
   - Adjustment frequency (months): 6, 12
   - Index type: SOFR, Treasury, LIBOR (legacy)

2. Rate Caps
   - Initial cap
   - Periodic cap
   - Lifetime cap

3. Special Flags
   - Texas 50(a)(6)
   - Interest-Only

FANNIE MAE ARM PLAN MATRIX:

Plan 4926:
  - Initial: 19-42 months
  - Adjust: 6 months
  - Index: 30-Day Avg SOFR
  - Caps: 2/1/5

Plan 4927:
  - Initial: 43-66 months
  - Adjust: 6 months
  - Index: 30-Day Avg SOFR
  - Caps: 2/1/5
  - Texas variant: 4927 Texas 50(a)(6)

Plan 4928:
  - Initial: 67-90 months
  - Adjust: 6 months
  - Index: 30-Day Avg SOFR
  - Caps: 5/1/5
  - Texas variant: 4928 Texas 50(a)(6)

Plan 4929:
  - Initial: 91-150 months
  - Adjust: 6 months
  - Index: 30-Day Avg SOFR
  - Caps: 5/1/5
  - Texas variant: 4929 Texas 50(a)(6)

MATCHING LOGIC:
1. Match initial period range
2. Verify adjustment frequency
3. Confirm index type
4. Check cap structure
5. Apply Texas flag if applicable

OUTPUT:
{
    "recommended_plan": "4927",
    "plan_description": "5/6mo SOFR, 2/1/5 Caps",
    "match_confidence": 0.99,
    "alternatives": [],
    "validation": {
        "initial_period_match": true,
        "index_match": true,
        "caps_match": true
    },
    "note": "Freddie Mac loans do not require ARM Plan code"
}`,
                integration: `INTEGRATION POINTS:

1. Byte DU XIS Screen
   - Add "Recommend Plan" button
   - Pre-populate dropdown with recommended value
   - Show match reasoning tooltip

2. Fannie Mae Matrix Updates
   - Subscribe to Fannie Mae guideline feeds
   - Auto-update lookup table monthly
   - Alert on matrix changes

3. Validation Layer
   - Verify selected plan before DU submission
   - Warn if manual selection differs from recommendation
   - Log all selections for QC reporting`
            },
            validator: {
                name: 'ARM Validation Agent',
                tags: ['Quality Control', 'Pre-AUS', 'Medium Complexity', 'High Priority'],
                purpose: `This agent performs comprehensive validation of all ARM configuration settings before AUS submission to catch errors that would cause resubmissions or underwriting delays.`,
                prompt: `You are building a Quality Control Agent for CMG Financial's Byte LOS system.

AGENT NAME: ARM Validation Agent
TYPE: Quality Control / Pre-AUS Validation

OBJECTIVE:
Validate all ARM-related configuration in Byte before AUS submission to prevent errors and resubmissions.

VALIDATION CHECKLIST:

1. QUALIFYING RATE VALIDATION
   [ ] Qual Rate Option is populated (not blank)
   [ ] Qual Rate Option matches product type
   [ ] Rounding matches agency (Rounded for FM/FRE, Unrounded for Jumbo/FHA/VA)
   [ ] Qualifying Rate dropdown = "Rate Used For Qualifying"

2. AMORTIZATION VALIDATION
   [ ] Interest-Only loans have correct amortization setting
   [ ] Amortizing period matches product terms
   [ ] 20-year basis used for IO qualification (per SOFR ARM guidelines)

3. ARM PLAN CODE VALIDATION (Fannie Mae only)
   [ ] Plan code is populated for DU submission
   [ ] Plan code matches ARM product parameters
   [ ] Texas 50(a)(6) variant used if applicable
   [ ] Plan code exists in current Fannie Mae matrix

4. RATE/TERM CONSISTENCY
   [ ] Initial period in ARM plan matches product
   [ ] Index type matches (SOFR vs Treasury vs LIBOR)
   [ ] Cap structure is consistent

5. DISCLOSURE VALIDATION
   [ ] Maximum payment calculated in LE Page 3 / GFE
   [ ] Payment projections match ARM terms

ERROR SEVERITY LEVELS:
- CRITICAL: Will cause AUS rejection (must fix)
- WARNING: May cause issues (review recommended)
- INFO: Best practice suggestion

OUTPUT REPORT:
{
    "validation_status": "FAIL" | "PASS" | "PASS_WITH_WARNINGS",
    "critical_errors": [
        { "field": "Qual Rate Option", "issue": "Blank", "fix": "Select appropriate option" }
    ],
    "warnings": [
        { "field": "ARM Plan Code", "issue": "Using generic plan", "recommendation": "Consider specific SOFR plan" }
    ],
    "info": [],
    "ready_for_aus": false
}`,
                integration: `INTEGRATION POINTS:

1. Pre-AUS Trigger
   - Run automatically when user clicks "Submit to AUS"
   - Block submission if critical errors exist
   - Show validation report modal

2. On-Demand Validation
   - "Validate ARM Settings" button in 1008 screen
   - Processor can run before UW submission
   - Underwriter can run at approval/CTC

3. Reporting Dashboard
   - Track validation failure rates
   - Identify common errors for training
   - Measure error reduction over time

4. Guideline Sync
   - Connect to guideline repository
   - Update validation rules when guidelines change
   - Version validation rule sets`
            },
            guideline: {
                name: 'Guideline Lookup Agent',
                tags: ['Knowledge Retrieval', 'Real-time', 'High Complexity', 'Medium Priority'],
                purpose: `This agent provides real-time guideline retrieval for ARM qualification requirements from Fannie Mae, Freddie Mac, and investor sources.`,
                prompt: `You are building a Knowledge Retrieval Agent for CMG Financial's Byte LOS system.

AGENT NAME: Guideline Lookup Agent
TYPE: Knowledge Retrieval / RAG

OBJECTIVE:
Provide instant access to current ARM qualification guidelines from authoritative sources, eliminating manual lookup and ensuring users always have current information.

KNOWLEDGE SOURCES:

1. Fannie Mae
   - Selling Guide Section B5-7 (ARM Products)
   - ARM Plan Matrix (updated monthly)
   - Lender Letters (SEL announcements)

2. Freddie Mac
   - Single-Family Seller/Servicer Guide Chapter 4301
   - ARM Product descriptions
   - Bulletins

3. Government Programs
   - FHA Handbook 4000.1 (ARM sections)
   - VA Lender Handbook Chapter 9

4. CMG Overlays
   - Internal ARM guidelines
   - Investor-specific requirements
   - Cheat sheets (Qual Rate Defaults for Byte)

QUERY EXAMPLES:

User: "What is the qual rate for a 5/6 SOFR ARM?"
Agent Response:
"For a 5/6 SOFR ARM (Fannie Mae/Freddie Mac):
- Fully Amortizing: Qualify at the HIGHER of:
  * Note Rate + 2%, OR
  * Fully Indexed Rate
- Interest-Only: Qualify at fully amortizing P&I based on 20-year
  remaining term at the HIGHER of Note Rate + 2% or Fully Indexed Rate

Source: Fannie Mae Selling Guide B5-7-01
Last Updated: [Date]"

User: "Which ARM plan code for 7-year ARM?"
Agent Response:
"For a 7/6 SOFR ARM:
- Standard: Plan 4928 (67-90 month initial, 6mo adjust, 5/1/5 caps)
- Texas 50(a)(6): Plan 4928 Texas 50(a)(6)

Note: Freddie Mac loans do not require an ARM Plan code.

Source: Fannie Mae Standard ARM Plan Matrix
Last Updated: [Date]"

RESPONSE FORMAT:
{
    "answer": "formatted response",
    "sources": ["Fannie Mae Selling Guide B5-7-01", "ARM Plan Matrix v2024.01"],
    "confidence": 0.95,
    "last_verified": "2024-01-15",
    "related_topics": ["Qual Rate Options", "Interest-Only Qualification"]
}`,
                integration: `INTEGRATION POINTS:

1. Contextual Help System
   - "?" icon next to ARM fields in Byte
   - Click to get instant guideline for that field
   - Context-aware (knows current product type)

2. Chat Interface
   - Embedded chat in Byte sidebar
   - Natural language queries
   - Conversation history per loan

3. Knowledge Base Sync
   - Automated ingestion of guideline updates
   - RAG-based retrieval with embeddings
   - Source citation for compliance

4. Alert System
   - Notify users of guideline changes
   - Highlight changes affecting open loans
   - Training team notification for updates

TECHNICAL REQUIREMENTS:
- Vector database for guideline embeddings
- Daily sync with Fannie Mae/Freddie Mac sources
- Citation tracking for audit compliance`
            }
        };

        // Scroll to agent card and highlight
        function scrollToAgent(agentId) {
            const agentCard = document.getElementById(agentId);
            if (agentCard) {
                document.querySelectorAll('.agent-card.highlight').forEach(card => {
                    card.classList.remove('highlight');
                });

                agentCard.scrollIntoView({ behavior: 'smooth', block: 'center' });

                setTimeout(() => {
                    agentCard.classList.add('highlight');
                }, 300);

                setTimeout(() => {
                    agentCard.classList.remove('highlight');
                }, 2500);
            }
        }

        // Show agent prompt modal
        let currentPromptContent = '';

        function showAgentPrompt(agentKey) {
            const agent = agentPrompts[agentKey];
            if (!agent) return;

            document.getElementById('promptModalTitle').textContent = `${agent.name} - Build Prompt`;

            const tagsHtml = agent.tags.map(tag => `<span class="prompt-tag">${tag}</span>`).join('');
            document.getElementById('promptTags').innerHTML = tagsHtml;

            document.getElementById('promptPurpose').textContent = agent.purpose;
            document.getElementById('promptContent').textContent = agent.prompt;
            document.getElementById('promptIntegration').textContent = agent.integration;

            currentPromptContent = `# ${agent.name}\n\n## Purpose\n${agent.purpose}\n\n## Build Prompt\n${agent.prompt}\n\n## Integration Points\n${agent.integration}`;

            document.getElementById('promptModal').classList.add('show');
            document.body.style.overflow = 'hidden';
        }

        function closePromptModal() {
            document.getElementById('promptModal').classList.remove('show');
            document.body.style.overflow = '';
        }

        async function copyPromptToClipboard() {
            try {
                await navigator.clipboard.writeText(currentPromptContent);
                const success = document.getElementById('copySuccess');
                success.style.display = 'block';
                setTimeout(() => { success.style.display = 'none'; }, 2000);
            } catch (e) {
                alert('Failed to copy prompt.');
            }
        }

        document.getElementById('promptModal').addEventListener('click', (e) => {
            if (e.target.id === 'promptModal') closePromptModal();
        });
    </script>
</body>
</html>
