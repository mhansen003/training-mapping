<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Byte - Create Second Mortgage Workflow</title>
    <link href="https://fonts.googleapis.com/css2?family=Plus+Jakarta+Sans:wght@400;500;600;700;800&family=JetBrains+Mono:wght@400;500&display=swap" rel="stylesheet">
    <style>
        :root {
            --bg-primary: #0a0f1a;
            --bg-secondary: #111827;
            --bg-card: #1a2234;
            --accent-blue: #3b82f6;
            --accent-teal: #14b8a6;
            --accent-amber: #f59e0b;
            --accent-rose: #f43f5e;
            --accent-green: #22c55e;
            --accent-purple: #8b5cf6;
            --text-primary: #f1f5f9;
            --text-secondary: #94a3b8;
            --text-muted: #64748b;
            --border-subtle: rgba(255,255,255,0.08);
            --sidebar-width: 280px;
        }

        * { box-sizing: border-box; margin: 0; padding: 0; }
        html { scroll-behavior: smooth; }
        body {
            font-family: 'Plus Jakarta Sans', -apple-system, BlinkMacSystemFont, sans-serif;
            background: var(--bg-primary);
            color: var(--text-primary);
            min-height: 100vh;
        }

        /* Breadcrumb */
        .breadcrumb {
            background: linear-gradient(90deg, #0d1525 0%, #1a2234 100%);
            padding: 14px 25px;
            display: flex;
            align-items: center;
            gap: 12px;
            font-size: 0.95rem;
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            z-index: 1001;
            border-bottom: 1px solid var(--border-subtle);
        }

        .breadcrumb a {
            color: var(--text-secondary);
            text-decoration: none;
            font-weight: 600;
            padding: 8px 16px;
            background: rgba(255,255,255,0.05);
            border-radius: 8px;
            transition: all 0.2s;
            border: 1px solid var(--border-subtle);
        }

        .breadcrumb a:hover {
            background: rgba(59, 130, 246, 0.15);
            color: var(--accent-blue);
            border-color: rgba(59, 130, 246, 0.3);
        }

        .breadcrumb .separator { color: var(--text-muted); font-size: 1.2rem; }
        .breadcrumb .current { color: var(--accent-amber); font-weight: 600; padding: 8px 16px; }

        /* Sidebar */
        .sidebar {
            position: fixed;
            top: 54px;
            left: 0;
            width: var(--sidebar-width);
            height: calc(100vh - 54px);
            background: var(--bg-secondary);
            overflow-y: auto;
            z-index: 1000;
            border-right: 1px solid var(--border-subtle);
            display: flex;
            flex-direction: column;
        }

        .sidebar-header {
            padding: 25px 20px;
            background: rgba(0,0,0,0.3);
            border-bottom: 1px solid var(--border-subtle);
        }

        .sidebar-header h2 { color: var(--text-primary); font-size: 1.2rem; font-weight: 700; margin-bottom: 5px; }
        .sidebar-header p { color: var(--text-muted); font-size: 0.85rem; }

        /* Tab Switch */
        .sidebar-tabs {
            display: flex;
            border-bottom: 1px solid var(--border-subtle);
        }

        .sidebar-tab {
            flex: 1;
            padding: 14px 10px;
            text-align: center;
            font-size: 0.8rem;
            font-weight: 700;
            color: var(--text-muted);
            cursor: pointer;
            transition: all 0.2s;
            border-bottom: 3px solid transparent;
            background: none;
            border-left: none;
            border-right: none;
            border-top: none;
        }

        .sidebar-tab:hover { background: rgba(255,255,255,0.03); color: var(--text-secondary); }
        .sidebar-tab.active { color: var(--accent-blue); border-bottom-color: var(--accent-blue); background: rgba(59, 130, 246, 0.08); }
        .sidebar-tab.agent-tab.active { color: var(--accent-purple); border-bottom-color: var(--accent-purple); background: rgba(139, 92, 246, 0.08); }

        .sidebar-nav { padding: 15px 0; flex: 1; overflow-y: auto; }

        .nav-item {
            display: flex;
            align-items: center;
            gap: 12px;
            padding: 14px 20px;
            color: var(--text-secondary);
            text-decoration: none;
            border-left: 3px solid transparent;
            transition: all 0.2s ease;
            cursor: pointer;
        }

        .nav-item:hover { background: rgba(255,255,255,0.03); color: var(--text-primary); }
        .nav-item.active { background: rgba(59, 130, 246, 0.1); border-left-color: var(--accent-blue); color: var(--text-primary); }

        .nav-number {
            background: rgba(255,255,255,0.1);
            color: var(--text-secondary);
            width: 28px;
            height: 28px;
            border-radius: 8px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 700;
            font-size: 0.85rem;
            flex-shrink: 0;
        }

        .nav-item.active .nav-number { background: var(--accent-blue); color: white; }
        .nav-label { font-size: 0.95rem; font-weight: 500; }

        .sidebar-footer {
            padding: 20px;
            border-top: 1px solid var(--border-subtle);
            background: rgba(0,0,0,0.2);
        }

        .doc-btn {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
            width: 100%;
            padding: 14px 20px;
            background: linear-gradient(135deg, var(--accent-blue) 0%, var(--accent-teal) 100%);
            color: white;
            border: none;
            border-radius: 10px;
            font-weight: 600;
            cursor: pointer;
            transition: transform 0.2s, box-shadow 0.2s;
            text-decoration: none;
            font-size: 0.95rem;
        }

        .doc-btn:hover { transform: translateY(-2px); box-shadow: 0 8px 25px rgba(59, 130, 246, 0.3); }

        /* Main Content */
        .main-content { margin-left: var(--sidebar-width); padding: 80px 40px 40px 40px; }

        /* Tab Panels */
        .tab-panel { display: none; }
        .tab-panel.active { display: block; }

        .header {
            background: var(--bg-card);
            border: 1px solid var(--border-subtle);
            padding: 35px;
            border-radius: 16px;
            margin-bottom: 30px;
            position: relative;
            overflow: hidden;
        }

        .header::before {
            content: '';
            position: absolute;
            top: 0; left: 0; right: 0; bottom: 0;
            background:
                radial-gradient(ellipse at 20% 20%, rgba(59, 130, 246, 0.1) 0%, transparent 50%),
                radial-gradient(ellipse at 80% 80%, rgba(20, 184, 166, 0.08) 0%, transparent 50%);
            pointer-events: none;
        }

        .header h1 {
            font-size: 2.2rem;
            font-weight: 800;
            margin-bottom: 10px;
            position: relative;
            background: linear-gradient(135deg, var(--text-primary) 0%, var(--accent-blue) 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .header .subtitle { color: var(--text-secondary); font-size: 1.1rem; position: relative; }

        .header .meta { display: flex; gap: 15px; margin-top: 20px; flex-wrap: wrap; position: relative; }

        .header .meta-item {
            background: rgba(255,255,255,0.05);
            border: 1px solid var(--border-subtle);
            padding: 8px 16px;
            border-radius: 8px;
            font-size: 0.9rem;
            color: var(--text-secondary);
        }

        /* Legend */
        .legend {
            display: flex;
            flex-wrap: wrap;
            gap: 15px;
            padding: 18px 22px;
            background: var(--bg-card);
            border: 1px solid var(--border-subtle);
            border-radius: 12px;
            margin-bottom: 25px;
        }

        .legend-item { display: flex; align-items: center; gap: 8px; font-size: 0.85rem; color: var(--text-secondary); }
        .legend-color { width: 18px; height: 18px; border-radius: 4px; }

        /* Sections */
        .section {
            background: var(--bg-card);
            border: 1px solid var(--border-subtle);
            border-radius: 16px;
            margin-bottom: 25px;
            overflow: hidden;
            scroll-margin-top: 75px;
        }

        .section-header {
            background: linear-gradient(135deg, var(--bg-secondary) 0%, rgba(59, 130, 246, 0.1) 100%);
            border-bottom: 1px solid var(--border-subtle);
            padding: 22px 25px;
            display: flex;
            align-items: center;
            gap: 18px;
        }

        .section-number {
            background: linear-gradient(135deg, var(--accent-blue) 0%, var(--accent-teal) 100%);
            color: white;
            width: 48px;
            height: 48px;
            border-radius: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 800;
            font-size: 1.3rem;
            flex-shrink: 0;
        }

        .section-title h2 { font-size: 1.35rem; font-weight: 700; margin-bottom: 4px; color: var(--text-primary); }
        .section-title span { font-size: 0.9rem; color: var(--text-muted); }
        .section-content { padding: 28px; }

        /* Workflow Diagrams */
        .workflow-diagram {
            background: rgba(0,0,0,0.3);
            border: 1px solid var(--border-subtle);
            border-radius: 12px;
            padding: 28px;
            margin-bottom: 22px;
        }

        .flow-row { display: flex; align-items: center; justify-content: center; flex-wrap: wrap; gap: 12px; margin: 15px 0; }

        .flow-node {
            padding: 14px 22px;
            border-radius: 10px;
            text-align: center;
            font-size: 0.9rem;
            font-weight: 600;
            min-width: 150px;
            border: 1px solid var(--border-subtle);
        }

        .flow-node.start { background: linear-gradient(135deg, var(--accent-green) 0%, #16a34a 100%); color: white; border-radius: 25px; border: none; }
        .flow-node.action { background: linear-gradient(135deg, var(--accent-blue) 0%, #2563eb 100%); color: white; border: none; }
        .flow-node.decision { background: linear-gradient(135deg, var(--accent-amber) 0%, #d97706 100%); color: var(--bg-primary); border: none; }
        .flow-node.input { background: var(--bg-secondary); border: 2px solid var(--accent-blue); color: var(--text-primary); }
        .flow-node.output { background: linear-gradient(135deg, var(--accent-teal) 0%, #0d9488 100%); color: white; border: none; }
        .flow-node.exception { background: linear-gradient(135deg, var(--accent-rose) 0%, #dc2626 100%); color: white; border: none; }

        .flow-arrow { color: var(--accent-blue); font-size: 1.5rem; }
        .flow-arrow.down { transform: rotate(90deg); }

        .decision-branch { display: flex; gap: 40px; justify-content: center; margin: 20px 0; flex-wrap: wrap; }
        .branch { display: flex; flex-direction: column; align-items: center; gap: 10px; }

        .branch-label {
            background: var(--bg-secondary);
            border: 1px solid var(--border-subtle);
            padding: 6px 16px;
            border-radius: 20px;
            font-size: 0.8rem;
            font-weight: 700;
            color: var(--text-secondary);
        }

        /* Tables */
        .field-table { width: 100%; border-collapse: collapse; margin: 18px 0; }

        .field-table th {
            background: rgba(59, 130, 246, 0.15);
            color: var(--accent-blue);
            padding: 14px 18px;
            text-align: left;
            font-weight: 600;
            font-size: 0.9rem;
            text-transform: uppercase;
            letter-spacing: 0.05em;
            border-bottom: 1px solid var(--border-subtle);
        }

        .field-table td { padding: 14px 18px; border-bottom: 1px solid var(--border-subtle); color: var(--text-secondary); }
        .field-table tr:hover { background: rgba(255,255,255,0.02); }

        .badge { display: inline-block; padding: 4px 12px; border-radius: 6px; font-size: 0.75rem; font-weight: 700; text-transform: uppercase; letter-spacing: 0.05em; }
        .badge.required-badge { background: rgba(244, 63, 94, 0.15); color: var(--accent-rose); }
        .badge.optional-badge { background: rgba(34, 197, 94, 0.15); color: var(--accent-green); }
        .badge.calculated-badge { background: rgba(59, 130, 246, 0.15); color: var(--accent-blue); }
        .badge.sync-badge { background: rgba(139, 92, 246, 0.15); color: var(--accent-purple); }

        /* Info Boxes */
        .exception-box, .tip-box, .info-box {
            padding: 18px 22px;
            margin: 18px 0;
            border-radius: 0 10px 10px 0;
            border-left-width: 4px;
            border-left-style: solid;
        }

        .exception-box { background: rgba(244, 63, 94, 0.08); border-color: var(--accent-rose); border: 1px solid rgba(244, 63, 94, 0.2); border-left: 4px solid var(--accent-rose); }
        .exception-box h4 { color: var(--accent-rose); margin-bottom: 10px; font-size: 1rem; }
        .exception-box p, .exception-box li { color: var(--text-secondary); }

        .tip-box { background: rgba(34, 197, 94, 0.08); border-color: var(--accent-green); border: 1px solid rgba(34, 197, 94, 0.2); border-left: 4px solid var(--accent-green); }
        .tip-box h4 { color: var(--accent-green); margin-bottom: 10px; font-size: 1rem; }
        .tip-box p, .tip-box li { color: var(--text-secondary); }

        .info-box { background: rgba(59, 130, 246, 0.08); border-color: var(--accent-blue); border: 1px solid rgba(59, 130, 246, 0.2); border-left: 4px solid var(--accent-blue); }
        .info-box h4 { color: var(--accent-blue); margin-bottom: 10px; font-size: 1rem; }
        .info-box p, .info-box li { color: var(--text-secondary); }

        /* Decision Tree */
        .decision-tree {
            background: rgba(0,0,0,0.2);
            border: 1px solid var(--border-subtle);
            border-radius: 12px;
            padding: 22px;
            margin: 22px 0;
        }

        .decision-tree h3 { color: var(--accent-blue); margin-bottom: 18px; padding-bottom: 12px; border-bottom: 1px solid var(--border-subtle); font-size: 1.1rem; }

        .tree-node { margin-left: 20px; padding: 12px; border-left: 2px solid var(--accent-teal); position: relative; color: var(--text-secondary); }
        .tree-node::before { content: ''; position: absolute; left: -2px; top: 22px; width: 15px; height: 2px; background: var(--accent-teal); }
        .tree-node.level-1 { margin-left: 0; border-left: none; }
        .tree-node.level-1::before { display: none; }

        .tree-label { background: var(--accent-amber); color: var(--bg-primary); padding: 6px 14px; border-radius: 6px; font-weight: 700; display: inline-block; margin-bottom: 6px; font-size: 0.9rem; }

        /* Summary Grid */
        .summary-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(180px, 1fr)); gap: 18px; margin: 22px 0; }

        .summary-card { background: rgba(0,0,0,0.3); border: 1px solid var(--border-subtle); border-radius: 12px; padding: 22px; text-align: center; }
        .summary-card h4 { color: var(--text-secondary); margin-bottom: 12px; font-size: 0.9rem; }
        .summary-card .value {
            font-size: 2.2rem;
            font-weight: 800;
            background: linear-gradient(135deg, var(--accent-blue) 0%, var(--accent-teal) 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }
        .summary-card .label { font-size: 0.85rem; color: var(--text-muted); margin-top: 8px; }

        /* Use Case Cards */
        .use-case-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(280px, 1fr)); gap: 20px; margin: 22px 0; }

        .use-card { background: rgba(0,0,0,0.2); border: 1px solid var(--border-subtle); border-radius: 12px; overflow: hidden; }
        .use-card-header { background: linear-gradient(135deg, var(--accent-blue) 0%, var(--accent-teal) 100%); color: white; padding: 18px; text-align: center; }
        .use-card-header h4 { font-size: 1.05rem; }
        .use-card-body { padding: 22px; }
        .use-card ul { list-style: none; padding: 0; }
        .use-card li { padding: 10px 0; border-bottom: 1px solid var(--border-subtle); display: flex; align-items: center; gap: 12px; color: var(--text-secondary); font-size: 0.95rem; }
        .use-card li:last-child { border-bottom: none; }
        .check-icon { color: var(--accent-green); font-weight: bold; }

        /* Quick Reference */
        .quick-ref {
            background: linear-gradient(135deg, var(--bg-secondary) 0%, var(--bg-card) 100%);
            border: 1px solid var(--border-subtle);
            padding: 28px;
            border-radius: 16px;
            margin-top: 30px;
            font-family: 'JetBrains Mono', monospace;
            scroll-margin-top: 75px;
        }

        .quick-ref h3 { color: var(--accent-amber); margin-bottom: 18px; font-family: 'Plus Jakarta Sans', sans-serif; }
        .quick-ref pre { background: rgba(0,0,0,0.4); border: 1px solid var(--border-subtle); padding: 20px; border-radius: 10px; overflow-x: auto; font-size: 0.85rem; line-height: 1.7; color: var(--text-secondary); }

        /* ====== AGENT OPPORTUNITIES STYLES ====== */
        .agent-header {
            background: var(--bg-card);
            border: 1px solid var(--border-subtle);
            padding: 35px;
            border-radius: 16px;
            margin-bottom: 30px;
            position: relative;
            overflow: hidden;
        }

        .agent-header::before {
            content: '';
            position: absolute;
            top: 0; left: 0; right: 0; bottom: 0;
            background:
                radial-gradient(ellipse at 20% 20%, rgba(139, 92, 246, 0.12) 0%, transparent 50%),
                radial-gradient(ellipse at 80% 80%, rgba(245, 158, 11, 0.1) 0%, transparent 50%);
            pointer-events: none;
        }

        .agent-header h1 {
            font-size: 2.2rem;
            font-weight: 800;
            margin-bottom: 10px;
            position: relative;
            background: linear-gradient(135deg, var(--accent-purple) 0%, var(--accent-amber) 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .agent-header .subtitle { color: var(--text-secondary); font-size: 1.1rem; position: relative; }

        /* Heat Map */
        .heat-map-container { margin-bottom: 35px; }
        .heat-map-title { font-size: 1.3rem; font-weight: 700; color: var(--text-primary); margin-bottom: 20px; display: flex; align-items: center; gap: 12px; }

        .heat-map-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
        }

        .heat-item {
            background: var(--bg-card);
            border: 1px solid var(--border-subtle);
            border-radius: 12px;
            padding: 20px;
            position: relative;
            overflow: hidden;
            transition: transform 0.2s, box-shadow 0.2s;
            cursor: pointer;
        }

        .heat-item:hover { transform: translateY(-3px); box-shadow: 0 10px 30px rgba(0,0,0,0.3); }
        .heat-item:active { transform: scale(0.98); }

        .heat-item::before {
            content: '';
            position: absolute;
            top: 0; left: 0; right: 0; height: 4px;
        }

        .heat-item.critical::before { background: linear-gradient(90deg, #ef4444, #f97316); }
        .heat-item.high::before { background: linear-gradient(90deg, #f97316, #eab308); }
        .heat-item.medium::before { background: linear-gradient(90deg, #eab308, #22c55e); }
        .heat-item.low::before { background: linear-gradient(90deg, #22c55e, #14b8a6); }

        .heat-score {
            position: absolute;
            top: 15px;
            right: 15px;
            font-size: 1.8rem;
            font-weight: 800;
        }

        .heat-item.critical .heat-score { color: #ef4444; }
        .heat-item.high .heat-score { color: #f97316; }
        .heat-item.medium .heat-score { color: #eab308; }
        .heat-item.low .heat-score { color: #22c55e; }

        .heat-name { font-size: 1rem; font-weight: 700; color: var(--text-primary); margin-bottom: 6px; padding-right: 50px; }
        .heat-desc { font-size: 0.85rem; color: var(--text-muted); margin-bottom: 12px; }

        .heat-metrics { display: flex; gap: 15px; margin-top: 12px; }
        .heat-metric { font-size: 0.75rem; color: var(--text-muted); }
        .heat-metric span { color: var(--text-secondary); font-weight: 600; }

        /* Agent Cards */
        .agent-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(380px, 1fr)); gap: 25px; margin-bottom: 35px; }

        .agent-card {
            background: var(--bg-card);
            border: 1px solid var(--border-subtle);
            border-radius: 16px;
            overflow: hidden;
            transition: transform 0.2s, box-shadow 0.2s;
        }

        .agent-card:hover { transform: translateY(-5px); box-shadow: 0 15px 50px rgba(0,0,0,0.3); }

        .agent-card.highlight {
            animation: highlightPulse 2s ease;
            box-shadow: 0 0 0 3px var(--accent-purple), 0 15px 50px rgba(139, 92, 246, 0.4);
        }

        @keyframes highlightPulse {
            0% { box-shadow: 0 0 0 3px var(--accent-purple), 0 15px 50px rgba(139, 92, 246, 0.6); }
            50% { box-shadow: 0 0 0 6px rgba(139, 92, 246, 0.5), 0 15px 50px rgba(139, 92, 246, 0.3); }
            100% { box-shadow: 0 0 0 0px transparent, 0 15px 50px rgba(0,0,0,0.3); }
        }

        .agent-card-header {
            padding: 22px;
            display: flex;
            align-items: flex-start;
            gap: 18px;
            border-bottom: 1px solid var(--border-subtle);
        }

        .agent-icon {
            width: 55px;
            height: 55px;
            background: linear-gradient(135deg, var(--accent-purple) 0%, var(--accent-blue) 100%);
            border-radius: 14px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.6rem;
            flex-shrink: 0;
        }

        .agent-info { flex: 1; }
        .agent-name { font-size: 1.15rem; font-weight: 700; color: var(--text-primary); margin-bottom: 5px; }
        .agent-type { font-size: 0.8rem; color: var(--accent-purple); font-weight: 600; text-transform: uppercase; letter-spacing: 0.05em; }

        .agent-priority {
            padding: 6px 12px;
            border-radius: 20px;
            font-size: 0.75rem;
            font-weight: 700;
            text-transform: uppercase;
        }

        .agent-priority.critical { background: rgba(239, 68, 68, 0.15); color: #ef4444; }
        .agent-priority.high { background: rgba(249, 115, 22, 0.15); color: #f97316; }
        .agent-priority.medium { background: rgba(234, 179, 8, 0.15); color: #eab308; }
        .agent-priority.low { background: rgba(34, 197, 94, 0.15); color: #22c55e; }

        .agent-card-body { padding: 22px; }
        .agent-description { font-size: 0.95rem; color: var(--text-secondary); line-height: 1.6; margin-bottom: 20px; }

        .agent-flow {
            background: rgba(0,0,0,0.3);
            border: 1px solid var(--border-subtle);
            border-radius: 10px;
            padding: 18px;
            margin-bottom: 20px;
        }

        .agent-flow-title { font-size: 0.85rem; color: var(--text-muted); margin-bottom: 12px; font-weight: 600; text-transform: uppercase; letter-spacing: 0.05em; }

        .agent-flow-diagram { display: flex; align-items: center; flex-wrap: wrap; gap: 8px; justify-content: center; }

        .agent-step {
            background: linear-gradient(135deg, var(--accent-purple) 0%, var(--accent-blue) 100%);
            color: white;
            padding: 8px 14px;
            border-radius: 6px;
            font-size: 0.8rem;
            font-weight: 600;
            white-space: nowrap;
        }

        .agent-arrow { color: var(--accent-purple); font-size: 1.2rem; }

        .agent-stats { display: grid; grid-template-columns: repeat(3, 1fr); gap: 12px; }

        .agent-stat {
            background: rgba(0,0,0,0.2);
            border-radius: 8px;
            padding: 12px;
            text-align: center;
        }

        .agent-stat-value {
            font-size: 1.3rem;
            font-weight: 800;
            background: linear-gradient(135deg, var(--accent-purple) 0%, var(--accent-amber) 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .agent-stat-label { font-size: 0.7rem; color: var(--text-muted); text-transform: uppercase; letter-spacing: 0.05em; margin-top: 4px; }

        .agent-prompt-btn {
            width: 100%;
            margin-top: 18px;
            padding: 14px 20px;
            background: linear-gradient(135deg, rgba(139, 92, 246, 0.2) 0%, rgba(59, 130, 246, 0.2) 100%);
            border: 1px solid rgba(139, 92, 246, 0.4);
            border-radius: 10px;
            color: var(--accent-purple);
            font-weight: 700;
            cursor: pointer;
            transition: all 0.2s;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
            font-size: 0.9rem;
        }

        .agent-prompt-btn:hover {
            background: linear-gradient(135deg, rgba(139, 92, 246, 0.3) 0%, rgba(59, 130, 246, 0.3) 100%);
            border-color: var(--accent-purple);
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(139, 92, 246, 0.25);
        }

        /* Summary Stats */
        .agent-summary {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin-bottom: 35px;
        }

        .agent-summary-card {
            background: var(--bg-card);
            border: 1px solid var(--border-subtle);
            border-radius: 14px;
            padding: 25px;
            text-align: center;
        }

        .agent-summary-value {
            font-size: 2.5rem;
            font-weight: 800;
            background: linear-gradient(135deg, var(--accent-purple) 0%, var(--accent-amber) 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .agent-summary-label { font-size: 0.9rem; color: var(--text-muted); margin-top: 8px; }

        /* Heat Map Legend */
        .heat-legend {
            display: flex;
            gap: 25px;
            padding: 18px 22px;
            background: var(--bg-card);
            border: 1px solid var(--border-subtle);
            border-radius: 12px;
            margin-bottom: 25px;
            flex-wrap: wrap;
        }

        .heat-legend-item { display: flex; align-items: center; gap: 10px; font-size: 0.9rem; color: var(--text-secondary); }
        .heat-legend-color { width: 24px; height: 24px; border-radius: 6px; }

        /* Modal */
        .modal-overlay {
            display: none;
            position: fixed;
            top: 0; left: 0; right: 0; bottom: 0;
            background: rgba(10, 15, 26, 0.9);
            z-index: 2000;
            justify-content: center;
            align-items: center;
            padding: 20px;
            backdrop-filter: blur(5px);
        }

        .modal-overlay.show { display: flex; }

        .modal {
            background: var(--bg-card);
            border: 1px solid var(--border-subtle);
            border-radius: 16px;
            width: 100%;
            max-width: 950px;
            max-height: 90vh;
            display: flex;
            flex-direction: column;
            box-shadow: 0 25px 80px rgba(0,0,0,0.5);
        }

        .modal-header {
            background: linear-gradient(135deg, var(--accent-blue) 0%, var(--accent-teal) 100%);
            color: white;
            padding: 22px 28px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            border-radius: 16px 16px 0 0;
        }

        .modal-header h3 { font-size: 1.25rem; font-weight: 700; }
        .modal-actions { display: flex; gap: 12px; }

        .modal-btn {
            padding: 10px 18px;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-weight: 700;
            transition: transform 0.2s;
            font-size: 0.9rem;
        }

        .modal-btn:hover { transform: scale(1.05); }
        .modal-btn.copy { background: white; color: var(--accent-blue); }
        .modal-btn.close { background: rgba(255,255,255,0.2); color: white; }

        .modal-body { padding: 28px; overflow-y: auto; flex: 1; }

        .modal-body pre {
            background: rgba(0,0,0,0.3);
            border: 1px solid var(--border-subtle);
            padding: 22px;
            border-radius: 10px;
            font-family: 'JetBrains Mono', monospace;
            font-size: 0.9rem;
            line-height: 1.7;
            white-space: pre-wrap;
            word-wrap: break-word;
            color: var(--text-secondary);
        }

        .copy-success {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: var(--accent-green);
            color: white;
            padding: 18px 35px;
            border-radius: 10px;
            font-weight: 700;
            z-index: 3000;
            display: none;
            animation: fadeInOut 2s ease;
        }

        @keyframes fadeInOut { 0%, 100% { opacity: 0; } 10%, 90% { opacity: 1; } }

        /* AI Prompt Modal */
        .prompt-modal .modal {
            max-width: 800px;
        }

        .prompt-modal .modal-header {
            background: linear-gradient(135deg, var(--accent-purple) 0%, var(--accent-blue) 100%);
        }

        .prompt-section {
            margin-bottom: 25px;
        }

        .prompt-section h4 {
            color: var(--accent-purple);
            font-size: 1rem;
            margin-bottom: 12px;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .prompt-box {
            background: rgba(0,0,0,0.4);
            border: 1px solid var(--border-subtle);
            border-radius: 10px;
            padding: 20px;
            font-family: 'JetBrains Mono', monospace;
            font-size: 0.85rem;
            line-height: 1.7;
            color: var(--text-secondary);
            white-space: pre-wrap;
            word-wrap: break-word;
        }

        .prompt-tags {
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
            margin-bottom: 20px;
        }

        .prompt-tag {
            background: rgba(139, 92, 246, 0.15);
            color: var(--accent-purple);
            padding: 6px 14px;
            border-radius: 20px;
            font-size: 0.8rem;
            font-weight: 600;
        }

        @media (max-width: 900px) {
            .sidebar { display: none; }
            .main-content { margin-left: 0; padding: 75px 20px 30px 20px; }
            .agent-grid { grid-template-columns: 1fr; }
        }
            .breadcrumb-logo-link { display: flex; align-items: center; padding: 4px 8px; background: rgba(255,255,255,0.08); border-radius: 8px; border: 1px solid rgba(255,255,255,0.12); transition: all 0.2s; }
        .breadcrumb-logo-link:hover { background: rgba(255,255,255,0.15); }
        .breadcrumb-logo { height: 28px; width: auto; }
    </style>
</head>
<body>
    <!-- Breadcrumb -->
    <nav class="breadcrumb">
        <a href="../../index.html" class="breadcrumb-logo-link"><img src="../../images/clear-ai-logo.png" alt="Clear AI" class="breadcrumb-logo"></a>
        <a href="../../index.html">Portal Home</a>
        <span class="separator">></span>
        <a href="./index.html">Byte</a>
        <span class="separator">></span>
        <span class="current">Create Second Mortgage</span>
    </nav>

    <!-- Fixed Sidebar -->
    <aside class="sidebar">
        <div class="sidebar-header">
            <h2>Second Mortgage</h2>
            <p>Interactive Workflow Guide</p>
        </div>

        <!-- Tab Switcher -->
        <div class="sidebar-tabs">
            <button class="sidebar-tab active" onclick="switchTab('workflow')">Workflow</button>
            <button class="sidebar-tab agent-tab" onclick="switchTab('agents')">AI Agents</button>
        </div>

        <!-- Workflow Navigation -->
        <nav class="sidebar-nav" id="workflow-nav">
            <a href="#section-0" class="nav-item active">
                <span class="nav-number">0</span>
                <span class="nav-label">Overview</span>
            </a>
            <a href="#section-1" class="nav-item">
                <span class="nav-number">1</span>
                <span class="nav-label">Home Screen</span>
            </a>
            <a href="#section-2" class="nav-item">
                <span class="nav-number">2</span>
                <span class="nav-label">Start Synchronization</span>
            </a>
            <a href="#section-3" class="nav-item">
                <span class="nav-number">3</span>
                <span class="nav-label">Template Selection</span>
            </a>
            <a href="#section-4" class="nav-item">
                <span class="nav-number">4</span>
                <span class="nav-label">Data Sync Fields</span>
            </a>
            <a href="#section-5" class="nav-item">
                <span class="nav-number">5</span>
                <span class="nav-label">Product Selection</span>
            </a>
            <a href="#section-6" class="nav-item">
                <span class="nav-number">6</span>
                <span class="nav-label">Update First Loan</span>
            </a>
            <a href="#quick-ref" class="nav-item">
                <span class="nav-number">*</span>
                <span class="nav-label">Quick Reference</span>
            </a>
        </nav>

        <!-- Agent Navigation -->
        <nav class="sidebar-nav" id="agents-nav" style="display: none;">
            <a href="#agent-summary" class="nav-item active">
                <span class="nav-number">S</span>
                <span class="nav-label">Summary</span>
            </a>
            <a href="#agent-heatmap" class="nav-item">
                <span class="nav-number">H</span>
                <span class="nav-label">Heat Map</span>
            </a>
            <a href="#agent-details" class="nav-item">
                <span class="nav-number">A</span>
                <span class="nav-label">Agent Details</span>
            </a>
        </nav>

        <div class="sidebar-footer">
            <button class="doc-btn" onclick="openDocModal()">
                View Workflow Markdown
            </button>
        </div>
    </aside>

    <!-- Main Content -->
    <main class="main-content">

        <!-- ==================== WORKFLOW TAB ==================== -->
        <div id="workflow-panel" class="tab-panel active">
            <!-- Header -->
            <div class="header">
                <h1>Creating a Second Mortgage in Byte</h1>
                <p class="subtitle">Synchronize subordinate liens with primary mortgage files</p>
                <div class="meta">
                    <span class="meta-item">System: BytePro Enterprise</span>
                    <span class="meta-item">Role: Loan Officer / Processor</span>
                    <span class="meta-item">Updated: Jan 27, 2026</span>
                    <span class="meta-item">Duration: 5-10 min</span>
                </div>
            </div>

            <!-- Legend -->
            <div class="legend">
                <div class="legend-item"><div class="legend-color" style="background: linear-gradient(135deg, #22c55e, #16a34a);"></div><span>Start/End</span></div>
                <div class="legend-item"><div class="legend-color" style="background: linear-gradient(135deg, #3b82f6, #2563eb);"></div><span>Action Step</span></div>
                <div class="legend-item"><div class="legend-color" style="background: linear-gradient(135deg, #f59e0b, #d97706);"></div><span>Decision Point</span></div>
                <div class="legend-item"><div class="legend-color" style="background: #111827; border: 2px solid #3b82f6;"></div><span>User Input</span></div>
                <div class="legend-item"><div class="legend-color" style="background: linear-gradient(135deg, #f43f5e, #dc2626);"></div><span>Exception</span></div>
                <div class="legend-item"><div class="legend-color" style="background: linear-gradient(135deg, #14b8a6, #0d9488);"></div><span>Output</span></div>
            </div>

            <!-- Section 0: Overview -->
            <section id="section-0" class="section">
                <div class="section-header">
                    <div class="section-number">0</div>
                    <div class="section-title"><h2>Second Mortgage Overview</h2><span>When and why to create synchronized second mortgages</span></div>
                </div>
                <div class="section-content">
                    <div class="info-box">
                        <h4>What is a Second Mortgage?</h4>
                        <p>A second (subordinate) lien that closes along with the primary mortgage. Can be a closed-end loan or an open-ended HELOC (Home Equity Line of Credit) that can be borrowed, repaid, and borrowed again.</p>
                    </div>

                    <div class="use-case-grid">
                        <div class="use-card">
                            <div class="use-card-header"><h4>Common Use Cases</h4></div>
                            <div class="use-card-body">
                                <ul>
                                    <li><span class="check-icon">+</span> Down Payment & Closing Cost Assistance (Bond Loans)</li>
                                    <li><span class="check-icon">+</span> Avoid Mortgage Insurance and Jumbo Pricing</li>
                                    <li><span class="check-icon">+</span> Home Renovations</li>
                                    <li><span class="check-icon">+</span> College Tuition</li>
                                    <li><span class="check-icon">+</span> Medical Expenses</li>
                                    <li><span class="check-icon">+</span> Debt Consolidation</li>
                                </ul>
                            </div>
                        </div>
                        <div class="use-card">
                            <div class="use-card-header"><h4>Key Requirements</h4></div>
                            <div class="use-card-body">
                                <ul>
                                    <li><span class="check-icon">!</span> Synchronization can ONLY be completed in Byte</li>
                                    <li><span class="check-icon">!</span> Bond seconds MUST be synchronized to first loan</li>
                                    <li><span class="check-icon">!</span> Review HFA guidelines before originating bond loans</li>
                                    <li><span class="check-icon">!</span> First mortgage file must be open on Home screen</li>
                                </ul>
                            </div>
                        </div>
                    </div>

                    <div class="exception-box">
                        <h4>Important: Byte-Only Process</h4>
                        <p>The task of synchronizing a Second Mortgage can <strong>ONLY</strong> be completed in Byte. This cannot be done in other systems.</p>
                    </div>
                </div>
            </section>

            <!-- Section 1: Home Screen -->
            <section id="section-1" class="section">
                <div class="section-header">
                    <div class="section-number">1</div>
                    <div class="section-title"><h2>Access Home Screen</h2><span>Open the first mortgage file and locate synchronization</span></div>
                </div>
                <div class="section-content">
                    <div class="workflow-diagram">
                        <div class="flow-row">
                            <div class="flow-node start">Start</div>
                            <span class="flow-arrow">-></span>
                            <div class="flow-node action">Open First Mortgage Loan File</div>
                            <span class="flow-arrow">-></span>
                            <div class="flow-node output">Home Screen Displays</div>
                        </div>
                    </div>

                    <div class="tip-box">
                        <h4>Pro Tip</h4>
                        <p>The loan file for the first mortgage will open on the <strong>Home screen</strong>. Scroll to the <strong>Status</strong> area to find the Synchronized File option.</p>
                    </div>

                    <table class="field-table">
                        <thead><tr><th>Location</th><th>Field</th><th>Initial Value</th><th>Notes</th></tr></thead>
                        <tbody>
                            <tr><td><strong style="color: var(--text-primary);">Home Screen</strong></td><td>Status Area</td><td>-</td><td>Contains synchronization controls</td></tr>
                            <tr><td><strong style="color: var(--text-primary);">Status Section</strong></td><td>Synchronized File</td><td>No</td><td>Click to initiate synchronization</td></tr>
                            <tr><td><strong style="color: var(--text-primary);">Status Section</strong></td><td>Template File</td><td>No</td><td>Shows template status</td></tr>
                        </tbody>
                    </table>
                </div>
            </section>

            <!-- Section 2: Start Synchronization -->
            <section id="section-2" class="section">
                <div class="section-header">
                    <div class="section-number">2</div>
                    <div class="section-title"><h2>Start Synchronization</h2><span>Initiate the second mortgage creation process</span></div>
                </div>
                <div class="section-content">
                    <div class="workflow-diagram">
                        <div class="flow-row">
                            <div class="flow-node action">Click "Synchronized File"</div>
                            <span class="flow-arrow">-></span>
                            <div class="flow-node output">Synchronization Pop-up Opens</div>
                        </div>
                        <div class="flow-row"><span class="flow-arrow down">|</span></div>
                        <div class="flow-row">
                            <div class="flow-node decision">File Type?</div>
                        </div>
                        <div class="decision-branch">
                            <div class="branch">
                                <span class="branch-label">Standard 2nd</span>
                                <span class="flow-arrow down">|</span>
                                <div class="flow-node input">Check "Create New File - 2nd"</div>
                            </div>
                            <div class="branch">
                                <span class="branch-label">CalHFA 2nd/3rd</span>
                                <span class="flow-arrow down">|</span>
                                <div class="flow-node input">Check "Create New File - 2nd and 3rd"</div>
                            </div>
                        </div>
                        <div class="flow-row"><span class="flow-arrow down">|</span></div>
                        <div class="flow-row">
                            <div class="flow-node action">Click "Start Synchronization"</div>
                        </div>
                    </div>

                    <div class="info-box">
                        <h4>Synchronization Options</h4>
                        <ul style="margin-top: 10px; padding-left: 20px;">
                            <li style="margin-bottom: 8px;"><strong>[Create New File - 2nd]</strong> - Standard second mortgage creation</li>
                            <li><strong>[Create New File - 2nd and 3rd]</strong> - CalHFA programs requiring both 2nd and 3rd liens</li>
                        </ul>
                    </div>
                </div>
            </section>

            <!-- Section 3: Template Selection -->
            <section id="section-3" class="section">
                <div class="section-header">
                    <div class="section-number">3</div>
                    <div class="section-title"><h2>Template Selection</h2><span>Choose the appropriate template for the second mortgage</span></div>
                </div>
                <div class="section-content">
                    <div class="workflow-diagram">
                        <div class="flow-row">
                            <div class="flow-node output">New Synchronized File Pop-up Opens</div>
                        </div>
                        <div class="flow-row"><span class="flow-arrow down">|</span></div>
                        <div class="flow-row">
                            <div class="flow-node input">Template File: Select "Retail Master Template"</div>
                        </div>
                        <div class="flow-row"><span class="flow-arrow down">|</span></div>
                        <div class="flow-row">
                            <div class="flow-node action">Click "OK"</div>
                            <span class="flow-arrow">-></span>
                            <div class="flow-node output">Byte Runs Synchronization</div>
                        </div>
                    </div>

                    <div class="summary-grid">
                        <div class="summary-card"><h4>File Name</h4><div class="value">Auto</div><div class="label">[Auto-generated]</div></div>
                        <div class="summary-card"><h4>Override Naming</h4><div class="value">Opt</div><div class="label">Optional checkbox available</div></div>
                        <div class="summary-card"><h4>Template</h4><div class="value">Retail</div><div class="label">Retail Master Template</div></div>
                    </div>

                    <div class="tip-box">
                        <h4>Result</h4>
                        <p>When creation is complete, you will see <strong>two loan tabs</strong> at the top of the screen: the original loan file and the Second Mortgage just created.</p>
                    </div>
                </div>
            </section>

            <!-- Section 4: Data Sync Fields -->
            <section id="section-4" class="section">
                <div class="section-header">
                    <div class="section-number">4</div>
                    <div class="section-title"><h2>Synchronized Data Fields</h2><span>Fields that transfer between first and second mortgage files</span></div>
                </div>
                <div class="section-content">
                    <div class="info-box">
                        <h4>Data Transfer Direction</h4>
                        <p>Most data transfers from the <strong>first loan</strong> to the second/third. However, several key fields are created for the first file FROM second/third file data.</p>
                    </div>

                    <table class="field-table">
                        <thead><tr><th>Field Name</th><th>Direction</th><th>Status</th><th>Description</th></tr></thead>
                        <tbody>
                            <tr><td><strong style="color: var(--text-primary);">Subordinate Financing Type</strong></td><td><span class="badge sync-badge">2nd -> 1st</span></td><td><span class="badge required-badge">Synced</span></td><td>Type of subordinate loan</td></tr>
                            <tr><td><strong style="color: var(--text-primary);">Subordinate Financing Interest Only Indicator</strong></td><td><span class="badge sync-badge">2nd -> 1st</span></td><td><span class="badge required-badge">Synced</span></td><td>Interest-only flag</td></tr>
                            <tr><td><strong style="color: var(--text-primary);">Subordinate Financing Base Loan Amount</strong></td><td><span class="badge sync-badge">2nd -> 1st</span></td><td><span class="badge required-badge">Synced</span></td><td>Second mortgage amount</td></tr>
                            <tr><td><strong style="color: var(--text-primary);">Subordinate Financing Interest Rate</strong></td><td><span class="badge sync-badge">2nd -> 1st</span></td><td><span class="badge required-badge">Synced</span></td><td>Rate on second mortgage</td></tr>
                            <tr><td><strong style="color: var(--text-primary);">Subordinate Financing Term in Months</strong></td><td><span class="badge sync-badge">2nd -> 1st</span></td><td><span class="badge required-badge">Synced</span></td><td>Loan term</td></tr>
                            <tr><td><strong style="color: var(--text-primary);">Subordinate Financing P&I Override</strong></td><td><span class="badge sync-badge">2nd -> 1st</span></td><td><span class="badge optional-badge">Override</span></td><td>Manual payment override</td></tr>
                            <tr><td><strong style="color: var(--text-primary);">Max HELOC Amount</strong></td><td><span class="badge sync-badge">2nd -> 1st</span></td><td><span class="badge calculated-badge">If HELOC</span></td><td>Maximum credit available on HELOCs</td></tr>
                        </tbody>
                    </table>

                    <div class="exception-box">
                        <h4>Bond Loan Note</h4>
                        <p>Some bond 2nd loans do <strong>not have interest rates</strong> and some do <strong>not require repayment</strong>. Update any necessary information in the second loan including rate and loan amount.</p>
                    </div>
                </div>
            </section>

            <!-- Section 5: Product Selection -->
            <section id="section-5" class="section">
                <div class="section-header">
                    <div class="section-number">5</div>
                    <div class="section-title"><h2>Product Selection for Second Loan</h2><span>Select appropriate loan product from State Agency options</span></div>
                </div>
                <div class="section-content">
                    <div class="workflow-diagram">
                        <div class="flow-row">
                            <div class="flow-node action">Open Second Loan Tab</div>
                            <span class="flow-arrow">-></span>
                            <div class="flow-node action">Navigate to Loan Product</div>
                            <span class="flow-arrow">-></span>
                            <div class="flow-node input">Click "Select" next to Loan Program Code</div>
                        </div>
                    </div>

                    <div class="decision-tree">
                        <h3>Loan Program Selection</h3>
                        <div class="tree-node level-1"><span class="tree-label">Select Loan Program Window</span></div>
                        <div class="tree-node"><span class="tree-label" style="background: var(--accent-blue); color: white;">State Agency Tab</span> -> Most bond products start with code <strong style="color: var(--text-primary);">201</strong></div>
                        <div class="tree-node"><span class="tree-label" style="background: var(--accent-teal); color: white;">Local Agency Tab</span> -> For local DPA programs</div>
                    </div>

                    <div class="info-box">
                        <h4>Product Code Examples (State Agency - 201 Series)</h4>
                        <ul style="margin-top: 10px; padding-left: 20px; column-count: 2;">
                            <li>201LEEDAH - LEE DPA DEF-BOND</li>
                            <li>201MHCMRB - MHC MRB 2nd Mortgage</li>
                            <li>201MIDPA - MSHDA Single Family DPA</li>
                            <li>201NCADV - NCHFA Home Adv DPA</li>
                            <li>201NEHBA - NIFA HBA 2nd Mortgage</li>
                            <li>201NHDFTHB - NHD HIP-FTHIB 2nd Mtg</li>
                        </ul>
                    </div>

                    <div class="tip-box">
                        <h4>Complete Required Fields</h4>
                        <p>After selecting the product, complete the <strong>Loan Amount</strong> and <strong>Interest Rate</strong> fields. The Amortization Type will show (e.g., "No Payment", "Fixed") based on the selected product.</p>
                    </div>
                </div>
            </section>

            <!-- Section 6: Update First Loan -->
            <section id="section-6" class="section">
                <div class="section-header">
                    <div class="section-number">6</div>
                    <div class="section-title"><h2>Update First Mortgage Loan</h2><span>Modify subordinate financing details in the primary loan</span></div>
                </div>
                <div class="section-content">
                    <div class="workflow-diagram">
                        <h3 style="text-align: center; margin-bottom: 22px; color: var(--accent-blue);">Subordinate Financing Update Flow</h3>
                        <div class="flow-row">
                            <div class="flow-node action">Open First Mortgage Tab</div>
                            <span class="flow-arrow">-></span>
                            <div class="flow-node action">Click "Edit Subordinate Financing"</div>
                        </div>
                        <div class="flow-row"><span class="flow-arrow down">|</span></div>
                        <div class="flow-row">
                            <div class="flow-node output">Subordinate Financing Dialog</div>
                        </div>
                        <div class="flow-row"><span class="flow-arrow down">|</span></div>
                        <div class="flow-row">
                            <div class="flow-node decision">Repayment Required?</div>
                        </div>
                        <div class="decision-branch">
                            <div class="branch">
                                <span class="branch-label">YES</span>
                                <span class="flow-arrow down">|</span>
                                <div class="flow-node output">Use Calculated P&I</div>
                            </div>
                            <div class="branch">
                                <span class="branch-label">NO</span>
                                <span class="flow-arrow down">|</span>
                                <div class="flow-node action">Override P&I to $0.00</div>
                            </div>
                        </div>
                    </div>

                    <div class="info-box">
                        <h4>Override Payment for No-Repayment Bonds</h4>
                        <p>If there is <strong>no repayment required</strong>:</p>
                        <ol style="margin-top: 10px; padding-left: 20px;">
                            <li style="margin-bottom: 8px;">Click on the payment amount in the <strong>Calculated P&I</strong> field</li>
                            <li style="margin-bottom: 8px;">Select radio button: <strong>"Override the calculation with this value:"</strong></li>
                            <li style="margin-bottom: 8px;">Type <strong>0.00</strong></li>
                            <li>Click <strong>OK</strong></li>
                        </ol>
                    </div>

                    <table class="field-table">
                        <thead><tr><th>Field</th><th>Location</th><th>Purpose</th></tr></thead>
                        <tbody>
                            <tr><td><strong style="color: var(--text-primary);">Sub Fi Type</strong></td><td>Subordinate Financing Dialog</td><td>Not HELOC / HELOC</td></tr>
                            <tr><td><strong style="color: var(--text-primary);">Loan Amount</strong></td><td>Subordinate Financing Dialog</td><td>Second mortgage amount (synced)</td></tr>
                            <tr><td><strong style="color: var(--text-primary);">Interest Rate</strong></td><td>Subordinate Financing Dialog</td><td>Rate on subordinate lien</td></tr>
                            <tr><td><strong style="color: var(--text-primary);">Term in Months</strong></td><td>Subordinate Financing Dialog</td><td>Loan term (e.g., 180, 360)</td></tr>
                            <tr><td><strong style="color: var(--text-primary);">Calculated P&I</strong></td><td>Subordinate Financing Dialog</td><td>Monthly payment (can override)</td></tr>
                        </tbody>
                    </table>

                    <div class="tip-box">
                        <h4>DTI Impact</h4>
                        <p>The payment amount will be updated in the first mortgage <strong>debt-to-income calculation</strong>. Setting to $0.00 for no-repayment programs ensures accurate DTI.</p>
                    </div>

                    <div class="exception-box">
                        <h4>Stopping Synchronization</h4>
                        <p>To stop the synchronization at any time: Click <strong>Synchronization File</strong> on the Home Screen and click <strong>Stop Synchronization</strong>.</p>
                    </div>
                </div>
            </section>

            <!-- Quick Reference -->
            <section id="quick-ref" class="quick-ref">
                <h3>Quick Reference Card</h3>
                <pre>
CREATE SECOND MORTGAGE IN BYTE - QUICK GUIDE
=============================================

PREREQUISITES:
* First mortgage loan file open on Home screen
* Review HFA guidelines for bond loan programs
* Synchronization can ONLY be done in Byte

STEP-BY-STEP:
1. Home Screen -> Status Area -> Click "Synchronized File"
2. Check [Create New File - 2nd] (or 2nd and 3rd for CalHFA)
3. Click "Start Synchronization"
4. Template File: Select "Retail Master Template" -> OK
5. Two loan tabs appear at top of screen

SECOND LOAN SETUP:
* Navigate to Loan Product section
* Click Select next to Loan Program Code
* State Agency tab -> Products starting with 201
* Enter Loan Amount and Interest Rate

FIRST LOAN UPDATE:
* Click "Edit Subordinate Financing"
* Verify synced data from second loan
* If NO repayment: Override Calculated P&I to 0.00

KEY SYNC FIELDS (2nd -> 1st):
* Subordinate Financing Type
* Base Loan Amount
* Interest Rate
* Term in Months
* P&I Override Value

STOP SYNC: Home Screen -> Synchronization File -> Stop Synchronization

VERIFICATION:
* Both loan files show Synchronized File: Yes
* Sync Results box shows "No errors found"
                </pre>
            </section>
        </div>

        <!-- ==================== AGENT OPPORTUNITIES TAB ==================== -->
        <div id="agents-panel" class="tab-panel">
            <!-- Header -->
            <div class="agent-header">
                <h1>AI Agent Opportunities</h1>
                <p class="subtitle">Automation Analysis for Second Mortgage Creation Workflow</p>
                <div class="meta">
                    <span class="meta-item">7 Process Steps Analyzed</span>
                    <span class="meta-item">4 Agent Candidates Identified</span>
                    <span class="meta-item">Est. 50% Time Savings</span>
                </div>
            </div>

            <!-- Summary Stats -->
            <div class="agent-summary" id="agent-summary">
                <div class="agent-summary-card">
                    <div class="agent-summary-value">4</div>
                    <div class="agent-summary-label">Agent Candidates</div>
                </div>
                <div class="agent-summary-card">
                    <div class="agent-summary-value">2</div>
                    <div class="agent-summary-label">High Priority</div>
                </div>
                <div class="agent-summary-card">
                    <div class="agent-summary-value">50%</div>
                    <div class="agent-summary-label">Time Savings</div>
                </div>
                <div class="agent-summary-card">
                    <div class="agent-summary-value">75%</div>
                    <div class="agent-summary-label">Automation Potential</div>
                </div>
            </div>

            <!-- Heat Map Legend -->
            <div class="heat-legend" id="agent-heatmap">
                <div class="heat-legend-item"><div class="heat-legend-color" style="background: linear-gradient(135deg, #ef4444, #f97316);"></div><span><strong>Critical (90-100)</strong> - Immediate ROI</span></div>
                <div class="heat-legend-item"><div class="heat-legend-color" style="background: linear-gradient(135deg, #f97316, #eab308);"></div><span><strong>High (70-89)</strong> - Strong candidate</span></div>
                <div class="heat-legend-item"><div class="heat-legend-color" style="background: linear-gradient(135deg, #eab308, #22c55e);"></div><span><strong>Medium (50-69)</strong> - Consider</span></div>
                <div class="heat-legend-item"><div class="heat-legend-color" style="background: linear-gradient(135deg, #22c55e, #14b8a6);"></div><span><strong>Low (0-49)</strong> - Future phase</span></div>
            </div>

            <!-- Heat Map Grid -->
            <div class="heat-map-container">
                <div class="heat-map-title">Automation Priority Heat Map <span style="font-size: 0.8rem; font-weight: 400; color: var(--text-muted);">(Click to jump to agent)</span></div>
                <div class="heat-map-grid">
                    <div class="heat-item critical" onclick="scrollToAgent('agent-autosync')" title="Click to view agent details">
                        <div class="heat-score">92</div>
                        <div class="heat-name">Auto-Sync Initiator</div>
                        <div class="heat-desc">Detect bond loan scenarios and auto-initiate synchronization</div>
                        <div class="heat-metrics">
                            <div class="heat-metric">Effort: <span>Low</span></div>
                            <div class="heat-metric">Impact: <span>High</span></div>
                            <div class="heat-metric">Step: <span>1-2</span></div>
                        </div>
                    </div>
                    <div class="heat-item high" onclick="scrollToAgent('agent-product')" title="Click to view agent details">
                        <div class="heat-score">85</div>
                        <div class="heat-name">Bond Product Matcher</div>
                        <div class="heat-desc">Auto-select correct State Agency product based on loan criteria</div>
                        <div class="heat-metrics">
                            <div class="heat-metric">Effort: <span>Medium</span></div>
                            <div class="heat-metric">Impact: <span>High</span></div>
                            <div class="heat-metric">Step: <span>5</span></div>
                        </div>
                    </div>
                    <div class="heat-item medium" onclick="scrollToAgent('agent-payment')" title="Click to view agent details">
                        <div class="heat-score">68</div>
                        <div class="heat-name">Payment Override Agent</div>
                        <div class="heat-desc">Automatically set P&I to $0 for no-repayment programs</div>
                        <div class="heat-metrics">
                            <div class="heat-metric">Effort: <span>Low</span></div>
                            <div class="heat-metric">Impact: <span>Medium</span></div>
                            <div class="heat-metric">Step: <span>6</span></div>
                        </div>
                    </div>
                    <div class="heat-item medium" onclick="scrollToAgent('agent-validation')" title="Click to view agent details">
                        <div class="heat-score">62</div>
                        <div class="heat-name">Sync Validation Agent</div>
                        <div class="heat-desc">Verify all required fields synced correctly between loans</div>
                        <div class="heat-metrics">
                            <div class="heat-metric">Effort: <span>Low</span></div>
                            <div class="heat-metric">Impact: <span>Medium</span></div>
                            <div class="heat-metric">Step: <span>4</span></div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Agent Details -->
            <h2 style="font-size: 1.4rem; margin: 35px 0 22px; color: var(--text-primary);" id="agent-details">Agent Specifications</h2>

            <div class="agent-grid">
                <!-- Agent 1: Auto-Sync Initiator -->
                <div class="agent-card" id="agent-autosync">
                    <div class="agent-card-header">
                        <div class="agent-icon">S</div>
                        <div class="agent-info">
                            <div class="agent-name">Auto-Sync Initiator Agent</div>
                            <div class="agent-type">Process Automation Agent</div>
                        </div>
                        <span class="agent-priority critical">Critical</span>
                    </div>
                    <div class="agent-card-body">
                        <p class="agent-description">Automatically detects when a loan scenario qualifies for a bond/DPA program and initiates the second mortgage synchronization process, pre-selecting the correct file type (2nd or 2nd/3rd for CalHFA).</p>
                        <div class="agent-flow">
                            <div class="agent-flow-title">Agent Flow</div>
                            <div class="agent-flow-diagram">
                                <div class="agent-step">Detect Bond Scenario</div>
                                <span class="agent-arrow">-></span>
                                <div class="agent-step">Match Program Type</div>
                                <span class="agent-arrow">-></span>
                                <div class="agent-step">Auto-Initiate Sync</div>
                                <span class="agent-arrow">-></span>
                                <div class="agent-step">Select Template</div>
                            </div>
                        </div>
                        <div class="agent-stats">
                            <div class="agent-stat"><div class="agent-stat-value">4min</div><div class="agent-stat-label">Time Saved</div></div>
                            <div class="agent-stat"><div class="agent-stat-value">98%</div><div class="agent-stat-label">Accuracy</div></div>
                            <div class="agent-stat"><div class="agent-stat-value">Low</div><div class="agent-stat-label">Complexity</div></div>
                        </div>
                        <button class="agent-prompt-btn" onclick="showAgentPrompt('autosync')">
                            View AI Prompt to Build This Agent
                        </button>
                    </div>
                </div>

                <!-- Agent 2: Bond Product Matcher -->
                <div class="agent-card" id="agent-product">
                    <div class="agent-card-header">
                        <div class="agent-icon">P</div>
                        <div class="agent-info">
                            <div class="agent-name">Bond Product Matcher Agent</div>
                            <div class="agent-type">Decision Support Agent</div>
                        </div>
                        <span class="agent-priority high">High</span>
                    </div>
                    <div class="agent-card-body">
                        <p class="agent-description">Analyzes loan criteria (state, county, income, FTHB status) and automatically selects the correct State Agency bond product code (201 series) based on HFA eligibility rules.</p>
                        <div class="agent-flow">
                            <div class="agent-flow-title">Agent Flow</div>
                            <div class="agent-flow-diagram">
                                <div class="agent-step">Extract Loan Data</div>
                                <span class="agent-arrow">-></span>
                                <div class="agent-step">Match HFA Rules</div>
                                <span class="agent-arrow">-></span>
                                <div class="agent-step">Rank Products</div>
                                <span class="agent-arrow">-></span>
                                <div class="agent-step">Auto-Select</div>
                            </div>
                        </div>
                        <div class="agent-stats">
                            <div class="agent-stat"><div class="agent-stat-value">3min</div><div class="agent-stat-label">Time Saved</div></div>
                            <div class="agent-stat"><div class="agent-stat-value">95%</div><div class="agent-stat-label">Match Rate</div></div>
                            <div class="agent-stat"><div class="agent-stat-value">Med</div><div class="agent-stat-label">Complexity</div></div>
                        </div>
                        <button class="agent-prompt-btn" onclick="showAgentPrompt('product')">
                            View AI Prompt to Build This Agent
                        </button>
                    </div>
                </div>

                <!-- Agent 3: Payment Override Agent -->
                <div class="agent-card" id="agent-payment">
                    <div class="agent-card-header">
                        <div class="agent-icon">$</div>
                        <div class="agent-info">
                            <div class="agent-name">Payment Override Agent</div>
                            <div class="agent-type">Data Automation Agent</div>
                        </div>
                        <span class="agent-priority medium">Medium</span>
                    </div>
                    <div class="agent-card-body">
                        <p class="agent-description">Automatically detects no-repayment bond programs and sets the subordinate financing P&I override to $0.00 in the first mortgage, ensuring accurate DTI calculations.</p>
                        <div class="agent-flow">
                            <div class="agent-flow-title">Agent Flow</div>
                            <div class="agent-flow-diagram">
                                <div class="agent-step">Check Product Type</div>
                                <span class="agent-arrow">-></span>
                                <div class="agent-step">Identify Repayment</div>
                                <span class="agent-arrow">-></span>
                                <div class="agent-step">Set P&I Override</div>
                                <span class="agent-arrow">-></span>
                                <div class="agent-step">Update DTI</div>
                            </div>
                        </div>
                        <div class="agent-stats">
                            <div class="agent-stat"><div class="agent-stat-value">1min</div><div class="agent-stat-label">Time Saved</div></div>
                            <div class="agent-stat"><div class="agent-stat-value">100%</div><div class="agent-stat-label">Accuracy</div></div>
                            <div class="agent-stat"><div class="agent-stat-value">Low</div><div class="agent-stat-label">Complexity</div></div>
                        </div>
                        <button class="agent-prompt-btn" onclick="showAgentPrompt('payment')">
                            View AI Prompt to Build This Agent
                        </button>
                    </div>
                </div>

                <!-- Agent 4: Sync Validation Agent -->
                <div class="agent-card" id="agent-validation">
                    <div class="agent-card-header">
                        <div class="agent-icon">V</div>
                        <div class="agent-info">
                            <div class="agent-name">Sync Validation Agent</div>
                            <div class="agent-type">Quality Assurance Agent</div>
                        </div>
                        <span class="agent-priority medium">Medium</span>
                    </div>
                    <div class="agent-card-body">
                        <p class="agent-description">Validates that all required fields have synced correctly between the first and second mortgage files, flagging any discrepancies or missing data for review.</p>
                        <div class="agent-flow">
                            <div class="agent-flow-title">Agent Flow</div>
                            <div class="agent-flow-diagram">
                                <div class="agent-step">Read Both Files</div>
                                <span class="agent-arrow">-></span>
                                <div class="agent-step">Compare Fields</div>
                                <span class="agent-arrow">-></span>
                                <div class="agent-step">Flag Issues</div>
                                <span class="agent-arrow">-></span>
                                <div class="agent-step">Generate Report</div>
                            </div>
                        </div>
                        <div class="agent-stats">
                            <div class="agent-stat"><div class="agent-stat-value">2min</div><div class="agent-stat-label">Time Saved</div></div>
                            <div class="agent-stat"><div class="agent-stat-value">99%</div><div class="agent-stat-label">Error Catch</div></div>
                            <div class="agent-stat"><div class="agent-stat-value">Low</div><div class="agent-stat-label">Complexity</div></div>
                        </div>
                        <button class="agent-prompt-btn" onclick="showAgentPrompt('validation')">
                            View AI Prompt to Build This Agent
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </main>

    <!-- Documentation Modal -->
    <div class="modal-overlay" id="docModal">
        <div class="modal">
            <div class="modal-header">
                <h3>Create Second Mortgage - Workflow Markdown</h3>
                <div class="modal-actions">
                    <button class="modal-btn copy" onclick="copyToClipboard()">Copy</button>
                    <button class="modal-btn close" onclick="closeDocModal()">Close</button>
                </div>
            </div>
            <div class="modal-body">
                <pre id="docContent"># Creating a Second Mortgage in Byte

## Overview
Second mortgages are subordinate liens that close along with the primary mortgage. They can be closed-end loans or open-ended HELOCs.

## Common Use Cases
- Down Payment & Closing Cost Assistance (Bond Loans)
- Avoid Mortgage Insurance and Jumbo Pricing
- Home Renovations
- College Tuition / Medical Expenses / Debt Consolidation

## Prerequisites
- First mortgage file open in Byte
- Review HFA guidelines for bond programs
- Synchronization can ONLY be done in Byte

## Process Steps

### Step 1: Access Home Screen
1. Open the first mortgage loan file
2. Navigate to Home screen
3. Scroll to Status area

### Step 2: Start Synchronization
1. Click "Synchronized File" in Status area
2. Check [Create New File - 2nd] or [Create New File - 2nd and 3rd] for CalHFA
3. Click "Start Synchronization"

### Step 3: Template Selection
1. New Synchronized File dialog opens
2. Template File: Select "Retail Master Template"
3. Click OK
4. Byte runs synchronization

### Step 4: Verify Sync
- Two loan tabs appear at top of screen
- Synchronized File shows "Yes" on both loans
- Check Sync Results for errors

### Step 5: Product Selection
1. Open second loan tab
2. Navigate to Loan Product
3. Click Select next to Loan Program Code
4. State Agency tab - products starting with 201
5. Enter Loan Amount and Interest Rate

### Step 6: Update First Loan
1. Open first mortgage tab
2. Click "Edit Subordinate Financing"
3. Verify synced data
4. If no repayment: Override P&I to $0.00

## Synchronized Fields (2nd -> 1st)
- Subordinate Financing Type
- Interest Only Indicator
- Base Loan Amount
- Interest Rate
- Term in Months
- P&I Override Value
- Max HELOC Amount (if applicable)

## Stop Synchronization
Home Screen -> Synchronization File -> Stop Synchronization</pre>
            </div>
        </div>
    </div>

    <div class="copy-success" id="copySuccess">Copied to clipboard!</div>

    <!-- AI Prompt Modal -->
    <div class="modal-overlay prompt-modal" id="promptModal">
        <div class="modal">
            <div class="modal-header">
                <h3 id="promptModalTitle">AI Agent Build Prompt</h3>
                <div class="modal-actions">
                    <button class="modal-btn copy" onclick="copyPromptToClipboard()">Copy Prompt</button>
                    <button class="modal-btn close" onclick="closePromptModal()">Close</button>
                </div>
            </div>
            <div class="modal-body">
                <div class="prompt-tags" id="promptTags"></div>
                <div class="prompt-section">
                    <h4>Agent Purpose</h4>
                    <div class="prompt-box" id="promptPurpose"></div>
                </div>
                <div class="prompt-section">
                    <h4>Full Build Prompt</h4>
                    <div class="prompt-box" id="promptContent"></div>
                </div>
                <div class="prompt-section">
                    <h4>Integration Points</h4>
                    <div class="prompt-box" id="promptIntegration"></div>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Scroll spy with isScrolling flag and timeout
        let isScrolling = false;
        let scrollTimeout;
        const sections = document.querySelectorAll('.section, .quick-ref');
        const navItems = document.querySelectorAll('#workflow-nav .nav-item');

        function updateActiveNav() {
            if (isScrolling) return;

            let current = '';
            sections.forEach(section => {
                const sectionTop = section.offsetTop - 100;
                if (window.scrollY >= sectionTop) current = section.getAttribute('id');
            });
            navItems.forEach(item => {
                item.classList.remove('active');
                if (item.getAttribute('href') === '#' + current) item.classList.add('active');
            });
        }

        // Handle nav clicks with scroll flag
        navItems.forEach(item => {
            item.addEventListener('click', function(e) {
                e.preventDefault();
                isScrolling = true;

                // Update active state immediately
                navItems.forEach(nav => nav.classList.remove('active'));
                this.classList.add('active');

                // Scroll to section
                const targetId = this.getAttribute('href').substring(1);
                const targetSection = document.getElementById(targetId);
                if (targetSection) {
                    targetSection.scrollIntoView({ behavior: 'smooth' });
                }

                // Reset flag after 1000ms
                clearTimeout(scrollTimeout);
                scrollTimeout = setTimeout(() => {
                    isScrolling = false;
                }, 1000);
            });
        });

        window.addEventListener('scroll', updateActiveNav);

        // Tab switching
        function switchTab(tab) {
            document.querySelectorAll('.sidebar-tab').forEach(t => t.classList.remove('active'));
            document.querySelectorAll('.tab-panel').forEach(p => p.classList.remove('active'));

            if (tab === 'workflow') {
                document.querySelector('.sidebar-tab:not(.agent-tab)').classList.add('active');
                document.getElementById('workflow-panel').classList.add('active');
                document.getElementById('workflow-nav').style.display = 'block';
                document.getElementById('agents-nav').style.display = 'none';
            } else {
                document.querySelector('.sidebar-tab.agent-tab').classList.add('active');
                document.getElementById('agents-panel').classList.add('active');
                document.getElementById('workflow-nav').style.display = 'none';
                document.getElementById('agents-nav').style.display = 'block';
            }

            window.scrollTo(0, 0);
        }

        // Scroll to agent from heat map
        function scrollToAgent(agentId) {
            switchTab('agents');
            setTimeout(() => {
                const agentCard = document.getElementById(agentId);
                if (agentCard) {
                    agentCard.scrollIntoView({ behavior: 'smooth', block: 'center' });
                    agentCard.classList.add('highlight');
                    setTimeout(() => agentCard.classList.remove('highlight'), 2000);
                }
            }, 100);
        }

        // Modal functions
        function openDocModal() {
            document.getElementById('docModal').classList.add('show');
            document.body.style.overflow = 'hidden';
        }

        function closeDocModal() {
            document.getElementById('docModal').classList.remove('show');
            document.body.style.overflow = '';
        }

        async function copyToClipboard() {
            try {
                await navigator.clipboard.writeText(document.getElementById('docContent').textContent);
                const success = document.getElementById('copySuccess');
                success.style.display = 'block';
                setTimeout(() => { success.style.display = 'none'; }, 2000);
            } catch (e) { alert('Failed to copy.'); }
        }

        // Agent Prompt System
        const agentPrompts = {
            autosync: {
                name: 'Auto-Sync Initiator Agent',
                tags: ['Process Automation', 'Byte Integration', 'Low Complexity', 'Critical Priority'],
                purpose: `This agent automatically detects when a loan scenario qualifies for a bond/DPA program requiring a synchronized second mortgage, and initiates the synchronization process with the correct file type selection.`,
                prompt: `You are building a Process Automation Agent for CMG Financial's Byte LOS system.

AGENT NAME: Auto-Sync Initiator Agent
TYPE: Process Automation / Workflow Trigger

OBJECTIVE:
Create an agent that monitors loan files and automatically initiates second mortgage synchronization when bond/DPA programs are detected.

TRIGGER CONDITIONS:
1. First mortgage file contains bond-eligible criteria:
   - State Agency or Local Agency product selected
   - DPA (Down Payment Assistance) program indicated
   - First-time homebuyer with income-restricted product
   - CalHFA or similar state programs

2. File type detection rules:
   IF program = CalHFA THEN select "Create New File - 2nd and 3rd"
   ELSE select "Create New File - 2nd"

AUTOMATION STEPS:
1. Monitor loan file for bond program indicators
2. When detected, navigate to Home Screen > Status area
3. Click "Synchronized File" link
4. Auto-select appropriate checkbox based on program type
5. Click "Start Synchronization"
6. Select "Retail Master Template"
7. Click OK
8. Verify two loan tabs created
9. Log synchronization initiation

OUTPUT:
{
  "syncInitiated": true,
  "fileType": "2nd" | "2nd and 3rd",
  "templateUsed": "Retail Master Template",
  "firstLoanNumber": "string",
  "secondLoanNumber": "string",
  "timestamp": "ISO date"
}`,
                integration: `INTEGRATION POINTS:
1. Byte LOS API / UI Automation
   - Monitor loan file changes
   - Access Home Screen status area
   - Execute synchronization commands

2. Program Eligibility Database
   - HFA program rules by state
   - CalHFA specific requirements
   - Bond program identifiers

3. Audit Trail
   - Log all auto-sync events
   - Track success/failure rates
   - Generate compliance reports`
            },
            product: {
                name: 'Bond Product Matcher Agent',
                tags: ['Decision Support', 'HFA Rules Engine', 'Medium Complexity', 'High Priority'],
                purpose: `This agent analyzes loan criteria and automatically selects the correct State Agency bond product code (201 series) based on HFA eligibility rules, income limits, and geographic requirements.`,
                prompt: `You are building a Decision Support Agent for CMG Financial's Byte LOS system.

AGENT NAME: Bond Product Matcher Agent
TYPE: Decision Support / Rules Engine

OBJECTIVE:
Create an agent that matches loan scenarios to the correct State Agency bond product based on HFA guidelines and eligibility criteria.

INPUT PARAMETERS:
1. Property Location (State, County, City)
2. Borrower Income
3. Purchase Price
4. First-Time Homebuyer Status
5. Property Type
6. Selected First Mortgage Program

PRODUCT MATCHING RULES:
State Agency products start with code 201:
- 201LEEDAH: LEE DPA DEF-BOND
- 201MHCMRB: MHC MRB 2nd Mortgage 10YrFx Bond
- 201MIDPA: MSHDA Single Family DPA 30YrFix
- 201MSTEP: MSHDA Step Forward DPA Forgivable
- 201NCADV: NCHFA Home Adv DPA 10YrFx Bond
- 201NCFIRST: NCHFA First Home Adv DPA 15YrFx
- 201NEHBA: NIFA HBA 10YrFx 2nd Mortgage
- (etc.)

MATCHING LOGIC:
1. Filter by state (extract state code from product)
2. Check income limits for county
3. Verify purchase price limits
4. Confirm FTHB requirement if applicable
5. Match amortization type (No Payment, Fixed)
6. Return ranked list of eligible products

OUTPUT:
{
  "recommendedProduct": {
    "code": "201XXXXX",
    "name": "Full Product Name",
    "amortization": "No Payment | Fixed",
    "confidence": 0.95
  },
  "alternatives": [...],
  "ineligible": [
    { "code": "...", "reason": "Income exceeds limit" }
  ]
}`,
                integration: `INTEGRATION POINTS:
1. HFA Guidelines Database
   - State-by-state program rules
   - Income/price limits by county
   - Eligibility requirements

2. Byte Product Selection Screen
   - Navigate to State Agency tab
   - Filter and highlight recommended
   - Auto-select with confirmation

3. Real-time Updates
   - Sync with HFA guideline changes
   - Update limits quarterly
   - Alert on program sunsets`
            },
            payment: {
                name: 'Payment Override Agent',
                tags: ['Data Automation', 'DTI Calculation', 'Low Complexity', 'Medium Priority'],
                purpose: `This agent automatically identifies no-repayment bond programs and sets the subordinate financing P&I override to $0.00 in the first mortgage, ensuring accurate debt-to-income calculations.`,
                prompt: `You are building a Data Automation Agent for CMG Financial's Byte LOS system.

AGENT NAME: Payment Override Agent
TYPE: Data Automation / Calculation Support

OBJECTIVE:
Create an agent that identifies bond programs with no repayment requirements and automatically sets the subordinate financing P&I override to $0.00.

NO-REPAYMENT PROGRAM INDICATORS:
1. Amortization Type = "No Payment"
2. Product description contains:
   - "Forgivable"
   - "Deferred"
   - "DEF-BOND"
   - "Silent Second"
3. Interest Rate = 0.000%
4. Specific program codes (maintain list)

AUTOMATION FLOW:
1. After sync completes, read second loan product info
2. Check for no-repayment indicators
3. If no repayment required:
   a. Open first mortgage loan
   b. Navigate to Subordinate Financing section
   c. Click on Calculated P&I value
   d. Select "Override the calculation with this value"
   e. Enter 0.00
   f. Click OK
4. Verify DTI recalculated correctly

VALIDATION:
- Confirm P&I shows 0.00 after override
- Verify DTI updated in first mortgage
- Log override action for audit

OUTPUT:
{
  "productCode": "201XXXXX",
  "isNoRepayment": true,
  "originalPI": 66.67,
  "overridePI": 0.00,
  "dtiBeforeOverride": 45.2,
  "dtiAfterOverride": 44.8,
  "overrideApplied": true
}`,
                integration: `INTEGRATION POINTS:
1. Byte Subordinate Financing Dialog
   - Access Edit Subordinate Financing button
   - Modify Calculated P&I field
   - Apply override value

2. Product Rules Database
   - Maintain list of no-repayment codes
   - Update when new programs added
   - Handle program variations

3. DTI Calculation Engine
   - Verify DTI recalculation
   - Compare before/after values
   - Flag if DTI unchanged (error)`
            },
            validation: {
                name: 'Sync Validation Agent',
                tags: ['Quality Assurance', 'Data Validation', 'Low Complexity', 'Medium Priority'],
                purpose: `This agent validates that all required fields have synced correctly between the first and second mortgage files, flagging any discrepancies or missing data for immediate review.`,
                prompt: `You are building a Quality Assurance Agent for CMG Financial's Byte LOS system.

AGENT NAME: Sync Validation Agent
TYPE: Quality Assurance / Data Validation

OBJECTIVE:
Create an agent that validates synchronization completeness and data integrity between linked first and second mortgage files.

VALIDATION CHECKS:

1. FILE LINKAGE
   - Both files show "Synchronized File: Yes"
   - Loan numbers correctly cross-referenced
   - Same borrower information

2. REQUIRED FIELD SYNC (2nd -> 1st)
   - Subordinate Financing Type: [value matched]
   - Interest Only Indicator: [value matched]
   - Base Loan Amount: [value matched]
   - Interest Rate: [value matched]
   - Term in Months: [value matched]
   - P&I Override: [value or calculation matched]

3. DATA CONSISTENCY
   - Borrower names match exactly
   - Property address identical
   - Closing date aligned
   - Lender information consistent

4. CALCULATION VERIFICATION
   - If HELOC: Max credit amount synced
   - DTI reflects subordinate payment
   - CLTV calculated correctly

ERROR SEVERITY LEVELS:
- CRITICAL: Missing required sync field
- WARNING: Data mismatch (non-blocking)
- INFO: Optional field not synced

OUTPUT:
{
  "validationPassed": true | false,
  "criticalErrors": [...],
  "warnings": [...],
  "fieldComparison": {
    "subFinType": { "first": "Not HELOC", "second": "Not HELOC", "match": true },
    "loanAmount": { "first": 12000, "second": 12000, "match": true },
    ...
  },
  "recommendations": [...]
}`,
                integration: `INTEGRATION POINTS:
1. Byte File Reader
   - Access both loan files
   - Extract synchronized fields
   - Compare values

2. Validation Rules Engine
   - Define matching requirements
   - Set tolerance thresholds
   - Handle edge cases

3. Error Reporting Dashboard
   - Display validation results
   - One-click navigation to issues
   - Batch validation for pipeline`
            }
        };

        let currentPromptKey = '';

        function showAgentPrompt(key) {
            const prompt = agentPrompts[key];
            if (!prompt) return;

            currentPromptKey = key;
            document.getElementById('promptModalTitle').textContent = prompt.name + ' - Build Prompt';
            document.getElementById('promptTags').innerHTML = prompt.tags.map(t => `<span class="prompt-tag">${t}</span>`).join('');
            document.getElementById('promptPurpose').textContent = prompt.purpose;
            document.getElementById('promptContent').textContent = prompt.prompt;
            document.getElementById('promptIntegration').textContent = prompt.integration;
            document.getElementById('promptModal').classList.add('show');
            document.body.style.overflow = 'hidden';
        }

        function closePromptModal() {
            document.getElementById('promptModal').classList.remove('show');
            document.body.style.overflow = '';
        }

        async function copyPromptToClipboard() {
            const prompt = agentPrompts[currentPromptKey];
            if (!prompt) return;

            const fullText = `# ${prompt.name}\n\n## Purpose\n${prompt.purpose}\n\n## Build Prompt\n${prompt.prompt}\n\n## Integration Points\n${prompt.integration}`;
            try {
                await navigator.clipboard.writeText(fullText);
                const success = document.getElementById('copySuccess');
                success.style.display = 'block';
                setTimeout(() => { success.style.display = 'none'; }, 2000);
            } catch (e) { alert('Failed to copy.'); }
        }

        // Keyboard and click handlers
        document.addEventListener('keydown', (e) => {
            if (e.key === 'Escape') {
                closeDocModal();
                closePromptModal();
            }
        });

        document.getElementById('docModal').addEventListener('click', (e) => {
            if (e.target.id === 'docModal') closeDocModal();
        });

        document.getElementById('promptModal').addEventListener('click', (e) => {
            if (e.target.id === 'promptModal') closePromptModal();
        });

        // Initialize
        document.addEventListener('DOMContentLoaded', () => { updateActiveNav(); });
    </script>
</body>
</html>
