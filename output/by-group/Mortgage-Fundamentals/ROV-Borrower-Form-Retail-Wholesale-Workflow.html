<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ROV Borrower Form Retail & Wholesale - Process Workflow</title>
    <link href="https://fonts.googleapis.com/css2?family=Plus+Jakarta+Sans:wght@400;500;600;700;800&family=JetBrains+Mono:wght@400;500&display=swap" rel="stylesheet">
    <style>
        :root {
            --bg-primary: #0a0f1a;
            --bg-secondary: #111827;
            --bg-card: #1a2234;
            --accent-blue: #3b82f6;
            --accent-teal: #14b8a6;
            --accent-amber: #f59e0b;
            --accent-rose: #f43f5e;
            --accent-green: #22c55e;
            --accent-purple: #8b5cf6;
            --text-primary: #f1f5f9;
            --text-secondary: #94a3b8;
            --text-muted: #64748b;
            --border-subtle: rgba(255,255,255,0.08);
            --sidebar-width: 280px;
        }

        * { box-sizing: border-box; margin: 0; padding: 0; }
        html { scroll-behavior: smooth; }
        body {
            font-family: 'Plus Jakarta Sans', -apple-system, BlinkMacSystemFont, sans-serif;
            background: var(--bg-primary);
            color: var(--text-primary);
            min-height: 100vh;
        }

        /* Breadcrumb */
        .breadcrumb {
            background: linear-gradient(90deg, #0d1525 0%, #1a2234 100%);
            padding: 14px 25px;
            display: flex;
            align-items: center;
            gap: 12px;
            font-size: 0.95rem;
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            z-index: 1001;
            border-bottom: 1px solid var(--border-subtle);
        }

        .breadcrumb a {
            color: var(--text-secondary);
            text-decoration: none;
            font-weight: 600;
            padding: 8px 16px;
            background: rgba(255,255,255,0.05);
            border-radius: 8px;
            transition: all 0.2s;
            border: 1px solid var(--border-subtle);
        }

        .breadcrumb a:hover {
            background: rgba(59, 130, 246, 0.15);
            color: var(--accent-blue);
            border-color: rgba(59, 130, 246, 0.3);
        }

        .breadcrumb .separator { color: var(--text-muted); font-size: 1.2rem; }
        .breadcrumb .current { color: var(--accent-amber); font-weight: 600; padding: 8px 16px; }

        /* Sidebar */
        .sidebar {
            position: fixed;
            top: 54px;
            left: 0;
            width: var(--sidebar-width);
            height: calc(100vh - 54px);
            background: var(--bg-secondary);
            overflow-y: auto;
            z-index: 1000;
            border-right: 1px solid var(--border-subtle);
            display: flex;
            flex-direction: column;
        }

        .sidebar-header {
            padding: 25px 20px;
            background: rgba(0,0,0,0.3);
            border-bottom: 1px solid var(--border-subtle);
        }

        .sidebar-header h2 { color: var(--text-primary); font-size: 1.2rem; font-weight: 700; margin-bottom: 5px; }
        .sidebar-header p { color: var(--text-muted); font-size: 0.85rem; }

        /* Tab Switch */
        .sidebar-tabs {
            display: flex;
            border-bottom: 1px solid var(--border-subtle);
        }

        .sidebar-tab {
            flex: 1;
            padding: 14px 10px;
            text-align: center;
            font-size: 0.8rem;
            font-weight: 700;
            color: var(--text-muted);
            cursor: pointer;
            transition: all 0.2s;
            border-bottom: 3px solid transparent;
            background: none;
            border-left: none;
            border-right: none;
            border-top: none;
        }

        .sidebar-tab:hover { background: rgba(255,255,255,0.03); color: var(--text-secondary); }
        .sidebar-tab.active { color: var(--accent-blue); border-bottom-color: var(--accent-blue); background: rgba(59, 130, 246, 0.08); }
        .sidebar-tab.agent-tab.active { color: var(--accent-purple); border-bottom-color: var(--accent-purple); background: rgba(139, 92, 246, 0.08); }

        .sidebar-nav { padding: 15px 0; flex: 1; overflow-y: auto; }

        .nav-item {
            display: flex;
            align-items: center;
            gap: 12px;
            padding: 14px 20px;
            color: var(--text-secondary);
            text-decoration: none;
            border-left: 3px solid transparent;
            transition: all 0.2s ease;
            cursor: pointer;
        }

        .nav-item:hover { background: rgba(255,255,255,0.03); color: var(--text-primary); }
        .nav-item.active { background: rgba(59, 130, 246, 0.1); border-left-color: var(--accent-blue); color: var(--text-primary); }

        .nav-number {
            background: rgba(255,255,255,0.1);
            color: var(--text-secondary);
            width: 28px;
            height: 28px;
            border-radius: 8px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 700;
            font-size: 0.85rem;
            flex-shrink: 0;
        }

        .nav-item.active .nav-number { background: var(--accent-blue); color: white; }
        .nav-label { font-size: 0.95rem; font-weight: 500; }

        .sidebar-footer {
            padding: 20px;
            border-top: 1px solid var(--border-subtle);
            background: rgba(0,0,0,0.2);
        }

        .doc-btn {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
            width: 100%;
            padding: 14px 20px;
            background: linear-gradient(135deg, var(--accent-blue) 0%, var(--accent-teal) 100%);
            color: white;
            border: none;
            border-radius: 10px;
            font-weight: 600;
            cursor: pointer;
            transition: transform 0.2s, box-shadow 0.2s;
            text-decoration: none;
            font-size: 0.95rem;
        }

        .doc-btn:hover { transform: translateY(-2px); box-shadow: 0 8px 25px rgba(59, 130, 246, 0.3); }

        /* Main Content */
        .main-content { margin-left: var(--sidebar-width); padding: 80px 40px 40px 40px; }

        /* Tab Panels */
        .tab-panel { display: none; }
        .tab-panel.active { display: block; }

        .header {
            background: var(--bg-card);
            border: 1px solid var(--border-subtle);
            padding: 35px;
            border-radius: 16px;
            margin-bottom: 30px;
            position: relative;
            overflow: hidden;
        }

        .header::before {
            content: '';
            position: absolute;
            top: 0; left: 0; right: 0; bottom: 0;
            background:
                radial-gradient(ellipse at 20% 20%, rgba(59, 130, 246, 0.1) 0%, transparent 50%),
                radial-gradient(ellipse at 80% 80%, rgba(20, 184, 166, 0.08) 0%, transparent 50%);
            pointer-events: none;
        }

        .header h1 {
            font-size: 2.2rem;
            font-weight: 800;
            margin-bottom: 10px;
            position: relative;
            background: linear-gradient(135deg, var(--text-primary) 0%, var(--accent-blue) 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .header .subtitle { color: var(--text-secondary); font-size: 1.1rem; position: relative; }

        .header .meta { display: flex; gap: 15px; margin-top: 20px; flex-wrap: wrap; position: relative; }

        .header .meta-item {
            background: rgba(255,255,255,0.05);
            border: 1px solid var(--border-subtle);
            padding: 8px 16px;
            border-radius: 8px;
            font-size: 0.9rem;
            color: var(--text-secondary);
        }

        /* Legend */
        .legend {
            display: flex;
            flex-wrap: wrap;
            gap: 15px;
            padding: 18px 22px;
            background: var(--bg-card);
            border: 1px solid var(--border-subtle);
            border-radius: 12px;
            margin-bottom: 25px;
        }

        .legend-item { display: flex; align-items: center; gap: 8px; font-size: 0.85rem; color: var(--text-secondary); }
        .legend-color { width: 18px; height: 18px; border-radius: 4px; }

        /* Sections */
        .section {
            background: var(--bg-card);
            border: 1px solid var(--border-subtle);
            border-radius: 16px;
            margin-bottom: 25px;
            overflow: hidden;
            scroll-margin-top: 75px;
        }

        .section-header {
            background: linear-gradient(135deg, var(--bg-secondary) 0%, rgba(59, 130, 246, 0.1) 100%);
            border-bottom: 1px solid var(--border-subtle);
            padding: 22px 25px;
            display: flex;
            align-items: center;
            gap: 18px;
        }

        .section-number {
            background: linear-gradient(135deg, var(--accent-blue) 0%, var(--accent-teal) 100%);
            color: white;
            width: 48px;
            height: 48px;
            border-radius: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 800;
            font-size: 1.3rem;
            flex-shrink: 0;
        }

        .section-title h2 { font-size: 1.35rem; font-weight: 700; margin-bottom: 4px; color: var(--text-primary); }
        .section-title span { font-size: 0.9rem; color: var(--text-muted); }
        .section-content { padding: 28px; }

        /* Workflow Diagrams */
        .workflow-diagram {
            background: rgba(0,0,0,0.3);
            border: 1px solid var(--border-subtle);
            border-radius: 12px;
            padding: 28px;
            margin-bottom: 22px;
        }

        .flow-row { display: flex; align-items: center; justify-content: center; flex-wrap: wrap; gap: 12px; margin: 15px 0; }

        .flow-node {
            padding: 14px 22px;
            border-radius: 10px;
            text-align: center;
            font-size: 0.9rem;
            font-weight: 600;
            min-width: 150px;
            border: 1px solid var(--border-subtle);
        }

        .flow-node.start { background: linear-gradient(135deg, var(--accent-green) 0%, #16a34a 100%); color: white; border-radius: 25px; border: none; }
        .flow-node.action { background: linear-gradient(135deg, var(--accent-blue) 0%, #2563eb 100%); color: white; border: none; }
        .flow-node.decision { background: linear-gradient(135deg, var(--accent-amber) 0%, #d97706 100%); color: var(--bg-primary); border: none; }
        .flow-node.input { background: var(--bg-secondary); border: 2px solid var(--accent-blue); color: var(--text-primary); }
        .flow-node.output { background: linear-gradient(135deg, var(--accent-teal) 0%, #0d9488 100%); color: white; border: none; }
        .flow-node.exception { background: linear-gradient(135deg, var(--accent-rose) 0%, #dc2626 100%); color: white; border: none; }

        .flow-arrow { color: var(--accent-blue); font-size: 1.5rem; }
        .flow-arrow.down { transform: rotate(90deg); }

        .decision-branch { display: flex; gap: 40px; justify-content: center; margin: 20px 0; flex-wrap: wrap; }
        .branch { display: flex; flex-direction: column; align-items: center; gap: 10px; }

        .branch-label {
            background: var(--bg-secondary);
            border: 1px solid var(--border-subtle);
            padding: 6px 16px;
            border-radius: 20px;
            font-size: 0.8rem;
            font-weight: 700;
            color: var(--text-secondary);
        }

        /* Tables */
        .field-table { width: 100%; border-collapse: collapse; margin: 18px 0; }

        .field-table th {
            background: rgba(59, 130, 246, 0.15);
            color: var(--accent-blue);
            padding: 14px 18px;
            text-align: left;
            font-weight: 600;
            font-size: 0.9rem;
            text-transform: uppercase;
            letter-spacing: 0.05em;
            border-bottom: 1px solid var(--border-subtle);
        }

        .field-table td { padding: 14px 18px; border-bottom: 1px solid var(--border-subtle); color: var(--text-secondary); }
        .field-table tr:hover { background: rgba(255,255,255,0.02); }

        .badge { display: inline-block; padding: 4px 12px; border-radius: 6px; font-size: 0.75rem; font-weight: 700; text-transform: uppercase; letter-spacing: 0.05em; }
        .badge.required-badge { background: rgba(244, 63, 94, 0.15); color: var(--accent-rose); }
        .badge.optional-badge { background: rgba(34, 197, 94, 0.15); color: var(--accent-green); }
        .badge.calculated-badge { background: rgba(59, 130, 246, 0.15); color: var(--accent-blue); }

        /* Info Boxes */
        .exception-box, .tip-box, .info-box {
            padding: 18px 22px;
            margin: 18px 0;
            border-radius: 0 10px 10px 0;
            border-left-width: 4px;
            border-left-style: solid;
        }

        .exception-box { background: rgba(244, 63, 94, 0.08); border-color: var(--accent-rose); border: 1px solid rgba(244, 63, 94, 0.2); border-left: 4px solid var(--accent-rose); }
        .exception-box h4 { color: var(--accent-rose); margin-bottom: 10px; font-size: 1rem; }
        .exception-box p, .exception-box li { color: var(--text-secondary); }

        .tip-box { background: rgba(34, 197, 94, 0.08); border-color: var(--accent-green); border: 1px solid rgba(34, 197, 94, 0.2); border-left: 4px solid var(--accent-green); }
        .tip-box h4 { color: var(--accent-green); margin-bottom: 10px; font-size: 1rem; }
        .tip-box p, .tip-box li { color: var(--text-secondary); }

        .info-box { background: rgba(59, 130, 246, 0.08); border-color: var(--accent-blue); border: 1px solid rgba(59, 130, 246, 0.2); border-left: 4px solid var(--accent-blue); }
        .info-box h4 { color: var(--accent-blue); margin-bottom: 10px; font-size: 1rem; }
        .info-box p, .info-box li { color: var(--text-secondary); }

        /* Decision Tree */
        .decision-tree {
            background: rgba(0,0,0,0.2);
            border: 1px solid var(--border-subtle);
            border-radius: 12px;
            padding: 22px;
            margin: 22px 0;
        }

        .decision-tree h3 { color: var(--accent-blue); margin-bottom: 18px; padding-bottom: 12px; border-bottom: 1px solid var(--border-subtle); font-size: 1.1rem; }

        .tree-node { margin-left: 20px; padding: 12px; border-left: 2px solid var(--accent-teal); position: relative; color: var(--text-secondary); }
        .tree-node::before { content: ''; position: absolute; left: -2px; top: 22px; width: 15px; height: 2px; background: var(--accent-teal); }
        .tree-node.level-1 { margin-left: 0; border-left: none; }
        .tree-node.level-1::before { display: none; }

        .tree-label { background: var(--accent-amber); color: var(--bg-primary); padding: 6px 14px; border-radius: 6px; font-weight: 700; display: inline-block; margin-bottom: 6px; font-size: 0.9rem; }

        /* Summary Grid */
        .summary-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(180px, 1fr)); gap: 18px; margin: 22px 0; }

        .summary-card { background: rgba(0,0,0,0.3); border: 1px solid var(--border-subtle); border-radius: 12px; padding: 22px; text-align: center; }
        .summary-card h4 { color: var(--text-secondary); margin-bottom: 12px; font-size: 0.9rem; }
        .summary-card .value {
            font-size: 2.2rem;
            font-weight: 800;
            background: linear-gradient(135deg, var(--accent-blue) 0%, var(--accent-teal) 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }
        .summary-card .label { font-size: 0.85rem; color: var(--text-muted); margin-top: 8px; }

        /* Quick Reference */
        .quick-ref {
            background: linear-gradient(135deg, var(--bg-secondary) 0%, var(--bg-card) 100%);
            border: 1px solid var(--border-subtle);
            padding: 28px;
            border-radius: 16px;
            margin-top: 30px;
            font-family: 'JetBrains Mono', monospace;
            scroll-margin-top: 75px;
        }

        .quick-ref h3 { color: var(--accent-amber); margin-bottom: 18px; font-family: 'Plus Jakarta Sans', sans-serif; }
        .quick-ref pre { background: rgba(0,0,0,0.4); border: 1px solid var(--border-subtle); padding: 20px; border-radius: 10px; overflow-x: auto; font-size: 0.85rem; line-height: 1.7; color: var(--text-secondary); }

        /* Step List */
        .step-list { list-style: none; padding: 0; margin: 18px 0; }
        .step-list li {
            padding: 14px 18px;
            border-left: 3px solid var(--accent-blue);
            background: rgba(0,0,0,0.2);
            margin-bottom: 10px;
            border-radius: 0 8px 8px 0;
            color: var(--text-secondary);
        }
        .step-list li strong { color: var(--text-primary); }

        /* ====== AGENT OPPORTUNITIES STYLES ====== */
        .agent-header {
            background: var(--bg-card);
            border: 1px solid var(--border-subtle);
            padding: 35px;
            border-radius: 16px;
            margin-bottom: 30px;
            position: relative;
            overflow: hidden;
        }

        .agent-header::before {
            content: '';
            position: absolute;
            top: 0; left: 0; right: 0; bottom: 0;
            background:
                radial-gradient(ellipse at 20% 20%, rgba(139, 92, 246, 0.12) 0%, transparent 50%),
                radial-gradient(ellipse at 80% 80%, rgba(245, 158, 11, 0.1) 0%, transparent 50%);
            pointer-events: none;
        }

        .agent-header h1 {
            font-size: 2.2rem;
            font-weight: 800;
            margin-bottom: 10px;
            position: relative;
            background: linear-gradient(135deg, var(--accent-purple) 0%, var(--accent-amber) 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .agent-header .subtitle { color: var(--text-secondary); font-size: 1.1rem; position: relative; }

        /* Heat Map */
        .heat-map-container { margin-bottom: 35px; }
        .heat-map-title { font-size: 1.3rem; font-weight: 700; color: var(--text-primary); margin-bottom: 20px; display: flex; align-items: center; gap: 12px; }

        .heat-map-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
        }

        .heat-item {
            background: var(--bg-card);
            border: 1px solid var(--border-subtle);
            border-radius: 12px;
            padding: 20px;
            position: relative;
            overflow: hidden;
            transition: transform 0.2s, box-shadow 0.2s;
            cursor: pointer;
        }

        .heat-item:hover { transform: translateY(-3px); box-shadow: 0 10px 30px rgba(0,0,0,0.3); }
        .heat-item:active { transform: scale(0.98); }

        .heat-item::before {
            content: '';
            position: absolute;
            top: 0; left: 0; right: 0; height: 4px;
        }

        .heat-item.critical::before { background: linear-gradient(90deg, #ef4444, #f97316); }
        .heat-item.high::before { background: linear-gradient(90deg, #f97316, #eab308); }
        .heat-item.medium::before { background: linear-gradient(90deg, #eab308, #22c55e); }
        .heat-item.low::before { background: linear-gradient(90deg, #22c55e, #14b8a6); }

        .heat-score {
            position: absolute;
            top: 15px;
            right: 15px;
            font-size: 1.8rem;
            font-weight: 800;
        }

        .heat-item.critical .heat-score { color: #ef4444; }
        .heat-item.high .heat-score { color: #f97316; }
        .heat-item.medium .heat-score { color: #eab308; }
        .heat-item.low .heat-score { color: #22c55e; }

        .heat-name { font-size: 1rem; font-weight: 700; color: var(--text-primary); margin-bottom: 6px; padding-right: 50px; }
        .heat-desc { font-size: 0.85rem; color: var(--text-muted); margin-bottom: 12px; }

        .heat-metrics { display: flex; gap: 15px; margin-top: 12px; }
        .heat-metric { font-size: 0.75rem; color: var(--text-muted); }
        .heat-metric span { color: var(--text-secondary); font-weight: 600; }

        /* Agent Cards */
        .agent-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(380px, 1fr)); gap: 25px; margin-bottom: 35px; }

        .agent-card {
            background: var(--bg-card);
            border: 1px solid var(--border-subtle);
            border-radius: 16px;
            overflow: hidden;
            transition: transform 0.2s, box-shadow 0.2s;
        }

        .agent-card:hover { transform: translateY(-5px); box-shadow: 0 15px 50px rgba(0,0,0,0.3); }

        .agent-card.highlight {
            animation: highlightPulse 2s ease;
            box-shadow: 0 0 0 3px var(--accent-purple), 0 15px 50px rgba(139, 92, 246, 0.4);
        }

        @keyframes highlightPulse {
            0% { box-shadow: 0 0 0 3px var(--accent-purple), 0 15px 50px rgba(139, 92, 246, 0.6); }
            50% { box-shadow: 0 0 0 6px rgba(139, 92, 246, 0.5), 0 15px 50px rgba(139, 92, 246, 0.3); }
            100% { box-shadow: 0 0 0 0px transparent, 0 15px 50px rgba(0,0,0,0.3); }
        }

        .agent-card-header {
            padding: 22px;
            display: flex;
            align-items: flex-start;
            gap: 18px;
            border-bottom: 1px solid var(--border-subtle);
        }

        .agent-icon {
            width: 55px;
            height: 55px;
            background: linear-gradient(135deg, var(--accent-purple) 0%, var(--accent-blue) 100%);
            border-radius: 14px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.6rem;
            flex-shrink: 0;
        }

        .agent-info { flex: 1; }
        .agent-name { font-size: 1.15rem; font-weight: 700; color: var(--text-primary); margin-bottom: 5px; }
        .agent-type { font-size: 0.8rem; color: var(--accent-purple); font-weight: 600; text-transform: uppercase; letter-spacing: 0.05em; }

        .agent-priority {
            padding: 6px 12px;
            border-radius: 20px;
            font-size: 0.75rem;
            font-weight: 700;
            text-transform: uppercase;
        }

        .agent-priority.critical { background: rgba(239, 68, 68, 0.15); color: #ef4444; }
        .agent-priority.high { background: rgba(249, 115, 22, 0.15); color: #f97316; }
        .agent-priority.medium { background: rgba(234, 179, 8, 0.15); color: #eab308; }
        .agent-priority.low { background: rgba(34, 197, 94, 0.15); color: #22c55e; }

        .agent-card-body { padding: 22px; }
        .agent-description { font-size: 0.95rem; color: var(--text-secondary); line-height: 1.6; margin-bottom: 20px; }

        .agent-flow {
            background: rgba(0,0,0,0.3);
            border: 1px solid var(--border-subtle);
            border-radius: 10px;
            padding: 18px;
            margin-bottom: 20px;
        }

        .agent-flow-title { font-size: 0.85rem; color: var(--text-muted); margin-bottom: 12px; font-weight: 600; text-transform: uppercase; letter-spacing: 0.05em; }

        .agent-flow-diagram { display: flex; align-items: center; flex-wrap: wrap; gap: 8px; justify-content: center; }

        .agent-step {
            background: linear-gradient(135deg, var(--accent-purple) 0%, var(--accent-blue) 100%);
            color: white;
            padding: 8px 14px;
            border-radius: 6px;
            font-size: 0.8rem;
            font-weight: 600;
            white-space: nowrap;
        }

        .agent-arrow { color: var(--accent-purple); font-size: 1.2rem; }

        .agent-stats { display: grid; grid-template-columns: repeat(3, 1fr); gap: 12px; }

        .agent-stat {
            background: rgba(0,0,0,0.2);
            border-radius: 8px;
            padding: 12px;
            text-align: center;
        }

        .agent-stat-value {
            font-size: 1.3rem;
            font-weight: 800;
            background: linear-gradient(135deg, var(--accent-purple) 0%, var(--accent-amber) 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .agent-stat-label { font-size: 0.7rem; color: var(--text-muted); text-transform: uppercase; letter-spacing: 0.05em; margin-top: 4px; }

        /* View Prompt Button */
        .agent-prompt-btn {
            width: 100%;
            margin-top: 18px;
            padding: 14px 20px;
            background: linear-gradient(135deg, rgba(139, 92, 246, 0.2) 0%, rgba(59, 130, 246, 0.2) 100%);
            border: 1px solid rgba(139, 92, 246, 0.4);
            border-radius: 10px;
            color: var(--accent-purple);
            font-weight: 700;
            cursor: pointer;
            transition: all 0.2s;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
            font-size: 0.9rem;
        }

        .agent-prompt-btn:hover {
            background: linear-gradient(135deg, rgba(139, 92, 246, 0.3) 0%, rgba(59, 130, 246, 0.3) 100%);
            border-color: var(--accent-purple);
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(139, 92, 246, 0.25);
        }

        /* Summary Stats */
        .agent-summary {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin-bottom: 35px;
        }

        .agent-summary-card {
            background: var(--bg-card);
            border: 1px solid var(--border-subtle);
            border-radius: 14px;
            padding: 25px;
            text-align: center;
        }

        .agent-summary-value {
            font-size: 2.5rem;
            font-weight: 800;
            background: linear-gradient(135deg, var(--accent-purple) 0%, var(--accent-amber) 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .agent-summary-label { font-size: 0.9rem; color: var(--text-muted); margin-top: 8px; }

        /* Heat Map Legend */
        .heat-legend {
            display: flex;
            gap: 25px;
            padding: 18px 22px;
            background: var(--bg-card);
            border: 1px solid var(--border-subtle);
            border-radius: 12px;
            margin-bottom: 25px;
            flex-wrap: wrap;
        }

        .heat-legend-item { display: flex; align-items: center; gap: 10px; font-size: 0.9rem; color: var(--text-secondary); }
        .heat-legend-color { width: 24px; height: 24px; border-radius: 6px; }

        /* Modal */
        .modal-overlay {
            display: none;
            position: fixed;
            top: 0; left: 0; right: 0; bottom: 0;
            background: rgba(10, 15, 26, 0.9);
            z-index: 2000;
            justify-content: center;
            align-items: center;
            padding: 20px;
            backdrop-filter: blur(5px);
        }

        .modal-overlay.show { display: flex; }

        .modal {
            background: var(--bg-card);
            border: 1px solid var(--border-subtle);
            border-radius: 16px;
            width: 100%;
            max-width: 950px;
            max-height: 90vh;
            display: flex;
            flex-direction: column;
            box-shadow: 0 25px 80px rgba(0,0,0,0.5);
        }

        .modal-header {
            background: linear-gradient(135deg, var(--accent-blue) 0%, var(--accent-teal) 100%);
            color: white;
            padding: 22px 28px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            border-radius: 16px 16px 0 0;
        }

        .modal-header h3 { font-size: 1.25rem; font-weight: 700; }
        .modal-actions { display: flex; gap: 12px; }

        .modal-btn {
            padding: 10px 18px;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-weight: 700;
            transition: transform 0.2s;
            font-size: 0.9rem;
        }

        .modal-btn:hover { transform: scale(1.05); }
        .modal-btn.copy { background: white; color: var(--accent-blue); }
        .modal-btn.close { background: rgba(255,255,255,0.2); color: white; }

        .modal-body { padding: 28px; overflow-y: auto; flex: 1; }

        .modal-body pre {
            background: rgba(0,0,0,0.3);
            border: 1px solid var(--border-subtle);
            padding: 22px;
            border-radius: 10px;
            font-family: 'JetBrains Mono', monospace;
            font-size: 0.9rem;
            line-height: 1.7;
            white-space: pre-wrap;
            word-wrap: break-word;
            color: var(--text-secondary);
        }

        .copy-success {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: var(--accent-green);
            color: white;
            padding: 18px 35px;
            border-radius: 10px;
            font-weight: 700;
            z-index: 3000;
            display: none;
            animation: fadeInOut 2s ease;
        }

        @keyframes fadeInOut { 0%, 100% { opacity: 0; } 10%, 90% { opacity: 1; } }

        /* Prompt Modal */
        .prompt-modal .modal { max-width: 800px; }
        .prompt-modal .modal-header { background: linear-gradient(135deg, var(--accent-purple) 0%, var(--accent-blue) 100%); }

        .prompt-section { margin-bottom: 25px; }
        .prompt-section h4 { color: var(--accent-purple); font-size: 1rem; margin-bottom: 12px; display: flex; align-items: center; gap: 8px; }

        .prompt-box {
            background: rgba(0,0,0,0.4);
            border: 1px solid var(--border-subtle);
            border-radius: 10px;
            padding: 20px;
            font-family: 'JetBrains Mono', monospace;
            font-size: 0.85rem;
            line-height: 1.7;
            color: var(--text-secondary);
            white-space: pre-wrap;
            word-wrap: break-word;
        }

        .prompt-tags { display: flex; gap: 10px; flex-wrap: wrap; margin-bottom: 20px; }
        .prompt-tag { background: rgba(139, 92, 246, 0.15); color: var(--accent-purple); padding: 6px 14px; border-radius: 20px; font-size: 0.8rem; font-weight: 600; }

        .copy-prompt-btn {
            background: linear-gradient(135deg, var(--accent-purple) 0%, var(--accent-blue) 100%);
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 8px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.2s;
            margin-top: 15px;
        }

        .copy-prompt-btn:hover { transform: scale(1.05); box-shadow: 0 5px 20px rgba(139, 92, 246, 0.3); }

        @media (max-width: 900px) {
            .sidebar { display: none; }
            .main-content { margin-left: 0; padding: 75px 20px 30px 20px; }
            .agent-grid { grid-template-columns: 1fr; }
        }
        .breadcrumb-logo-link { display: inline-flex; align-items: center; padding: 4px 8px; background: rgba(255,255,255,0.08); border-radius: 8px; border: 1px solid rgba(255,255,255,0.12); transition: all 0.2s; flex-shrink: 0; margin-right: 4px; }
        .breadcrumb-logo-link:hover { background: rgba(255,255,255,0.15); }
        .breadcrumb-logo { height: 24px; width: auto; display: block; }
    </style>
</head>
<body>
    <!-- Breadcrumb -->
    <nav class="breadcrumb">
<a href="../../index.html" class="breadcrumb-logo-link"><img src="../../images/clear-ai-logo.png" alt="Clear AI" class="breadcrumb-logo"></a>
        <a href="../../index.html">Home</a>
        <span class="separator">></span>
        <a href="./index.html">Mortgage Fundamentals</a>
        <span class="separator">></span>
        <span class="current">ROV Borrower Form Retail & Wholesale</span>
    </nav>

    <!-- Fixed Sidebar -->
    <aside class="sidebar">
        <div class="sidebar-header">
            <h2>ROV Borrower Form</h2>
            <p>Reconsideration of Value Process</p>
        </div>

        <!-- Tab Switcher -->
        <div class="sidebar-tabs">
            <button class="sidebar-tab active" onclick="switchTab('workflow')">Workflow</button>
            <button class="sidebar-tab agent-tab" onclick="switchTab('agents')">AI Agents</button>
        </div>

        <!-- Workflow Navigation -->
        <nav class="sidebar-nav" id="workflow-nav">
            <a href="#section-1" class="nav-item active">
                <span class="nav-number">1</span>
                <span class="nav-label">ROV Overview</span>
            </a>
            <a href="#section-2" class="nav-item">
                <span class="nav-number">2</span>
                <span class="nav-label">Borrower Information</span>
            </a>
            <a href="#section-3" class="nav-item">
                <span class="nav-number">3</span>
                <span class="nav-label">Purpose Selection</span>
            </a>
            <a href="#section-4" class="nav-item">
                <span class="nav-number">4</span>
                <span class="nav-label">Comparable Requirements</span>
            </a>
            <a href="#section-5" class="nav-item">
                <span class="nav-number">5</span>
                <span class="nav-label">Proposed Comparables</span>
            </a>
            <a href="#section-6" class="nav-item">
                <span class="nav-number">6</span>
                <span class="nav-label">Submission Process</span>
            </a>
            <a href="#quick-ref" class="nav-item">
                <span class="nav-number">*</span>
                <span class="nav-label">Quick Reference</span>
            </a>
        </nav>

        <!-- Agent Navigation -->
        <nav class="sidebar-nav" id="agents-nav" style="display: none;">
            <a href="#agent-summary" class="nav-item active">
                <span class="nav-number">S</span>
                <span class="nav-label">Summary</span>
            </a>
            <a href="#agent-heatmap" class="nav-item">
                <span class="nav-number">H</span>
                <span class="nav-label">Heat Map</span>
            </a>
            <a href="#agent-details" class="nav-item">
                <span class="nav-number">A</span>
                <span class="nav-label">Agent Details</span>
            </a>
        </nav>

        <div class="sidebar-footer">
            <button class="doc-btn" onclick="openDocModal()">
                View Workflow Markdown
            </button>
        </div>
    </aside>

    <!-- Main Content -->
    <main class="main-content">

        <!-- ==================== WORKFLOW TAB ==================== -->
        <div id="workflow-panel" class="tab-panel active">
            <!-- Header -->
            <div class="header">
                <h1>Reconsideration of Value (ROV) Borrower Form</h1>
                <p class="subtitle">Complete guide for submitting ROV requests for Retail and Wholesale channels when additional market information or factual corrections exist</p>
                <div class="meta">
                    <span class="meta-item">Channel: Retail & Wholesale</span>
                    <span class="meta-item">Role: Loan Officer / Borrower</span>
                    <span class="meta-item">Limit: One ROV per Appraisal</span>
                    <span class="meta-item">Comparables: Up to 5 total</span>
                </div>
            </div>

            <!-- Legend -->
            <div class="legend">
                <div class="legend-item"><div class="legend-color" style="background: linear-gradient(135deg, #22c55e, #16a34a);"></div><span>Start/End</span></div>
                <div class="legend-item"><div class="legend-color" style="background: linear-gradient(135deg, #3b82f6, #2563eb);"></div><span>Action Step</span></div>
                <div class="legend-item"><div class="legend-color" style="background: linear-gradient(135deg, #f59e0b, #d97706);"></div><span>Decision Point</span></div>
                <div class="legend-item"><div class="legend-color" style="background: #111827; border: 2px solid #3b82f6;"></div><span>User Input</span></div>
                <div class="legend-item"><div class="legend-color" style="background: linear-gradient(135deg, #f43f5e, #dc2626);"></div><span>Exception</span></div>
                <div class="legend-item"><div class="legend-color" style="background: linear-gradient(135deg, #14b8a6, #0d9488);"></div><span>Output</span></div>
            </div>

            <!-- Section 1: ROV Overview -->
            <section id="section-1" class="section">
                <div class="section-header">
                    <div class="section-number">1</div>
                    <div class="section-title"><h2>ROV Overview</h2><span>Understanding when and why to submit a Reconsideration of Value request</span></div>
                </div>
                <div class="section-content">
                    <div class="workflow-diagram">
                        <div class="flow-row">
                            <div class="flow-node start">Appraisal Received</div>
                            <span class="flow-arrow">-></span>
                            <div class="flow-node decision">Value Concern?</div>
                        </div>
                        <div class="decision-branch">
                            <div class="branch">
                                <span class="branch-label">YES</span>
                                <div class="flow-node action">Gather Additional Data</div>
                            </div>
                            <div class="branch">
                                <span class="branch-label">NO</span>
                                <div class="flow-node output">Proceed with Loan</div>
                            </div>
                        </div>
                    </div>
                    <div class="info-box">
                        <h4>What is a Reconsideration of Value (ROV)?</h4>
                        <p>A Reconsideration Request may be submitted when additional market information exists or additional facts about the subject's physical condition exist that were not considered and/or included in the original appraisal. The completion of a Reconsideration request <strong>may or may not</strong> result in a change to the report or the value opinion.</p>
                    </div>
                    <div class="exception-box">
                        <h4>Important Limitation</h4>
                        <p><strong>One ROV can be submitted per Appraisal.</strong> Make sure to gather all relevant information before submitting your request, as you will not have another opportunity.</p>
                    </div>
                    <div class="tip-box">
                        <h4>Need Assistance?</h4>
                        <p>If you need assistance completing the form, you can reach out to your <strong>Loan Officer</strong> or <strong>Account Manager</strong> for guidance.</p>
                    </div>
                </div>
            </section>

            <!-- Section 2: Borrower Information -->
            <section id="section-2" class="section">
                <div class="section-header">
                    <div class="section-number">2</div>
                    <div class="section-title"><h2>Borrower Information</h2><span>Complete the header section with loan and property details</span></div>
                </div>
                <div class="section-content">
                    <div class="workflow-diagram">
                        <div class="flow-row">
                            <div class="flow-node action">Obtain ROV Form</div>
                            <span class="flow-arrow">-></span>
                            <div class="flow-node input">Enter Borrower Info</div>
                            <span class="flow-arrow">-></span>
                            <div class="flow-node input">Enter Property Details</div>
                            <span class="flow-arrow">-></span>
                            <div class="flow-node input">Enter Dates</div>
                        </div>
                    </div>
                    <table class="field-table">
                        <thead>
                            <tr>
                                <th>Field</th>
                                <th>Description</th>
                                <th>Status</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td><strong>Borrower's Full Name</strong></td>
                                <td>Complete legal name of the borrower</td>
                                <td><span class="badge required-badge">Required</span></td>
                            </tr>
                            <tr>
                                <td><strong>Loan Number</strong></td>
                                <td>CMG loan number assigned to the file</td>
                                <td><span class="badge required-badge">Required</span></td>
                            </tr>
                            <tr>
                                <td><strong>Subject Property</strong></td>
                                <td>Full address of the property being appraised</td>
                                <td><span class="badge required-badge">Required</span></td>
                            </tr>
                            <tr>
                                <td><strong>Appraisal Effective Date</strong></td>
                                <td>The effective date shown on the original appraisal report</td>
                                <td><span class="badge required-badge">Required</span></td>
                            </tr>
                            <tr>
                                <td><strong>Submission Date</strong></td>
                                <td>Date the ROV form is being submitted</td>
                                <td><span class="badge required-badge">Required</span></td>
                            </tr>
                            <tr>
                                <td><strong>Requested By</strong></td>
                                <td>Pre-filled as "Borrower ROV"</td>
                                <td><span class="badge calculated-badge">Pre-Filled</span></td>
                            </tr>
                            <tr>
                                <td><strong>Date</strong></td>
                                <td>Date of the ROV request</td>
                                <td><span class="badge required-badge">Required</span></td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </section>

            <!-- Section 3: Purpose Selection -->
            <section id="section-3" class="section">
                <div class="section-header">
                    <div class="section-number">3</div>
                    <div class="section-title"><h2>Purpose for Reconsideration</h2><span>Select the applicable reason(s) for the ROV request</span></div>
                </div>
                <div class="section-content">
                    <div class="workflow-diagram">
                        <div class="flow-row">
                            <div class="flow-node decision">Select Purpose</div>
                        </div>
                        <div class="decision-branch">
                            <div class="branch">
                                <span class="branch-label">Option A</span>
                                <div class="flow-node action">Additional Comparables</div>
                            </div>
                            <div class="branch">
                                <span class="branch-label">Option B</span>
                                <div class="flow-node action">Factual Errors</div>
                            </div>
                            <div class="branch">
                                <span class="branch-label">Option C</span>
                                <div class="flow-node exception">Bias/Discrimination</div>
                            </div>
                        </div>
                    </div>

                    <div class="decision-tree">
                        <h3>Purpose Options (Check Applicable Box)</h3>
                        <ul class="step-list">
                            <li><strong>Option A:</strong> Review additional sold comparables which sold <strong>prior to the effective date</strong> of the Appraisal Report</li>
                            <li><strong>Option B:</strong> Correct and/or explain any factual errors <em>(comment required below)</em></li>
                            <li><strong>Option C:</strong> Appraisal may have been influenced by Bias or Discrimination <em>(comment required below)</em></li>
                        </ul>
                    </div>

                    <div class="info-box">
                        <h4>Multiple Purposes</h4>
                        <p>You may select more than one purpose if applicable. For example, you might want to submit additional comparables AND correct factual errors in the same ROV request.</p>
                    </div>

                    <div class="exception-box">
                        <h4>Bias or Discrimination Concerns</h4>
                        <p>If you believe the appraisal may have been influenced by bias or discrimination, select Option C and provide detailed comments explaining your concerns. These requests receive priority review.</p>
                    </div>
                </div>
            </section>

            <!-- Section 4: Comparable Requirements -->
            <section id="section-4" class="section">
                <div class="section-header">
                    <div class="section-number">4</div>
                    <div class="section-title"><h2>Acceptable Comparable Requirements</h2><span>Guidelines for selecting appropriate comparable sales</span></div>
                </div>
                <div class="section-content">
                    <div class="summary-grid">
                        <div class="summary-card">
                            <h4>Sale Timeframe</h4>
                            <div class="value">12</div>
                            <div class="label">Months Max Prior to Effective Date</div>
                        </div>
                        <div class="summary-card">
                            <h4>Recommended Comps</h4>
                            <div class="value">3-5</div>
                            <div class="label">Additional Comparables</div>
                        </div>
                        <div class="summary-card">
                            <h4>Per Appraisal</h4>
                            <div class="value">1</div>
                            <div class="label">ROV Allowed</div>
                        </div>
                    </div>

                    <div class="decision-tree">
                        <h3>Comparable Selection Criteria</h3>
                        <ul class="step-list">
                            <li><strong>Timing:</strong> Comparables must be a closed sale no more than <strong>12 months prior</strong> to the effective date of the Appraisal and <strong>cannot be after</strong> the effective date</li>
                            <li><strong>Characteristics:</strong> Comparable sales should have similar characteristics including GLA, room/bedroom/bathroom count, age, condition, quality of construction, and style - but do not have to be identical</li>
                            <li><strong>Proximity:</strong> The comparable sale should be proximate to your home. While proximity may vary based on the rural or urban location of your home, keep in mind that the closer (and more similar in characteristics) the comparable, the more likely it will be considered appropriate and acceptable</li>
                            <li><strong>Subdivision/PUD Sales:</strong> If you live in a subdivision, condominium project, or PUD, recent sales in your development of similar homes are the most persuasive</li>
                        </ul>
                    </div>

                    <div class="tip-box">
                        <h4>Recommendation</h4>
                        <p>Provide <strong>3 additional comparables up to a total of 5</strong> to give the appraiser sufficient data for reconsideration. Quality over quantity - choose comparables that best match your property's characteristics.</p>
                    </div>

                    <table class="field-table">
                        <thead>
                            <tr>
                                <th>Characteristic</th>
                                <th>Description</th>
                                <th>Weight</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td><strong>GLA (Gross Living Area)</strong></td>
                                <td>Similar square footage to subject property</td>
                                <td><span class="badge required-badge">High</span></td>
                            </tr>
                            <tr>
                                <td><strong>Bedroom/Bathroom Count</strong></td>
                                <td>Similar room configuration</td>
                                <td><span class="badge required-badge">High</span></td>
                            </tr>
                            <tr>
                                <td><strong>Age</strong></td>
                                <td>Year built within reasonable range</td>
                                <td><span class="badge calculated-badge">Medium</span></td>
                            </tr>
                            <tr>
                                <td><strong>Condition</strong></td>
                                <td>Similar physical condition and updates</td>
                                <td><span class="badge required-badge">High</span></td>
                            </tr>
                            <tr>
                                <td><strong>Quality of Construction</strong></td>
                                <td>Similar build quality and materials</td>
                                <td><span class="badge calculated-badge">Medium</span></td>
                            </tr>
                            <tr>
                                <td><strong>Style</strong></td>
                                <td>Similar architectural style (ranch, colonial, etc.)</td>
                                <td><span class="badge optional-badge">Low</span></td>
                            </tr>
                            <tr>
                                <td><strong>Proximity</strong></td>
                                <td>Distance from subject property - closer is better</td>
                                <td><span class="badge required-badge">High</span></td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </section>

            <!-- Section 5: Proposed Comparables -->
            <section id="section-5" class="section">
                <div class="section-header">
                    <div class="section-number">5</div>
                    <div class="section-title"><h2>Proposed Comparable Sales</h2><span>Enter details for each comparable sale being submitted</span></div>
                </div>
                <div class="section-content">
                    <div class="workflow-diagram">
                        <div class="flow-row">
                            <div class="flow-node action">Research Comparables</div>
                            <span class="flow-arrow">-></span>
                            <div class="flow-node input">Enter Comp 1 Details</div>
                            <span class="flow-arrow">-></span>
                            <div class="flow-node decision">More Comps?</div>
                        </div>
                        <div class="decision-branch">
                            <div class="branch">
                                <span class="branch-label">YES</span>
                                <div class="flow-node input">Enter Additional Comps</div>
                            </div>
                            <div class="branch">
                                <span class="branch-label">NO (Max 5)</span>
                                <div class="flow-node output">Review & Submit</div>
                            </div>
                        </div>
                    </div>

                    <table class="field-table">
                        <thead>
                            <tr>
                                <th>Field</th>
                                <th>Description</th>
                                <th>Status</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td><strong>Property Address</strong></td>
                                <td>Full address of the comparable property</td>
                                <td><span class="badge required-badge">Required</span></td>
                            </tr>
                            <tr>
                                <td><strong>MLS Listing</strong></td>
                                <td>MLS listing number for the comparable</td>
                                <td><span class="badge required-badge">Required</span></td>
                            </tr>
                            <tr>
                                <td><strong>Proximity to Subject</strong></td>
                                <td>Distance from the subject property (e.g., 0.5 miles)</td>
                                <td><span class="badge required-badge">Required</span></td>
                            </tr>
                            <tr>
                                <td><strong>Beds</strong></td>
                                <td>Number of bedrooms</td>
                                <td><span class="badge required-badge">Required</span></td>
                            </tr>
                            <tr>
                                <td><strong>Bath</strong></td>
                                <td>Number of bathrooms</td>
                                <td><span class="badge required-badge">Required</span></td>
                            </tr>
                            <tr>
                                <td><strong>Site Size</strong></td>
                                <td>Lot size in square feet or acres</td>
                                <td><span class="badge required-badge">Required</span></td>
                            </tr>
                            <tr>
                                <td><strong>GLA</strong></td>
                                <td>Gross Living Area in square feet</td>
                                <td><span class="badge required-badge">Required</span></td>
                            </tr>
                            <tr>
                                <td><strong>Basement</strong></td>
                                <td>Basement type/size (finished SF, unfinished, none)</td>
                                <td><span class="badge required-badge">Required</span></td>
                            </tr>
                            <tr>
                                <td><strong>Value</strong></td>
                                <td>Sale price of the comparable</td>
                                <td><span class="badge required-badge">Required</span></td>
                            </tr>
                            <tr>
                                <td><strong>Close Date</strong></td>
                                <td>Date the sale closed (must be before appraisal effective date)</td>
                                <td><span class="badge required-badge">Required</span></td>
                            </tr>
                            <tr>
                                <td><strong>Comments</strong></td>
                                <td>Explanation of why this comparable supports the ROV request</td>
                                <td><span class="badge optional-badge">Recommended</span></td>
                            </tr>
                        </tbody>
                    </table>

                    <div class="info-box">
                        <h4>Multiple Comparable Entries</h4>
                        <p>The form provides space for up to 5 comparable sales. Each comparable has its own entry section with all required fields plus a comments area to explain why this sale is relevant.</p>
                    </div>

                    <div class="tip-box">
                        <h4>Comments Best Practice</h4>
                        <p>Use the comments section for each comparable to highlight key similarities to your property, explain any adjustments needed, or note why this sale better represents market value than the appraiser's original comparables.</p>
                    </div>
                </div>
            </section>

            <!-- Section 6: Submission Process -->
            <section id="section-6" class="section">
                <div class="section-header">
                    <div class="section-number">6</div>
                    <div class="section-title"><h2>Submission Process</h2><span>Complete and submit the ROV form for review</span></div>
                </div>
                <div class="section-content">
                    <div class="workflow-diagram">
                        <div class="flow-row">
                            <div class="flow-node action">Complete Form</div>
                            <span class="flow-arrow">-></span>
                            <div class="flow-node action">Review All Entries</div>
                            <span class="flow-arrow">-></span>
                            <div class="flow-node action">Submit to Processing</div>
                            <span class="flow-arrow">-></span>
                            <div class="flow-node output">Routed for Review</div>
                        </div>
                    </div>
                    <ul class="step-list">
                        <li><strong>Step 1:</strong> Complete all required fields in the header section (Borrower Name, Loan Number, Property Address, Dates)</li>
                        <li><strong>Step 2:</strong> Select the appropriate purpose(s) for the ROV request</li>
                        <li><strong>Step 3:</strong> Enter details for each proposed comparable sale (up to 5)</li>
                        <li><strong>Step 4:</strong> Add comments explaining factual errors or bias concerns if applicable</li>
                        <li><strong>Step 5:</strong> Review all entries for accuracy and completeness</li>
                        <li><strong>Step 6:</strong> Submit the completed form to your processing point of contact</li>
                        <li><strong>Step 7:</strong> Processing will route the request for appraiser review</li>
                    </ul>

                    <div class="info-box">
                        <h4>What Happens Next</h4>
                        <p>Once submitted, your processing point of contact will route the ROV request for review. The appraiser will evaluate the additional comparables and/or address the factual corrections or bias concerns raised. Remember that a reconsideration <strong>may or may not</strong> result in a change to the value opinion.</p>
                    </div>

                    <div class="exception-box">
                        <h4>Reminder: One Chance</h4>
                        <p>You only get <strong>one ROV per appraisal</strong>. Make sure your submission is complete and includes all relevant comparables and documentation before submitting.</p>
                    </div>
                </div>
            </section>

            <!-- Quick Reference -->
            <div id="quick-ref" class="quick-ref">
                <h3>ROV Quick Reference</h3>
                <pre>
RECONSIDERATION OF VALUE (ROV) CHECKLIST
=========================================

HEADER INFORMATION
------------------
[ ] Borrower's Full Name
[ ] Loan Number
[ ] Subject Property Address
[ ] Appraisal Effective Date
[ ] Submission Date
[ ] Requested By (Borrower ROV)
[ ] Date

PURPOSE SELECTION (Check Applicable)
------------------------------------
[ ] Additional sold comparables (prior to effective date)
[ ] Factual errors (comments required)
[ ] Bias/Discrimination concerns (comments required)

COMPARABLE REQUIREMENTS
-----------------------
Timing:      Closed sale within 12 months PRIOR to effective date
             Cannot be AFTER the effective date
Quantity:    Recommend 3-5 additional comparables
Limit:       ONE ROV allowed per appraisal

COMPARABLE CHARACTERISTICS (Similar to Subject)
-----------------------------------------------
- GLA (Gross Living Area)      [HIGH WEIGHT]
- Bedroom/Bathroom Count       [HIGH WEIGHT]
- Condition                    [HIGH WEIGHT]
- Proximity                    [HIGH WEIGHT]
- Age                          [MEDIUM WEIGHT]
- Quality of Construction      [MEDIUM WEIGHT]
- Style                        [LOW WEIGHT]

COMPARABLE ENTRY FIELDS (Per Comp)
----------------------------------
[ ] Property Address
[ ] MLS Listing Number
[ ] Proximity to Subject
[ ] Beds / Bath
[ ] Site Size
[ ] GLA (Gross Living Area)
[ ] Basement
[ ] Value (Sale Price)
[ ] Close Date
[ ] Comments (recommended)

SUBMISSION PROCESS
------------------
1. Complete form with all required fields
2. Submit to processing point of contact
3. Processing routes for appraiser review
4. Await reconsideration decision

NOTES
-----
- One ROV per appraisal - make it count!
- May or may not result in value change
- Contact LO or Account Manager for assistance
                </pre>
            </div>
        </div>

        <!-- ==================== AI AGENTS TAB ==================== -->
        <div id="agents-panel" class="tab-panel">
            <!-- Agent Header -->
            <div class="agent-header">
                <h1>AI Agent Opportunities</h1>
                <p class="subtitle">Automation opportunities identified for the ROV Borrower Form process</p>
            </div>

            <!-- Summary Stats -->
            <div class="agent-summary" id="agent-summary">
                <div class="agent-summary-card">
                    <div class="agent-summary-value">4</div>
                    <div class="agent-summary-label">Agent Opportunities</div>
                </div>
                <div class="agent-summary-card">
                    <div class="agent-summary-value">65%</div>
                    <div class="agent-summary-label">Automation Potential</div>
                </div>
                <div class="agent-summary-card">
                    <div class="agent-summary-value">15 min</div>
                    <div class="agent-summary-label">Est. Time Saved</div>
                </div>
                <div class="agent-summary-card">
                    <div class="agent-summary-value">High</div>
                    <div class="agent-summary-label">Accuracy Impact</div>
                </div>
            </div>

            <!-- Heat Map Legend -->
            <div class="heat-legend">
                <div class="heat-legend-item">
                    <div class="heat-legend-color" style="background: linear-gradient(90deg, #ef4444, #f97316);"></div>
                    <span>Critical Priority (9-10)</span>
                </div>
                <div class="heat-legend-item">
                    <div class="heat-legend-color" style="background: linear-gradient(90deg, #f97316, #eab308);"></div>
                    <span>High Priority (7-8)</span>
                </div>
                <div class="heat-legend-item">
                    <div class="heat-legend-color" style="background: linear-gradient(90deg, #eab308, #22c55e);"></div>
                    <span>Medium Priority (5-6)</span>
                </div>
                <div class="heat-legend-item">
                    <div class="heat-legend-color" style="background: linear-gradient(90deg, #22c55e, #14b8a6);"></div>
                    <span>Low Priority (1-4)</span>
                </div>
            </div>

            <!-- Heat Map Grid -->
            <div class="heat-map-container" id="agent-heatmap">
                <div class="heat-map-title">Priority Heat Map</div>
                <div class="heat-map-grid">
                    <div class="heat-item critical" onclick="scrollToAgent('agent-compsearch')">
                        <div class="heat-score">9.1</div>
                        <div class="heat-name">Comp Search Agent</div>
                        <div class="heat-desc">Auto-search MLS for qualifying comparable sales</div>
                        <div class="heat-metrics">
                            <div class="heat-metric">Time: <span>10 min</span></div>
                            <div class="heat-metric">Complexity: <span>Medium</span></div>
                        </div>
                    </div>
                    <div class="heat-item high" onclick="scrollToAgent('agent-validation')">
                        <div class="heat-score">8.3</div>
                        <div class="heat-name">Form Validator</div>
                        <div class="heat-desc">Validate comparable dates and requirements</div>
                        <div class="heat-metrics">
                            <div class="heat-metric">Time: <span>2 min</span></div>
                            <div class="heat-metric">Complexity: <span>Low</span></div>
                        </div>
                    </div>
                    <div class="heat-item high" onclick="scrollToAgent('agent-autofill')">
                        <div class="heat-score">7.8</div>
                        <div class="heat-name">Auto-Fill Agent</div>
                        <div class="heat-desc">Pre-populate form from loan data</div>
                        <div class="heat-metrics">
                            <div class="heat-metric">Time: <span>2 min</span></div>
                            <div class="heat-metric">Complexity: <span>Low</span></div>
                        </div>
                    </div>
                    <div class="heat-item medium" onclick="scrollToAgent('agent-biasdetect')">
                        <div class="heat-score">6.5</div>
                        <div class="heat-name">Bias Detection</div>
                        <div class="heat-desc">Flag potential appraisal bias indicators</div>
                        <div class="heat-metrics">
                            <div class="heat-metric">Time: <span>N/A</span></div>
                            <div class="heat-metric">Complexity: <span>High</span></div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Agent Details -->
            <div id="agent-details">
                <h2 style="color: var(--text-primary); margin-bottom: 25px; font-size: 1.5rem;">Agent Details</h2>
                <div class="agent-grid">
                    <!-- Comp Search Agent -->
                    <div class="agent-card" id="agent-compsearch">
                        <div class="agent-card-header">
                            <div class="agent-icon">C</div>
                            <div class="agent-info">
                                <div class="agent-name">Comp Search Agent</div>
                                <div class="agent-type">MLS Integration / Data Mining</div>
                            </div>
                            <span class="agent-priority critical">Critical</span>
                        </div>
                        <div class="agent-card-body">
                            <p class="agent-description">Automatically searches MLS databases for comparable sales that meet ROV criteria: closed within 12 months, similar characteristics (GLA, beds, baths, age, condition), and proximate to subject property. Ranks results by similarity score.</p>
                            <div class="agent-flow">
                                <div class="agent-flow-title">Agent Flow</div>
                                <div class="agent-flow-diagram">
                                    <span class="agent-step">Subject Data</span>
                                    <span class="agent-arrow">-></span>
                                    <span class="agent-step">MLS Query</span>
                                    <span class="agent-arrow">-></span>
                                    <span class="agent-step">Filter & Score</span>
                                    <span class="agent-arrow">-></span>
                                    <span class="agent-step">Rank Comps</span>
                                </div>
                            </div>
                            <div class="agent-stats">
                                <div class="agent-stat">
                                    <div class="agent-stat-value">10 min</div>
                                    <div class="agent-stat-label">Time Saved</div>
                                </div>
                                <div class="agent-stat">
                                    <div class="agent-stat-value">92%</div>
                                    <div class="agent-stat-label">Accuracy</div>
                                </div>
                                <div class="agent-stat">
                                    <div class="agent-stat-value">Med</div>
                                    <div class="agent-stat-label">Complexity</div>
                                </div>
                            </div>
                            <button class="agent-prompt-btn" onclick="showAgentPrompt('compsearch')">
                                View Build Prompt
                            </button>
                        </div>
                    </div>

                    <!-- Form Validator Agent -->
                    <div class="agent-card" id="agent-validation">
                        <div class="agent-card-header">
                            <div class="agent-icon">V</div>
                            <div class="agent-info">
                                <div class="agent-name">Form Validator</div>
                                <div class="agent-type">Data Validation / Rules Engine</div>
                            </div>
                            <span class="agent-priority high">High</span>
                        </div>
                        <div class="agent-card-body">
                            <p class="agent-description">Validates ROV form entries against requirements: ensures close dates are within 12 months and before appraisal effective date, verifies all required fields are complete, and flags comparables that may not meet similarity criteria.</p>
                            <div class="agent-flow">
                                <div class="agent-flow-title">Agent Flow</div>
                                <div class="agent-flow-diagram">
                                    <span class="agent-step">Form Input</span>
                                    <span class="agent-arrow">-></span>
                                    <span class="agent-step">Date Check</span>
                                    <span class="agent-arrow">-></span>
                                    <span class="agent-step">Field Validate</span>
                                    <span class="agent-arrow">-></span>
                                    <span class="agent-step">Flag Issues</span>
                                </div>
                            </div>
                            <div class="agent-stats">
                                <div class="agent-stat">
                                    <div class="agent-stat-value">2 min</div>
                                    <div class="agent-stat-label">Time Saved</div>
                                </div>
                                <div class="agent-stat">
                                    <div class="agent-stat-value">99%</div>
                                    <div class="agent-stat-label">Accuracy</div>
                                </div>
                                <div class="agent-stat">
                                    <div class="agent-stat-value">Low</div>
                                    <div class="agent-stat-label">Complexity</div>
                                </div>
                            </div>
                            <button class="agent-prompt-btn" onclick="showAgentPrompt('validation')">
                                View Build Prompt
                            </button>
                        </div>
                    </div>

                    <!-- Auto-Fill Agent -->
                    <div class="agent-card" id="agent-autofill">
                        <div class="agent-card-header">
                            <div class="agent-icon">A</div>
                            <div class="agent-info">
                                <div class="agent-name">Auto-Fill Agent</div>
                                <div class="agent-type">Data Integration / Form Pre-fill</div>
                            </div>
                            <span class="agent-priority high">High</span>
                        </div>
                        <div class="agent-card-body">
                            <p class="agent-description">Automatically pre-populates ROV form header fields from the loan file (borrower name, loan number, property address) and extracts appraisal effective date from the original appraisal report to ensure accuracy.</p>
                            <div class="agent-flow">
                                <div class="agent-flow-title">Agent Flow</div>
                                <div class="agent-flow-diagram">
                                    <span class="agent-step">Loan File</span>
                                    <span class="agent-arrow">-></span>
                                    <span class="agent-step">Extract Data</span>
                                    <span class="agent-arrow">-></span>
                                    <span class="agent-step">Map Fields</span>
                                    <span class="agent-arrow">-></span>
                                    <span class="agent-step">Pre-Fill</span>
                                </div>
                            </div>
                            <div class="agent-stats">
                                <div class="agent-stat">
                                    <div class="agent-stat-value">2 min</div>
                                    <div class="agent-stat-label">Time Saved</div>
                                </div>
                                <div class="agent-stat">
                                    <div class="agent-stat-value">99%</div>
                                    <div class="agent-stat-label">Accuracy</div>
                                </div>
                                <div class="agent-stat">
                                    <div class="agent-stat-value">Low</div>
                                    <div class="agent-stat-label">Complexity</div>
                                </div>
                            </div>
                            <button class="agent-prompt-btn" onclick="showAgentPrompt('autofill')">
                                View Build Prompt
                            </button>
                        </div>
                    </div>

                    <!-- Bias Detection Agent -->
                    <div class="agent-card" id="agent-biasdetect">
                        <div class="agent-card-header">
                            <div class="agent-icon">B</div>
                            <div class="agent-info">
                                <div class="agent-name">Bias Detection Agent</div>
                                <div class="agent-type">AI Analysis / Pattern Recognition</div>
                            </div>
                            <span class="agent-priority medium">Medium</span>
                        </div>
                        <div class="agent-card-body">
                            <p class="agent-description">Analyzes appraisal reports for potential bias indicators by comparing value trends, comparable selection patterns, and adjustments against historical data and demographic factors to flag potential fair housing concerns.</p>
                            <div class="agent-flow">
                                <div class="agent-flow-title">Agent Flow</div>
                                <div class="agent-flow-diagram">
                                    <span class="agent-step">Appraisal Data</span>
                                    <span class="agent-arrow">-></span>
                                    <span class="agent-step">Pattern Analysis</span>
                                    <span class="agent-arrow">-></span>
                                    <span class="agent-step">Compare Trends</span>
                                    <span class="agent-arrow">-></span>
                                    <span class="agent-step">Flag Concerns</span>
                                </div>
                            </div>
                            <div class="agent-stats">
                                <div class="agent-stat">
                                    <div class="agent-stat-value">N/A</div>
                                    <div class="agent-stat-label">Time Saved</div>
                                </div>
                                <div class="agent-stat">
                                    <div class="agent-stat-value">85%</div>
                                    <div class="agent-stat-label">Accuracy</div>
                                </div>
                                <div class="agent-stat">
                                    <div class="agent-stat-value">High</div>
                                    <div class="agent-stat-label">Complexity</div>
                                </div>
                            </div>
                            <button class="agent-prompt-btn" onclick="showAgentPrompt('biasdetect')">
                                View Build Prompt
                            </button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </main>

    <!-- Documentation Modal -->
    <div class="modal-overlay" id="docModal">
        <div class="modal">
            <div class="modal-header">
                <h3>ROV Borrower Form Documentation</h3>
                <div class="modal-actions">
                    <button class="modal-btn copy" onclick="copyToClipboard()">Copy</button>
                    <button class="modal-btn close" onclick="closeDocModal()">Close</button>
                </div>
            </div>
            <div class="modal-body">
                <pre id="docContent"># Reconsideration of Value (ROV) Borrower Form - Retail & Wholesale

## Overview
A Reconsideration Request may be submitted when additional market information exists or additional facts about the subject's physical condition exist that were not considered in the original appraisal. One ROV can be submitted per Appraisal.

## Purpose Options
1. Review additional sold comparables (prior to effective date)
2. Correct and/or explain factual errors
3. Address potential bias or discrimination concerns

## Acceptable Comparables
- Closed sale no more than 12 months prior to appraisal effective date
- Cannot be after the effective date
- Similar characteristics: GLA, beds/baths, age, condition, quality, style
- Proximate to subject property
- Recommend 3-5 additional comparables

## Comparable Entry Fields
- Property Address
- MLS Listing Number
- Proximity to Subject
- Beds / Bath
- Site Size
- GLA (Gross Living Area)
- Basement
- Value (Sale Price)
- Close Date
- Comments

## Submission Process
1. Complete all header fields
2. Select purpose(s) for ROV
3. Enter comparable details (up to 5)
4. Add comments as needed
5. Submit to processing point of contact
6. Processing routes for appraiser review

## Notes
- One ROV per appraisal - make it count
- May or may not result in value change
- Contact LO or Account Manager for assistance</pre>
            </div>
        </div>
    </div>

    <!-- AI Prompt Modal -->
    <div class="modal-overlay prompt-modal" id="promptModal">
        <div class="modal">
            <div class="modal-header">
                <h3 id="promptModalTitle">AI Agent Build Prompt</h3>
                <div class="modal-actions">
                    <button class="modal-btn copy" onclick="copyPromptToClipboard()">Copy Prompt</button>
                    <button class="modal-btn close" onclick="closePromptModal()">Close</button>
                </div>
            </div>
            <div class="modal-body">
                <div class="prompt-tags" id="promptTags"></div>
                <div class="prompt-section">
                    <h4>Agent Purpose</h4>
                    <div class="prompt-box" id="promptPurpose"></div>
                </div>
                <div class="prompt-section">
                    <h4>Full Build Prompt</h4>
                    <div class="prompt-box" id="promptContent"></div>
                </div>
                <div class="prompt-section">
                    <h4>Integration Points</h4>
                    <div class="prompt-box" id="promptIntegration"></div>
                </div>
            </div>
        </div>
    </div>

    <div class="copy-success" id="copySuccess">Copied to clipboard!</div>

    <script>
        // Tab switching
        function switchTab(tab) {
            document.querySelectorAll('.sidebar-tab').forEach(t => t.classList.remove('active'));
            document.querySelectorAll('.tab-panel').forEach(p => p.classList.remove('active'));

            if (tab === 'workflow') {
                document.querySelector('.sidebar-tab:not(.agent-tab)').classList.add('active');
                document.getElementById('workflow-panel').classList.add('active');
                document.getElementById('workflow-nav').style.display = 'block';
                document.getElementById('agents-nav').style.display = 'none';
            } else {
                document.querySelector('.sidebar-tab.agent-tab').classList.add('active');
                document.getElementById('agents-panel').classList.add('active');
                document.getElementById('workflow-nav').style.display = 'none';
                document.getElementById('agents-nav').style.display = 'block';
            }

            window.scrollTo(0, 0);
        }

        // Scroll spy with isScrolling flag and 1000ms timeout
        const sections = document.querySelectorAll('.section, .quick-ref');
        const navItems = document.querySelectorAll('#workflow-nav .nav-item');
        let isScrolling = false;
        let scrollTimeout;

        function updateActiveNav() {
            if (isScrolling) return;

            let current = '';
            sections.forEach(section => {
                const sectionTop = section.offsetTop - 100;
                if (window.scrollY >= sectionTop) current = section.getAttribute('id');
            });
            navItems.forEach(item => {
                item.classList.remove('active');
                if (item.getAttribute('href') === '#' + current) item.classList.add('active');
            });
        }

        // Handle nav click to temporarily disable scroll spy
        navItems.forEach(item => {
            item.addEventListener('click', function(e) {
                isScrolling = true;
                clearTimeout(scrollTimeout);

                // Remove active from all, add to clicked
                navItems.forEach(nav => nav.classList.remove('active'));
                this.classList.add('active');

                // Re-enable scroll spy after 1000ms
                scrollTimeout = setTimeout(() => {
                    isScrolling = false;
                }, 1000);
            });
        });

        window.addEventListener('scroll', updateActiveNav);

        // Modal
        function openDocModal() {
            document.getElementById('docModal').classList.add('show');
            document.body.style.overflow = 'hidden';
        }

        function closeDocModal() {
            document.getElementById('docModal').classList.remove('show');
            document.body.style.overflow = '';
        }

        async function copyToClipboard() {
            try {
                await navigator.clipboard.writeText(document.getElementById('docContent').textContent);
                const success = document.getElementById('copySuccess');
                success.style.display = 'block';
                setTimeout(() => { success.style.display = 'none'; }, 2000);
            } catch (e) { alert('Failed to copy.'); }
        }

        document.addEventListener('keydown', (e) => { if (e.key === 'Escape') { closeDocModal(); closePromptModal(); } });
        document.getElementById('docModal').addEventListener('click', (e) => { if (e.target.id === 'docModal') closeDocModal(); });

        document.addEventListener('DOMContentLoaded', () => { updateActiveNav(); });

        // Scroll to agent card and highlight
        function scrollToAgent(agentId) {
            const agentCard = document.getElementById(agentId);
            if (agentCard) {
                document.querySelectorAll('.agent-card.highlight').forEach(card => {
                    card.classList.remove('highlight');
                });

                agentCard.scrollIntoView({ behavior: 'smooth', block: 'center' });

                setTimeout(() => {
                    agentCard.classList.add('highlight');
                }, 300);

                setTimeout(() => {
                    agentCard.classList.remove('highlight');
                }, 2500);
            }
        }

        // Agent Prompt System
        const agentPrompts = {
            compsearch: {
                name: 'Comp Search Agent',
                tags: ['MLS Integration', 'Data Mining', 'Medium Complexity', 'Critical Priority'],
                purpose: `This agent automatically searches MLS databases for comparable sales that meet ROV criteria. It filters for sales closed within 12 months prior to appraisal effective date, matches property characteristics (GLA, beds, baths, age, condition), and ranks results by similarity score to help borrowers find the best supporting comparables.`,
                prompt: `You are building an MLS Integration Agent for CMG Financial's ROV Borrower Form process.

AGENT NAME: Comp Search Agent
TYPE: MLS Integration / Data Mining

OBJECTIVE:
Automatically search MLS databases for comparable sales that meet ROV requirements and rank them by similarity to the subject property.

INPUT DATA:
- Subject Property Address
- Appraisal Effective Date
- Subject GLA (Gross Living Area)
- Subject Bed/Bath Count
- Subject Year Built
- Subject Lot Size
- Subject Style/Type

SEARCH CRITERIA:
1. Date Filter: Closed sales within 12 months PRIOR to appraisal effective date
2. Proximity: Start with 0.5 mile radius, expand to 1 mile, then 2 miles if needed
3. GLA Range: +/- 20% of subject GLA
4. Bed/Bath: Within 1 bedroom, 1 bathroom
5. Year Built: Within 10 years of subject
6. Property Type: Match subject type (SFR, Condo, Townhouse)

SIMILARITY SCORING ALGORITHM:
{
  "gla_match": 0-25 points (closer = higher),
  "proximity": 0-25 points (closer = higher),
  "beds_baths": 0-20 points (exact match = max),
  "age": 0-15 points (closer = higher),
  "condition": 0-15 points (similar = higher)
}

OUTPUT FORMAT:
{
  "comparables": [
    {
      "address": "123 Main St",
      "mls_number": "MLS12345",
      "proximity": "0.3 miles",
      "beds": 3,
      "baths": 2,
      "gla": 1850,
      "lot_size": "0.25 acres",
      "basement": "Full Finished",
      "sale_price": 425000,
      "close_date": "2025-09-15",
      "similarity_score": 87
    }
  ],
  "total_found": 15,
  "returned": 5
}`,
                integration: `INTEGRATION POINTS:
1. MLS Data Sources
   - RETS/RESO API connections
   - Realtor.com API
   - Zillow API (supplementary)
   - Local MLS board feeds

2. Loan Origination System
   - Pull subject property data
   - Extract appraisal effective date
   - Pre-fill ROV form with selected comps

3. Scoring Engine
   - Configurable weights per characteristic
   - Market-specific adjustments
   - Historical accuracy feedback loop

4. User Interface
   - Interactive comp selection
   - Side-by-side comparison view
   - One-click add to ROV form`
            },
            validation: {
                name: 'Form Validator Agent',
                tags: ['Data Validation', 'Rules Engine', 'Low Complexity', 'High Priority'],
                purpose: `This agent validates ROV form entries against CMG requirements in real-time. It ensures all close dates are within 12 months and before the appraisal effective date, verifies required fields are complete, and flags comparables that may not meet similarity criteria before submission.`,
                prompt: `You are building a Validation Agent for CMG Financial's ROV Borrower Form process.

AGENT NAME: Form Validator Agent
TYPE: Data Validation / Rules Engine

OBJECTIVE:
Validate all ROV form entries against requirements before submission to prevent rejections and ensure compliance.

VALIDATION RULES:

1. DATE VALIDATION:
   - Close Date must be <= Appraisal Effective Date
   - Close Date must be >= (Appraisal Effective Date - 12 months)
   - Submission Date should be current or within 30 days

2. REQUIRED FIELD CHECK:
   Header Section:
   - Borrower Full Name: Not empty, valid characters
   - Loan Number: Match CMG format (YYYY-NNNNNN)
   - Subject Property: Valid address format
   - Appraisal Effective Date: Valid date, not future

   Comparable Section (each):
   - Property Address: Not empty
   - MLS Listing: Valid MLS format
   - Proximity: Numeric with unit (miles/feet)
   - Beds/Baths: Positive integers
   - GLA: Positive number, reasonable range (500-10000)
   - Value: Positive number, reasonable range

3. SIMILARITY CHECKS (Warnings):
   - GLA variance > 30% from subject: WARN
   - Bed count variance > 2: WARN
   - Bath count variance > 2: WARN
   - Proximity > 2 miles (urban) / 5 miles (rural): WARN

OUTPUT:
{
  "valid": true/false,
  "errors": [
    { "field": "comp1_close_date", "message": "Close date is after appraisal effective date" }
  ],
  "warnings": [
    { "field": "comp2_gla", "message": "GLA is 35% larger than subject - may require significant adjustment" }
  ]
}`,
                integration: `INTEGRATION POINTS:
1. Form Input Monitoring
   - Real-time validation on field blur
   - Submit button enabled/disabled based on validation
   - Inline error messages

2. Business Rules Engine
   - Configurable validation rules
   - Market-specific proximity thresholds
   - Product-specific requirements

3. User Feedback
   - Color-coded field status (red/yellow/green)
   - Tooltip explanations for errors
   - Suggested corrections where possible

4. Submission Gate
   - Block submission if critical errors exist
   - Allow submission with warnings + acknowledgment
   - Log validation results for QC`
            },
            autofill: {
                name: 'Auto-Fill Agent',
                tags: ['Data Integration', 'Form Pre-fill', 'Low Complexity', 'High Priority'],
                purpose: `This agent automatically pre-populates the ROV form header fields by extracting data from the loan file and original appraisal report. It pulls borrower name, loan number, property address, and appraisal effective date to ensure accuracy and save time.`,
                prompt: `You are building an Auto-Fill Agent for CMG Financial's ROV Borrower Form process.

AGENT NAME: Auto-Fill Agent
TYPE: Data Integration / Form Pre-fill

OBJECTIVE:
Automatically populate ROV form header fields from authoritative data sources to ensure accuracy and reduce manual entry errors.

DATA SOURCES:
1. Loan Origination System (LOS)
   - Borrower Full Name
   - Loan Number
   - Subject Property Address

2. Appraisal Report (PDF)
   - Appraisal Effective Date
   - Subject Property Details (for validation)
   - Original Appraised Value

FIELD MAPPING:
{
  "borrower_name": {
    "source": "LOS.borrower.full_name",
    "format": "First Middle Last",
    "validation": "not_empty"
  },
  "loan_number": {
    "source": "LOS.loan.loan_number",
    "format": "YYYY-NNNNNN",
    "validation": "cmg_loan_format"
  },
  "subject_property": {
    "source": "LOS.property.address",
    "format": "Street, City, State ZIP",
    "validation": "valid_address"
  },
  "appraisal_effective_date": {
    "source": "Appraisal.effective_date",
    "format": "MM/DD/YYYY",
    "validation": "valid_date, not_future"
  },
  "submission_date": {
    "source": "system.current_date",
    "format": "MM/DD/YYYY",
    "validation": "valid_date"
  },
  "requested_by": {
    "source": "static",
    "value": "Borrower ROV",
    "editable": false
  }
}

OUTPUT:
{
  "filled_fields": 6,
  "data": {
    "borrower_name": "John Michael Smith",
    "loan_number": "2026-001234",
    "subject_property": "123 Main Street, Anytown, CA 90210",
    "appraisal_effective_date": "01/15/2026",
    "submission_date": "01/27/2026",
    "requested_by": "Borrower ROV"
  },
  "confidence": 0.99
}`,
                integration: `INTEGRATION POINTS:
1. Loan Origination System
   - API access to borrower data
   - Read-only loan file access
   - Real-time data sync

2. Document Management
   - Access stored appraisal PDF
   - OCR extraction for effective date
   - Cross-reference with LOS data

3. Form Interface
   - Pre-fill on form load
   - Show data source for each field
   - Allow override with audit trail

4. Error Handling
   - Graceful degradation if source unavailable
   - Manual entry fallback
   - Data mismatch alerts`
            },
            biasdetect: {
                name: 'Bias Detection Agent',
                tags: ['AI Analysis', 'Pattern Recognition', 'High Complexity', 'Medium Priority'],
                purpose: `This agent analyzes appraisal reports for potential bias indicators by examining value trends, comparable selection patterns, and adjustment calculations. It compares against historical data and demographic factors to flag potential fair housing concerns for priority review.`,
                prompt: `You are building a Bias Detection Agent for CMG Financial's ROV process.

AGENT NAME: Bias Detection Agent
TYPE: AI Analysis / Pattern Recognition

OBJECTIVE:
Analyze appraisal reports for indicators of potential bias or discrimination to support borrowers who may have received an unfair valuation.

ANALYSIS CATEGORIES:

1. COMPARABLE SELECTION ANALYSIS:
   - Geographic distribution of comps
   - Demographic patterns of comp neighborhoods
   - Distance to subject vs. available closer sales
   - Exclusion of higher-value proximate sales

2. ADJUSTMENT PATTERN ANALYSIS:
   - Consistency of adjustment amounts
   - Direction bias (all negative vs. mixed)
   - Unusual adjustment categories
   - Comparison to market norms

3. VALUE TREND ANALYSIS:
   - Subject value vs. neighborhood median
   - Historical appreciation patterns
   - Comparison to adjacent neighborhoods
   - AVM cross-reference

4. NARRATIVE ANALYSIS:
   - Negative language about neighborhood
   - Condition descriptions vs. photos
   - Subjective quality assessments
   - Inconsistent commentary

BIAS INDICATORS (Scored 0-100):
{
  "comp_selection_score": 0-25,
  "adjustment_pattern_score": 0-25,
  "value_trend_score": 0-25,
  "narrative_score": 0-25,
  "total_bias_risk": 0-100
}

RISK LEVELS:
- 0-25: Low - No significant indicators
- 26-50: Moderate - Some patterns warrant review
- 51-75: High - Multiple concerning indicators
- 76-100: Critical - Strong evidence of potential bias

OUTPUT:
{
  "bias_risk_score": 67,
  "risk_level": "High",
  "indicators": [
    {
      "category": "Comparable Selection",
      "finding": "3 higher-value sales within 0.5 miles excluded",
      "impact": "High"
    },
    {
      "category": "Adjustments",
      "finding": "All 6 adjustments are negative, totaling -$45,000",
      "impact": "Medium"
    }
  ],
  "recommendation": "Flag for priority ROV review - potential bias indicators detected"
}`,
                integration: `INTEGRATION POINTS:
1. Data Sources
   - Appraisal PDF parsing
   - MLS historical data
   - Census demographic data
   - AVM services (Zillow, CoreLogic)

2. Machine Learning Models
   - Trained on historical bias cases
   - Adjustment pattern recognition
   - Narrative sentiment analysis
   - Comparable quality scoring

3. Compliance Integration
   - Fair Housing Act alignment
   - ECOA requirements
   - State-specific regulations
   - Audit trail for findings

4. Reporting
   - Detailed findings report
   - Evidence documentation
   - Regulatory escalation pathway
   - Appraiser feedback loop`
            }
        };

        // Show agent prompt modal
        let currentPromptContent = '';

        function showAgentPrompt(agentKey) {
            const agent = agentPrompts[agentKey];
            if (!agent) return;

            document.getElementById('promptModalTitle').textContent = agent.name + ' - Build Prompt';

            const tagsHtml = agent.tags.map(tag => '<span class="prompt-tag">' + tag + '</span>').join('');
            document.getElementById('promptTags').innerHTML = tagsHtml;

            document.getElementById('promptPurpose').textContent = agent.purpose;
            document.getElementById('promptContent').textContent = agent.prompt;
            document.getElementById('promptIntegration').textContent = agent.integration;

            currentPromptContent = '# ' + agent.name + '\n\n## Purpose\n' + agent.purpose + '\n\n## Build Prompt\n' + agent.prompt + '\n\n## Integration Points\n' + agent.integration;

            document.getElementById('promptModal').classList.add('show');
            document.body.style.overflow = 'hidden';
        }

        function closePromptModal() {
            document.getElementById('promptModal').classList.remove('show');
            document.body.style.overflow = '';
        }

        async function copyPromptToClipboard() {
            try {
                await navigator.clipboard.writeText(currentPromptContent);
                const success = document.getElementById('copySuccess');
                success.style.display = 'block';
                setTimeout(() => { success.style.display = 'none'; }, 2000);
            } catch (e) {
                alert('Failed to copy prompt.');
            }
        }

        document.getElementById('promptModal').addEventListener('click', (e) => {
            if (e.target.id === 'promptModal') closePromptModal();
        });
    </script>
</body>
</html>
