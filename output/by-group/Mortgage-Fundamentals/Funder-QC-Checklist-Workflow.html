<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Funder QC Checklist - Process Workflow</title>
    <link href="https://fonts.googleapis.com/css2?family=Plus+Jakarta+Sans:wght@400;500;600;700;800&family=JetBrains+Mono:wght@400;500&display=swap" rel="stylesheet">
    <style>
        :root {
            --bg-primary: #0a0f1a;
            --bg-secondary: #111827;
            --bg-card: #1a2234;
            --accent-blue: #3b82f6;
            --accent-teal: #14b8a6;
            --accent-amber: #f59e0b;
            --accent-rose: #f43f5e;
            --accent-green: #22c55e;
            --accent-purple: #8b5cf6;
            --text-primary: #f1f5f9;
            --text-secondary: #94a3b8;
            --text-muted: #64748b;
            --border-subtle: rgba(255,255,255,0.08);
            --sidebar-width: 280px;
        }

        * { box-sizing: border-box; margin: 0; padding: 0; }
        html { scroll-behavior: smooth; }
        body {
            font-family: 'Plus Jakarta Sans', -apple-system, BlinkMacSystemFont, sans-serif;
            background: var(--bg-primary);
            color: var(--text-primary);
            min-height: 100vh;
        }

        /* Breadcrumb */
        .breadcrumb {
            background: linear-gradient(90deg, #0d1525 0%, #1a2234 100%);
            padding: 14px 25px;
            display: flex;
            align-items: center;
            gap: 12px;
            font-size: 0.95rem;
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            z-index: 1001;
            border-bottom: 1px solid var(--border-subtle);
        }

        .breadcrumb a {
            color: var(--text-secondary);
            text-decoration: none;
            font-weight: 600;
            padding: 8px 16px;
            background: rgba(255,255,255,0.05);
            border-radius: 8px;
            transition: all 0.2s;
            border: 1px solid var(--border-subtle);
        }

        .breadcrumb a:hover {
            background: rgba(59, 130, 246, 0.15);
            color: var(--accent-blue);
            border-color: rgba(59, 130, 246, 0.3);
        }

        .breadcrumb .separator { color: var(--text-muted); font-size: 1.2rem; }
        .breadcrumb .current { color: var(--accent-amber); font-weight: 600; padding: 8px 16px; }

        /* Sidebar */
        .sidebar {
            position: fixed;
            top: 54px;
            left: 0;
            width: var(--sidebar-width);
            height: calc(100vh - 54px);
            background: var(--bg-secondary);
            overflow-y: auto;
            z-index: 1000;
            border-right: 1px solid var(--border-subtle);
            display: flex;
            flex-direction: column;
        }

        .sidebar-header {
            padding: 25px 20px;
            background: rgba(0,0,0,0.3);
            border-bottom: 1px solid var(--border-subtle);
        }

        .sidebar-header h2 { color: var(--text-primary); font-size: 1.2rem; font-weight: 700; margin-bottom: 5px; }
        .sidebar-header p { color: var(--text-muted); font-size: 0.85rem; }

        /* Tab Switch */
        .sidebar-tabs {
            display: flex;
            border-bottom: 1px solid var(--border-subtle);
        }

        .sidebar-tab {
            flex: 1;
            padding: 14px 10px;
            text-align: center;
            font-size: 0.8rem;
            font-weight: 700;
            color: var(--text-muted);
            cursor: pointer;
            transition: all 0.2s;
            border-bottom: 3px solid transparent;
            background: none;
            border-left: none;
            border-right: none;
            border-top: none;
        }

        .sidebar-tab:hover { background: rgba(255,255,255,0.03); color: var(--text-secondary); }
        .sidebar-tab.active { color: var(--accent-blue); border-bottom-color: var(--accent-blue); background: rgba(59, 130, 246, 0.08); }
        .sidebar-tab.agent-tab.active { color: var(--accent-purple); border-bottom-color: var(--accent-purple); background: rgba(139, 92, 246, 0.08); }

        .sidebar-nav { padding: 15px 0; flex: 1; overflow-y: auto; }

        .nav-item {
            display: flex;
            align-items: center;
            gap: 12px;
            padding: 14px 20px;
            color: var(--text-secondary);
            text-decoration: none;
            border-left: 3px solid transparent;
            transition: all 0.2s ease;
            cursor: pointer;
        }

        .nav-item:hover { background: rgba(255,255,255,0.03); color: var(--text-primary); }
        .nav-item.active { background: rgba(59, 130, 246, 0.1); border-left-color: var(--accent-blue); color: var(--text-primary); }

        .nav-number {
            background: rgba(255,255,255,0.1);
            color: var(--text-secondary);
            width: 28px;
            height: 28px;
            border-radius: 8px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 700;
            font-size: 0.85rem;
            flex-shrink: 0;
        }

        .nav-item.active .nav-number { background: var(--accent-blue); color: white; }
        .nav-label { font-size: 0.95rem; font-weight: 500; }

        .sidebar-footer {
            padding: 20px;
            border-top: 1px solid var(--border-subtle);
            background: rgba(0,0,0,0.2);
        }

        .doc-btn {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
            width: 100%;
            padding: 14px 20px;
            background: linear-gradient(135deg, var(--accent-blue) 0%, var(--accent-teal) 100%);
            color: white;
            border: none;
            border-radius: 10px;
            font-weight: 600;
            cursor: pointer;
            transition: transform 0.2s, box-shadow 0.2s;
            text-decoration: none;
            font-size: 0.95rem;
        }

        .doc-btn:hover { transform: translateY(-2px); box-shadow: 0 8px 25px rgba(59, 130, 246, 0.3); }

        /* Main Content */
        .main-content { margin-left: var(--sidebar-width); padding: 80px 40px 40px 40px; }

        /* Tab Panels */
        .tab-panel { display: none; }
        .tab-panel.active { display: block; }

        .header {
            background: var(--bg-card);
            border: 1px solid var(--border-subtle);
            padding: 35px;
            border-radius: 16px;
            margin-bottom: 30px;
            position: relative;
            overflow: hidden;
        }

        .header::before {
            content: '';
            position: absolute;
            top: 0; left: 0; right: 0; bottom: 0;
            background:
                radial-gradient(ellipse at 20% 20%, rgba(59, 130, 246, 0.1) 0%, transparent 50%),
                radial-gradient(ellipse at 80% 80%, rgba(20, 184, 166, 0.08) 0%, transparent 50%);
            pointer-events: none;
        }

        .header h1 {
            font-size: 2.2rem;
            font-weight: 800;
            margin-bottom: 10px;
            position: relative;
            background: linear-gradient(135deg, var(--text-primary) 0%, var(--accent-blue) 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .header .subtitle { color: var(--text-secondary); font-size: 1.1rem; position: relative; }

        .header .meta { display: flex; gap: 15px; margin-top: 20px; flex-wrap: wrap; position: relative; }

        .header .meta-item {
            background: rgba(255,255,255,0.05);
            border: 1px solid var(--border-subtle);
            padding: 8px 16px;
            border-radius: 8px;
            font-size: 0.9rem;
            color: var(--text-secondary);
        }

        /* Legend */
        .legend {
            display: flex;
            flex-wrap: wrap;
            gap: 15px;
            padding: 18px 22px;
            background: var(--bg-card);
            border: 1px solid var(--border-subtle);
            border-radius: 12px;
            margin-bottom: 25px;
        }

        .legend-item { display: flex; align-items: center; gap: 8px; font-size: 0.85rem; color: var(--text-secondary); }
        .legend-color { width: 18px; height: 18px; border-radius: 4px; }

        /* Sections */
        .section {
            background: var(--bg-card);
            border: 1px solid var(--border-subtle);
            border-radius: 16px;
            margin-bottom: 25px;
            overflow: hidden;
            scroll-margin-top: 75px;
        }

        .section-header {
            background: linear-gradient(135deg, var(--bg-secondary) 0%, rgba(59, 130, 246, 0.1) 100%);
            border-bottom: 1px solid var(--border-subtle);
            padding: 22px 25px;
            display: flex;
            align-items: center;
            gap: 18px;
        }

        .section-number {
            background: linear-gradient(135deg, var(--accent-blue) 0%, var(--accent-teal) 100%);
            color: white;
            width: 48px;
            height: 48px;
            border-radius: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 800;
            font-size: 1.3rem;
            flex-shrink: 0;
        }

        .section-title h2 { font-size: 1.35rem; font-weight: 700; margin-bottom: 4px; color: var(--text-primary); }
        .section-title span { font-size: 0.9rem; color: var(--text-muted); }
        .section-content { padding: 28px; }

        /* Workflow Diagrams */
        .workflow-diagram {
            background: rgba(0,0,0,0.3);
            border: 1px solid var(--border-subtle);
            border-radius: 12px;
            padding: 28px;
            margin-bottom: 22px;
        }

        .flow-row { display: flex; align-items: center; justify-content: center; flex-wrap: wrap; gap: 12px; margin: 15px 0; }

        .flow-node {
            padding: 14px 22px;
            border-radius: 10px;
            text-align: center;
            font-size: 0.9rem;
            font-weight: 600;
            min-width: 150px;
            border: 1px solid var(--border-subtle);
        }

        .flow-node.start { background: linear-gradient(135deg, var(--accent-green) 0%, #16a34a 100%); color: white; border-radius: 25px; border: none; }
        .flow-node.action { background: linear-gradient(135deg, var(--accent-blue) 0%, #2563eb 100%); color: white; border: none; }
        .flow-node.decision { background: linear-gradient(135deg, var(--accent-amber) 0%, #d97706 100%); color: var(--bg-primary); border: none; }
        .flow-node.input { background: var(--bg-secondary); border: 2px solid var(--accent-blue); color: var(--text-primary); }
        .flow-node.output { background: linear-gradient(135deg, var(--accent-teal) 0%, #0d9488 100%); color: white; border: none; }
        .flow-node.exception { background: linear-gradient(135deg, var(--accent-rose) 0%, #dc2626 100%); color: white; border: none; }

        .flow-arrow { color: var(--accent-blue); font-size: 1.5rem; }
        .flow-arrow.down { transform: rotate(90deg); }

        .decision-branch { display: flex; gap: 40px; justify-content: center; margin: 20px 0; flex-wrap: wrap; }
        .branch { display: flex; flex-direction: column; align-items: center; gap: 10px; }

        .branch-label {
            background: var(--bg-secondary);
            border: 1px solid var(--border-subtle);
            padding: 6px 16px;
            border-radius: 20px;
            font-size: 0.8rem;
            font-weight: 700;
            color: var(--text-secondary);
        }

        /* Tables */
        .field-table { width: 100%; border-collapse: collapse; margin: 18px 0; }

        .field-table th {
            background: rgba(59, 130, 246, 0.15);
            color: var(--accent-blue);
            padding: 14px 18px;
            text-align: left;
            font-weight: 600;
            font-size: 0.9rem;
            text-transform: uppercase;
            letter-spacing: 0.05em;
            border-bottom: 1px solid var(--border-subtle);
        }

        .field-table td { padding: 14px 18px; border-bottom: 1px solid var(--border-subtle); color: var(--text-secondary); }
        .field-table tr:hover { background: rgba(255,255,255,0.02); }

        .badge { display: inline-block; padding: 4px 12px; border-radius: 6px; font-size: 0.75rem; font-weight: 700; text-transform: uppercase; letter-spacing: 0.05em; }
        .badge.required-badge { background: rgba(244, 63, 94, 0.15); color: var(--accent-rose); }
        .badge.optional-badge { background: rgba(34, 197, 94, 0.15); color: var(--accent-green); }
        .badge.calculated-badge { background: rgba(59, 130, 246, 0.15); color: var(--accent-blue); }
        .badge.conditional-badge { background: rgba(245, 158, 11, 0.15); color: var(--accent-amber); }

        /* Info Boxes */
        .exception-box, .tip-box, .info-box {
            padding: 18px 22px;
            margin: 18px 0;
            border-radius: 0 10px 10px 0;
            border-left-width: 4px;
            border-left-style: solid;
        }

        .exception-box { background: rgba(244, 63, 94, 0.08); border-color: var(--accent-rose); border: 1px solid rgba(244, 63, 94, 0.2); border-left: 4px solid var(--accent-rose); }
        .exception-box h4 { color: var(--accent-rose); margin-bottom: 10px; font-size: 1rem; }
        .exception-box p, .exception-box li { color: var(--text-secondary); }

        .tip-box { background: rgba(34, 197, 94, 0.08); border-color: var(--accent-green); border: 1px solid rgba(34, 197, 94, 0.2); border-left: 4px solid var(--accent-green); }
        .tip-box h4 { color: var(--accent-green); margin-bottom: 10px; font-size: 1rem; }
        .tip-box p, .tip-box li { color: var(--text-secondary); }

        .info-box { background: rgba(59, 130, 246, 0.08); border-color: var(--accent-blue); border: 1px solid rgba(59, 130, 246, 0.2); border-left: 4px solid var(--accent-blue); }
        .info-box h4 { color: var(--accent-blue); margin-bottom: 10px; font-size: 1rem; }
        .info-box p, .info-box li { color: var(--text-secondary); }

        /* Decision Tree */
        .decision-tree {
            background: rgba(0,0,0,0.2);
            border: 1px solid var(--border-subtle);
            border-radius: 12px;
            padding: 22px;
            margin: 22px 0;
        }

        .decision-tree h3 { color: var(--accent-blue); margin-bottom: 18px; padding-bottom: 12px; border-bottom: 1px solid var(--border-subtle); font-size: 1.1rem; }

        .tree-node { margin-left: 20px; padding: 12px; border-left: 2px solid var(--accent-teal); position: relative; color: var(--text-secondary); }
        .tree-node::before { content: ''; position: absolute; left: -2px; top: 22px; width: 15px; height: 2px; background: var(--accent-teal); }
        .tree-node.level-1 { margin-left: 0; border-left: none; }
        .tree-node.level-1::before { display: none; }

        .tree-label { background: var(--accent-amber); color: var(--bg-primary); padding: 6px 14px; border-radius: 6px; font-weight: 700; display: inline-block; margin-bottom: 6px; font-size: 0.9rem; }

        /* Summary Grid */
        .summary-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(180px, 1fr)); gap: 18px; margin: 22px 0; }

        .summary-card { background: rgba(0,0,0,0.3); border: 1px solid var(--border-subtle); border-radius: 12px; padding: 22px; text-align: center; }
        .summary-card h4 { color: var(--text-secondary); margin-bottom: 12px; font-size: 0.9rem; }
        .summary-card .value {
            font-size: 2.2rem;
            font-weight: 800;
            background: linear-gradient(135deg, var(--accent-blue) 0%, var(--accent-teal) 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }
        .summary-card .label { font-size: 0.85rem; color: var(--text-muted); margin-top: 8px; }

        /* Checklist Items */
        .checklist-container {
            background: rgba(0,0,0,0.2);
            border: 1px solid var(--border-subtle);
            border-radius: 12px;
            padding: 22px;
            margin: 18px 0;
        }

        .checklist-item {
            display: flex;
            align-items: flex-start;
            gap: 12px;
            padding: 12px 0;
            border-bottom: 1px solid var(--border-subtle);
            color: var(--text-secondary);
        }

        .checklist-item:last-child { border-bottom: none; }

        .checklist-box {
            width: 20px;
            height: 20px;
            border: 2px solid var(--accent-blue);
            border-radius: 4px;
            flex-shrink: 0;
            margin-top: 2px;
        }

        .checklist-text { flex: 1; line-height: 1.5; }
        .checklist-text strong { color: var(--text-primary); }
        .checklist-note { font-size: 0.85rem; color: var(--text-muted); font-style: italic; margin-top: 4px; }

        /* Quick Reference */
        .quick-ref {
            background: linear-gradient(135deg, var(--bg-secondary) 0%, var(--bg-card) 100%);
            border: 1px solid var(--border-subtle);
            padding: 28px;
            border-radius: 16px;
            margin-top: 30px;
            font-family: 'JetBrains Mono', monospace;
            scroll-margin-top: 75px;
        }

        .quick-ref h3 { color: var(--accent-amber); margin-bottom: 18px; font-family: 'Plus Jakarta Sans', sans-serif; }
        .quick-ref pre { background: rgba(0,0,0,0.4); border: 1px solid var(--border-subtle); padding: 20px; border-radius: 10px; overflow-x: auto; font-size: 0.85rem; line-height: 1.7; color: var(--text-secondary); }

        /* Step List */
        .step-list { list-style: none; padding: 0; margin: 18px 0; }
        .step-list li {
            padding: 14px 18px;
            border-left: 3px solid var(--accent-blue);
            background: rgba(0,0,0,0.2);
            margin-bottom: 10px;
            border-radius: 0 8px 8px 0;
            color: var(--text-secondary);
        }
        .step-list li strong { color: var(--text-primary); }

        /* ====== AGENT OPPORTUNITIES STYLES ====== */
        .agent-header {
            background: var(--bg-card);
            border: 1px solid var(--border-subtle);
            padding: 35px;
            border-radius: 16px;
            margin-bottom: 30px;
            position: relative;
            overflow: hidden;
        }

        .agent-header::before {
            content: '';
            position: absolute;
            top: 0; left: 0; right: 0; bottom: 0;
            background:
                radial-gradient(ellipse at 20% 20%, rgba(139, 92, 246, 0.12) 0%, transparent 50%),
                radial-gradient(ellipse at 80% 80%, rgba(245, 158, 11, 0.1) 0%, transparent 50%);
            pointer-events: none;
        }

        .agent-header h1 {
            font-size: 2.2rem;
            font-weight: 800;
            margin-bottom: 10px;
            position: relative;
            background: linear-gradient(135deg, var(--accent-purple) 0%, var(--accent-amber) 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .agent-header .subtitle { color: var(--text-secondary); font-size: 1.1rem; position: relative; }

        /* Heat Map */
        .heat-map-container { margin-bottom: 35px; }
        .heat-map-title { font-size: 1.3rem; font-weight: 700; color: var(--text-primary); margin-bottom: 20px; display: flex; align-items: center; gap: 12px; }

        .heat-map-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
        }

        .heat-item {
            background: var(--bg-card);
            border: 1px solid var(--border-subtle);
            border-radius: 12px;
            padding: 20px;
            position: relative;
            overflow: hidden;
            transition: transform 0.2s, box-shadow 0.2s;
            cursor: pointer;
        }

        .heat-item:hover { transform: translateY(-3px); box-shadow: 0 10px 30px rgba(0,0,0,0.3); }
        .heat-item:active { transform: scale(0.98); }

        .heat-item::before {
            content: '';
            position: absolute;
            top: 0; left: 0; right: 0; height: 4px;
        }

        .heat-item.critical::before { background: linear-gradient(90deg, #ef4444, #f97316); }
        .heat-item.high::before { background: linear-gradient(90deg, #f97316, #eab308); }
        .heat-item.medium::before { background: linear-gradient(90deg, #eab308, #22c55e); }
        .heat-item.low::before { background: linear-gradient(90deg, #22c55e, #14b8a6); }

        .heat-score {
            position: absolute;
            top: 15px;
            right: 15px;
            font-size: 1.8rem;
            font-weight: 800;
        }

        .heat-item.critical .heat-score { color: #ef4444; }
        .heat-item.high .heat-score { color: #f97316; }
        .heat-item.medium .heat-score { color: #eab308; }
        .heat-item.low .heat-score { color: #22c55e; }

        .heat-name { font-size: 1rem; font-weight: 700; color: var(--text-primary); margin-bottom: 6px; padding-right: 50px; }
        .heat-desc { font-size: 0.85rem; color: var(--text-muted); margin-bottom: 12px; }

        .heat-metrics { display: flex; gap: 15px; margin-top: 12px; }
        .heat-metric { font-size: 0.75rem; color: var(--text-muted); }
        .heat-metric span { color: var(--text-secondary); font-weight: 600; }

        /* Agent Cards */
        .agent-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(380px, 1fr)); gap: 25px; margin-bottom: 35px; }

        .agent-card {
            background: var(--bg-card);
            border: 1px solid var(--border-subtle);
            border-radius: 16px;
            overflow: hidden;
            transition: transform 0.2s, box-shadow 0.2s;
        }

        .agent-card:hover { transform: translateY(-5px); box-shadow: 0 15px 50px rgba(0,0,0,0.3); }

        .agent-card.highlight {
            animation: highlightPulse 2s ease;
            box-shadow: 0 0 0 3px var(--accent-purple), 0 15px 50px rgba(139, 92, 246, 0.4);
        }

        @keyframes highlightPulse {
            0% { box-shadow: 0 0 0 3px var(--accent-purple), 0 15px 50px rgba(139, 92, 246, 0.6); }
            50% { box-shadow: 0 0 0 6px rgba(139, 92, 246, 0.5), 0 15px 50px rgba(139, 92, 246, 0.3); }
            100% { box-shadow: 0 0 0 0px transparent, 0 15px 50px rgba(0,0,0,0.3); }
        }

        .agent-card-header {
            padding: 22px;
            display: flex;
            align-items: flex-start;
            gap: 18px;
            border-bottom: 1px solid var(--border-subtle);
        }

        .agent-icon {
            width: 55px;
            height: 55px;
            background: linear-gradient(135deg, var(--accent-purple) 0%, var(--accent-blue) 100%);
            border-radius: 14px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.6rem;
            flex-shrink: 0;
        }

        .agent-info { flex: 1; }
        .agent-name { font-size: 1.15rem; font-weight: 700; color: var(--text-primary); margin-bottom: 5px; }
        .agent-type { font-size: 0.8rem; color: var(--accent-purple); font-weight: 600; text-transform: uppercase; letter-spacing: 0.05em; }

        .agent-priority {
            padding: 6px 12px;
            border-radius: 20px;
            font-size: 0.75rem;
            font-weight: 700;
            text-transform: uppercase;
        }

        .agent-priority.critical { background: rgba(239, 68, 68, 0.15); color: #ef4444; }
        .agent-priority.high { background: rgba(249, 115, 22, 0.15); color: #f97316; }
        .agent-priority.medium { background: rgba(234, 179, 8, 0.15); color: #eab308; }
        .agent-priority.low { background: rgba(34, 197, 94, 0.15); color: #22c55e; }

        .agent-card-body { padding: 22px; }
        .agent-description { font-size: 0.95rem; color: var(--text-secondary); line-height: 1.6; margin-bottom: 20px; }

        .agent-flow {
            background: rgba(0,0,0,0.3);
            border: 1px solid var(--border-subtle);
            border-radius: 10px;
            padding: 18px;
            margin-bottom: 20px;
        }

        .agent-flow-title { font-size: 0.85rem; color: var(--text-muted); margin-bottom: 12px; font-weight: 600; text-transform: uppercase; letter-spacing: 0.05em; }

        .agent-flow-diagram { display: flex; align-items: center; flex-wrap: wrap; gap: 8px; justify-content: center; }

        .agent-step {
            background: linear-gradient(135deg, var(--accent-purple) 0%, var(--accent-blue) 100%);
            color: white;
            padding: 8px 14px;
            border-radius: 6px;
            font-size: 0.8rem;
            font-weight: 600;
            white-space: nowrap;
        }

        .agent-arrow { color: var(--accent-purple); font-size: 1.2rem; }

        .agent-stats { display: grid; grid-template-columns: repeat(3, 1fr); gap: 12px; }

        .agent-stat {
            background: rgba(0,0,0,0.2);
            border-radius: 8px;
            padding: 12px;
            text-align: center;
        }

        .agent-stat-value {
            font-size: 1.3rem;
            font-weight: 800;
            background: linear-gradient(135deg, var(--accent-purple) 0%, var(--accent-amber) 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .agent-stat-label { font-size: 0.7rem; color: var(--text-muted); text-transform: uppercase; letter-spacing: 0.05em; margin-top: 4px; }

        /* View Prompt Button */
        .agent-prompt-btn {
            width: 100%;
            margin-top: 18px;
            padding: 14px 20px;
            background: linear-gradient(135deg, rgba(139, 92, 246, 0.2) 0%, rgba(59, 130, 246, 0.2) 100%);
            border: 1px solid rgba(139, 92, 246, 0.4);
            border-radius: 10px;
            color: var(--accent-purple);
            font-weight: 700;
            cursor: pointer;
            transition: all 0.2s;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
            font-size: 0.9rem;
        }

        .agent-prompt-btn:hover {
            background: linear-gradient(135deg, rgba(139, 92, 246, 0.3) 0%, rgba(59, 130, 246, 0.3) 100%);
            border-color: var(--accent-purple);
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(139, 92, 246, 0.25);
        }

        /* Summary Stats */
        .agent-summary {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin-bottom: 35px;
        }

        .agent-summary-card {
            background: var(--bg-card);
            border: 1px solid var(--border-subtle);
            border-radius: 14px;
            padding: 25px;
            text-align: center;
        }

        .agent-summary-value {
            font-size: 2.5rem;
            font-weight: 800;
            background: linear-gradient(135deg, var(--accent-purple) 0%, var(--accent-amber) 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .agent-summary-label { font-size: 0.9rem; color: var(--text-muted); margin-top: 8px; }

        /* Heat Map Legend */
        .heat-legend {
            display: flex;
            gap: 25px;
            padding: 18px 22px;
            background: var(--bg-card);
            border: 1px solid var(--border-subtle);
            border-radius: 12px;
            margin-bottom: 25px;
            flex-wrap: wrap;
        }

        .heat-legend-item { display: flex; align-items: center; gap: 10px; font-size: 0.9rem; color: var(--text-secondary); }
        .heat-legend-color { width: 24px; height: 24px; border-radius: 6px; }

        /* Modal */
        .modal-overlay {
            display: none;
            position: fixed;
            top: 0; left: 0; right: 0; bottom: 0;
            background: rgba(10, 15, 26, 0.9);
            z-index: 2000;
            justify-content: center;
            align-items: center;
            padding: 20px;
            backdrop-filter: blur(5px);
        }

        .modal-overlay.show { display: flex; }

        .modal {
            background: var(--bg-card);
            border: 1px solid var(--border-subtle);
            border-radius: 16px;
            width: 100%;
            max-width: 950px;
            max-height: 90vh;
            display: flex;
            flex-direction: column;
            box-shadow: 0 25px 80px rgba(0,0,0,0.5);
        }

        .modal-header {
            background: linear-gradient(135deg, var(--accent-blue) 0%, var(--accent-teal) 100%);
            color: white;
            padding: 22px 28px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            border-radius: 16px 16px 0 0;
        }

        .modal-header h3 { font-size: 1.25rem; font-weight: 700; }
        .modal-actions { display: flex; gap: 12px; }

        .modal-btn {
            padding: 10px 18px;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-weight: 700;
            transition: transform 0.2s;
            font-size: 0.9rem;
        }

        .modal-btn:hover { transform: scale(1.05); }
        .modal-btn.copy { background: white; color: var(--accent-blue); }
        .modal-btn.close { background: rgba(255,255,255,0.2); color: white; }

        .modal-body { padding: 28px; overflow-y: auto; flex: 1; }

        .modal-body pre {
            background: rgba(0,0,0,0.3);
            border: 1px solid var(--border-subtle);
            padding: 22px;
            border-radius: 10px;
            font-family: 'JetBrains Mono', monospace;
            font-size: 0.9rem;
            line-height: 1.7;
            white-space: pre-wrap;
            word-wrap: break-word;
            color: var(--text-secondary);
        }

        .copy-success {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: var(--accent-green);
            color: white;
            padding: 18px 35px;
            border-radius: 10px;
            font-weight: 700;
            z-index: 3000;
            display: none;
            animation: fadeInOut 2s ease;
        }

        @keyframes fadeInOut { 0%, 100% { opacity: 0; } 10%, 90% { opacity: 1; } }

        /* Prompt Modal */
        .prompt-modal .modal { max-width: 800px; }
        .prompt-modal .modal-header { background: linear-gradient(135deg, var(--accent-purple) 0%, var(--accent-blue) 100%); }

        .prompt-section { margin-bottom: 25px; }
        .prompt-section h4 { color: var(--accent-purple); font-size: 1rem; margin-bottom: 12px; display: flex; align-items: center; gap: 8px; }

        .prompt-box {
            background: rgba(0,0,0,0.4);
            border: 1px solid var(--border-subtle);
            border-radius: 10px;
            padding: 20px;
            font-family: 'JetBrains Mono', monospace;
            font-size: 0.85rem;
            line-height: 1.7;
            color: var(--text-secondary);
            white-space: pre-wrap;
            word-wrap: break-word;
        }

        .prompt-tags { display: flex; gap: 10px; flex-wrap: wrap; margin-bottom: 20px; }
        .prompt-tag { background: rgba(139, 92, 246, 0.15); color: var(--accent-purple); padding: 6px 14px; border-radius: 20px; font-size: 0.8rem; font-weight: 600; }

        @media (max-width: 900px) {
            .sidebar { display: none; }
            .main-content { margin-left: 0; padding: 75px 20px 30px 20px; }
            .agent-grid { grid-template-columns: 1fr; }
        }
    </style>
</head>
<body>
    <!-- Breadcrumb -->
    <nav class="breadcrumb">
        <a href="../../index.html">Portal Home</a>
        <span class="separator">></span>
        <a href="./index.html">Mortgage Fundamentals</a>
        <span class="separator">></span>
        <span class="current">Funder QC Checklist</span>
    </nav>

    <!-- Fixed Sidebar -->
    <aside class="sidebar">
        <div class="sidebar-header">
            <h2>Funder QC Checklist</h2>
            <p>Complete Review Guide</p>
        </div>

        <!-- Tab Switcher -->
        <div class="sidebar-tabs">
            <button class="sidebar-tab active" onclick="switchTab('workflow')">Workflow</button>
            <button class="sidebar-tab agent-tab" onclick="switchTab('agents')">AI Agents</button>
        </div>

        <!-- Workflow Navigation -->
        <nav class="sidebar-nav" id="workflow-nav">
            <a href="#section-1" class="nav-item active">
                <span class="nav-number">1</span>
                <span class="nav-label">Loan Information</span>
            </a>
            <a href="#section-2" class="nav-item">
                <span class="nav-number">2</span>
                <span class="nav-label">Loan Type Actions</span>
            </a>
            <a href="#section-3" class="nav-item">
                <span class="nav-number">3</span>
                <span class="nav-label">Borrower Documents</span>
            </a>
            <a href="#section-4" class="nav-item">
                <span class="nav-number">4</span>
                <span class="nav-label">Loan Documents</span>
            </a>
            <a href="#section-5" class="nav-item">
                <span class="nav-number">5</span>
                <span class="nav-label">Disclosures & Forms</span>
            </a>
            <a href="#section-6" class="nav-item">
                <span class="nav-number">6</span>
                <span class="nav-label">Insurance & Property</span>
            </a>
            <a href="#section-7" class="nav-item">
                <span class="nav-number">7</span>
                <span class="nav-label">Government Loans</span>
            </a>
            <a href="#section-8" class="nav-item">
                <span class="nav-number">8</span>
                <span class="nav-label">Special Programs</span>
            </a>
            <a href="#quick-ref" class="nav-item">
                <span class="nav-number">*</span>
                <span class="nav-label">Quick Reference</span>
            </a>
        </nav>

        <!-- Agent Navigation -->
        <nav class="sidebar-nav" id="agents-nav" style="display: none;">
            <a href="#agent-summary" class="nav-item active">
                <span class="nav-number">S</span>
                <span class="nav-label">Summary</span>
            </a>
            <a href="#agent-heatmap" class="nav-item">
                <span class="nav-number">H</span>
                <span class="nav-label">Heat Map</span>
            </a>
            <a href="#agent-details" class="nav-item">
                <span class="nav-number">A</span>
                <span class="nav-label">Agent Details</span>
            </a>
        </nav>

        <div class="sidebar-footer">
            <button class="doc-btn" onclick="openDocModal()">
                View Workflow Markdown
            </button>
        </div>
    </aside>

    <!-- Main Content -->
    <main class="main-content">

        <!-- ==================== WORKFLOW TAB ==================== -->
        <div id="workflow-panel" class="tab-panel active">
            <!-- Header -->
            <div class="header">
                <h1>Funder QC Checklist</h1>
                <p class="subtitle">Complete quality control review checklist for loan funding verification - ensuring all documents are complete and compliant before funding</p>
                <div class="meta">
                    <span class="meta-item">Department: Funding</span>
                    <span class="meta-item">Role: Funder / QC Specialist</span>
                    <span class="meta-item">Doc ID: RET220/020720</span>
                    <span class="meta-item">Duration: 15-30 min per loan</span>
                </div>
            </div>

            <!-- Legend -->
            <div class="legend">
                <div class="legend-item"><div class="legend-color" style="background: linear-gradient(135deg, #22c55e, #16a34a);"></div><span>Start/End</span></div>
                <div class="legend-item"><div class="legend-color" style="background: linear-gradient(135deg, #3b82f6, #2563eb);"></div><span>Action Step</span></div>
                <div class="legend-item"><div class="legend-color" style="background: linear-gradient(135deg, #f59e0b, #d97706);"></div><span>Decision Point</span></div>
                <div class="legend-item"><div class="legend-color" style="background: #111827; border: 2px solid #3b82f6;"></div><span>User Input</span></div>
                <div class="legend-item"><div class="legend-color" style="background: linear-gradient(135deg, #f43f5e, #dc2626);"></div><span>Exception</span></div>
                <div class="legend-item"><div class="legend-color" style="background: linear-gradient(135deg, #14b8a6, #0d9488);"></div><span>Output</span></div>
            </div>

            <!-- Section 1: Loan Information -->
            <section id="section-1" class="section">
                <div class="section-header">
                    <div class="section-number">1</div>
                    <div class="section-title"><h2>Loan Information Setup</h2><span>Initial loan identification and system entry requirements</span></div>
                </div>
                <div class="section-content">
                    <div class="workflow-diagram">
                        <div class="flow-row">
                            <div class="flow-node start">Start QC Review</div>
                            <span class="flow-arrow">-></span>
                            <div class="flow-node input">Enter Borrower Name</div>
                            <span class="flow-arrow">-></span>
                            <div class="flow-node input">Enter Loan Number</div>
                            <span class="flow-arrow">-></span>
                            <div class="flow-node decision">Select Loan Type</div>
                        </div>
                    </div>

                    <table class="field-table">
                        <thead>
                            <tr>
                                <th>Field</th>
                                <th>Description</th>
                                <th>Status</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td><strong>Borrower(s) Name</strong></td>
                                <td>Full name of all borrowers on the loan</td>
                                <td><span class="badge required-badge">Required</span></td>
                            </tr>
                            <tr>
                                <td><strong>Loan Number</strong></td>
                                <td>Unique loan identifier in the system</td>
                                <td><span class="badge required-badge">Required</span></td>
                            </tr>
                            <tr>
                                <td><strong>Loan Type</strong></td>
                                <td>Conventional, FHA, VA, USDA, Bond, etc.</td>
                                <td><span class="badge required-badge">Required</span></td>
                            </tr>
                            <tr>
                                <td><strong>CPL Date</strong></td>
                                <td>Closing Protection Letter date</td>
                                <td><span class="badge required-badge">Required</span></td>
                            </tr>
                        </tbody>
                    </table>

                    <div class="exception-box">
                        <h4>CRITICAL: Funder Conditions</h4>
                        <p><strong>DO NOT LEAVE ANY FUNDER CONDITIONS LEFT OPEN.</strong> All conditions must be cleared and documented in the Conversation Log before proceeding with funding.</p>
                    </div>

                    <div class="info-box">
                        <h4>Bond Loans Notice</h4>
                        <p>For ALL BOND LOANS: Refer to the State Checklist for additional required documents specific to the bond program and state requirements.</p>
                    </div>
                </div>
            </section>

            <!-- Section 2: Loan Type Actions -->
            <section id="section-2" class="section">
                <div class="section-header">
                    <div class="section-number">2</div>
                    <div class="section-title"><h2>Loan Type Specific Actions</h2><span>Actions required based on loan type selection</span></div>
                </div>
                <div class="section-content">
                    <div class="workflow-diagram">
                        <div class="flow-row">
                            <div class="flow-node decision">Loan Type?</div>
                        </div>
                        <div class="decision-branch">
                            <div class="branch">
                                <span class="branch-label">Conventional</span>
                                <div class="flow-node action">UCD Upload</div>
                            </div>
                            <div class="branch">
                                <span class="branch-label">2nd Lien/DPA</span>
                                <div class="flow-node action">UDM: Deactivated</div>
                            </div>
                            <div class="branch">
                                <span class="branch-label">All Types</span>
                                <div class="flow-node output">Enter Shipping Received Date</div>
                            </div>
                        </div>
                    </div>

                    <div class="decision-tree">
                        <h3>Conventional Loans - UCD Upload</h3>
                        <ul class="step-list">
                            <li><strong>Step 1:</strong> Upload Funding Package to investor system</li>
                            <li><strong>Step 2:</strong> Mark package as Approved in the system</li>
                            <li><strong>Step 3:</strong> Verify UCD (Uniform Closing Dataset) is properly formatted</li>
                        </ul>
                    </div>

                    <div class="decision-tree">
                        <h3>2nd Lien / DPA Loans</h3>
                        <ul class="step-list">
                            <li><strong>Step 1:</strong> Set UDM status to Deactivated</li>
                            <li><strong>Step 2:</strong> Verify Note, DOT (Deed of Trust), and CD are present</li>
                            <li><strong>Step 3:</strong> Ensure all DPA program requirements are met</li>
                        </ul>
                    </div>

                    <div class="tip-box">
                        <h4>Shipping Received Date</h4>
                        <p>The Shipping Received Date must be entered for all loan types to track when the physical funding package was received.</p>
                    </div>
                </div>
            </section>

            <!-- Section 3: Borrower Documents -->
            <section id="section-3" class="section">
                <div class="section-header">
                    <div class="section-number">3</div>
                    <div class="section-title"><h2>Borrower Documents Review</h2><span>Verification of borrower identification and signed documents</span></div>
                </div>
                <div class="section-content">
                    <div class="workflow-diagram">
                        <div class="flow-row">
                            <div class="flow-node action">Review ID Documents</div>
                            <span class="flow-arrow">-></span>
                            <div class="flow-node action">Verify Signed CDs</div>
                            <span class="flow-arrow">-></span>
                            <div class="flow-node action">Check 1003 Signatures</div>
                            <span class="flow-arrow">-></span>
                            <div class="flow-node decision">All Complete?</div>
                        </div>
                        <div class="decision-branch">
                            <div class="branch">
                                <span class="branch-label">YES</span>
                                <div class="flow-node output">Continue to Loan Docs</div>
                            </div>
                            <div class="branch">
                                <span class="branch-label">NO</span>
                                <div class="flow-node exception">Request Missing Items</div>
                            </div>
                        </div>
                    </div>

                    <div class="checklist-container">
                        <h3 style="color: var(--accent-blue); margin-bottom: 15px;">Borrower Document Checklist</h3>

                        <div class="checklist-item">
                            <div class="checklist-box"></div>
                            <div class="checklist-text">
                                <strong>Identification (Passport, DL)</strong>
                                <div class="checklist-note">Credit cards must be DELETED from package - do not include</div>
                            </div>
                        </div>

                        <div class="checklist-item">
                            <div class="checklist-box"></div>
                            <div class="checklist-text">
                                <strong>Sellers Signed CD</strong>
                                <div class="checklist-note">Closing Disclosure signed by all sellers (purchases only)</div>
                            </div>
                        </div>

                        <div class="checklist-item">
                            <div class="checklist-box"></div>
                            <div class="checklist-text">
                                <strong>Borrowers Signed CD</strong>
                                <div class="checklist-note">Closing Disclosure signed by all borrowers</div>
                            </div>
                        </div>

                        <div class="checklist-item">
                            <div class="checklist-box"></div>
                            <div class="checklist-text">
                                <strong>1003 Uniform Residential Loan Application</strong>
                                <div class="checklist-note">If Initial 1003 is signed by LO - do NOT request signature. If Initial & Final are not signed - request signature</div>
                            </div>
                        </div>

                        <div class="checklist-item">
                            <div class="checklist-box"></div>
                            <div class="checklist-text">
                                <strong>Signature Affidavit and AKA Statement</strong>
                                <div class="checklist-note">Top AND bottom sections must be signed</div>
                            </div>
                        </div>

                        <div class="checklist-item">
                            <div class="checklist-box"></div>
                            <div class="checklist-text">
                                <strong>W-9 Request for Taxpayer ID Number and Certification</strong>
                            </div>
                        </div>

                        <div class="checklist-item">
                            <div class="checklist-box"></div>
                            <div class="checklist-text">
                                <strong>4506-T Request for Transcript of Tax Return</strong>
                            </div>
                        </div>

                        <div class="checklist-item">
                            <div class="checklist-box"></div>
                            <div class="checklist-text">
                                <strong>Occupancy Statement</strong>
                            </div>
                        </div>
                    </div>

                    <div class="exception-box">
                        <h4>Privacy Requirement</h4>
                        <p>Identification documents showing credit card numbers or other sensitive financial information must be redacted or removed from the funding package before submission.</p>
                    </div>
                </div>
            </section>

            <!-- Section 4: Loan Documents -->
            <section id="section-4" class="section">
                <div class="section-header">
                    <div class="section-number">4</div>
                    <div class="section-title"><h2>Loan Documents Review</h2><span>Core loan documents and legal instruments verification</span></div>
                </div>
                <div class="section-content">
                    <div class="workflow-diagram">
                        <div class="flow-row">
                            <div class="flow-node action">Review Note</div>
                            <span class="flow-arrow">-></span>
                            <div class="flow-node action">Verify DOT/Mortgage</div>
                            <span class="flow-arrow">-></span>
                            <div class="flow-node action">Check Riders</div>
                            <span class="flow-arrow">-></span>
                            <div class="flow-node output">Verify Legal Description</div>
                        </div>
                    </div>

                    <div class="checklist-container">
                        <h3 style="color: var(--accent-blue); margin-bottom: 15px;">Loan Document Checklist</h3>

                        <div class="checklist-item">
                            <div class="checklist-box"></div>
                            <div class="checklist-text">
                                <strong>Note and Addendums</strong>
                                <div class="checklist-note">Include all applicable addendums to the promissory note</div>
                            </div>
                        </div>

                        <div class="checklist-item">
                            <div class="checklist-box"></div>
                            <div class="checklist-text">
                                <strong>Warranty Deed</strong>
                                <div class="checklist-note">PURCHASES ONLY - verify property transfer documentation</div>
                            </div>
                        </div>

                        <div class="checklist-item">
                            <div class="checklist-box"></div>
                            <div class="checklist-text">
                                <strong>Mortgage or Deed of Trust</strong>
                                <div class="checklist-note">Verify legal description and applicable riders are included</div>
                            </div>
                        </div>

                        <div class="checklist-item">
                            <div class="checklist-box"></div>
                            <div class="checklist-text">
                                <strong>Closing Instructions and Addendum</strong>
                                <div class="checklist-note">FHA ONLY: Include addendum to closing instructions</div>
                            </div>
                        </div>

                        <div class="checklist-item">
                            <div class="checklist-box"></div>
                            <div class="checklist-text">
                                <strong>Fee Details Form and Fee Worksheet</strong>
                            </div>
                        </div>

                        <div class="checklist-item">
                            <div class="checklist-box"></div>
                            <div class="checklist-text">
                                <strong>Net Funding Worksheet</strong>
                            </div>
                        </div>

                        <div class="checklist-item">
                            <div class="checklist-box"></div>
                            <div class="checklist-text">
                                <strong>Amortization Schedule</strong>
                            </div>
                        </div>

                        <div class="checklist-item">
                            <div class="checklist-box"></div>
                            <div class="checklist-text">
                                <strong>Compliance Agreement</strong>
                            </div>
                        </div>
                    </div>

                    <table class="field-table">
                        <thead>
                            <tr>
                                <th>Document</th>
                                <th>Loan Type</th>
                                <th>Special Instructions</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td><strong>Warranty Deed</strong></td>
                                <td>Purchase Only</td>
                                <td>Verify seller to buyer transfer</td>
                            </tr>
                            <tr>
                                <td><strong>DOT Riders</strong></td>
                                <td>If Applicable</td>
                                <td>ARM, Condo, PUD, 2-4 Family, etc.</td>
                            </tr>
                            <tr>
                                <td><strong>Closing Instructions Addendum</strong></td>
                                <td>FHA Only</td>
                                <td>Must accompany closing instructions</td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </section>

            <!-- Section 5: Disclosures & Forms -->
            <section id="section-5" class="section">
                <div class="section-header">
                    <div class="section-number">5</div>
                    <div class="section-title"><h2>Disclosures & Forms</h2><span>Required disclosures and regulatory forms</span></div>
                </div>
                <div class="section-content">
                    <div class="checklist-container">
                        <h3 style="color: var(--accent-blue); margin-bottom: 15px;">Disclosure Checklist</h3>

                        <div class="checklist-item">
                            <div class="checklist-box"></div>
                            <div class="checklist-text">
                                <strong>Initial Escrow Account Disclosure Statement</strong>
                            </div>
                        </div>

                        <div class="checklist-item">
                            <div class="checklist-box"></div>
                            <div class="checklist-text">
                                <strong>First Payment Letter</strong>
                                <div class="checklist-note">Verify Mailing Disclosure is correct in system</div>
                            </div>
                        </div>

                        <div class="checklist-item">
                            <div class="checklist-box"></div>
                            <div class="checklist-text">
                                <strong>Patriot Act Disclosure</strong>
                            </div>
                        </div>

                        <div class="checklist-item">
                            <div class="checklist-box"></div>
                            <div class="checklist-text">
                                <strong>Texas Disclosures</strong>
                                <div class="checklist-note">TX LOANS ONLY - state-specific requirements</div>
                            </div>
                        </div>

                        <div class="checklist-item">
                            <div class="checklist-box"></div>
                            <div class="checklist-text">
                                <strong>Notice of Right to Cancel</strong>
                                <div class="checklist-note">REFINANCE ONLY - 3-day rescission period documentation</div>
                            </div>
                        </div>

                        <div class="checklist-item">
                            <div class="checklist-box"></div>
                            <div class="checklist-text">
                                <strong>Escrow Waiver</strong>
                                <div class="checklist-note">Check Section G in CD pg. 2 - Blank field/Not Escrow = Waived</div>
                            </div>
                        </div>
                    </div>

                    <div class="info-box">
                        <h4>Refinance-Specific Requirements</h4>
                        <ul style="margin-top: 10px; margin-left: 20px;">
                            <li><strong>Notice of Right to Cancel:</strong> Required for all refinance transactions</li>
                            <li><strong>Payoff Demand:</strong> Must be dated within 30 days of closing</li>
                        </ul>
                    </div>

                    <div class="tip-box">
                        <h4>Escrow Waiver Verification</h4>
                        <p>To verify escrow waiver status, check Section G on page 2 of the Closing Disclosure. If the field is blank or shows "Not Escrow," the escrow has been waived.</p>
                    </div>
                </div>
            </section>

            <!-- Section 6: Insurance & Property -->
            <section id="section-6" class="section">
                <div class="section-header">
                    <div class="section-number">6</div>
                    <div class="section-title"><h2>Insurance & Property Documents</h2><span>Hazard insurance, flood, and property tax documentation</span></div>
                </div>
                <div class="section-content">
                    <div class="workflow-diagram">
                        <div class="flow-row">
                            <div class="flow-node action">Verify Hazard Insurance</div>
                            <span class="flow-arrow">-></span>
                            <div class="flow-node decision">Flood Zone?</div>
                        </div>
                        <div class="decision-branch">
                            <div class="branch">
                                <span class="branch-label">YES</span>
                                <div class="flow-node exception">Flood Insurance Required</div>
                            </div>
                            <div class="branch">
                                <span class="branch-label">NO</span>
                                <div class="flow-node output">Document "Not in Flood Hazard Area"</div>
                            </div>
                        </div>
                    </div>

                    <div class="checklist-container">
                        <h3 style="color: var(--accent-blue); margin-bottom: 15px;">Insurance & Property Checklist</h3>

                        <div class="checklist-item">
                            <div class="checklist-box"></div>
                            <div class="checklist-text">
                                <strong>Hazard Insurance</strong>
                                <div class="checklist-note">Include Required Notice and verify property is NOT in a flood hazard area</div>
                            </div>
                        </div>

                        <div class="checklist-item">
                            <div class="checklist-box"></div>
                            <div class="checklist-text">
                                <strong>Payoff Demand</strong>
                                <div class="checklist-note">REFINANCE ONLY - must be dated within 30 days</div>
                            </div>
                        </div>

                        <div class="checklist-item">
                            <div class="checklist-box"></div>
                            <div class="checklist-text">
                                <strong>Tax Record Information Sheet / Tax Certificate</strong>
                            </div>
                        </div>
                    </div>

                    <div class="exception-box">
                        <h4>Payoff Demand Dating Requirement</h4>
                        <p>For refinance transactions, the payoff demand letter must be dated within 30 days of the closing date. Expired payoffs require a new payoff statement to be obtained.</p>
                    </div>
                </div>
            </section>

            <!-- Section 7: Government Loans -->
            <section id="section-7" class="section">
                <div class="section-header">
                    <div class="section-number">7</div>
                    <div class="section-title"><h2>Government Loan Requirements</h2><span>FHA and VA specific documentation requirements</span></div>
                </div>
                <div class="section-content">
                    <div class="workflow-diagram">
                        <div class="flow-row">
                            <div class="flow-node decision">Loan Type?</div>
                        </div>
                        <div class="decision-branch">
                            <div class="branch">
                                <span class="branch-label">FHA</span>
                                <div class="flow-node action">92900 + Settlement Cert</div>
                            </div>
                            <div class="branch">
                                <span class="branch-label">VA</span>
                                <div class="flow-node action">26-1820 Verification</div>
                            </div>
                        </div>
                    </div>

                    <div class="exception-box">
                        <h4>CRITICAL: Government Loan Suspension Warning</h4>
                        <p><strong>FHA AND VA WILL SUSPEND IF DOCUMENTS ARE NOT COMPLETE.</strong> All government loan documents must be signed by ALL parties before submission.</p>
                    </div>

                    <div class="decision-tree">
                        <h3>FHA Loan Requirements</h3>
                        <div class="checklist-container" style="margin-top: 15px;">
                            <div class="checklist-item">
                                <div class="checklist-box"></div>
                                <div class="checklist-text">
                                    <strong>Form 92900</strong>
                                    <div class="checklist-note">Closer/Funder to sign first and last pages. Underwriter to sign page 3.</div>
                                </div>
                            </div>

                            <div class="checklist-item">
                                <div class="checklist-box"></div>
                                <div class="checklist-text">
                                    <strong>Settlement Certification</strong>
                                    <div class="checklist-note">Date from Purchase & Sale Agreement. Upload separately and label as "FHA MISC - Settlement Certification"</div>
                                </div>
                            </div>

                            <div class="checklist-item">
                                <div class="checklist-box"></div>
                                <div class="checklist-text">
                                    <strong>Closing Instructions Addendum</strong>
                                    <div class="checklist-note">FHA-specific addendum required</div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="decision-tree">
                        <h3>VA Loan Requirements</h3>
                        <div class="checklist-container" style="margin-top: 15px;">
                            <div class="checklist-item">
                                <div class="checklist-box"></div>
                                <div class="checklist-text">
                                    <strong>VA Form 26-1820</strong>
                                    <div class="checklist-note">
                                        <ul style="margin-left: 20px; margin-top: 5px;">
                                            <li>Page 2 Item B must be checked</li>
                                            <li>Page 2 Section 26A and B must be dated and signed</li>
                                            <li>For VA: Only the first 2 pages are required for Form 92900</li>
                                        </ul>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <table class="field-table">
                        <thead>
                            <tr>
                                <th>Form</th>
                                <th>Loan Type</th>
                                <th>Signature Requirements</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td><strong>92900</strong></td>
                                <td>FHA</td>
                                <td>Closer/Funder: pg 1 & last; UW: pg 3</td>
                            </tr>
                            <tr>
                                <td><strong>92900</strong></td>
                                <td>VA</td>
                                <td>First 2 pages only required</td>
                            </tr>
                            <tr>
                                <td><strong>26-1820</strong></td>
                                <td>VA</td>
                                <td>Pg 2 Item B checked; 26A/B dated & signed</td>
                            </tr>
                            <tr>
                                <td><strong>Settlement Cert</strong></td>
                                <td>FHA</td>
                                <td>Upload as "FHA MISC - Settlement Certification"</td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </section>

            <!-- Section 8: Special Programs -->
            <section id="section-8" class="section">
                <div class="section-header">
                    <div class="section-number">8</div>
                    <div class="section-title"><h2>Special Programs & Construction</h2><span>Additional documentation for special loan programs</span></div>
                </div>
                <div class="section-content">
                    <div class="checklist-container">
                        <h3 style="color: var(--accent-blue); margin-bottom: 15px;">Construction Loans Checklist</h3>

                        <div class="checklist-item">
                            <div class="checklist-box"></div>
                            <div class="checklist-text">
                                <strong>203K Documentation</strong>
                                <div class="checklist-note">All 203K program documents must be complete</div>
                            </div>
                        </div>

                        <div class="checklist-item">
                            <div class="checklist-box"></div>
                            <div class="checklist-text">
                                <strong>Warranty of Completion</strong>
                            </div>
                        </div>

                        <div class="checklist-item">
                            <div class="checklist-box"></div>
                            <div class="checklist-text">
                                <strong>10-Year Warranty</strong>
                            </div>
                        </div>

                        <div class="checklist-item">
                            <div class="checklist-box"></div>
                            <div class="checklist-text">
                                <strong>Termite Inspection / All Docs</strong>
                                <div class="checklist-note">ALL construction documents must be signed by ALL parties</div>
                            </div>
                        </div>
                    </div>

                    <div class="checklist-container">
                        <h3 style="color: var(--accent-blue); margin-bottom: 15px;">Additional Programs (If Applicable)</h3>

                        <div class="checklist-item">
                            <div class="checklist-box"></div>
                            <div class="checklist-text">
                                <strong>MCC (Mortgage Credit Certificate)</strong>
                                <div class="checklist-note">State-issued tax credit documentation</div>
                            </div>
                        </div>

                        <div class="checklist-item">
                            <div class="checklist-box"></div>
                            <div class="checklist-text">
                                <strong>USDA Documentation</strong>
                                <div class="checklist-note">USDA Rural Development specific forms</div>
                            </div>
                        </div>

                        <div class="checklist-item">
                            <div class="checklist-box"></div>
                            <div class="checklist-text">
                                <strong>MI (Mortgage Insurance) Documentation</strong>
                                <div class="checklist-note">Private mortgage insurance certificates and disclosures</div>
                            </div>
                        </div>
                    </div>

                    <div class="info-box">
                        <h4>Construction Document Reminder</h4>
                        <p>For ALL construction loans (203K, new construction, etc.), verify that every document has been signed by ALL required parties before submitting the funding package.</p>
                    </div>

                    <div class="tip-box">
                        <h4>Final Step: Conversation Log</h4>
                        <p>After completing all checklist items, add detailed notes to the Conversation Log documenting the QC review completion, any issues found and resolved, and confirmation that all funder conditions have been cleared.</p>
                    </div>
                </div>
            </section>

            <!-- Quick Reference -->
            <div id="quick-ref" class="quick-ref">
                <h3>Funder QC Checklist Quick Reference</h3>
                <pre>
FUNDER QC CHECKLIST - QUICK REFERENCE
=====================================

CRITICAL REMINDERS
------------------
[ ] DO NOT leave any Funder Conditions open
[ ] Add notes to Conversation Log
[ ] BOND LOANS: Refer to State Checklist
[ ] Credit cards DELETED from ID documents
[ ] GOV'T LOANS: All parties must sign

LOAN TYPE ACTIONS
-----------------
CONVENTIONAL:  UCD Upload -> Mark as Approved
2ND LIEN/DPA:  UDM: Deactivated -> Note, DOT, CD
ALL TYPES:     Enter Shipping Received Date

SIGNATURE REQUIREMENTS
----------------------
1003:     LO signed initial = OK | Both unsigned = Request
92900:    FHA: Closer/Funder pg 1&last, UW pg 3
          VA: First 2 pages only
26-1820:  Pg 2 Item B checked, 26A/B dated & signed
Sig Aff:  Top AND bottom signed

REFINANCE ONLY
--------------
[ ] Notice of Right to Cancel
[ ] Payoff Demand (dated within 30 days)

PURCHASES ONLY
--------------
[ ] Warranty Deed
[ ] Sellers Signed CD

FHA SPECIFIC
------------
[ ] Settlement Certification (Date from P&S)
    Upload as: "FHA MISC - Settlement Certification"
[ ] Closing Instructions Addendum

VA SPECIFIC
-----------
[ ] Form 26-1820 verification
[ ] Page 2 Item B checked
[ ] Section 26A and B dated and signed

CONSTRUCTION LOANS
------------------
[ ] 203K Documentation
[ ] Warranty of Completion
[ ] 10-Year Warranty
[ ] Termite - ALL docs signed by ALL parties

ADDITIONAL IF APPLICABLE
------------------------
[ ] MCC Documentation
[ ] USDA Documentation
[ ] MI Documentation
[ ] Texas Disclosures (TX loans only)
                </pre>
            </div>
        </div>

        <!-- ==================== AI AGENTS TAB ==================== -->
        <div id="agents-panel" class="tab-panel">
            <!-- Agent Header -->
            <div class="agent-header">
                <h1>AI Agent Opportunities</h1>
                <p class="subtitle">Automation opportunities identified for the Funder QC Checklist process</p>
            </div>

            <!-- Summary Stats -->
            <div class="agent-summary" id="agent-summary">
                <div class="agent-summary-card">
                    <div class="agent-summary-value">5</div>
                    <div class="agent-summary-label">Agent Opportunities</div>
                </div>
                <div class="agent-summary-card">
                    <div class="agent-summary-value">78%</div>
                    <div class="agent-summary-label">Automation Potential</div>
                </div>
                <div class="agent-summary-card">
                    <div class="agent-summary-value">12 min</div>
                    <div class="agent-summary-label">Est. Time Saved</div>
                </div>
                <div class="agent-summary-card">
                    <div class="agent-summary-value">Critical</div>
                    <div class="agent-summary-label">Compliance Impact</div>
                </div>
            </div>

            <!-- Heat Map Legend -->
            <div class="heat-legend">
                <div class="heat-legend-item">
                    <div class="heat-legend-color" style="background: linear-gradient(90deg, #ef4444, #f97316);"></div>
                    <span>Critical Priority (9-10)</span>
                </div>
                <div class="heat-legend-item">
                    <div class="heat-legend-color" style="background: linear-gradient(90deg, #f97316, #eab308);"></div>
                    <span>High Priority (7-8)</span>
                </div>
                <div class="heat-legend-item">
                    <div class="heat-legend-color" style="background: linear-gradient(90deg, #eab308, #22c55e);"></div>
                    <span>Medium Priority (5-6)</span>
                </div>
                <div class="heat-legend-item">
                    <div class="heat-legend-color" style="background: linear-gradient(90deg, #22c55e, #14b8a6);"></div>
                    <span>Low Priority (1-4)</span>
                </div>
            </div>

            <!-- Heat Map Grid -->
            <div class="heat-map-container" id="agent-heatmap">
                <div class="heat-map-title">Priority Heat Map</div>
                <div class="heat-map-grid">
                    <div class="heat-item critical" onclick="scrollToAgent('agent-docverify')">
                        <div class="heat-score">9.5</div>
                        <div class="heat-name">Document Verification Agent</div>
                        <div class="heat-desc">Auto-verify presence and completeness of all required documents</div>
                        <div class="heat-metrics">
                            <div class="heat-metric">Time: <span>8 min</span></div>
                            <div class="heat-metric">Complexity: <span>Medium</span></div>
                        </div>
                    </div>
                    <div class="heat-item critical" onclick="scrollToAgent('agent-signature')">
                        <div class="heat-score">9.2</div>
                        <div class="heat-name">Signature Validation Agent</div>
                        <div class="heat-desc">Detect and validate required signatures on all forms</div>
                        <div class="heat-metrics">
                            <div class="heat-metric">Time: <span>5 min</span></div>
                            <div class="heat-metric">Complexity: <span>High</span></div>
                        </div>
                    </div>
                    <div class="heat-item high" onclick="scrollToAgent('agent-govcheck')">
                        <div class="heat-score">8.4</div>
                        <div class="heat-name">Government Loan Validator</div>
                        <div class="heat-desc">Verify FHA/VA specific form requirements automatically</div>
                        <div class="heat-metrics">
                            <div class="heat-metric">Time: <span>3 min</span></div>
                            <div class="heat-metric">Complexity: <span>Medium</span></div>
                        </div>
                    </div>
                    <div class="heat-item high" onclick="scrollToAgent('agent-condition')">
                        <div class="heat-score">7.8</div>
                        <div class="heat-name">Condition Tracker Agent</div>
                        <div class="heat-desc">Monitor and alert on open funder conditions</div>
                        <div class="heat-metrics">
                            <div class="heat-metric">Time: <span>2 min</span></div>
                            <div class="heat-metric">Complexity: <span>Low</span></div>
                        </div>
                    </div>
                    <div class="heat-item medium" onclick="scrollToAgent('agent-dateval')">
                        <div class="heat-score">6.5</div>
                        <div class="heat-name">Date Validation Agent</div>
                        <div class="heat-desc">Verify payoff demands and document dates are within requirements</div>
                        <div class="heat-metrics">
                            <div class="heat-metric">Time: <span>1 min</span></div>
                            <div class="heat-metric">Complexity: <span>Low</span></div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Agent Details -->
            <div id="agent-details">
                <h2 style="color: var(--text-primary); margin-bottom: 25px; font-size: 1.5rem;">Agent Details</h2>
                <div class="agent-grid">
                    <!-- Document Verification Agent -->
                    <div class="agent-card" id="agent-docverify">
                        <div class="agent-card-header">
                            <div class="agent-icon">D</div>
                            <div class="agent-info">
                                <div class="agent-name">Document Verification Agent</div>
                                <div class="agent-type">Document Analysis / OCR</div>
                            </div>
                            <span class="agent-priority critical">Critical</span>
                        </div>
                        <div class="agent-card-body">
                            <p class="agent-description">Automatically scans the funding package to verify presence and completeness of all required documents based on loan type. Uses OCR and document classification to identify missing items and generate a pre-populated checklist with pass/fail status.</p>
                            <div class="agent-flow">
                                <div class="agent-flow-title">Agent Flow</div>
                                <div class="agent-flow-diagram">
                                    <span class="agent-step">Scan Package</span>
                                    <span class="agent-arrow">-></span>
                                    <span class="agent-step">Classify Docs</span>
                                    <span class="agent-arrow">-></span>
                                    <span class="agent-step">Check Requirements</span>
                                    <span class="agent-arrow">-></span>
                                    <span class="agent-step">Generate Report</span>
                                </div>
                            </div>
                            <div class="agent-stats">
                                <div class="agent-stat">
                                    <div class="agent-stat-value">8 min</div>
                                    <div class="agent-stat-label">Time Saved</div>
                                </div>
                                <div class="agent-stat">
                                    <div class="agent-stat-value">97%</div>
                                    <div class="agent-stat-label">Accuracy</div>
                                </div>
                                <div class="agent-stat">
                                    <div class="agent-stat-value">Med</div>
                                    <div class="agent-stat-label">Complexity</div>
                                </div>
                            </div>
                            <button class="agent-prompt-btn" onclick="showAgentPrompt('docverify')">
                                View Build Prompt
                            </button>
                        </div>
                    </div>

                    <!-- Signature Validation Agent -->
                    <div class="agent-card" id="agent-signature">
                        <div class="agent-card-header">
                            <div class="agent-icon">S</div>
                            <div class="agent-info">
                                <div class="agent-name">Signature Validation Agent</div>
                                <div class="agent-type">Computer Vision / ML</div>
                            </div>
                            <span class="agent-priority critical">Critical</span>
                        </div>
                        <div class="agent-card-body">
                            <p class="agent-description">Uses computer vision to detect signature presence on required document locations. Validates that all parties have signed where required (e.g., 92900 pages, Signature Affidavit top/bottom, VA 26-1820 sections). Flags missing or incomplete signatures.</p>
                            <div class="agent-flow">
                                <div class="agent-flow-title">Agent Flow</div>
                                <div class="agent-flow-diagram">
                                    <span class="agent-step">Identify Forms</span>
                                    <span class="agent-arrow">-></span>
                                    <span class="agent-step">Locate Sig Fields</span>
                                    <span class="agent-arrow">-></span>
                                    <span class="agent-step">Detect Signatures</span>
                                    <span class="agent-arrow">-></span>
                                    <span class="agent-step">Validate</span>
                                </div>
                            </div>
                            <div class="agent-stats">
                                <div class="agent-stat">
                                    <div class="agent-stat-value">5 min</div>
                                    <div class="agent-stat-label">Time Saved</div>
                                </div>
                                <div class="agent-stat">
                                    <div class="agent-stat-value">94%</div>
                                    <div class="agent-stat-label">Accuracy</div>
                                </div>
                                <div class="agent-stat">
                                    <div class="agent-stat-value">High</div>
                                    <div class="agent-stat-label">Complexity</div>
                                </div>
                            </div>
                            <button class="agent-prompt-btn" onclick="showAgentPrompt('signature')">
                                View Build Prompt
                            </button>
                        </div>
                    </div>

                    <!-- Government Loan Validator -->
                    <div class="agent-card" id="agent-govcheck">
                        <div class="agent-card-header">
                            <div class="agent-icon">G</div>
                            <div class="agent-info">
                                <div class="agent-name">Government Loan Validator</div>
                                <div class="agent-type">Rule Engine / Validation</div>
                            </div>
                            <span class="agent-priority high">High</span>
                        </div>
                        <div class="agent-card-body">
                            <p class="agent-description">Specialized validator for FHA and VA loan requirements. Automatically checks Form 92900 signature locations, VA 26-1820 Item B status and Section 26A/B completion, Settlement Certification labeling, and prevents submission of incomplete government loan packages.</p>
                            <div class="agent-flow">
                                <div class="agent-flow-title">Agent Flow</div>
                                <div class="agent-flow-diagram">
                                    <span class="agent-step">Detect Loan Type</span>
                                    <span class="agent-arrow">-></span>
                                    <span class="agent-step">Load Rules</span>
                                    <span class="agent-arrow">-></span>
                                    <span class="agent-step">Validate Forms</span>
                                    <span class="agent-arrow">-></span>
                                    <span class="agent-step">Block/Allow</span>
                                </div>
                            </div>
                            <div class="agent-stats">
                                <div class="agent-stat">
                                    <div class="agent-stat-value">3 min</div>
                                    <div class="agent-stat-label">Time Saved</div>
                                </div>
                                <div class="agent-stat">
                                    <div class="agent-stat-value">99%</div>
                                    <div class="agent-stat-label">Accuracy</div>
                                </div>
                                <div class="agent-stat">
                                    <div class="agent-stat-value">Med</div>
                                    <div class="agent-stat-label">Complexity</div>
                                </div>
                            </div>
                            <button class="agent-prompt-btn" onclick="showAgentPrompt('govcheck')">
                                View Build Prompt
                            </button>
                        </div>
                    </div>

                    <!-- Condition Tracker Agent -->
                    <div class="agent-card" id="agent-condition">
                        <div class="agent-card-header">
                            <div class="agent-icon">C</div>
                            <div class="agent-info">
                                <div class="agent-name">Condition Tracker Agent</div>
                                <div class="agent-type">Monitoring / Alerts</div>
                            </div>
                            <span class="agent-priority high">High</span>
                        </div>
                        <div class="agent-card-body">
                            <p class="agent-description">Monitors all funder conditions in real-time and prevents funding submission when any conditions remain open. Sends proactive alerts to funders about outstanding conditions and auto-generates Conversation Log entries when conditions are cleared.</p>
                            <div class="agent-flow">
                                <div class="agent-flow-title">Agent Flow</div>
                                <div class="agent-flow-diagram">
                                    <span class="agent-step">Scan Conditions</span>
                                    <span class="agent-arrow">-></span>
                                    <span class="agent-step">Check Status</span>
                                    <span class="agent-arrow">-></span>
                                    <span class="agent-step">Alert/Block</span>
                                    <span class="agent-arrow">-></span>
                                    <span class="agent-step">Log Actions</span>
                                </div>
                            </div>
                            <div class="agent-stats">
                                <div class="agent-stat">
                                    <div class="agent-stat-value">2 min</div>
                                    <div class="agent-stat-label">Time Saved</div>
                                </div>
                                <div class="agent-stat">
                                    <div class="agent-stat-value">100%</div>
                                    <div class="agent-stat-label">Accuracy</div>
                                </div>
                                <div class="agent-stat">
                                    <div class="agent-stat-value">Low</div>
                                    <div class="agent-stat-label">Complexity</div>
                                </div>
                            </div>
                            <button class="agent-prompt-btn" onclick="showAgentPrompt('condition')">
                                View Build Prompt
                            </button>
                        </div>
                    </div>

                    <!-- Date Validation Agent -->
                    <div class="agent-card" id="agent-dateval">
                        <div class="agent-card-header">
                            <div class="agent-icon">T</div>
                            <div class="agent-info">
                                <div class="agent-name">Date Validation Agent</div>
                                <div class="agent-type">Data Extraction / Rules</div>
                            </div>
                            <span class="agent-priority medium">Medium</span>
                        </div>
                        <div class="agent-card-body">
                            <p class="agent-description">Extracts and validates dates from key documents. Ensures payoff demands are within 30 days, CPL dates are current, and Settlement Certification dates match P&S agreements. Flags expired or mismatched dates before funding.</p>
                            <div class="agent-flow">
                                <div class="agent-flow-title">Agent Flow</div>
                                <div class="agent-flow-diagram">
                                    <span class="agent-step">Extract Dates</span>
                                    <span class="agent-arrow">-></span>
                                    <span class="agent-step">Apply Rules</span>
                                    <span class="agent-arrow">-></span>
                                    <span class="agent-step">Compare</span>
                                    <span class="agent-arrow">-></span>
                                    <span class="agent-step">Flag Issues</span>
                                </div>
                            </div>
                            <div class="agent-stats">
                                <div class="agent-stat">
                                    <div class="agent-stat-value">1 min</div>
                                    <div class="agent-stat-label">Time Saved</div>
                                </div>
                                <div class="agent-stat">
                                    <div class="agent-stat-value">98%</div>
                                    <div class="agent-stat-label">Accuracy</div>
                                </div>
                                <div class="agent-stat">
                                    <div class="agent-stat-value">Low</div>
                                    <div class="agent-stat-label">Complexity</div>
                                </div>
                            </div>
                            <button class="agent-prompt-btn" onclick="showAgentPrompt('dateval')">
                                View Build Prompt
                            </button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </main>

    <!-- Documentation Modal -->
    <div class="modal-overlay" id="docModal">
        <div class="modal">
            <div class="modal-header">
                <h3>Funder QC Checklist Documentation</h3>
                <div class="modal-actions">
                    <button class="modal-btn copy" onclick="copyToClipboard()">Copy</button>
                    <button class="modal-btn close" onclick="closeDocModal()">Close</button>
                </div>
            </div>
            <div class="modal-body">
                <pre id="docContent"># Funder QC Checklist - Complete Review Guide

## Overview
The Funder QC Checklist ensures all loan documents are complete, properly signed, and compliant before funding. This checklist is critical for preventing suspensions and ensuring smooth loan delivery.

## Critical Reminders
- DO NOT leave any Funder Conditions open
- Add notes to Conversation Log
- BOND LOANS: Refer to State Checklist for additional requirements
- Government loans (FHA/VA) WILL SUSPEND if documents are incomplete

## Loan Type Actions
### Conventional Loans
- Upload Funding Package
- Mark as Approved
- UCD Upload required

### 2nd Lien / DPA
- Set UDM to Deactivated
- Verify Note, DOT, and CD

### All Loan Types
- Enter Shipping Received Date

## Borrower Documents
- Identification (Passport, DL) - credit cards DELETED
- Sellers Signed CD (purchases only)
- Borrowers Signed CD
- 1003 - LO signed = OK; unsigned = request
- Signature Affidavit (top AND bottom signed)
- W-9 and 4506-T
- Occupancy Statement

## Loan Documents
- Note and Addendums
- Warranty Deed (purchases only)
- Mortgage/Deed of Trust with legal description and riders
- Fee Details and Net Funding Worksheets
- Amortization Schedule
- Compliance Agreement

## Government Loan Requirements
### FHA
- Form 92900 (Closer/Funder: pg 1 & last; UW: pg 3)
- Settlement Certification (label as "FHA MISC")
- Closing Instructions Addendum

### VA
- Form 26-1820 (Pg 2 Item B checked; 26A/B dated & signed)
- First 2 pages of 92900 only

## Refinance-Specific
- Notice of Right to Cancel
- Payoff Demand (dated within 30 days)

## Document ID: RET220/020720</pre>
            </div>
        </div>
    </div>

    <!-- AI Prompt Modal -->
    <div class="modal-overlay prompt-modal" id="promptModal">
        <div class="modal">
            <div class="modal-header">
                <h3 id="promptModalTitle">AI Agent Build Prompt</h3>
                <div class="modal-actions">
                    <button class="modal-btn copy" onclick="copyPromptToClipboard()">Copy Prompt</button>
                    <button class="modal-btn close" onclick="closePromptModal()">Close</button>
                </div>
            </div>
            <div class="modal-body">
                <div class="prompt-tags" id="promptTags"></div>
                <div class="prompt-section">
                    <h4>Agent Purpose</h4>
                    <div class="prompt-box" id="promptPurpose"></div>
                </div>
                <div class="prompt-section">
                    <h4>Full Build Prompt</h4>
                    <div class="prompt-box" id="promptContent"></div>
                </div>
                <div class="prompt-section">
                    <h4>Integration Points</h4>
                    <div class="prompt-box" id="promptIntegration"></div>
                </div>
            </div>
        </div>
    </div>

    <div class="copy-success" id="copySuccess">Copied to clipboard!</div>

    <script>
        // Tab switching
        function switchTab(tab) {
            document.querySelectorAll('.sidebar-tab').forEach(t => t.classList.remove('active'));
            document.querySelectorAll('.tab-panel').forEach(p => p.classList.remove('active'));

            if (tab === 'workflow') {
                document.querySelector('.sidebar-tab:not(.agent-tab)').classList.add('active');
                document.getElementById('workflow-panel').classList.add('active');
                document.getElementById('workflow-nav').style.display = 'block';
                document.getElementById('agents-nav').style.display = 'none';
            } else {
                document.querySelector('.sidebar-tab.agent-tab').classList.add('active');
                document.getElementById('agents-panel').classList.add('active');
                document.getElementById('workflow-nav').style.display = 'none';
                document.getElementById('agents-nav').style.display = 'block';
            }

            window.scrollTo(0, 0);
        }

        // Scroll spy with isScrolling flag and 1000ms timeout
        const sections = document.querySelectorAll('.section, .quick-ref');
        const navItems = document.querySelectorAll('#workflow-nav .nav-item');
        let isScrolling = false;
        let scrollTimeout;

        function updateActiveNav() {
            if (isScrolling) return;

            let current = '';
            sections.forEach(section => {
                const sectionTop = section.offsetTop - 100;
                if (window.scrollY >= sectionTop) current = section.getAttribute('id');
            });
            navItems.forEach(item => {
                item.classList.remove('active');
                if (item.getAttribute('href') === '#' + current) item.classList.add('active');
            });
        }

        // Handle nav click to temporarily disable scroll spy
        navItems.forEach(item => {
            item.addEventListener('click', function(e) {
                isScrolling = true;
                clearTimeout(scrollTimeout);

                // Remove active from all, add to clicked
                navItems.forEach(nav => nav.classList.remove('active'));
                this.classList.add('active');

                // Re-enable scroll spy after 1000ms
                scrollTimeout = setTimeout(() => {
                    isScrolling = false;
                }, 1000);
            });
        });

        window.addEventListener('scroll', updateActiveNav);

        // Modal
        function openDocModal() {
            document.getElementById('docModal').classList.add('show');
            document.body.style.overflow = 'hidden';
        }

        function closeDocModal() {
            document.getElementById('docModal').classList.remove('show');
            document.body.style.overflow = '';
        }

        async function copyToClipboard() {
            try {
                await navigator.clipboard.writeText(document.getElementById('docContent').textContent);
                const success = document.getElementById('copySuccess');
                success.style.display = 'block';
                setTimeout(() => { success.style.display = 'none'; }, 2000);
            } catch (e) { alert('Failed to copy.'); }
        }

        document.addEventListener('keydown', (e) => { if (e.key === 'Escape') { closeDocModal(); closePromptModal(); } });
        document.getElementById('docModal').addEventListener('click', (e) => { if (e.target.id === 'docModal') closeDocModal(); });

        document.addEventListener('DOMContentLoaded', () => { updateActiveNav(); });

        // Scroll to agent card and highlight
        function scrollToAgent(agentId) {
            const agentCard = document.getElementById(agentId);
            if (agentCard) {
                document.querySelectorAll('.agent-card.highlight').forEach(card => {
                    card.classList.remove('highlight');
                });

                agentCard.scrollIntoView({ behavior: 'smooth', block: 'center' });

                setTimeout(() => {
                    agentCard.classList.add('highlight');
                }, 300);

                setTimeout(() => {
                    agentCard.classList.remove('highlight');
                }, 2500);
            }
        }

        // Agent Prompt System
        const agentPrompts = {
            docverify: {
                name: 'Document Verification Agent',
                tags: ['Document Analysis', 'OCR', 'Medium Complexity', 'Critical Priority'],
                purpose: `This agent automatically scans the entire funding package to verify presence and completeness of all required documents based on loan type. It uses OCR and document classification to identify missing items and generates a pre-populated checklist with pass/fail status for each required document.`,
                prompt: `You are building a Document Verification Agent for the Funder QC Checklist process.

AGENT NAME: Document Verification Agent
TYPE: Document Analysis / OCR / Classification

OBJECTIVE:
Create an agent that automatically scans funding packages, classifies documents, and verifies completeness against loan-type-specific requirements.

INPUT DATA:
- Funding package (PDF/images)
- Loan type (Conventional, FHA, VA, USDA, Bond, etc.)
- Transaction type (Purchase, Refinance)
- State (for state-specific requirements)

DOCUMENT CLASSIFICATION MODEL:
Train on document types:
- Closing Disclosure (Borrower/Seller)
- 1003 URLA
- Note and Addendums
- Deed of Trust / Mortgage
- Warranty Deed
- Form 92900 (FHA/VA)
- VA 26-1820
- Settlement Certification
- W-9, 4506-T
- Insurance documents
- Payoff statements

REQUIREMENT RULES ENGINE:
{
  "ALL_LOANS": ["CD_Borrower", "1003", "Note", "DOT", "W9", "4506T"],
  "PURCHASE": ["CD_Seller", "Warranty_Deed"],
  "REFINANCE": ["Right_to_Cancel", "Payoff_Demand"],
  "FHA": ["92900", "Settlement_Cert", "Closing_Addendum"],
  "VA": ["26_1820", "92900_partial"],
  "TX": ["Texas_Disclosures"]
}

OUTPUT:
{
  "loan_number": "2026-001234",
  "loan_type": "FHA",
  "transaction_type": "Purchase",
  "documents_found": [...],
  "documents_missing": [...],
  "checklist": [
    { "item": "Borrowers Signed CD", "status": "PASS", "page": 12 },
    { "item": "Settlement Certification", "status": "FAIL", "note": "Not found" }
  ],
  "overall_status": "INCOMPLETE",
  "missing_count": 2
}`,
                integration: `INTEGRATION POINTS:
1. Document Storage
   - Connect to LOS document repository
   - Scan uploaded funding packages
   - Index by document type

2. OCR Engine
   - Azure Form Recognizer or AWS Textract
   - Custom model for mortgage docs
   - High-accuracy text extraction

3. Classification Model
   - TensorFlow/PyTorch classifier
   - 95%+ accuracy target
   - Continuous learning from corrections

4. LOS Integration
   - Update checklist status in real-time
   - Flag missing documents
   - Generate condition requests

5. Reporting
   - Dashboard with package status
   - Missing document alerts
   - Compliance metrics`
            },
            signature: {
                name: 'Signature Validation Agent',
                tags: ['Computer Vision', 'ML', 'High Complexity', 'Critical Priority'],
                purpose: `This agent uses computer vision to detect signature presence on required document locations. It validates that all parties have signed where required, including complex multi-page signature requirements like Form 92900 and VA 26-1820. Flags missing or incomplete signatures before funding.`,
                prompt: `You are building a Signature Validation Agent for the Funder QC Checklist process.

AGENT NAME: Signature Validation Agent
TYPE: Computer Vision / Machine Learning

OBJECTIVE:
Detect and validate required signatures on all loan documents, ensuring compliance with specific signing requirements per form type.

SIGNATURE DETECTION MODEL:
- Train CNN model on signature vs. non-signature regions
- Handle various signature styles (cursive, printed, initials)
- Detect absence of signature in required fields
- Confidence threshold: 85%

SIGNATURE LOCATION RULES:
{
  "1003": {
    "pages": ["first", "last"],
    "signers": ["borrower", "co_borrower", "LO"],
    "rule": "LO_signed_initial_OK_else_request"
  },
  "92900_FHA": {
    "page_1": ["closer", "funder"],
    "page_3": ["underwriter"],
    "last_page": ["closer", "funder"]
  },
  "92900_VA": {
    "pages": [1, 2],
    "signers": ["all_required"]
  },
  "26_1820": {
    "page_2": {
      "item_B": "checkbox_required",
      "section_26A": "date_and_signature",
      "section_26B": "date_and_signature"
    }
  },
  "Signature_Affidavit": {
    "top": "all_borrowers",
    "bottom": "all_borrowers"
  }
}

PROCESSING STEPS:
1. Identify document type
2. Load signature requirements
3. Locate signature regions (ML model)
4. Detect signature presence
5. Match signer count to requirement
6. Generate validation report

OUTPUT:
{
  "document": "Form 92900",
  "loan_type": "FHA",
  "validations": [
    { "location": "Page 1 - Closer/Funder", "status": "SIGNED", "confidence": 0.94 },
    { "location": "Page 3 - Underwriter", "status": "MISSING", "confidence": 0.98 }
  ],
  "overall_status": "INCOMPLETE",
  "action_required": "Request UW signature on page 3"
}`,
                integration: `INTEGRATION POINTS:
1. Computer Vision
   - OpenCV for image processing
   - TensorFlow/PyTorch for ML model
   - Pre-trained signature detection

2. Document Parsing
   - PDF to image conversion
   - Page detection and ordering
   - Region of interest extraction

3. Form Template Database
   - Store signature locations per form
   - Version control for form updates
   - State-specific variations

4. LOS Integration
   - Update signature status
   - Generate re-signing requests
   - Track signature completion

5. Audit Trail
   - Log all validations
   - Store confidence scores
   - Enable human review queue`
            },
            govcheck: {
                name: 'Government Loan Validator',
                tags: ['Rule Engine', 'Validation', 'Medium Complexity', 'High Priority'],
                purpose: `This specialized validator focuses on FHA and VA loan requirements. It automatically checks Form 92900 signature locations, VA 26-1820 Item B checkbox status and Section 26A/B completion, Settlement Certification proper labeling, and prevents submission of incomplete government loan packages.`,
                prompt: `You are building a Government Loan Validator Agent for the Funder QC Checklist process.

AGENT NAME: Government Loan Validator
TYPE: Rule Engine / Compliance Validation

OBJECTIVE:
Ensure all FHA and VA specific requirements are met before allowing funding package submission, preventing suspensions.

FHA VALIDATION RULES:
{
  "form_92900": {
    "page_1": {
      "closer_signature": "required",
      "funder_signature": "required"
    },
    "page_3": {
      "underwriter_signature": "required"
    },
    "last_page": {
      "closer_signature": "required",
      "funder_signature": "required"
    }
  },
  "settlement_certification": {
    "present": "required",
    "date_source": "P&S_Agreement",
    "label": "FHA MISC - Settlement Certification",
    "upload_location": "separate"
  },
  "closing_instructions_addendum": {
    "present": "required"
  }
}

VA VALIDATION RULES:
{
  "form_92900": {
    "pages_required": [1, 2],
    "note": "Only first 2 pages required for VA"
  },
  "form_26_1820": {
    "page_2": {
      "item_B": {
        "type": "checkbox",
        "status": "must_be_checked"
      },
      "section_26A": {
        "date": "required",
        "signature": "required"
      },
      "section_26B": {
        "date": "required",
        "signature": "required"
      }
    }
  }
}

BLOCKING LOGIC:
- If ANY required item is missing/incomplete: BLOCK submission
- Generate detailed error list
- Provide specific remediation steps

OUTPUT:
{
  "loan_type": "VA",
  "validation_status": "BLOCKED",
  "errors": [
    { "form": "26-1820", "issue": "Page 2 Item B not checked", "severity": "CRITICAL" },
    { "form": "26-1820", "issue": "Section 26A missing date", "severity": "CRITICAL" }
  ],
  "can_submit": false,
  "remediation": "Complete VA 26-1820 Page 2 requirements before submission"
}`,
                integration: `INTEGRATION POINTS:
1. Rule Engine
   - Drools or custom rules processor
   - Version-controlled rule sets
   - Agency guideline updates

2. Form Detection
   - Identify government forms in package
   - Extract specific fields/checkboxes
   - OCR for form completion status

3. Submission Gateway
   - Pre-submission validation hook
   - Block incomplete packages
   - Generate error reports

4. Agency Systems
   - FHA Connection preparation
   - VA WebLGY readiness check
   - Pre-flight validation

5. Alert System
   - Immediate notification of failures
   - Escalation for repeated issues
   - Compliance dashboard`
            },
            condition: {
                name: 'Condition Tracker Agent',
                tags: ['Monitoring', 'Alerts', 'Low Complexity', 'High Priority'],
                purpose: `This agent monitors all funder conditions in real-time and prevents funding submission when any conditions remain open. It sends proactive alerts about outstanding conditions and automatically generates Conversation Log entries when conditions are cleared or when blocking submission.`,
                prompt: `You are building a Condition Tracker Agent for the Funder QC Checklist process.

AGENT NAME: Condition Tracker Agent
TYPE: Monitoring / Workflow Automation

OBJECTIVE:
Ensure no loans are funded with open conditions, provide real-time visibility into condition status, and automate condition-related documentation.

MONITORING RULES:
{
  "scan_frequency": "real-time",
  "condition_types": ["funder", "prior_to_funding", "PTF"],
  "block_on_open": true,
  "alert_thresholds": {
    "warning": 24, // hours until target fund date
    "urgent": 12,
    "critical": 4
  }
}

CONDITION STATES:
- OPEN: Not yet satisfied
- PENDING_REVIEW: Documents submitted, awaiting approval
- SATISFIED: Condition cleared
- WAIVED: Approved waiver on file

ALERT CHANNELS:
- LOS notification
- Email to funder
- Dashboard highlight
- Slack/Teams webhook

AUTO-DOCUMENTATION:
On condition clear:
{
  "action": "add_convo_log",
  "message": "Condition [ID] - [Description] cleared by [User] at [Timestamp]",
  "attach_docs": true
}

On submission block:
{
  "action": "add_convo_log",
  "message": "Funding submission BLOCKED - [X] open conditions remain. See condition list for details.",
  "list_conditions": true
}

OUTPUT:
{
  "loan_number": "2026-001234",
  "total_conditions": 5,
  "open_conditions": 2,
  "pending_review": 1,
  "satisfied": 2,
  "can_fund": false,
  "blocking_conditions": [
    { "id": "PTF-001", "description": "Final Payoff Statement", "days_open": 3 },
    { "id": "PTF-002", "description": "Corrected CD", "days_open": 1 }
  ],
  "convo_log_entries": 3
}`,
                integration: `INTEGRATION POINTS:
1. LOS Conditions Module
   - Real-time condition status API
   - Webhook for status changes
   - Condition history tracking

2. Workflow Engine
   - Pre-funding gate
   - Condition satisfaction triggers
   - Automated escalation

3. Notification Service
   - Multi-channel alerts
   - User preferences
   - Digest vs. immediate

4. Conversation Log
   - Auto-generate entries
   - Link to conditions
   - Audit trail

5. Reporting
   - Condition aging reports
   - Funder performance metrics
   - Compliance tracking`
            },
            dateval: {
                name: 'Date Validation Agent',
                tags: ['Data Extraction', 'Rules', 'Low Complexity', 'Medium Priority'],
                purpose: `This agent extracts and validates dates from key documents to ensure compliance with timing requirements. It ensures payoff demands are within 30 days, CPL dates are current, Settlement Certification dates match P&S agreements, and flags any expired or mismatched dates before funding.`,
                prompt: `You are building a Date Validation Agent for the Funder QC Checklist process.

AGENT NAME: Date Validation Agent
TYPE: Data Extraction / Rules Validation

OBJECTIVE:
Extract dates from funding documents and validate against business rules to prevent funding with expired or invalid documentation.

DATE EXTRACTION TARGETS:
{
  "payoff_demand": {
    "extract_from": "Payoff Statement",
    "field": "Statement Date",
    "applies_to": "REFINANCE"
  },
  "cpl_date": {
    "extract_from": "Closing Protection Letter",
    "field": "Issue Date"
  },
  "settlement_cert_date": {
    "extract_from": "Settlement Certification",
    "field": "Date",
    "cross_reference": "P&S Agreement Date"
  },
  "closing_date": {
    "extract_from": "Closing Disclosure",
    "field": "Closing Date"
  }
}

VALIDATION RULES:
{
  "payoff_demand": {
    "max_age_days": 30,
    "compare_to": "closing_date",
    "error": "Payoff demand expired - must be within 30 days"
  },
  "cpl_date": {
    "must_be": "current",
    "error": "CPL date not current"
  },
  "settlement_cert": {
    "must_match": "p_and_s_date",
    "error": "Settlement Cert date does not match P&S"
  }
}

PROCESSING:
1. OCR extract target fields
2. Parse dates (handle multiple formats)
3. Calculate date differences
4. Apply validation rules
5. Generate report

OUTPUT:
{
  "loan_number": "2026-001234",
  "transaction_type": "REFINANCE",
  "closing_date": "2026-01-25",
  "validations": [
    {
      "document": "Payoff Demand",
      "extracted_date": "2025-12-20",
      "days_old": 36,
      "max_allowed": 30,
      "status": "EXPIRED",
      "action": "Request new payoff statement"
    },
    {
      "document": "Settlement Certification",
      "extracted_date": "2026-01-10",
      "p_and_s_date": "2026-01-10",
      "status": "VALID"
    }
  ],
  "overall_status": "FAIL",
  "blocking_issues": 1
}`,
                integration: `INTEGRATION POINTS:
1. OCR Engine
   - Date field extraction
   - Multi-format parsing
   - Confidence scoring

2. Document Repository
   - Access funding package
   - Cross-reference documents
   - Version tracking

3. Rules Engine
   - Configurable date rules
   - Investor-specific requirements
   - Holiday calendar awareness

4. LOS Integration
   - Flag expired documents
   - Generate refresh requests
   - Update condition status

5. Reporting
   - Date compliance dashboard
   - Expiration forecasting
   - Trend analysis`
            }
        };

        // Show agent prompt modal
        let currentPromptContent = '';

        function showAgentPrompt(agentKey) {
            const agent = agentPrompts[agentKey];
            if (!agent) return;

            document.getElementById('promptModalTitle').textContent = agent.name + ' - Build Prompt';

            const tagsHtml = agent.tags.map(tag => '<span class="prompt-tag">' + tag + '</span>').join('');
            document.getElementById('promptTags').innerHTML = tagsHtml;

            document.getElementById('promptPurpose').textContent = agent.purpose;
            document.getElementById('promptContent').textContent = agent.prompt;
            document.getElementById('promptIntegration').textContent = agent.integration;

            currentPromptContent = '# ' + agent.name + '\n\n## Purpose\n' + agent.purpose + '\n\n## Build Prompt\n' + agent.prompt + '\n\n## Integration Points\n' + agent.integration;

            document.getElementById('promptModal').classList.add('show');
            document.body.style.overflow = 'hidden';
        }

        function closePromptModal() {
            document.getElementById('promptModal').classList.remove('show');
            document.body.style.overflow = '';
        }

        async function copyPromptToClipboard() {
            try {
                await navigator.clipboard.writeText(currentPromptContent);
                const success = document.getElementById('copySuccess');
                success.style.display = 'block';
                setTimeout(() => { success.style.display = 'none'; }, 2000);
            } catch (e) {
                alert('Failed to copy prompt.');
            }
        }

        document.getElementById('promptModal').addEventListener('click', (e) => {
            if (e.target.id === 'promptModal') closePromptModal();
        });
    </script>
</body>
</html>
