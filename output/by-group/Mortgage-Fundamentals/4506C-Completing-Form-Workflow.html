<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>4506-C Form Completion - Process Workflow</title>
    <link href="https://fonts.googleapis.com/css2?family=Plus+Jakarta+Sans:wght@400;500;600;700;800&family=JetBrains+Mono:wght@400;500&display=swap" rel="stylesheet">
    <style>
        :root {
            --bg-primary: #0a0f1a;
            --bg-secondary: #111827;
            --bg-card: #1a2234;
            --accent-blue: #3b82f6;
            --accent-teal: #14b8a6;
            --accent-amber: #f59e0b;
            --accent-rose: #f43f5e;
            --accent-green: #22c55e;
            --accent-purple: #8b5cf6;
            --text-primary: #f1f5f9;
            --text-secondary: #94a3b8;
            --text-muted: #64748b;
            --border-subtle: rgba(255,255,255,0.08);
            --sidebar-width: 280px;
        }

        * { box-sizing: border-box; margin: 0; padding: 0; }
        html { scroll-behavior: smooth; }
        body {
            font-family: 'Plus Jakarta Sans', -apple-system, BlinkMacSystemFont, sans-serif;
            background: var(--bg-primary);
            color: var(--text-primary);
            min-height: 100vh;
        }

        /* Breadcrumb */
        .breadcrumb {
            background: linear-gradient(90deg, #0d1525 0%, #1a2234 100%);
            padding: 14px 25px;
            display: flex;
            align-items: center;
            gap: 12px;
            font-size: 0.95rem;
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            z-index: 1001;
            border-bottom: 1px solid var(--border-subtle);
        }

        .breadcrumb a {
            color: var(--text-secondary);
            text-decoration: none;
            font-weight: 600;
            padding: 8px 16px;
            background: rgba(255,255,255,0.05);
            border-radius: 8px;
            transition: all 0.2s;
            border: 1px solid var(--border-subtle);
        }

        .breadcrumb a:hover {
            background: rgba(59, 130, 246, 0.15);
            color: var(--accent-blue);
            border-color: rgba(59, 130, 246, 0.3);
        }

        .breadcrumb .separator { color: var(--text-muted); font-size: 1.2rem; }
        .breadcrumb .current { color: var(--accent-amber); font-weight: 600; padding: 8px 16px; }

        /* Sidebar */
        .sidebar {
            position: fixed;
            top: 54px;
            left: 0;
            width: var(--sidebar-width);
            height: calc(100vh - 54px);
            background: var(--bg-secondary);
            overflow-y: auto;
            z-index: 1000;
            border-right: 1px solid var(--border-subtle);
            display: flex;
            flex-direction: column;
        }

        .sidebar-header {
            padding: 25px 20px;
            background: rgba(0,0,0,0.3);
            border-bottom: 1px solid var(--border-subtle);
        }

        .sidebar-header h2 { color: var(--text-primary); font-size: 1.2rem; font-weight: 700; margin-bottom: 5px; }
        .sidebar-header p { color: var(--text-muted); font-size: 0.85rem; }

        /* Tab Switch */
        .sidebar-tabs {
            display: flex;
            border-bottom: 1px solid var(--border-subtle);
        }

        .sidebar-tab {
            flex: 1;
            padding: 14px 10px;
            text-align: center;
            font-size: 0.8rem;
            font-weight: 700;
            color: var(--text-muted);
            cursor: pointer;
            transition: all 0.2s;
            border-bottom: 3px solid transparent;
            background: none;
            border-left: none;
            border-right: none;
            border-top: none;
        }

        .sidebar-tab:hover { background: rgba(255,255,255,0.03); color: var(--text-secondary); }
        .sidebar-tab.active { color: var(--accent-blue); border-bottom-color: var(--accent-blue); background: rgba(59, 130, 246, 0.08); }
        .sidebar-tab.agent-tab.active { color: var(--accent-purple); border-bottom-color: var(--accent-purple); background: rgba(139, 92, 246, 0.08); }

        .sidebar-nav { padding: 15px 0; flex: 1; overflow-y: auto; }

        .nav-item {
            display: flex;
            align-items: center;
            gap: 12px;
            padding: 14px 20px;
            color: var(--text-secondary);
            text-decoration: none;
            border-left: 3px solid transparent;
            transition: all 0.2s ease;
            cursor: pointer;
        }

        .nav-item:hover { background: rgba(255,255,255,0.03); color: var(--text-primary); }
        .nav-item.active { background: rgba(59, 130, 246, 0.1); border-left-color: var(--accent-blue); color: var(--text-primary); }

        .nav-number {
            background: rgba(255,255,255,0.1);
            color: var(--text-secondary);
            width: 28px;
            height: 28px;
            border-radius: 8px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 700;
            font-size: 0.85rem;
            flex-shrink: 0;
        }

        .nav-item.active .nav-number { background: var(--accent-blue); color: white; }
        .nav-label { font-size: 0.95rem; font-weight: 500; }

        .sidebar-footer {
            padding: 20px;
            border-top: 1px solid var(--border-subtle);
            background: rgba(0,0,0,0.2);
        }

        .doc-btn {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
            width: 100%;
            padding: 14px 20px;
            background: linear-gradient(135deg, var(--accent-blue) 0%, var(--accent-teal) 100%);
            color: white;
            border: none;
            border-radius: 10px;
            font-weight: 600;
            cursor: pointer;
            transition: transform 0.2s, box-shadow 0.2s;
            text-decoration: none;
            font-size: 0.95rem;
        }

        .doc-btn:hover { transform: translateY(-2px); box-shadow: 0 8px 25px rgba(59, 130, 246, 0.3); }

        /* Main Content */
        .main-content { margin-left: var(--sidebar-width); padding: 80px 40px 40px 40px; }

        /* Tab Panels */
        .tab-panel { display: none; }
        .tab-panel.active { display: block; }

        .header {
            background: var(--bg-card);
            border: 1px solid var(--border-subtle);
            padding: 35px;
            border-radius: 16px;
            margin-bottom: 30px;
            position: relative;
            overflow: hidden;
        }

        .header::before {
            content: '';
            position: absolute;
            top: 0; left: 0; right: 0; bottom: 0;
            background:
                radial-gradient(ellipse at 20% 20%, rgba(59, 130, 246, 0.1) 0%, transparent 50%),
                radial-gradient(ellipse at 80% 80%, rgba(20, 184, 166, 0.08) 0%, transparent 50%);
            pointer-events: none;
        }

        .header h1 {
            font-size: 2.2rem;
            font-weight: 800;
            margin-bottom: 10px;
            position: relative;
            background: linear-gradient(135deg, var(--text-primary) 0%, var(--accent-blue) 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .header .subtitle { color: var(--text-secondary); font-size: 1.1rem; position: relative; }

        .header .meta { display: flex; gap: 15px; margin-top: 20px; flex-wrap: wrap; position: relative; }

        .header .meta-item {
            background: rgba(255,255,255,0.05);
            border: 1px solid var(--border-subtle);
            padding: 8px 16px;
            border-radius: 8px;
            font-size: 0.9rem;
            color: var(--text-secondary);
        }

        /* Legend */
        .legend {
            display: flex;
            flex-wrap: wrap;
            gap: 15px;
            padding: 18px 22px;
            background: var(--bg-card);
            border: 1px solid var(--border-subtle);
            border-radius: 12px;
            margin-bottom: 25px;
        }

        .legend-item { display: flex; align-items: center; gap: 8px; font-size: 0.85rem; color: var(--text-secondary); }
        .legend-color { width: 18px; height: 18px; border-radius: 4px; }

        /* Sections */
        .section {
            background: var(--bg-card);
            border: 1px solid var(--border-subtle);
            border-radius: 16px;
            margin-bottom: 25px;
            overflow: hidden;
            scroll-margin-top: 75px;
        }

        .section-header {
            background: linear-gradient(135deg, var(--bg-secondary) 0%, rgba(59, 130, 246, 0.1) 100%);
            border-bottom: 1px solid var(--border-subtle);
            padding: 22px 25px;
            display: flex;
            align-items: center;
            gap: 18px;
        }

        .section-number {
            background: linear-gradient(135deg, var(--accent-blue) 0%, var(--accent-teal) 100%);
            color: white;
            width: 48px;
            height: 48px;
            border-radius: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 800;
            font-size: 1.3rem;
            flex-shrink: 0;
        }

        .section-title h2 { font-size: 1.35rem; font-weight: 700; margin-bottom: 4px; color: var(--text-primary); }
        .section-title span { font-size: 0.9rem; color: var(--text-muted); }
        .section-content { padding: 28px; }

        /* Workflow Diagrams */
        .workflow-diagram {
            background: rgba(0,0,0,0.3);
            border: 1px solid var(--border-subtle);
            border-radius: 12px;
            padding: 28px;
            margin-bottom: 22px;
        }

        .flow-row { display: flex; align-items: center; justify-content: center; flex-wrap: wrap; gap: 12px; margin: 15px 0; }

        .flow-node {
            padding: 14px 22px;
            border-radius: 10px;
            text-align: center;
            font-size: 0.9rem;
            font-weight: 600;
            min-width: 150px;
            border: 1px solid var(--border-subtle);
        }

        .flow-node.start { background: linear-gradient(135deg, var(--accent-green) 0%, #16a34a 100%); color: white; border-radius: 25px; border: none; }
        .flow-node.action { background: linear-gradient(135deg, var(--accent-blue) 0%, #2563eb 100%); color: white; border: none; }
        .flow-node.decision { background: linear-gradient(135deg, var(--accent-amber) 0%, #d97706 100%); color: var(--bg-primary); border: none; }
        .flow-node.input { background: var(--bg-secondary); border: 2px solid var(--accent-blue); color: var(--text-primary); }
        .flow-node.output { background: linear-gradient(135deg, var(--accent-teal) 0%, #0d9488 100%); color: white; border: none; }
        .flow-node.exception { background: linear-gradient(135deg, var(--accent-rose) 0%, #dc2626 100%); color: white; border: none; }

        .flow-arrow { color: var(--accent-blue); font-size: 1.5rem; }
        .flow-arrow.down { transform: rotate(90deg); }

        .decision-branch { display: flex; gap: 40px; justify-content: center; margin: 20px 0; flex-wrap: wrap; }
        .branch { display: flex; flex-direction: column; align-items: center; gap: 10px; }

        .branch-label {
            background: var(--bg-secondary);
            border: 1px solid var(--border-subtle);
            padding: 6px 16px;
            border-radius: 20px;
            font-size: 0.8rem;
            font-weight: 700;
            color: var(--text-secondary);
        }

        /* Tables */
        .field-table { width: 100%; border-collapse: collapse; margin: 18px 0; }

        .field-table th {
            background: rgba(59, 130, 246, 0.15);
            color: var(--accent-blue);
            padding: 14px 18px;
            text-align: left;
            font-weight: 600;
            font-size: 0.9rem;
            text-transform: uppercase;
            letter-spacing: 0.05em;
            border-bottom: 1px solid var(--border-subtle);
        }

        .field-table td { padding: 14px 18px; border-bottom: 1px solid var(--border-subtle); color: var(--text-secondary); }
        .field-table tr:hover { background: rgba(255,255,255,0.02); }

        .badge { display: inline-block; padding: 4px 12px; border-radius: 6px; font-size: 0.75rem; font-weight: 700; text-transform: uppercase; letter-spacing: 0.05em; }
        .badge.required-badge { background: rgba(244, 63, 94, 0.15); color: var(--accent-rose); }
        .badge.optional-badge { background: rgba(34, 197, 94, 0.15); color: var(--accent-green); }
        .badge.calculated-badge { background: rgba(59, 130, 246, 0.15); color: var(--accent-blue); }

        /* Info Boxes */
        .exception-box, .tip-box, .info-box {
            padding: 18px 22px;
            margin: 18px 0;
            border-radius: 0 10px 10px 0;
            border-left-width: 4px;
            border-left-style: solid;
        }

        .exception-box { background: rgba(244, 63, 94, 0.08); border-color: var(--accent-rose); border: 1px solid rgba(244, 63, 94, 0.2); border-left: 4px solid var(--accent-rose); }
        .exception-box h4 { color: var(--accent-rose); margin-bottom: 10px; font-size: 1rem; }
        .exception-box p, .exception-box li { color: var(--text-secondary); }

        .tip-box { background: rgba(34, 197, 94, 0.08); border-color: var(--accent-green); border: 1px solid rgba(34, 197, 94, 0.2); border-left: 4px solid var(--accent-green); }
        .tip-box h4 { color: var(--accent-green); margin-bottom: 10px; font-size: 1rem; }
        .tip-box p, .tip-box li { color: var(--text-secondary); }

        .info-box { background: rgba(59, 130, 246, 0.08); border-color: var(--accent-blue); border: 1px solid rgba(59, 130, 246, 0.2); border-left: 4px solid var(--accent-blue); }
        .info-box h4 { color: var(--accent-blue); margin-bottom: 10px; font-size: 1rem; }
        .info-box p, .info-box li { color: var(--text-secondary); }

        /* Decision Tree */
        .decision-tree {
            background: rgba(0,0,0,0.2);
            border: 1px solid var(--border-subtle);
            border-radius: 12px;
            padding: 22px;
            margin: 22px 0;
        }

        .decision-tree h3 { color: var(--accent-blue); margin-bottom: 18px; padding-bottom: 12px; border-bottom: 1px solid var(--border-subtle); font-size: 1.1rem; }

        .tree-node { margin-left: 20px; padding: 12px; border-left: 2px solid var(--accent-teal); position: relative; color: var(--text-secondary); }
        .tree-node::before { content: ''; position: absolute; left: -2px; top: 22px; width: 15px; height: 2px; background: var(--accent-teal); }
        .tree-node.level-1 { margin-left: 0; border-left: none; }
        .tree-node.level-1::before { display: none; }

        .tree-label { background: var(--accent-amber); color: var(--bg-primary); padding: 6px 14px; border-radius: 6px; font-weight: 700; display: inline-block; margin-bottom: 6px; font-size: 0.9rem; }

        /* Summary Grid */
        .summary-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(180px, 1fr)); gap: 18px; margin: 22px 0; }

        .summary-card { background: rgba(0,0,0,0.3); border: 1px solid var(--border-subtle); border-radius: 12px; padding: 22px; text-align: center; }
        .summary-card h4 { color: var(--text-secondary); margin-bottom: 12px; font-size: 0.9rem; }
        .summary-card .value {
            font-size: 2.2rem;
            font-weight: 800;
            background: linear-gradient(135deg, var(--accent-blue) 0%, var(--accent-teal) 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }
        .summary-card .label { font-size: 0.85rem; color: var(--text-muted); margin-top: 8px; }

        /* MI Comparison Cards */
        .mi-comparison { display: grid; grid-template-columns: repeat(auto-fit, minmax(280px, 1fr)); gap: 20px; margin: 22px 0; }

        .mi-card { background: rgba(0,0,0,0.2); border: 1px solid var(--border-subtle); border-radius: 12px; overflow: hidden; }
        .mi-card-header { background: linear-gradient(135deg, var(--accent-blue) 0%, var(--accent-teal) 100%); color: white; padding: 18px; text-align: center; }
        .mi-card-header h4 { font-size: 1.05rem; }
        .mi-card-body { padding: 22px; }
        .mi-card ul { list-style: none; padding: 0; }
        .mi-card li { padding: 10px 0; border-bottom: 1px solid var(--border-subtle); display: flex; align-items: center; gap: 12px; color: var(--text-secondary); font-size: 0.95rem; }
        .mi-card li:last-child { border-bottom: none; }
        .check-icon { color: var(--accent-green); font-weight: bold; }
        .x-icon { color: var(--accent-rose); font-weight: bold; }

        /* Quick Reference */
        .quick-ref {
            background: linear-gradient(135deg, var(--bg-secondary) 0%, var(--bg-card) 100%);
            border: 1px solid var(--border-subtle);
            padding: 28px;
            border-radius: 16px;
            margin-top: 30px;
            font-family: 'JetBrains Mono', monospace;
            scroll-margin-top: 75px;
        }

        .quick-ref h3 { color: var(--accent-amber); margin-bottom: 18px; font-family: 'Plus Jakarta Sans', sans-serif; }
        .quick-ref pre { background: rgba(0,0,0,0.4); border: 1px solid var(--border-subtle); padding: 20px; border-radius: 10px; overflow-x: auto; font-size: 0.85rem; line-height: 1.7; color: var(--text-secondary); }

        /* ====== AGENT OPPORTUNITIES STYLES ====== */
        .agent-header {
            background: var(--bg-card);
            border: 1px solid var(--border-subtle);
            padding: 35px;
            border-radius: 16px;
            margin-bottom: 30px;
            position: relative;
            overflow: hidden;
        }

        .agent-header::before {
            content: '';
            position: absolute;
            top: 0; left: 0; right: 0; bottom: 0;
            background:
                radial-gradient(ellipse at 20% 20%, rgba(139, 92, 246, 0.12) 0%, transparent 50%),
                radial-gradient(ellipse at 80% 80%, rgba(245, 158, 11, 0.1) 0%, transparent 50%);
            pointer-events: none;
        }

        .agent-header h1 {
            font-size: 2.2rem;
            font-weight: 800;
            margin-bottom: 10px;
            position: relative;
            background: linear-gradient(135deg, var(--accent-purple) 0%, var(--accent-amber) 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .agent-header .subtitle { color: var(--text-secondary); font-size: 1.1rem; position: relative; }

        /* Heat Map */
        .heat-map-container { margin-bottom: 35px; }
        .heat-map-title { font-size: 1.3rem; font-weight: 700; color: var(--text-primary); margin-bottom: 20px; display: flex; align-items: center; gap: 12px; }

        .heat-map-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
        }

        .heat-item {
            background: var(--bg-card);
            border: 1px solid var(--border-subtle);
            border-radius: 12px;
            padding: 20px;
            position: relative;
            overflow: hidden;
            transition: transform 0.2s, box-shadow 0.2s;
            cursor: pointer;
        }

        .heat-item:hover { transform: translateY(-3px); box-shadow: 0 10px 30px rgba(0,0,0,0.3); }
        .heat-item:active { transform: scale(0.98); }

        .heat-item::before {
            content: '';
            position: absolute;
            top: 0; left: 0; right: 0; height: 4px;
        }

        .heat-item.critical::before { background: linear-gradient(90deg, #ef4444, #f97316); }
        .heat-item.high::before { background: linear-gradient(90deg, #f97316, #eab308); }
        .heat-item.medium::before { background: linear-gradient(90deg, #eab308, #22c55e); }
        .heat-item.low::before { background: linear-gradient(90deg, #22c55e, #14b8a6); }

        .heat-score {
            position: absolute;
            top: 15px;
            right: 15px;
            font-size: 1.8rem;
            font-weight: 800;
        }

        .heat-item.critical .heat-score { color: #ef4444; }
        .heat-item.high .heat-score { color: #f97316; }
        .heat-item.medium .heat-score { color: #eab308; }
        .heat-item.low .heat-score { color: #22c55e; }

        .heat-name { font-size: 1rem; font-weight: 700; color: var(--text-primary); margin-bottom: 6px; padding-right: 50px; }
        .heat-desc { font-size: 0.85rem; color: var(--text-muted); margin-bottom: 12px; }

        .heat-metrics { display: flex; gap: 15px; margin-top: 12px; }
        .heat-metric { font-size: 0.75rem; color: var(--text-muted); }
        .heat-metric span { color: var(--text-secondary); font-weight: 600; }

        /* Agent Cards */
        .agent-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(380px, 1fr)); gap: 25px; margin-bottom: 35px; }

        .agent-card {
            background: var(--bg-card);
            border: 1px solid var(--border-subtle);
            border-radius: 16px;
            overflow: hidden;
            transition: transform 0.2s, box-shadow 0.2s;
        }

        .agent-card:hover { transform: translateY(-5px); box-shadow: 0 15px 50px rgba(0,0,0,0.3); }

        .agent-card.highlight {
            animation: highlightPulse 2s ease;
            box-shadow: 0 0 0 3px var(--accent-purple), 0 15px 50px rgba(139, 92, 246, 0.4);
        }

        @keyframes highlightPulse {
            0% { box-shadow: 0 0 0 3px var(--accent-purple), 0 15px 50px rgba(139, 92, 246, 0.6); }
            50% { box-shadow: 0 0 0 6px rgba(139, 92, 246, 0.5), 0 15px 50px rgba(139, 92, 246, 0.3); }
            100% { box-shadow: 0 0 0 0px transparent, 0 15px 50px rgba(0,0,0,0.3); }
        }

        .agent-card-header {
            padding: 22px;
            display: flex;
            align-items: flex-start;
            gap: 18px;
            border-bottom: 1px solid var(--border-subtle);
        }

        .agent-icon {
            width: 55px;
            height: 55px;
            background: linear-gradient(135deg, var(--accent-purple) 0%, var(--accent-blue) 100%);
            border-radius: 14px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.6rem;
            flex-shrink: 0;
        }

        .agent-info { flex: 1; }
        .agent-name { font-size: 1.15rem; font-weight: 700; color: var(--text-primary); margin-bottom: 5px; }
        .agent-type { font-size: 0.8rem; color: var(--accent-purple); font-weight: 600; text-transform: uppercase; letter-spacing: 0.05em; }

        .agent-priority {
            padding: 6px 12px;
            border-radius: 20px;
            font-size: 0.75rem;
            font-weight: 700;
            text-transform: uppercase;
        }

        .agent-priority.critical { background: rgba(239, 68, 68, 0.15); color: #ef4444; }
        .agent-priority.high { background: rgba(249, 115, 22, 0.15); color: #f97316; }
        .agent-priority.medium { background: rgba(234, 179, 8, 0.15); color: #eab308; }
        .agent-priority.low { background: rgba(34, 197, 94, 0.15); color: #22c55e; }

        .agent-card-body { padding: 22px; }
        .agent-description { font-size: 0.95rem; color: var(--text-secondary); line-height: 1.6; margin-bottom: 20px; }

        .agent-flow {
            background: rgba(0,0,0,0.3);
            border: 1px solid var(--border-subtle);
            border-radius: 10px;
            padding: 18px;
            margin-bottom: 20px;
        }

        .agent-flow-title { font-size: 0.85rem; color: var(--text-muted); margin-bottom: 12px; font-weight: 600; text-transform: uppercase; letter-spacing: 0.05em; }

        .agent-flow-diagram { display: flex; align-items: center; flex-wrap: wrap; gap: 8px; justify-content: center; }

        .agent-step {
            background: linear-gradient(135deg, var(--accent-purple) 0%, var(--accent-blue) 100%);
            color: white;
            padding: 8px 14px;
            border-radius: 6px;
            font-size: 0.8rem;
            font-weight: 600;
            white-space: nowrap;
        }

        .agent-arrow { color: var(--accent-purple); font-size: 1.2rem; }

        .agent-stats { display: grid; grid-template-columns: repeat(3, 1fr); gap: 12px; }

        .agent-stat {
            background: rgba(0,0,0,0.2);
            border-radius: 8px;
            padding: 12px;
            text-align: center;
        }

        .agent-stat-value {
            font-size: 1.3rem;
            font-weight: 800;
            background: linear-gradient(135deg, var(--accent-purple) 0%, var(--accent-amber) 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .agent-stat-label { font-size: 0.7rem; color: var(--text-muted); text-transform: uppercase; letter-spacing: 0.05em; margin-top: 4px; }

        /* View Prompt Button */
        .agent-prompt-btn {
            width: 100%;
            margin-top: 18px;
            padding: 14px 20px;
            background: linear-gradient(135deg, rgba(139, 92, 246, 0.2) 0%, rgba(59, 130, 246, 0.2) 100%);
            border: 1px solid rgba(139, 92, 246, 0.4);
            border-radius: 10px;
            color: var(--accent-purple);
            font-weight: 700;
            cursor: pointer;
            transition: all 0.2s;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
            font-size: 0.9rem;
        }

        .agent-prompt-btn:hover {
            background: linear-gradient(135deg, rgba(139, 92, 246, 0.3) 0%, rgba(59, 130, 246, 0.3) 100%);
            border-color: var(--accent-purple);
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(139, 92, 246, 0.25);
        }

        /* Summary Stats */
        .agent-summary {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin-bottom: 35px;
        }

        .agent-summary-card {
            background: var(--bg-card);
            border: 1px solid var(--border-subtle);
            border-radius: 14px;
            padding: 25px;
            text-align: center;
        }

        .agent-summary-value {
            font-size: 2.5rem;
            font-weight: 800;
            background: linear-gradient(135deg, var(--accent-purple) 0%, var(--accent-amber) 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .agent-summary-label { font-size: 0.9rem; color: var(--text-muted); margin-top: 8px; }

        /* Heat Map Legend */
        .heat-legend {
            display: flex;
            gap: 25px;
            padding: 18px 22px;
            background: var(--bg-card);
            border: 1px solid var(--border-subtle);
            border-radius: 12px;
            margin-bottom: 25px;
            flex-wrap: wrap;
        }

        .heat-legend-item { display: flex; align-items: center; gap: 10px; font-size: 0.9rem; color: var(--text-secondary); }
        .heat-legend-color { width: 24px; height: 24px; border-radius: 6px; }

        /* Modal */
        .modal-overlay {
            display: none;
            position: fixed;
            top: 0; left: 0; right: 0; bottom: 0;
            background: rgba(10, 15, 26, 0.9);
            z-index: 2000;
            justify-content: center;
            align-items: center;
            padding: 20px;
            backdrop-filter: blur(5px);
        }

        .modal-overlay.show { display: flex; }

        .modal {
            background: var(--bg-card);
            border: 1px solid var(--border-subtle);
            border-radius: 16px;
            width: 100%;
            max-width: 950px;
            max-height: 90vh;
            display: flex;
            flex-direction: column;
            box-shadow: 0 25px 80px rgba(0,0,0,0.5);
        }

        .modal-header {
            background: linear-gradient(135deg, var(--accent-blue) 0%, var(--accent-teal) 100%);
            color: white;
            padding: 22px 28px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            border-radius: 16px 16px 0 0;
        }

        .modal-header h3 { font-size: 1.25rem; font-weight: 700; }
        .modal-actions { display: flex; gap: 12px; }

        .modal-btn {
            padding: 10px 18px;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-weight: 700;
            transition: transform 0.2s;
            font-size: 0.9rem;
        }

        .modal-btn:hover { transform: scale(1.05); }
        .modal-btn.copy { background: white; color: var(--accent-blue); }
        .modal-btn.close { background: rgba(255,255,255,0.2); color: white; }

        .modal-body { padding: 28px; overflow-y: auto; flex: 1; }

        .modal-body pre {
            background: rgba(0,0,0,0.3);
            border: 1px solid var(--border-subtle);
            padding: 22px;
            border-radius: 10px;
            font-family: 'JetBrains Mono', monospace;
            font-size: 0.9rem;
            line-height: 1.7;
            white-space: pre-wrap;
            word-wrap: break-word;
            color: var(--text-secondary);
        }

        .copy-success {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: var(--accent-green);
            color: white;
            padding: 18px 35px;
            border-radius: 10px;
            font-weight: 700;
            z-index: 3000;
            display: none;
            animation: fadeInOut 2s ease;
        }

        @keyframes fadeInOut { 0%, 100% { opacity: 0; } 10%, 90% { opacity: 1; } }

        /* Prompt Modal */
        .prompt-modal .modal { max-width: 800px; }
        .prompt-modal .modal-header { background: linear-gradient(135deg, var(--accent-purple) 0%, var(--accent-blue) 100%); }

        .prompt-section { margin-bottom: 25px; }
        .prompt-section h4 { color: var(--accent-purple); font-size: 1rem; margin-bottom: 12px; display: flex; align-items: center; gap: 8px; }

        .prompt-box {
            background: rgba(0,0,0,0.4);
            border: 1px solid var(--border-subtle);
            border-radius: 10px;
            padding: 20px;
            font-family: 'JetBrains Mono', monospace;
            font-size: 0.85rem;
            line-height: 1.7;
            color: var(--text-secondary);
            white-space: pre-wrap;
            word-wrap: break-word;
        }

        .prompt-tags { display: flex; gap: 10px; flex-wrap: wrap; margin-bottom: 20px; }
        .prompt-tag { background: rgba(139, 92, 246, 0.15); color: var(--accent-purple); padding: 6px 14px; border-radius: 20px; font-size: 0.8rem; font-weight: 600; }

        .copy-prompt-btn {
            background: linear-gradient(135deg, var(--accent-purple) 0%, var(--accent-blue) 100%);
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 8px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.2s;
            margin-top: 15px;
        }

        .copy-prompt-btn:hover { transform: scale(1.05); box-shadow: 0 5px 20px rgba(139, 92, 246, 0.3); }

        /* Step List */
        .step-list { list-style: none; padding: 0; margin: 18px 0; }
        .step-list li {
            padding: 14px 18px;
            border-left: 3px solid var(--accent-blue);
            background: rgba(0,0,0,0.2);
            margin-bottom: 10px;
            border-radius: 0 8px 8px 0;
            color: var(--text-secondary);
        }
        .step-list li strong { color: var(--text-primary); }

        @media (max-width: 900px) {
            .sidebar { display: none; }
            .main-content { margin-left: 0; padding: 75px 20px 30px 20px; }
            .agent-grid { grid-template-columns: 1fr; }
        }
            .breadcrumb-logo-link { display: flex; align-items: center; padding: 4px 8px; background: rgba(255,255,255,0.08); border-radius: 8px; border: 1px solid rgba(255,255,255,0.12); transition: all 0.2s; }
        .breadcrumb-logo-link:hover { background: rgba(255,255,255,0.15); }
        .breadcrumb-logo { height: 28px; width: auto; }
    </style>
</head>
<body>
    <!-- Breadcrumb -->
    <nav class="breadcrumb">
        <a href="../../index.html" class="breadcrumb-logo-link"><img src="../../images/clear-ai-logo.png" alt="Clear AI" class="breadcrumb-logo"></a>
        <a href="../../index.html">Portal Home</a>
        <span class="separator">></span>
        <a href="./index.html">Mortgage Fundamentals</a>
        <span class="separator">></span>
        <span class="current">4506-C Form Completion</span>
    </nav>

    <!-- Fixed Sidebar -->
    <aside class="sidebar">
        <div class="sidebar-header">
            <h2>4506-C Job Aid</h2>
            <p>IRS Tax Transcript Request</p>
        </div>

        <!-- Tab Switcher -->
        <div class="sidebar-tabs">
            <button class="sidebar-tab active" onclick="switchTab('workflow')">Workflow</button>
            <button class="sidebar-tab agent-tab" onclick="switchTab('agents')">AI Agents</button>
        </div>

        <!-- Workflow Navigation -->
        <nav class="sidebar-nav" id="workflow-nav">
            <a href="#section-1" class="nav-item active">
                <span class="nav-number">1</span>
                <span class="nav-label">Borrower Information</span>
            </a>
            <a href="#section-2" class="nav-item">
                <span class="nav-number">2</span>
                <span class="nav-label">Address Information</span>
            </a>
            <a href="#section-3" class="nav-item">
                <span class="nav-number">3</span>
                <span class="nav-label">IVES Participant</span>
            </a>
            <a href="#section-4" class="nav-item">
                <span class="nav-number">4</span>
                <span class="nav-label">Transcript Requested</span>
            </a>
            <a href="#section-5" class="nav-item">
                <span class="nav-number">5</span>
                <span class="nav-label">Wage & Income</span>
            </a>
            <a href="#section-6" class="nav-item">
                <span class="nav-number">6</span>
                <span class="nav-label">Signature & Attestation</span>
            </a>
            <a href="#section-7" class="nav-item">
                <span class="nav-number">7</span>
                <span class="nav-label">Forms Required Matrix</span>
            </a>
            <a href="#section-8" class="nav-item">
                <span class="nav-number">8</span>
                <span class="nav-label">Personal Tax Returns</span>
            </a>
            <a href="#section-9" class="nav-item">
                <span class="nav-number">9</span>
                <span class="nav-label">Business Tax Returns</span>
            </a>
            <a href="#quick-ref" class="nav-item">
                <span class="nav-number">*</span>
                <span class="nav-label">Quick Reference</span>
            </a>
        </nav>

        <!-- Agent Navigation -->
        <nav class="sidebar-nav" id="agents-nav" style="display: none;">
            <a href="#agent-summary" class="nav-item active">
                <span class="nav-number">S</span>
                <span class="nav-label">Summary</span>
            </a>
            <a href="#agent-heatmap" class="nav-item">
                <span class="nav-number">H</span>
                <span class="nav-label">Heat Map</span>
            </a>
            <a href="#agent-details" class="nav-item">
                <span class="nav-number">A</span>
                <span class="nav-label">Agent Details</span>
            </a>
        </nav>

        <div class="sidebar-footer">
            <button class="doc-btn" onclick="openDocModal()">
                View Workflow Markdown
            </button>
        </div>
    </aside>

    <!-- Main Content -->
    <main class="main-content">

        <!-- ==================== WORKFLOW TAB ==================== -->
        <div id="workflow-panel" class="tab-panel active">
            <!-- Header -->
            <div class="header">
                <h1>4506-C Form Completion Guide</h1>
                <p class="subtitle">Comprehensive job aid for completing IRS Form 4506-C - IVES Request for Transcript of Tax Return</p>
                <div class="meta">
                    <span class="meta-item">Form: IRS 4506-C (Oct 2022)</span>
                    <span class="meta-item">OMB: 1545-1872</span>
                    <span class="meta-item">IVES Participant: Veri-Tax LLC</span>
                    <span class="meta-item">Duration: 5-15 min per form</span>
                </div>
            </div>

            <!-- Legend -->
            <div class="legend">
                <div class="legend-item"><div class="legend-color" style="background: linear-gradient(135deg, #22c55e, #16a34a);"></div><span>Start/End</span></div>
                <div class="legend-item"><div class="legend-color" style="background: linear-gradient(135deg, #3b82f6, #2563eb);"></div><span>Action Step</span></div>
                <div class="legend-item"><div class="legend-color" style="background: linear-gradient(135deg, #f59e0b, #d97706);"></div><span>Decision Point</span></div>
                <div class="legend-item"><div class="legend-color" style="background: #111827; border: 2px solid #3b82f6;"></div><span>User Input</span></div>
                <div class="legend-item"><div class="legend-color" style="background: linear-gradient(135deg, #f43f5e, #dc2626);"></div><span>Exception</span></div>
                <div class="legend-item"><div class="legend-color" style="background: linear-gradient(135deg, #14b8a6, #0d9488);"></div><span>Output</span></div>
            </div>

            <!-- Section 1: Borrower Information -->
            <section id="section-1" class="section">
                <div class="section-header">
                    <div class="section-number">1</div>
                    <div class="section-title"><h2>Borrower Information (Lines 1a-2c)</h2><span>Enter taxpayer identification information</span></div>
                </div>
                <div class="section-content">
                    <div class="workflow-diagram">
                        <div class="flow-row">
                            <div class="flow-node start">Start</div>
                            <span class="flow-arrow">-></span>
                            <div class="flow-node action">Enter Line 1a</div>
                            <span class="flow-arrow">-></span>
                            <div class="flow-node action">Enter Line 1b</div>
                            <span class="flow-arrow">-></span>
                            <div class="flow-node decision">Name Changed?</div>
                        </div>
                        <div class="decision-branch">
                            <div class="branch">
                                <span class="branch-label">YES</span>
                                <div class="flow-node input">Complete Line 1c</div>
                            </div>
                            <div class="branch">
                                <span class="branch-label">NO</span>
                                <div class="flow-node output">Skip Line 1c</div>
                            </div>
                        </div>
                    </div>

                    <table class="field-table">
                        <thead>
                            <tr>
                                <th>Line</th>
                                <th>Field Name</th>
                                <th>Entry Requirements</th>
                                <th>Status</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td><strong>1a</strong></td>
                                <td>Borrower First and Last Name OR Business Name</td>
                                <td>Enter full legal name as shown on tax return</td>
                                <td><span class="badge required-badge">Required</span></td>
                            </tr>
                            <tr>
                                <td><strong>1b</strong></td>
                                <td>SSN or Business EIN</td>
                                <td>Format: XXX-XX-XXXX (SSN) or XX-XXXXX (EIN)</td>
                                <td><span class="badge required-badge">Required</span></td>
                            </tr>
                            <tr>
                                <td><strong>1c</strong></td>
                                <td>Previous Name</td>
                                <td>Only complete if name has changed since taxes were filed</td>
                                <td><span class="badge optional-badge">Conditional</span></td>
                            </tr>
                            <tr>
                                <td><strong>2a</strong></td>
                                <td>Second Taxpayer Name</td>
                                <td>Only complete if ordering a joint 1040</td>
                                <td><span class="badge optional-badge">Conditional</span></td>
                            </tr>
                            <tr>
                                <td><strong>2b</strong></td>
                                <td>Second Taxpayer SSN</td>
                                <td>Required if Line 2a is completed</td>
                                <td><span class="badge optional-badge">Conditional</span></td>
                            </tr>
                            <tr>
                                <td><strong>2c</strong></td>
                                <td>Second Taxpayer Previous Name</td>
                                <td>Only complete if second taxpayer name has changed</td>
                                <td><span class="badge optional-badge">Conditional</span></td>
                            </tr>
                        </tbody>
                    </table>

                    <div class="info-box">
                        <h4>Joint 1040 Returns</h4>
                        <p>Lines 2a and 2b are <strong>only</strong> required when ordering a joint 1040 return. For individual returns or business returns, leave these lines blank.</p>
                    </div>
                </div>
            </section>

            <!-- Section 2: Address Information -->
            <section id="section-2" class="section">
                <div class="section-header">
                    <div class="section-number">2</div>
                    <div class="section-title"><h2>Address Information (Lines 3-4)</h2><span>Current and previous addresses as shown on tax returns</span></div>
                </div>
                <div class="section-content">
                    <div class="workflow-diagram">
                        <div class="flow-row">
                            <div class="flow-node action">Enter Current Address</div>
                            <span class="flow-arrow">-></span>
                            <div class="flow-node decision">Address Different on Tax Return?</div>
                        </div>
                        <div class="decision-branch">
                            <div class="branch">
                                <span class="branch-label">YES</span>
                                <div class="flow-node input">Enter Lines 3a & 3b</div>
                            </div>
                            <div class="branch">
                                <span class="branch-label">NO</span>
                                <div class="flow-node output">Skip Lines 3a & 3b</div>
                            </div>
                        </div>
                    </div>

                    <table class="field-table">
                        <thead>
                            <tr>
                                <th>Line</th>
                                <th>Field Name</th>
                                <th>Entry Requirements</th>
                                <th>Status</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td><strong>3</strong></td>
                                <td>Current Address</td>
                                <td>Street, Apt/Suite, City, State, ZIP</td>
                                <td><span class="badge required-badge">Required</span></td>
                            </tr>
                            <tr>
                                <td><strong>3a & 3b</strong></td>
                                <td>Previous Address on Tax Return</td>
                                <td>Enter address as it appears on most recent tax return if different from current</td>
                                <td><span class="badge optional-badge">Conditional</span></td>
                            </tr>
                            <tr>
                                <td><strong>4</strong></td>
                                <td>Street Address (Prior)</td>
                                <td>Previous address shown on tax return filed if different from Line 3</td>
                                <td><span class="badge optional-badge">Conditional</span></td>
                            </tr>
                        </tbody>
                    </table>

                    <div class="tip-box">
                        <h4>Address Matching Critical</h4>
                        <p>The address must match exactly as it appears on the tax return being requested. Mismatched addresses will cause the IRS to reject the transcript request.</p>
                    </div>
                </div>
            </section>

            <!-- Section 3: IVES Participant -->
            <section id="section-3" class="section">
                <div class="section-header">
                    <div class="section-number">3</div>
                    <div class="section-title"><h2>IVES Participant Information (Line 5)</h2><span>Designate the IVES participant to receive transcripts</span></div>
                </div>
                <div class="section-content">
                    <div class="workflow-diagram">
                        <div class="flow-row">
                            <div class="flow-node action">Enter IVES Participant</div>
                            <span class="flow-arrow">-></span>
                            <div class="flow-node output">Leave 5b & 5c Blank</div>
                        </div>
                    </div>

                    <table class="field-table">
                        <thead>
                            <tr>
                                <th>Line</th>
                                <th>Field</th>
                                <th>Value</th>
                                <th>Notes</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td><strong>5a</strong></td>
                                <td>IVES Participant Name</td>
                                <td>Veri-Tax LLC</td>
                                <td><span class="badge required-badge">Required</span></td>
                            </tr>
                            <tr>
                                <td><strong>5a</strong></td>
                                <td>IVES Participant Address</td>
                                <td>30 Executive Park Suite 200, Irvine, CA 92614</td>
                                <td><span class="badge required-badge">Required</span></td>
                            </tr>
                            <tr>
                                <td><strong>5a</strong></td>
                                <td>IVES Participant ID Number</td>
                                <td>0000301975</td>
                                <td><span class="badge required-badge">Required</span></td>
                            </tr>
                            <tr>
                                <td><strong>5a</strong></td>
                                <td>SOR Mailbox ID</td>
                                <td>OGEN4506</td>
                                <td><span class="badge required-badge">Required</span></td>
                            </tr>
                            <tr>
                                <td><strong>5b</strong></td>
                                <td>Customer File Number</td>
                                <td>(Leave Blank)</td>
                                <td><span class="badge optional-badge">Do Not Complete</span></td>
                            </tr>
                            <tr>
                                <td><strong>5c</strong></td>
                                <td>Unique Identifier</td>
                                <td>(Leave Blank)</td>
                                <td><span class="badge optional-badge">Do Not Complete</span></td>
                            </tr>
                        </tbody>
                    </table>

                    <div class="info-box">
                        <h4>CMG Financial IVES Participant Details</h4>
                        <p>CMG Financial uses <strong>Veri-Tax LLC</strong> as the designated IVES participant for tax transcript requests. Always use the exact information shown above.</p>
                    </div>
                </div>
            </section>

            <!-- Section 4: Transcript Requested -->
            <section id="section-4" class="section">
                <div class="section-header">
                    <div class="section-number">4</div>
                    <div class="section-title"><h2>Transcript Requested (Line 6)</h2><span>Select the type of tax return transcript needed</span></div>
                </div>
                <div class="section-content">
                    <div class="workflow-diagram">
                        <div class="flow-row">
                            <div class="flow-node decision">Tax Return Type?</div>
                        </div>
                        <div class="decision-branch">
                            <div class="branch">
                                <span class="branch-label">Personal</span>
                                <div class="flow-node action">Enter 1040</div>
                            </div>
                            <div class="branch">
                                <span class="branch-label">Partnership</span>
                                <div class="flow-node action">Enter 1065</div>
                            </div>
                            <div class="branch">
                                <span class="branch-label">S-Corp</span>
                                <div class="flow-node action">Enter 1120-S</div>
                            </div>
                            <div class="branch">
                                <span class="branch-label">C-Corp</span>
                                <div class="flow-node action">Enter 1120</div>
                            </div>
                        </div>
                    </div>

                    <div class="exception-box">
                        <h4>CRITICAL: Line 6 Rules</h4>
                        <ul style="margin-top: 10px; margin-left: 20px;">
                            <li><strong>Do NOT complete Line 6</strong> if Wage & Income Information (W-2 or 1099) is requested</li>
                            <li>Enter <strong>ONLY ONE</strong> form type per 4506-C form</li>
                            <li>Check <strong>ONLY ONE</strong> box: 6a, 6b, or 6c</li>
                        </ul>
                    </div>

                    <table class="field-table">
                        <thead>
                            <tr>
                                <th>Checkbox</th>
                                <th>Description</th>
                                <th>When to Use</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td><strong>6a</strong></td>
                                <td>Return Transcript</td>
                                <td>Standard tax return transcript - most common</td>
                            </tr>
                            <tr>
                                <td><strong>6b</strong></td>
                                <td>Account Transcript</td>
                                <td>Shows changes made after original filing</td>
                            </tr>
                            <tr>
                                <td><strong>6c</strong></td>
                                <td>Record of Account</td>
                                <td>Combination of return transcript and account transcript</td>
                            </tr>
                        </tbody>
                    </table>

                    <div class="mi-comparison">
                        <div class="mi-card">
                            <div class="mi-card-header">
                                <h4>Form Types Reference</h4>
                            </div>
                            <div class="mi-card-body">
                                <ul>
                                    <li><span class="check-icon">1040</span> Personal Tax Returns, Schedule C/E Income</li>
                                    <li><span class="check-icon">1065</span> Partnership Returns (LP, LLP)</li>
                                    <li><span class="check-icon">1120</span> C Corporation Returns</li>
                                    <li><span class="check-icon">1120-S</span> S Corporation Returns</li>
                                    <li><span class="check-icon">990</span> Non-Profit Organization Returns</li>
                                    <li><span class="check-icon">941</span> Quarterly Payroll Tax Returns</li>
                                    <li><span class="check-icon">1041</span> Estate and Trust Returns</li>
                                </ul>
                            </div>
                        </div>
                    </div>
                </div>
            </section>

            <!-- Section 5: Wage & Income -->
            <section id="section-5" class="section">
                <div class="section-header">
                    <div class="section-number">5</div>
                    <div class="section-title"><h2>Wage and Income Transcripts (Line 7)</h2><span>Request W-2, 1099, and other income documents</span></div>
                </div>
                <div class="section-content">
                    <div class="workflow-diagram">
                        <div class="flow-row">
                            <div class="flow-node decision">Need W-2/1099?</div>
                        </div>
                        <div class="decision-branch">
                            <div class="branch">
                                <span class="branch-label">YES</span>
                                <div class="flow-node action">Check Line 7</div>
                                <span class="flow-arrow" style="transform: rotate(90deg);">-></span>
                                <div class="flow-node exception">Do NOT Complete Line 6</div>
                            </div>
                            <div class="branch">
                                <span class="branch-label">NO</span>
                                <div class="flow-node output">Skip Line 7</div>
                            </div>
                        </div>
                    </div>

                    <table class="field-table">
                        <thead>
                            <tr>
                                <th>Line</th>
                                <th>Field</th>
                                <th>Entry Requirements</th>
                                <th>Status</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td><strong>7</strong></td>
                                <td>Wage and Income Transcript</td>
                                <td>Check this box for W-2, 1098-E, 1099-G, etc.</td>
                                <td><span class="badge required-badge">If Applicable</span></td>
                            </tr>
                            <tr>
                                <td><strong>7a</strong></td>
                                <td>Specific Form Type</td>
                                <td>Enter only ONE form type: W-2, 1099, 1098, or K-1</td>
                                <td><span class="badge optional-badge">Optional</span></td>
                            </tr>
                            <tr>
                                <td><strong>7b</strong></td>
                                <td>Taxpayer Selection</td>
                                <td>Check Line 1a, Line 2a, or both. If no boxes checked, all information for borrower will be sent.</td>
                                <td><span class="badge optional-badge">Optional</span></td>
                            </tr>
                        </tbody>
                    </table>

                    <div class="exception-box">
                        <h4>Mutual Exclusion Rule</h4>
                        <p><strong>IMPORTANT:</strong> Do NOT check Line 7 if Line 6 is completed. These are mutually exclusive - you must submit separate 4506-C forms for tax return transcripts and wage/income transcripts.</p>
                    </div>

                    <div class="tip-box">
                        <h4>Line 7b - All Information Option</h4>
                        <p>If no boxes are checked in Line 7b but Line 7 is checked, all wage and income information on file for the borrower(s) listed will be sent. This is useful when you need comprehensive income documentation.</p>
                    </div>
                </div>
            </section>

            <!-- Section 6: Signature & Attestation -->
            <section id="section-6" class="section">
                <div class="section-header">
                    <div class="section-number">6</div>
                    <div class="section-title"><h2>Year Requested, Signature & Attestation (Line 8 & Sign)</h2><span>Date format and required signatures</span></div>
                </div>
                <div class="section-content">
                    <div class="workflow-diagram">
                        <div class="flow-row">
                            <div class="flow-node action">Enter Tax Year(s)</div>
                            <span class="flow-arrow">-></span>
                            <div class="flow-node action">Check Attestation Box</div>
                            <span class="flow-arrow">-></span>
                            <div class="flow-node action">Sign & Date</div>
                            <span class="flow-arrow">-></span>
                            <div class="flow-node output">Complete</div>
                        </div>
                    </div>

                    <table class="field-table">
                        <thead>
                            <tr>
                                <th>Field</th>
                                <th>Description</th>
                                <th>Format/Requirements</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td><strong>Line 8</strong></td>
                                <td>Year or Period Requested</td>
                                <td>Format: MM/DD/YYYY (e.g., 12/31/2022)</td>
                            </tr>
                            <tr>
                                <td><strong>Attestation</strong></td>
                                <td>Attestation Checkbox</td>
                                <td><span class="badge required-badge">Required</span> - Must be checked</td>
                            </tr>
                            <tr>
                                <td><strong>Signature</strong></td>
                                <td>Signature for Line 1a</td>
                                <td>Must match name on Line 1a exactly</td>
                            </tr>
                            <tr>
                                <td><strong>Date</strong></td>
                                <td>Date Signed</td>
                                <td>Current date when form is signed</td>
                            </tr>
                            <tr>
                                <td><strong>Phone</strong></td>
                                <td>Phone Number</td>
                                <td>Taxpayer phone number on Line 1a or 2a</td>
                            </tr>
                        </tbody>
                    </table>

                    <div class="decision-tree">
                        <h3>Electronic Signature Requirements</h3>
                        <p style="color: var(--text-secondary); margin-bottom: 15px;">If the form is electronically signed, additional checkboxes must be selected.</p>
                        <ul class="step-list">
                            <li><strong>Electronic Signature:</strong> Check the box "Signatory confirms document was electronically signed"</li>
                            <li><strong>Authorized Representative:</strong> If using POA for personal returns, check "Form 4506-C was signed by an Authorized Representative"</li>
                        </ul>
                    </div>

                    <div class="decision-tree">
                        <h3>Business Entity Authorized Signatories</h3>
                        <p style="color: var(--text-secondary); margin-bottom: 15px;">Authorized signatory must be an individual such as the business owner or officer with proper title.</p>

                        <table class="field-table">
                            <thead>
                                <tr>
                                    <th>Entity Type</th>
                                    <th>Form Numbers</th>
                                    <th>Acceptable Titles</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td><strong>Corporations</strong></td>
                                    <td>1120, 1120-S, 990, 941</td>
                                    <td>CEO, CFO, COO, Controller, Managing Member, President, Secretary, Shareholder, Treasurer, Assistant Treasurer, Vice-President</td>
                                </tr>
                                <tr>
                                    <td><strong>Partnerships</strong></td>
                                    <td>1065, 1065 LP/LLP</td>
                                    <td>Limited Partner, Partner</td>
                                </tr>
                                <tr>
                                    <td><strong>Estates/Trusts</strong></td>
                                    <td>1041</td>
                                    <td>Administrator, Beneficiary, Executor, Heir at Law, Next of Kin, Personal Representative, Trustee</td>
                                </tr>
                            </tbody>
                        </table>
                    </div>

                    <div class="exception-box">
                        <h4>Signature Must Match</h4>
                        <p>The signature on the 4506-C <strong>MUST</strong> match the name listed on Line 1a. For business returns, the title of the signatory must be one of the accepted titles listed above.</p>
                    </div>
                </div>
            </section>

            <!-- Section 7: Forms Required Matrix -->
            <section id="section-7" class="section">
                <div class="section-header">
                    <div class="section-number">7</div>
                    <div class="section-title"><h2>How Many 4506-C Forms Does a Loan Need?</h2><span>Comprehensive matrix for determining required forms</span></div>
                </div>
                <div class="section-content">
                    <table class="field-table">
                        <thead>
                            <tr>
                                <th>Number of Borrowers</th>
                                <th>Income Type</th>
                                <th>Number of 4506-C Forms Required</th>
                                <th>Total</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td><strong>Single Borrower</strong></td>
                                <td>W-2 Income</td>
                                <td>1 Form with Wage/Income</td>
                                <td><span class="badge calculated-badge">1</span></td>
                            </tr>
                            <tr>
                                <td><strong>Single Borrower</strong></td>
                                <td>Self-Employed (Schedule C)</td>
                                <td>1 Form with Wage/Income + 1 Form with 1040</td>
                                <td><span class="badge calculated-badge">2</span></td>
                            </tr>
                            <tr>
                                <td><strong>Single Borrower</strong></td>
                                <td>Self-Employed (Business)</td>
                                <td>1 Form with 1040 + 1 Form per business</td>
                                <td><span class="badge calculated-badge">2+</span></td>
                            </tr>
                            <tr>
                                <td><strong>Single Borrower</strong></td>
                                <td>Multiple Income (W-2 + 1099)</td>
                                <td>1 Form with 1040 + 1 Form with Wage/Income</td>
                                <td><span class="badge calculated-badge">2</span></td>
                            </tr>
                            <tr>
                                <td><strong>Married (one spouse on loan)</strong></td>
                                <td>W-2 Income</td>
                                <td>1 Form Wage/Income (borrower only)</td>
                                <td><span class="badge calculated-badge">1</span></td>
                            </tr>
                            <tr>
                                <td><strong>Married Borrowers</strong></td>
                                <td>Both W-2 Income</td>
                                <td>1 Form Wage/Income (borrower) + 1 Form Wage/Income (co-borrower)</td>
                                <td><span class="badge calculated-badge">2</span></td>
                            </tr>
                            <tr>
                                <td><strong>Married Borrowers</strong></td>
                                <td>One W-2, One Self-Employed</td>
                                <td>1 Form Wage/Income (W-2 borrower) + 1 Form 1040 (joint or separate) + 1 Form per business</td>
                                <td><span class="badge calculated-badge">3+</span></td>
                            </tr>
                            <tr>
                                <td><strong>Married Borrowers</strong></td>
                                <td>Both Self-Employed</td>
                                <td>1 Form 1040 (joint or 2 separate) + 1 Form per business</td>
                                <td><span class="badge calculated-badge">2+</span></td>
                            </tr>
                            <tr>
                                <td><strong>Joint (Unmarried)</strong></td>
                                <td>Both W-2 Income</td>
                                <td>1 Form Wage/Income (borrower) + 1 Form Wage/Income (co-borrower)</td>
                                <td><span class="badge calculated-badge">2</span></td>
                            </tr>
                            <tr>
                                <td><strong>Joint (Unmarried)</strong></td>
                                <td>One W-2, One Self-Employed</td>
                                <td>1 Form Wage/Income (W-2) + 1 Form 1040 (SE borrower) + 1 Form per business</td>
                                <td><span class="badge calculated-badge">3+</span></td>
                            </tr>
                            <tr>
                                <td><strong>Joint (Unmarried)</strong></td>
                                <td>Both Self-Employed</td>
                                <td>1 Form 1040 (per borrower) + 1 Form per business per borrower</td>
                                <td><span class="badge calculated-badge">4+</span></td>
                            </tr>
                        </tbody>
                    </table>

                    <div class="info-box">
                        <h4>Joint 1040 Filing</h4>
                        <p>If married borrowers file a joint 1040, only ONE 4506-C is needed for the 1040 with both taxpayers listed. If they file separately, each needs their own 4506-C for the 1040.</p>
                    </div>
                </div>
            </section>

            <!-- Section 8: Personal Tax Returns -->
            <section id="section-8" class="section">
                <div class="section-header">
                    <div class="section-number">8</div>
                    <div class="section-title"><h2>Personal Tax Return Scenarios</h2><span>Handle name and address changes for personal returns</span></div>
                </div>
                <div class="section-content">
                    <div class="info-box">
                        <h4>Personal Information Must Match Last 2 Years Tax Returns</h4>
                        <ul style="margin-top: 10px; margin-left: 20px;">
                            <li>Borrower Full Name</li>
                            <li>Personal Mailing Address</li>
                            <li>Social Security Number</li>
                        </ul>
                    </div>

                    <table class="field-table">
                        <thead>
                            <tr>
                                <th>Scenario</th>
                                <th>Action Required</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td>Borrower information on URLA is accurate and unchanged for the last 2 years of tax returns</td>
                                <td><span class="badge optional-badge">No Action Needed</span></td>
                            </tr>
                            <tr>
                                <td>Any borrower had a <strong>name change</strong> from the last 2 years of tax returns</td>
                                <td>Create another 4506-C for Borrower with a name that matches the tax returns</td>
                            </tr>
                            <tr>
                                <td>Any borrower had an <strong>address change</strong> from the last 2 years of tax returns</td>
                                <td>Create another 4506-C for the Borrower with an address that matches the tax returns</td>
                            </tr>
                            <tr>
                                <td><strong>Multiple name or address changes</strong> in the last 2 years of tax returns</td>
                                <td>Create as many 4506-C forms as needed to cover the 2 tax years</td>
                            </tr>
                        </tbody>
                    </table>

                    <div class="tip-box">
                        <h4>Example: Name Change Scenario</h4>
                        <p>If a borrower was "Jane Smith" on their 2021 tax return but changed to "Jane Doe" for their 2022 return, you need TWO 4506-C forms - one with "Jane Smith" for 2021 and one with "Jane Doe" for 2022.</p>
                    </div>
                </div>
            </section>

            <!-- Section 9: Business Tax Returns -->
            <section id="section-9" class="section">
                <div class="section-header">
                    <div class="section-number">9</div>
                    <div class="section-title"><h2>Business Tax Return Scenarios</h2><span>Handle business entity requirements and changes</span></div>
                </div>
                <div class="section-content">
                    <div class="info-box">
                        <h4>Business Information Must Match Last 2 Years Tax Returns</h4>
                        <ul style="margin-top: 10px; margin-left: 20px;">
                            <li>Business Name</li>
                            <li>Business Mailing Address</li>
                            <li>Business Tax ID Number (EIN)</li>
                        </ul>
                    </div>

                    <div class="exception-box">
                        <h4>Key Rule: One 4506-C Per Business</h4>
                        <p>When business income is used, a 4506-C is needed for the Business. If multiple businesses are used, a separate 4506-C is needed for <strong>EACH</strong> business.</p>
                    </div>

                    <table class="field-table">
                        <thead>
                            <tr>
                                <th>Scenario</th>
                                <th>Action Required</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td>Business information on URLA is accurate and unchanged for the last 2 years of tax returns</td>
                                <td>Create 4506-C forms as needed to cover the 2 years of tax returns</td>
                            </tr>
                            <tr>
                                <td>Business has had an <strong>address change</strong> from the last 2 years of tax returns</td>
                                <td>Create multiple 4506-C forms if needed to cover the 2 years of tax returns</td>
                            </tr>
                            <tr>
                                <td><strong>Multiple name or address changes</strong> in the last 2 years of tax returns</td>
                                <td>Create multiple 4506-C forms if needed to cover the 2 years of tax returns</td>
                            </tr>
                            <tr>
                                <td>Business <strong>changed tax filing structure</strong> (e.g., 1065 to 1120-S)</td>
                                <td>Create multiple 4506-C forms if needed to cover the 2 years of tax returns</td>
                            </tr>
                            <tr>
                                <td>Title of taxpayer shows as "owner", "partner", or "proprietor"</td>
                                <td>Create 4506-C with accepted titles: CEO, CFO, COO, Controller, Managing Member, President, Secretary, Shareholder, Treasurer/Assistant Treasurer, or Vice-President</td>
                            </tr>
                        </tbody>
                    </table>

                    <div class="tip-box">
                        <h4>Entity Type Change Example</h4>
                        <p>If a business filed as a 1065 (Partnership) two years ago but most recently filed as a 1120-S (S-Corp), you need separate 4506-C forms: one requesting the 1065 and one requesting the 1120-S.</p>
                    </div>
                </div>
            </section>

            <!-- Quick Reference -->
            <div id="quick-ref" class="quick-ref">
                <h3>4506-C Quick Reference</h3>
                <pre>
4506-C FORM COMPLETION CHECKLIST
================================

LINE-BY-LINE GUIDE
==================
Line 1a: Borrower Name or Business Name
Line 1b: SSN (XXX-XX-XXXX) or EIN (XX-XXXXX)
Line 1c: Previous name (only if changed since filing)

Line 2a: Second taxpayer name (joint 1040 only)
Line 2b: Second taxpayer SSN (joint 1040 only)
Line 2c: Second taxpayer previous name (if changed)

Line 3:  Current address
Line 3a/3b: Address on most recent tax return (if different)
Line 4:  Prior address (if different from Line 3)

Line 5a: IVES Participant: Veri-Tax LLC
         30 Executive Park Suite 200, Irvine, CA 92614
         ID: 0000301975 | SOR Mailbox: OGEN4506
Line 5b: LEAVE BLANK
Line 5c: LEAVE BLANK

Line 6:  Tax Return Type (1040, 1065, 1120, 1120-S)
         * Do NOT complete if requesting W-2/1099
         * Check ONLY ONE: 6a, 6b, or 6c

Line 7:  Wage & Income Transcripts (W-2, 1099, K-1)
         * Do NOT check if Line 6 is completed
Line 7a: Specific form type (optional)
Line 7b: Select taxpayer(s) or leave blank for all

Line 8:  Tax Year - Format: MM/DD/YYYY (e.g., 12/31/2022)

SIGNATURE: Must match Line 1a name exactly
ATTESTATION: Must be checked

FORM TYPE REFERENCE
==================
W-2 (Line 7)    - Wage & Income transcripts
1040 (Line 6)   - Personal Tax Returns, Schedule C/E
1065 (Line 6)   - Partnership Returns
1120 (Line 6)   - C Corporation Returns
1120-S (Line 6) - S Corporation Returns
990 (Line 6)    - Non-Profit Returns
941 (Line 6)    - Quarterly Payroll Tax
1041 (Line 6)   - Estate and Trust Returns

COMMON SCENARIOS - FORMS NEEDED
==============================
Single W-2 Borrower:         1 form (Wage/Income)
Single Self-Employed:        2+ forms (1040 + business)
Married Both W-2:            2 forms (Wage/Income each)
Married Mixed Income:        3+ forms
Joint Unmarried Both SE:     4+ forms

KEY RULES
=========
1. ONE form type per 4506-C
2. Line 6 and Line 7 are mutually exclusive
3. Info must match last 2 years of tax returns
4. Name/address changes = additional forms
5. Each business needs its own 4506-C
6. Business title must be acceptable (not "owner")
                </pre>
            </div>
        </div>

        <!-- ==================== AI AGENTS TAB ==================== -->
        <div id="agents-panel" class="tab-panel">
            <!-- Agent Header -->
            <div class="agent-header">
                <h1>AI Agent Opportunities</h1>
                <p class="subtitle">Automation opportunities identified for the 4506-C completion process</p>
            </div>

            <!-- Summary Stats -->
            <div class="agent-summary" id="agent-summary">
                <div class="agent-summary-card">
                    <div class="agent-summary-value">4</div>
                    <div class="agent-summary-label">Agent Opportunities</div>
                </div>
                <div class="agent-summary-card">
                    <div class="agent-summary-value">85%</div>
                    <div class="agent-summary-label">Automation Potential</div>
                </div>
                <div class="agent-summary-card">
                    <div class="agent-summary-value">12 min</div>
                    <div class="agent-summary-label">Est. Time Saved</div>
                </div>
                <div class="agent-summary-card">
                    <div class="agent-summary-value">High</div>
                    <div class="agent-summary-label">Error Reduction</div>
                </div>
            </div>

            <!-- Heat Map Legend -->
            <div class="heat-legend">
                <div class="heat-legend-item">
                    <div class="heat-legend-color" style="background: linear-gradient(90deg, #ef4444, #f97316);"></div>
                    <span>Critical Priority (9-10)</span>
                </div>
                <div class="heat-legend-item">
                    <div class="heat-legend-color" style="background: linear-gradient(90deg, #f97316, #eab308);"></div>
                    <span>High Priority (7-8)</span>
                </div>
                <div class="heat-legend-item">
                    <div class="heat-legend-color" style="background: linear-gradient(90deg, #eab308, #22c55e);"></div>
                    <span>Medium Priority (5-6)</span>
                </div>
                <div class="heat-legend-item">
                    <div class="heat-legend-color" style="background: linear-gradient(90deg, #22c55e, #14b8a6);"></div>
                    <span>Low Priority (1-4)</span>
                </div>
            </div>

            <!-- Heat Map Grid -->
            <div class="heat-map-container" id="agent-heatmap">
                <div class="heat-map-title">Priority Heat Map</div>
                <div class="heat-map-grid">
                    <div class="heat-item critical" onclick="scrollToAgent('agent-formgen')">
                        <div class="heat-score">9.5</div>
                        <div class="heat-name">Auto-Form Generator</div>
                        <div class="heat-desc">Auto-populate 4506-C from loan data with smart field mapping</div>
                        <div class="heat-metrics">
                            <div class="heat-metric">Time: <span>10 min</span></div>
                            <div class="heat-metric">Complexity: <span>Medium</span></div>
                        </div>
                    </div>
                    <div class="heat-item high" onclick="scrollToAgent('agent-formcount')">
                        <div class="heat-score">8.2</div>
                        <div class="heat-name">Form Count Calculator</div>
                        <div class="heat-desc">Determine required number of 4506-C forms based on borrower scenario</div>
                        <div class="heat-metrics">
                            <div class="heat-metric">Time: <span>3 min</span></div>
                            <div class="heat-metric">Complexity: <span>Low</span></div>
                        </div>
                    </div>
                    <div class="heat-item high" onclick="scrollToAgent('agent-validation')">
                        <div class="heat-score">7.8</div>
                        <div class="heat-name">Validation Agent</div>
                        <div class="heat-desc">Pre-submit validation to catch errors before IRS rejection</div>
                        <div class="heat-metrics">
                            <div class="heat-metric">Time: <span>2 min</span></div>
                            <div class="heat-metric">Complexity: <span>Low</span></div>
                        </div>
                    </div>
                    <div class="heat-item medium" onclick="scrollToAgent('agent-history')">
                        <div class="heat-score">6.1</div>
                        <div class="heat-name">History Tracker</div>
                        <div class="heat-desc">Detect name/address changes requiring multiple forms</div>
                        <div class="heat-metrics">
                            <div class="heat-metric">Time: <span>2 min</span></div>
                            <div class="heat-metric">Complexity: <span>Medium</span></div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Agent Details -->
            <div id="agent-details">
                <h2 style="color: var(--text-primary); margin-bottom: 25px; font-size: 1.5rem;">Agent Details</h2>
                <div class="agent-grid">
                    <!-- Auto-Form Generator -->
                    <div class="agent-card" id="agent-formgen">
                        <div class="agent-card-header">
                            <div class="agent-icon">G</div>
                            <div class="agent-info">
                                <div class="agent-name">Auto-Form Generator</div>
                                <div class="agent-type">Document Automation / PDF</div>
                            </div>
                            <span class="agent-priority critical">Critical</span>
                        </div>
                        <div class="agent-card-body">
                            <p class="agent-description">Automatically generates pre-filled 4506-C forms by extracting borrower, employer, and tax information from the loan file. Maps URLA data to correct form fields and handles IVES participant details automatically.</p>
                            <div class="agent-flow">
                                <div class="agent-flow-title">Agent Flow</div>
                                <div class="agent-flow-diagram">
                                    <span class="agent-step">Extract Loan Data</span>
                                    <span class="agent-arrow">-></span>
                                    <span class="agent-step">Map to Fields</span>
                                    <span class="agent-arrow">-></span>
                                    <span class="agent-step">Generate PDF</span>
                                    <span class="agent-arrow">-></span>
                                    <span class="agent-step">Queue for Signature</span>
                                </div>
                            </div>
                            <div class="agent-stats">
                                <div class="agent-stat">
                                    <div class="agent-stat-value">10 min</div>
                                    <div class="agent-stat-label">Time Saved</div>
                                </div>
                                <div class="agent-stat">
                                    <div class="agent-stat-value">98%</div>
                                    <div class="agent-stat-label">Accuracy</div>
                                </div>
                                <div class="agent-stat">
                                    <div class="agent-stat-value">Med</div>
                                    <div class="agent-stat-label">Complexity</div>
                                </div>
                            </div>
                            <button class="agent-prompt-btn" onclick="showAgentPrompt('formgen')">
                                View Build Prompt
                            </button>
                        </div>
                    </div>

                    <!-- Form Count Calculator -->
                    <div class="agent-card" id="agent-formcount">
                        <div class="agent-card-header">
                            <div class="agent-icon">C</div>
                            <div class="agent-info">
                                <div class="agent-name">Form Count Calculator</div>
                                <div class="agent-type">Logic / Decision Engine</div>
                            </div>
                            <span class="agent-priority high">High</span>
                        </div>
                        <div class="agent-card-body">
                            <p class="agent-description">Analyzes borrower count, marital status, income types, and business ownership to automatically calculate exactly how many 4506-C forms are required and which type each should be.</p>
                            <div class="agent-flow">
                                <div class="agent-flow-title">Agent Flow</div>
                                <div class="agent-flow-diagram">
                                    <span class="agent-step">Parse Borrowers</span>
                                    <span class="agent-arrow">-></span>
                                    <span class="agent-step">Analyze Income</span>
                                    <span class="agent-arrow">-></span>
                                    <span class="agent-step">Calculate Forms</span>
                                    <span class="agent-arrow">-></span>
                                    <span class="agent-step">Generate List</span>
                                </div>
                            </div>
                            <div class="agent-stats">
                                <div class="agent-stat">
                                    <div class="agent-stat-value">3 min</div>
                                    <div class="agent-stat-label">Time Saved</div>
                                </div>
                                <div class="agent-stat">
                                    <div class="agent-stat-value">100%</div>
                                    <div class="agent-stat-label">Accuracy</div>
                                </div>
                                <div class="agent-stat">
                                    <div class="agent-stat-value">Low</div>
                                    <div class="agent-stat-label">Complexity</div>
                                </div>
                            </div>
                            <button class="agent-prompt-btn" onclick="showAgentPrompt('formcount')">
                                View Build Prompt
                            </button>
                        </div>
                    </div>

                    <!-- Validation Agent -->
                    <div class="agent-card" id="agent-validation">
                        <div class="agent-card-header">
                            <div class="agent-icon">V</div>
                            <div class="agent-info">
                                <div class="agent-name">Validation Agent</div>
                                <div class="agent-type">Quality Assurance / Rules</div>
                            </div>
                            <span class="agent-priority high">High</span>
                        </div>
                        <div class="agent-card-body">
                            <p class="agent-description">Pre-submission validation that checks all form fields against IRS requirements, detects mutual exclusion violations (Line 6 vs Line 7), validates SSN/EIN formats, and ensures signature matches.</p>
                            <div class="agent-flow">
                                <div class="agent-flow-title">Agent Flow</div>
                                <div class="agent-flow-diagram">
                                    <span class="agent-step">Parse Form</span>
                                    <span class="agent-arrow">-></span>
                                    <span class="agent-step">Apply Rules</span>
                                    <span class="agent-arrow">-></span>
                                    <span class="agent-step">Flag Errors</span>
                                    <span class="agent-arrow">-></span>
                                    <span class="agent-step">Report</span>
                                </div>
                            </div>
                            <div class="agent-stats">
                                <div class="agent-stat">
                                    <div class="agent-stat-value">2 min</div>
                                    <div class="agent-stat-label">Time Saved</div>
                                </div>
                                <div class="agent-stat">
                                    <div class="agent-stat-value">95%</div>
                                    <div class="agent-stat-label">Error Catch</div>
                                </div>
                                <div class="agent-stat">
                                    <div class="agent-stat-value">Low</div>
                                    <div class="agent-stat-label">Complexity</div>
                                </div>
                            </div>
                            <button class="agent-prompt-btn" onclick="showAgentPrompt('validation')">
                                View Build Prompt
                            </button>
                        </div>
                    </div>

                    <!-- History Tracker -->
                    <div class="agent-card" id="agent-history">
                        <div class="agent-card-header">
                            <div class="agent-icon">H</div>
                            <div class="agent-info">
                                <div class="agent-name">History Tracker</div>
                                <div class="agent-type">Data Analysis / Comparison</div>
                            </div>
                            <span class="agent-priority medium">Medium</span>
                        </div>
                        <div class="agent-card-body">
                            <p class="agent-description">Compares borrower/business information across tax years to detect name changes, address changes, or entity type changes that require additional 4506-C forms.</p>
                            <div class="agent-flow">
                                <div class="agent-flow-title">Agent Flow</div>
                                <div class="agent-flow-diagram">
                                    <span class="agent-step">Load Tax Data</span>
                                    <span class="agent-arrow">-></span>
                                    <span class="agent-step">Compare Years</span>
                                    <span class="agent-arrow">-></span>
                                    <span class="agent-step">Detect Changes</span>
                                    <span class="agent-arrow">-></span>
                                    <span class="agent-step">Recommend Forms</span>
                                </div>
                            </div>
                            <div class="agent-stats">
                                <div class="agent-stat">
                                    <div class="agent-stat-value">2 min</div>
                                    <div class="agent-stat-label">Time Saved</div>
                                </div>
                                <div class="agent-stat">
                                    <div class="agent-stat-value">90%</div>
                                    <div class="agent-stat-label">Accuracy</div>
                                </div>
                                <div class="agent-stat">
                                    <div class="agent-stat-value">Med</div>
                                    <div class="agent-stat-label">Complexity</div>
                                </div>
                            </div>
                            <button class="agent-prompt-btn" onclick="showAgentPrompt('history')">
                                View Build Prompt
                            </button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </main>

    <!-- Documentation Modal -->
    <div class="modal-overlay" id="docModal">
        <div class="modal">
            <div class="modal-header">
                <h3>4506-C Form Completion - Workflow Documentation</h3>
                <div class="modal-actions">
                    <button class="modal-btn copy" onclick="copyToClipboard()">Copy</button>
                    <button class="modal-btn close" onclick="closeDocModal()">Close</button>
                </div>
            </div>
            <div class="modal-body">
                <pre id="docContent"># 4506-C Form Completion Guide

## Overview
IRS Form 4506-C is the IVES Request for Transcript of Tax Return. This form authorizes the IRS to release tax transcript information to designated IVES participants for mortgage loan verification.

## Key Form Lines

### Lines 1a-2c: Taxpayer Information
- Line 1a: Borrower name or business name
- Line 1b: SSN (XXX-XX-XXXX) or EIN (XX-XXXXX)
- Line 1c: Previous name (if changed since filing)
- Lines 2a-2c: Second taxpayer (joint 1040 only)

### Lines 3-4: Address Information
- Enter current address
- Lines 3a/3b for address on tax return if different

### Line 5: IVES Participant
- Veri-Tax LLC
- 30 Executive Park Suite 200, Irvine, CA 92614
- ID: 0000301975 | SOR: OGEN4506
- Leave 5b and 5c blank

### Line 6: Transcript Type (Mutual Exclusive with Line 7)
- 1040: Personal returns
- 1065: Partnership returns
- 1120/1120-S: Corporate returns

### Line 7: Wage & Income (Mutual Exclusive with Line 6)
- W-2, 1099, K-1 transcripts
- Do NOT complete if Line 6 is filled

### Line 8: Tax Year
- Format: MM/DD/YYYY

## Forms Required Matrix
- Single W-2: 1 form
- Single Self-Employed: 2+ forms
- Married Both W-2: 2 forms
- Married Mixed: 3+ forms
- Each business needs separate form

## Key Rules
1. Line 6 and Line 7 are mutually exclusive
2. ONE form type per 4506-C
3. Info must match last 2 years of returns
4. Name/address changes = additional forms
5. Business title must be acceptable</pre>
            </div>
        </div>
    </div>

    <!-- AI Prompt Modal -->
    <div class="modal-overlay prompt-modal" id="promptModal">
        <div class="modal">
            <div class="modal-header">
                <h3 id="promptModalTitle">AI Agent Build Prompt</h3>
                <div class="modal-actions">
                    <button class="modal-btn copy" onclick="copyPromptToClipboard()">Copy Prompt</button>
                    <button class="modal-btn close" onclick="closePromptModal()">Close</button>
                </div>
            </div>
            <div class="modal-body">
                <div class="prompt-tags" id="promptTags"></div>
                <div class="prompt-section">
                    <h4>Agent Purpose</h4>
                    <div class="prompt-box" id="promptPurpose"></div>
                </div>
                <div class="prompt-section">
                    <h4>Full Build Prompt</h4>
                    <div class="prompt-box" id="promptContent"></div>
                </div>
                <div class="prompt-section">
                    <h4>Integration Points</h4>
                    <div class="prompt-box" id="promptIntegration"></div>
                </div>
            </div>
        </div>
    </div>

    <div class="copy-success" id="copySuccess">Copied to clipboard!</div>

    <script>
        // Tab switching
        function switchTab(tab) {
            document.querySelectorAll('.sidebar-tab').forEach(t => t.classList.remove('active'));
            document.querySelectorAll('.tab-panel').forEach(p => p.classList.remove('active'));

            if (tab === 'workflow') {
                document.querySelector('.sidebar-tab:not(.agent-tab)').classList.add('active');
                document.getElementById('workflow-panel').classList.add('active');
                document.getElementById('workflow-nav').style.display = 'block';
                document.getElementById('agents-nav').style.display = 'none';
            } else {
                document.querySelector('.sidebar-tab.agent-tab').classList.add('active');
                document.getElementById('agents-panel').classList.add('active');
                document.getElementById('workflow-nav').style.display = 'none';
                document.getElementById('agents-nav').style.display = 'block';
            }

            window.scrollTo(0, 0);
        }

        // Scroll spy with isScrolling flag and 1000ms timeout
        const sections = document.querySelectorAll('.section, .quick-ref');
        const navItems = document.querySelectorAll('#workflow-nav .nav-item');
        let isScrolling = false;
        let scrollTimeout;

        function updateActiveNav() {
            if (isScrolling) return;

            let current = '';
            sections.forEach(section => {
                const sectionTop = section.offsetTop - 100;
                if (window.scrollY >= sectionTop) current = section.getAttribute('id');
            });
            navItems.forEach(item => {
                item.classList.remove('active');
                if (item.getAttribute('href') === '#' + current) item.classList.add('active');
            });
        }

        // Handle nav click to temporarily disable scroll spy
        navItems.forEach(item => {
            item.addEventListener('click', function(e) {
                isScrolling = true;
                clearTimeout(scrollTimeout);

                // Remove active from all, add to clicked
                navItems.forEach(nav => nav.classList.remove('active'));
                this.classList.add('active');

                // Re-enable scroll spy after 1000ms
                scrollTimeout = setTimeout(() => {
                    isScrolling = false;
                }, 1000);
            });
        });

        window.addEventListener('scroll', updateActiveNav);

        // Modal
        function openDocModal() {
            document.getElementById('docModal').classList.add('show');
            document.body.style.overflow = 'hidden';
        }

        function closeDocModal() {
            document.getElementById('docModal').classList.remove('show');
            document.body.style.overflow = '';
        }

        async function copyToClipboard() {
            try {
                await navigator.clipboard.writeText(document.getElementById('docContent').textContent);
                const success = document.getElementById('copySuccess');
                success.style.display = 'block';
                setTimeout(() => { success.style.display = 'none'; }, 2000);
            } catch (e) { alert('Failed to copy.'); }
        }

        document.addEventListener('keydown', (e) => { if (e.key === 'Escape') { closeDocModal(); closePromptModal(); } });
        document.getElementById('docModal').addEventListener('click', (e) => { if (e.target.id === 'docModal') closeDocModal(); });

        document.addEventListener('DOMContentLoaded', () => { updateActiveNav(); });

        // Scroll to agent card and highlight
        function scrollToAgent(agentId) {
            const agentCard = document.getElementById(agentId);
            if (agentCard) {
                document.querySelectorAll('.agent-card.highlight').forEach(card => {
                    card.classList.remove('highlight');
                });

                agentCard.scrollIntoView({ behavior: 'smooth', block: 'center' });

                setTimeout(() => {
                    agentCard.classList.add('highlight');
                }, 300);

                setTimeout(() => {
                    agentCard.classList.remove('highlight');
                }, 2500);
            }
        }

        // Agent Prompt System
        const agentPrompts = {
            formgen: {
                name: 'Auto-Form Generator',
                tags: ['Document Automation', 'PDF Generation', 'Medium Complexity', 'Critical Priority'],
                purpose: `This agent automatically generates pre-filled 4506-C forms by extracting borrower, employer, and tax information from the loan file. It intelligently maps URLA data to the correct form fields, handles IVES participant details, and produces ready-to-sign PDF documents, reducing form completion time from 10+ minutes to seconds.`,
                prompt: `You are building a Document Automation Agent for CMG Financial's 4506-C form completion process.

AGENT NAME: Auto-Form Generator
TYPE: Document Automation / PDF Generation

OBJECTIVE:
Create an agent that automatically generates pre-filled IRS Form 4506-C by extracting data from the loan origination system and mapping it to the correct form fields.

INPUT DATA SOURCES:
- URLA (Uniform Residential Loan Application)
- Borrower personal information
- Employment and income data
- Business entity information (if applicable)
- Previous loan file data for historical comparisons

FIELD MAPPING:
{
  "line_1a": "borrower.full_name OR business.name",
  "line_1b": "borrower.ssn OR business.ein",
  "line_1c": "borrower.previous_name (if exists)",
  "line_2a": "co_borrower.full_name (if joint 1040)",
  "line_2b": "co_borrower.ssn (if joint 1040)",
  "line_3": "borrower.current_address",
  "line_3a_3b": "borrower.tax_return_address (if different)",
  "line_5a": {
    "name": "Veri-Tax LLC",
    "address": "30 Executive Park Suite 200, Irvine, CA 92614",
    "id": "0000301975",
    "sor_mailbox": "OGEN4506"
  },
  "line_6": "form_type (1040|1065|1120|1120-S)",
  "line_7": "wage_income_flag (W-2|1099|K-1)",
  "line_8": "tax_year (MM/DD/YYYY format)"
}

BUSINESS LOGIC:
1. Determine if Line 6 OR Line 7 based on income type
2. Never populate both Line 6 and Line 7
3. Format SSN as XXX-XX-XXXX
4. Format EIN as XX-XXXXX
5. Set attestation checkbox to required
6. Pre-fill IVES participant data (always same)

PDF GENERATION:
- Use PDF form filling library (pdf-lib, iText)
- Maintain IRS form structure exactly
- Set form fields as editable for corrections
- Generate unique document ID for tracking`,
                integration: `INTEGRATION POINTS:
1. Loan Origination System
   - Read borrower data from URLA
   - Access income/employment records
   - Pull business entity information

2. PDF Processing
   - pdf-lib for Node.js
   - iText for Java/.NET
   - Adobe PDF Services API

3. Document Management
   - Store generated forms in loan file
   - Track form versions
   - Link to e-signature queue

4. Validation Service
   - Pre-fill validation before PDF generation
   - Field format verification
   - Required field checks

DEPLOYMENT:
- Trigger: Loan milestone or manual request
- Output: Pre-filled PDF ready for review/signature
- Fallback: Alert processor for manual completion`
            },
            formcount: {
                name: 'Form Count Calculator',
                tags: ['Logic Engine', 'Decision Rules', 'Low Complexity', 'High Priority'],
                purpose: `This agent analyzes the loan file to determine exactly how many 4506-C forms are required based on borrower count, marital status, income types (W-2 vs self-employed), and business ownership. It eliminates the guesswork and ensures no forms are missed.`,
                prompt: `You are building a Decision Engine Agent for CMG Financial's 4506-C form requirement calculation.

AGENT NAME: Form Count Calculator
TYPE: Logic / Decision Engine

OBJECTIVE:
Analyze loan file data to calculate the exact number and type of 4506-C forms required for complete tax transcript ordering.

INPUT DATA:
{
  "borrower_count": 1 | 2,
  "marital_status": "single" | "married" | "unmarried_joint",
  "borrower_1": {
    "income_types": ["W-2", "1099", "Schedule_C", "Schedule_E"],
    "businesses": ["business_name_1", "business_name_2"],
    "files_joint_1040": true | false
  },
  "borrower_2": {
    "income_types": [...],
    "businesses": [...],
    "files_joint_1040": true | false
  }
}

DECISION RULES:

Rule 1: W-2 Income
- Each borrower with W-2 income needs 1 Wage/Income form

Rule 2: Self-Employed (Schedule C)
- Needs 1 Wage/Income form + 1 Form 1040

Rule 3: Business Ownership
- Each business needs 1 separate form (1065 or 1120/1120-S)
- Business form type depends on entity structure

Rule 4: Joint 1040 Filing
- Married filing jointly: 1 Form 1040 with both names
- Married filing separately: 2 Form 1040s
- Unmarried: Always separate 1040s

Rule 5: Multiple Income Types
- Wage/Income and tax return forms are separate
- Never combine W-2 request with 1040 request

OUTPUT:
{
  "total_forms": 4,
  "forms_breakdown": [
    { "type": "Wage/Income", "borrower": "John Smith", "for": "W-2" },
    { "type": "Wage/Income", "borrower": "Jane Smith", "for": "W-2" },
    { "type": "1040", "borrower": "John & Jane Smith", "for": "Joint Return" },
    { "type": "1120-S", "business": "ABC Corp", "for": "S-Corp Return" }
  ]
}`,
                integration: `INTEGRATION POINTS:
1. Loan Origination System
   - Pull borrower employment data
   - Access income analysis worksheets
   - Business entity lookup

2. Auto-Form Generator
   - Pass form list to generator
   - Trigger form creation for each requirement

3. User Interface
   - Display form count to processor
   - Allow manual override if needed
   - Show reasoning for each form

4. Audit Trail
   - Log calculation inputs
   - Record decision path
   - Track manual overrides`
            },
            validation: {
                name: 'Validation Agent',
                tags: ['Quality Assurance', 'Rules Engine', 'Low Complexity', 'High Priority'],
                purpose: `This agent performs comprehensive pre-submission validation of 4506-C forms, checking all fields against IRS requirements, detecting mutual exclusion violations (Line 6 vs Line 7), validating SSN/EIN formats, and ensuring signatures match borrower names.`,
                prompt: `You are building a Quality Assurance Agent for CMG Financial's 4506-C form validation.

AGENT NAME: Validation Agent
TYPE: Quality Assurance / Rules Engine

OBJECTIVE:
Validate completed 4506-C forms before submission to catch errors that would cause IRS rejection.

VALIDATION RULES:

1. Required Fields Check:
   - Line 1a: Name present
   - Line 1b: SSN/EIN present and formatted
   - Line 3: Current address complete
   - Line 5a: IVES participant info complete
   - Line 8: Tax year(s) present
   - Attestation: Checked
   - Signature: Present

2. Mutual Exclusion Check:
   - IF Line 6 has value THEN Line 7 must be empty
   - IF Line 7 is checked THEN Line 6 must be empty
   - Flag error if both populated

3. Format Validation:
   - SSN format: XXX-XX-XXXX (regex: ^\\d{3}-\\d{2}-\\d{4}$)
   - EIN format: XX-XXXXX (regex: ^\\d{2}-\\d{5}$)
   - Date format: MM/DD/YYYY
   - Phone format: (XXX) XXX-XXXX

4. Signature Match:
   - Signature name must match Line 1a exactly
   - If business, verify authorized title

5. IVES Participant Verification:
   - Line 5a values match CMG's IVES participant
   - Lines 5b and 5c are blank

6. Conditional Fields:
   - Line 1c only if name changed
   - Lines 2a-2c only for joint 1040
   - Lines 3a/3b only if address different

OUTPUT:
{
  "valid": false,
  "errors": [
    { "field": "line_6", "error": "Cannot have both Line 6 and Line 7 populated", "severity": "critical" },
    { "field": "line_1b", "error": "SSN format invalid", "severity": "critical" }
  ],
  "warnings": [
    { "field": "line_1c", "warning": "Previous name field populated but no name change indicated" }
  ]
}`,
                integration: `INTEGRATION POINTS:
1. Form Parser
   - OCR or PDF field extraction
   - Handle filled PDF forms
   - Support scanned documents

2. LOS Validation
   - Cross-reference with loan data
   - Verify SSN matches borrower record
   - Confirm business EIN in file

3. Error Reporting
   - Real-time validation feedback
   - Error highlighting on form image
   - Suggested corrections

4. Workflow Integration
   - Block submission if critical errors
   - Alert processor for warnings
   - Log validation results`
            },
            history: {
                name: 'History Tracker',
                tags: ['Data Analysis', 'Comparison', 'Medium Complexity', 'Medium Priority'],
                purpose: `This agent compares borrower and business information across tax years to detect name changes, address changes, or entity type changes that require additional 4506-C forms. It ensures complete coverage for 2-year verification requirements.`,
                prompt: `You are building a Data Analysis Agent for CMG Financial's 4506-C historical change detection.

AGENT NAME: History Tracker
TYPE: Data Analysis / Comparison

OBJECTIVE:
Detect changes in borrower or business information across tax years that require multiple 4506-C forms for complete transcript retrieval.

INPUT DATA:
{
  "borrower": {
    "current": {
      "name": "Jane Doe",
      "address": "123 New St, City, ST 12345",
      "ssn": "XXX-XX-1234"
    },
    "tax_year_1": {
      "name": "Jane Smith",
      "address": "456 Old Ave, Town, ST 67890"
    },
    "tax_year_2": {
      "name": "Jane Doe",
      "address": "123 New St, City, ST 12345"
    }
  },
  "business": {
    "current": {
      "name": "ABC Corp",
      "address": "789 Business Blvd",
      "ein": "XX-XXXXX",
      "entity_type": "1120-S"
    },
    "tax_year_1": {
      "entity_type": "1065"
    },
    "tax_year_2": {
      "entity_type": "1120-S"
    }
  }
}

DETECTION LOGIC:

1. Name Change Detection:
   - Compare current name vs each tax year
   - Flag if any mismatch found
   - Recommend separate form with previous name

2. Address Change Detection:
   - Compare current address vs each tax year
   - Use fuzzy matching for minor variations
   - Flag significant address changes

3. Entity Type Change Detection:
   - Compare business entity type across years
   - 1065 -> 1120-S = Partnership to S-Corp
   - Requires separate form for each entity type

4. SSN/EIN Consistency:
   - Verify same identifier across years
   - Flag if mismatch (data entry error)

OUTPUT:
{
  "changes_detected": true,
  "additional_forms_needed": [
    {
      "reason": "Name change",
      "tax_year": 2022,
      "old_value": "Jane Smith",
      "new_value": "Jane Doe",
      "recommendation": "Create 4506-C with name 'Jane Smith' for 2022 tax year"
    },
    {
      "reason": "Entity type change",
      "tax_year": 2022,
      "old_value": "1065 (Partnership)",
      "new_value": "1120-S (S-Corp)",
      "recommendation": "Create separate 4506-C requesting 1065 for 2022"
    }
  ]
}`,
                integration: `INTEGRATION POINTS:
1. Tax Document Repository
   - Access prior year tax returns
   - Extract name/address from returns
   - Determine entity types

2. LOS Historical Data
   - Previous loan applications
   - Address history
   - Name change records

3. Form Count Calculator
   - Feed detected changes to calculator
   - Adjust total form count
   - Update form specifications

4. Auto-Form Generator
   - Generate forms with historical data
   - Pre-fill with correct year's information
   - Flag forms requiring specific old data`
            }
        };

        // Show agent prompt modal
        let currentPromptContent = '';

        function showAgentPrompt(agentKey) {
            const agent = agentPrompts[agentKey];
            if (!agent) return;

            document.getElementById('promptModalTitle').textContent = agent.name + ' - Build Prompt';

            const tagsHtml = agent.tags.map(tag => '<span class="prompt-tag">' + tag + '</span>').join('');
            document.getElementById('promptTags').innerHTML = tagsHtml;

            document.getElementById('promptPurpose').textContent = agent.purpose;
            document.getElementById('promptContent').textContent = agent.prompt;
            document.getElementById('promptIntegration').textContent = agent.integration;

            currentPromptContent = '# ' + agent.name + '\n\n## Purpose\n' + agent.purpose + '\n\n## Build Prompt\n' + agent.prompt + '\n\n## Integration Points\n' + agent.integration;

            document.getElementById('promptModal').classList.add('show');
            document.body.style.overflow = 'hidden';
        }

        function closePromptModal() {
            document.getElementById('promptModal').classList.remove('show');
            document.body.style.overflow = '';
        }

        async function copyPromptToClipboard() {
            try {
                await navigator.clipboard.writeText(currentPromptContent);
                const success = document.getElementById('copySuccess');
                success.style.display = 'block';
                setTimeout(() => { success.style.display = 'none'; }, 2000);
            } catch (e) {
                alert('Failed to copy prompt.');
            }
        }

        document.getElementById('promptModal').addEventListener('click', (e) => {
            if (e.target.id === 'promptModal') closePromptModal();
        });
    </script>
</body>
</html>
