<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>FHA Case Number for SUA - Process Workflow</title>
    <link href="https://fonts.googleapis.com/css2?family=Plus+Jakarta+Sans:wght@400;500;600;700;800&family=JetBrains+Mono:wght@400;500&display=swap" rel="stylesheet">
    <style>
        :root {
            --bg-primary: #0a0f1a;
            --bg-secondary: #111827;
            --bg-card: #1a2234;
            --accent-blue: #3b82f6;
            --accent-teal: #14b8a6;
            --accent-amber: #f59e0b;
            --accent-rose: #f43f5e;
            --accent-green: #22c55e;
            --accent-purple: #8b5cf6;
            --text-primary: #f1f5f9;
            --text-secondary: #94a3b8;
            --text-muted: #64748b;
            --border-subtle: rgba(255,255,255,0.08);
            --sidebar-width: 280px;
        }

        * { box-sizing: border-box; margin: 0; padding: 0; }
        html { scroll-behavior: smooth; }
        body {
            font-family: 'Plus Jakarta Sans', -apple-system, BlinkMacSystemFont, sans-serif;
            background: var(--bg-primary);
            color: var(--text-primary);
            min-height: 100vh;
        }

        /* Breadcrumb */
        .breadcrumb {
            background: linear-gradient(90deg, #0d1525 0%, #1a2234 100%);
            padding: 14px 25px;
            display: flex;
            align-items: center;
            gap: 12px;
            font-size: 0.95rem;
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            z-index: 1001;
            border-bottom: 1px solid var(--border-subtle);
        }

        .breadcrumb a {
            color: var(--text-secondary);
            text-decoration: none;
            font-weight: 600;
            padding: 8px 16px;
            background: rgba(255,255,255,0.05);
            border-radius: 8px;
            transition: all 0.2s;
            border: 1px solid var(--border-subtle);
        }

        .breadcrumb a:hover {
            background: rgba(59, 130, 246, 0.15);
            color: var(--accent-blue);
            border-color: rgba(59, 130, 246, 0.3);
        }

        .breadcrumb .separator { color: var(--text-muted); font-size: 1.2rem; }
        .breadcrumb .current { color: var(--accent-amber); font-weight: 600; padding: 8px 16px; }

        /* Sidebar */
        .sidebar {
            position: fixed;
            top: 54px;
            left: 0;
            width: var(--sidebar-width);
            height: calc(100vh - 54px);
            background: var(--bg-secondary);
            overflow-y: auto;
            z-index: 1000;
            border-right: 1px solid var(--border-subtle);
            display: flex;
            flex-direction: column;
        }

        .sidebar-header {
            padding: 25px 20px;
            background: rgba(0,0,0,0.3);
            border-bottom: 1px solid var(--border-subtle);
        }

        .sidebar-header h2 { color: var(--text-primary); font-size: 1.2rem; font-weight: 700; margin-bottom: 5px; }
        .sidebar-header p { color: var(--text-muted); font-size: 0.85rem; }

        /* Tab Switch */
        .sidebar-tabs {
            display: flex;
            border-bottom: 1px solid var(--border-subtle);
        }

        .sidebar-tab {
            flex: 1;
            padding: 14px 10px;
            text-align: center;
            font-size: 0.8rem;
            font-weight: 700;
            color: var(--text-muted);
            cursor: pointer;
            transition: all 0.2s;
            border-bottom: 3px solid transparent;
            background: none;
            border-left: none;
            border-right: none;
            border-top: none;
        }

        .sidebar-tab:hover { background: rgba(255,255,255,0.03); color: var(--text-secondary); }
        .sidebar-tab.active { color: var(--accent-blue); border-bottom-color: var(--accent-blue); background: rgba(59, 130, 246, 0.08); }
        .sidebar-tab.agent-tab.active { color: var(--accent-purple); border-bottom-color: var(--accent-purple); background: rgba(139, 92, 246, 0.08); }

        .sidebar-nav { padding: 15px 0; flex: 1; overflow-y: auto; }

        .nav-item {
            display: flex;
            align-items: center;
            gap: 12px;
            padding: 14px 20px;
            color: var(--text-secondary);
            text-decoration: none;
            border-left: 3px solid transparent;
            transition: all 0.2s ease;
            cursor: pointer;
        }

        .nav-item:hover { background: rgba(255,255,255,0.03); color: var(--text-primary); }
        .nav-item.active { background: rgba(59, 130, 246, 0.1); border-left-color: var(--accent-blue); color: var(--text-primary); }

        .nav-number {
            background: rgba(255,255,255,0.1);
            color: var(--text-secondary);
            width: 28px;
            height: 28px;
            border-radius: 8px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 700;
            font-size: 0.85rem;
            flex-shrink: 0;
        }

        .nav-item.active .nav-number { background: var(--accent-blue); color: white; }
        .nav-label { font-size: 0.95rem; font-weight: 500; }

        .sidebar-footer {
            padding: 20px;
            border-top: 1px solid var(--border-subtle);
            background: rgba(0,0,0,0.2);
        }

        .doc-btn {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
            width: 100%;
            padding: 14px 20px;
            background: linear-gradient(135deg, var(--accent-blue) 0%, var(--accent-teal) 100%);
            color: white;
            border: none;
            border-radius: 10px;
            font-weight: 600;
            cursor: pointer;
            transition: transform 0.2s, box-shadow 0.2s;
            text-decoration: none;
            font-size: 0.95rem;
        }

        .doc-btn:hover { transform: translateY(-2px); box-shadow: 0 8px 25px rgba(59, 130, 246, 0.3); }

        /* Main Content */
        .main-content { margin-left: var(--sidebar-width); padding: 80px 40px 40px 40px; }

        /* Tab Panels */
        .tab-panel { display: none; }
        .tab-panel.active { display: block; }

        .header {
            background: var(--bg-card);
            border: 1px solid var(--border-subtle);
            padding: 35px;
            border-radius: 16px;
            margin-bottom: 30px;
            position: relative;
            overflow: hidden;
        }

        .header::before {
            content: '';
            position: absolute;
            top: 0; left: 0; right: 0; bottom: 0;
            background:
                radial-gradient(ellipse at 20% 20%, rgba(59, 130, 246, 0.1) 0%, transparent 50%),
                radial-gradient(ellipse at 80% 80%, rgba(20, 184, 166, 0.08) 0%, transparent 50%);
            pointer-events: none;
        }

        .header h1 {
            font-size: 2.2rem;
            font-weight: 800;
            margin-bottom: 10px;
            position: relative;
            background: linear-gradient(135deg, var(--text-primary) 0%, var(--accent-blue) 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .header .subtitle { color: var(--text-secondary); font-size: 1.1rem; position: relative; }

        .header .meta { display: flex; gap: 15px; margin-top: 20px; flex-wrap: wrap; position: relative; }

        .header .meta-item {
            background: rgba(255,255,255,0.05);
            border: 1px solid var(--border-subtle);
            padding: 8px 16px;
            border-radius: 8px;
            font-size: 0.9rem;
            color: var(--text-secondary);
        }

        /* Legend */
        .legend {
            display: flex;
            flex-wrap: wrap;
            gap: 15px;
            padding: 18px 22px;
            background: var(--bg-card);
            border: 1px solid var(--border-subtle);
            border-radius: 12px;
            margin-bottom: 25px;
        }

        .legend-item { display: flex; align-items: center; gap: 8px; font-size: 0.85rem; color: var(--text-secondary); }
        .legend-color { width: 18px; height: 18px; border-radius: 4px; }

        /* Sections */
        .section {
            background: var(--bg-card);
            border: 1px solid var(--border-subtle);
            border-radius: 16px;
            margin-bottom: 25px;
            overflow: hidden;
            scroll-margin-top: 75px;
        }

        .section-header {
            background: linear-gradient(135deg, var(--bg-secondary) 0%, rgba(59, 130, 246, 0.1) 100%);
            border-bottom: 1px solid var(--border-subtle);
            padding: 22px 25px;
            display: flex;
            align-items: center;
            gap: 18px;
        }

        .section-number {
            background: linear-gradient(135deg, var(--accent-blue) 0%, var(--accent-teal) 100%);
            color: white;
            width: 48px;
            height: 48px;
            border-radius: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 800;
            font-size: 1.3rem;
            flex-shrink: 0;
        }

        .section-title h2 { font-size: 1.35rem; font-weight: 700; margin-bottom: 4px; color: var(--text-primary); }
        .section-title span { font-size: 0.9rem; color: var(--text-muted); }
        .section-content { padding: 28px; }

        /* Workflow Diagrams */
        .workflow-diagram {
            background: rgba(0,0,0,0.3);
            border: 1px solid var(--border-subtle);
            border-radius: 12px;
            padding: 28px;
            margin-bottom: 22px;
        }

        .flow-row { display: flex; align-items: center; justify-content: center; flex-wrap: wrap; gap: 12px; margin: 15px 0; }

        .flow-node {
            padding: 14px 22px;
            border-radius: 10px;
            text-align: center;
            font-size: 0.9rem;
            font-weight: 600;
            min-width: 150px;
            border: 1px solid var(--border-subtle);
        }

        .flow-node.start { background: linear-gradient(135deg, var(--accent-green) 0%, #16a34a 100%); color: white; border-radius: 25px; border: none; }
        .flow-node.action { background: linear-gradient(135deg, var(--accent-blue) 0%, #2563eb 100%); color: white; border: none; }
        .flow-node.decision { background: linear-gradient(135deg, var(--accent-amber) 0%, #d97706 100%); color: var(--bg-primary); border: none; }
        .flow-node.input { background: var(--bg-secondary); border: 2px solid var(--accent-blue); color: var(--text-primary); }
        .flow-node.output { background: linear-gradient(135deg, var(--accent-teal) 0%, #0d9488 100%); color: white; border: none; }
        .flow-node.exception { background: linear-gradient(135deg, var(--accent-rose) 0%, #dc2626 100%); color: white; border: none; }

        .flow-arrow { color: var(--accent-blue); font-size: 1.5rem; }
        .flow-arrow.down { transform: rotate(90deg); }

        .decision-branch { display: flex; gap: 40px; justify-content: center; margin: 20px 0; flex-wrap: wrap; }
        .branch { display: flex; flex-direction: column; align-items: center; gap: 10px; }

        .branch-label {
            background: var(--bg-secondary);
            border: 1px solid var(--border-subtle);
            padding: 6px 16px;
            border-radius: 20px;
            font-size: 0.8rem;
            font-weight: 700;
            color: var(--text-secondary);
        }

        /* Tables */
        .field-table { width: 100%; border-collapse: collapse; margin: 18px 0; }

        .field-table th {
            background: rgba(59, 130, 246, 0.15);
            color: var(--accent-blue);
            padding: 14px 18px;
            text-align: left;
            font-weight: 600;
            font-size: 0.9rem;
            text-transform: uppercase;
            letter-spacing: 0.05em;
            border-bottom: 1px solid var(--border-subtle);
        }

        .field-table td { padding: 14px 18px; border-bottom: 1px solid var(--border-subtle); color: var(--text-secondary); }
        .field-table tr:hover { background: rgba(255,255,255,0.02); }

        .badge { display: inline-block; padding: 4px 12px; border-radius: 6px; font-size: 0.75rem; font-weight: 700; text-transform: uppercase; letter-spacing: 0.05em; }
        .badge.required-badge { background: rgba(244, 63, 94, 0.15); color: var(--accent-rose); }
        .badge.optional-badge { background: rgba(34, 197, 94, 0.15); color: var(--accent-green); }
        .badge.calculated-badge { background: rgba(59, 130, 246, 0.15); color: var(--accent-blue); }
        .badge.conditional-badge { background: rgba(245, 158, 11, 0.15); color: var(--accent-amber); }

        /* Info Boxes */
        .exception-box, .tip-box, .info-box, .warning-box {
            padding: 18px 22px;
            margin: 18px 0;
            border-radius: 0 10px 10px 0;
            border-left-width: 4px;
            border-left-style: solid;
        }

        .exception-box { background: rgba(244, 63, 94, 0.08); border-color: var(--accent-rose); border: 1px solid rgba(244, 63, 94, 0.2); border-left: 4px solid var(--accent-rose); }
        .exception-box h4 { color: var(--accent-rose); margin-bottom: 10px; font-size: 1rem; }
        .exception-box p, .exception-box li { color: var(--text-secondary); }

        .tip-box { background: rgba(34, 197, 94, 0.08); border-color: var(--accent-green); border: 1px solid rgba(34, 197, 94, 0.2); border-left: 4px solid var(--accent-green); }
        .tip-box h4 { color: var(--accent-green); margin-bottom: 10px; font-size: 1rem; }
        .tip-box p, .tip-box li { color: var(--text-secondary); }

        .info-box { background: rgba(59, 130, 246, 0.08); border-color: var(--accent-blue); border: 1px solid rgba(59, 130, 246, 0.2); border-left: 4px solid var(--accent-blue); }
        .info-box h4 { color: var(--accent-blue); margin-bottom: 10px; font-size: 1rem; }
        .info-box p, .info-box li { color: var(--text-secondary); }

        .warning-box { background: rgba(245, 158, 11, 0.08); border-color: var(--accent-amber); border: 1px solid rgba(245, 158, 11, 0.2); border-left: 4px solid var(--accent-amber); }
        .warning-box h4 { color: var(--accent-amber); margin-bottom: 10px; font-size: 1rem; }
        .warning-box p, .warning-box li { color: var(--text-secondary); }

        /* Decision Tree */
        .decision-tree {
            background: rgba(0,0,0,0.2);
            border: 1px solid var(--border-subtle);
            border-radius: 12px;
            padding: 22px;
            margin: 22px 0;
        }

        .decision-tree h3 { color: var(--accent-blue); margin-bottom: 18px; padding-bottom: 12px; border-bottom: 1px solid var(--border-subtle); font-size: 1.1rem; }

        .tree-node { margin-left: 20px; padding: 12px; border-left: 2px solid var(--accent-teal); position: relative; color: var(--text-secondary); }
        .tree-node::before { content: ''; position: absolute; left: -2px; top: 22px; width: 15px; height: 2px; background: var(--accent-teal); }
        .tree-node.level-1 { margin-left: 0; border-left: none; }
        .tree-node.level-1::before { display: none; }

        .tree-label { background: var(--accent-amber); color: var(--bg-primary); padding: 6px 14px; border-radius: 6px; font-weight: 700; display: inline-block; margin-bottom: 6px; font-size: 0.9rem; }

        /* Summary Grid */
        .summary-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(180px, 1fr)); gap: 18px; margin: 22px 0; }

        .summary-card { background: rgba(0,0,0,0.3); border: 1px solid var(--border-subtle); border-radius: 12px; padding: 22px; text-align: center; }
        .summary-card h4 { color: var(--text-secondary); margin-bottom: 12px; font-size: 0.9rem; }
        .summary-card .value {
            font-size: 2.2rem;
            font-weight: 800;
            background: linear-gradient(135deg, var(--accent-blue) 0%, var(--accent-teal) 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }
        .summary-card .label { font-size: 0.85rem; color: var(--text-muted); margin-top: 8px; }

        /* Quick Reference */
        .quick-ref {
            background: linear-gradient(135deg, var(--bg-secondary) 0%, var(--bg-card) 100%);
            border: 1px solid var(--border-subtle);
            padding: 28px;
            border-radius: 16px;
            margin-top: 30px;
            font-family: 'JetBrains Mono', monospace;
            scroll-margin-top: 75px;
        }

        .quick-ref h3 { color: var(--accent-amber); margin-bottom: 18px; font-family: 'Plus Jakarta Sans', sans-serif; }
        .quick-ref pre { background: rgba(0,0,0,0.4); border: 1px solid var(--border-subtle); padding: 20px; border-radius: 10px; overflow-x: auto; font-size: 0.85rem; line-height: 1.7; color: var(--text-secondary); }

        /* Step List */
        .step-list { list-style: none; padding: 0; margin: 18px 0; }
        .step-list li {
            padding: 14px 18px;
            border-left: 3px solid var(--accent-blue);
            background: rgba(0,0,0,0.2);
            margin-bottom: 10px;
            border-radius: 0 8px 8px 0;
            color: var(--text-secondary);
        }
        .step-list li strong { color: var(--text-primary); }

        /* ====== AGENT OPPORTUNITIES STYLES ====== */
        .agent-header {
            background: var(--bg-card);
            border: 1px solid var(--border-subtle);
            padding: 35px;
            border-radius: 16px;
            margin-bottom: 30px;
            position: relative;
            overflow: hidden;
        }

        .agent-header::before {
            content: '';
            position: absolute;
            top: 0; left: 0; right: 0; bottom: 0;
            background:
                radial-gradient(ellipse at 20% 20%, rgba(139, 92, 246, 0.12) 0%, transparent 50%),
                radial-gradient(ellipse at 80% 80%, rgba(245, 158, 11, 0.1) 0%, transparent 50%);
            pointer-events: none;
        }

        .agent-header h1 {
            font-size: 2.2rem;
            font-weight: 800;
            margin-bottom: 10px;
            position: relative;
            background: linear-gradient(135deg, var(--accent-purple) 0%, var(--accent-amber) 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .agent-header .subtitle { color: var(--text-secondary); font-size: 1.1rem; position: relative; }

        /* Heat Map */
        .heat-map-container { margin-bottom: 35px; }
        .heat-map-title { font-size: 1.3rem; font-weight: 700; color: var(--text-primary); margin-bottom: 20px; display: flex; align-items: center; gap: 12px; }

        .heat-map-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
        }

        .heat-item {
            background: var(--bg-card);
            border: 1px solid var(--border-subtle);
            border-radius: 12px;
            padding: 20px;
            position: relative;
            overflow: hidden;
            transition: transform 0.2s, box-shadow 0.2s;
            cursor: pointer;
        }

        .heat-item:hover { transform: translateY(-3px); box-shadow: 0 10px 30px rgba(0,0,0,0.3); }
        .heat-item:active { transform: scale(0.98); }

        .heat-item::before {
            content: '';
            position: absolute;
            top: 0; left: 0; right: 0; height: 4px;
        }

        .heat-item.critical::before { background: linear-gradient(90deg, #ef4444, #f97316); }
        .heat-item.high::before { background: linear-gradient(90deg, #f97316, #eab308); }
        .heat-item.medium::before { background: linear-gradient(90deg, #eab308, #22c55e); }
        .heat-item.low::before { background: linear-gradient(90deg, #22c55e, #14b8a6); }

        .heat-score {
            position: absolute;
            top: 15px;
            right: 15px;
            font-size: 1.8rem;
            font-weight: 800;
        }

        .heat-item.critical .heat-score { color: #ef4444; }
        .heat-item.high .heat-score { color: #f97316; }
        .heat-item.medium .heat-score { color: #eab308; }
        .heat-item.low .heat-score { color: #22c55e; }

        .heat-name { font-size: 1rem; font-weight: 700; color: var(--text-primary); margin-bottom: 6px; padding-right: 50px; }
        .heat-desc { font-size: 0.85rem; color: var(--text-muted); margin-bottom: 12px; }

        .heat-metrics { display: flex; gap: 15px; margin-top: 12px; }
        .heat-metric { font-size: 0.75rem; color: var(--text-muted); }
        .heat-metric span { color: var(--text-secondary); font-weight: 600; }

        /* Agent Cards */
        .agent-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(380px, 1fr)); gap: 25px; margin-bottom: 35px; }

        .agent-card {
            background: var(--bg-card);
            border: 1px solid var(--border-subtle);
            border-radius: 16px;
            overflow: hidden;
            transition: transform 0.2s, box-shadow 0.2s;
        }

        .agent-card:hover { transform: translateY(-5px); box-shadow: 0 15px 50px rgba(0,0,0,0.3); }

        .agent-card.highlight {
            animation: highlightPulse 2s ease;
            box-shadow: 0 0 0 3px var(--accent-purple), 0 15px 50px rgba(139, 92, 246, 0.4);
        }

        @keyframes highlightPulse {
            0% { box-shadow: 0 0 0 3px var(--accent-purple), 0 15px 50px rgba(139, 92, 246, 0.6); }
            50% { box-shadow: 0 0 0 6px rgba(139, 92, 246, 0.5), 0 15px 50px rgba(139, 92, 246, 0.3); }
            100% { box-shadow: 0 0 0 0px transparent, 0 15px 50px rgba(0,0,0,0.3); }
        }

        .agent-card-header {
            padding: 22px;
            display: flex;
            align-items: flex-start;
            gap: 18px;
            border-bottom: 1px solid var(--border-subtle);
        }

        .agent-icon {
            width: 55px;
            height: 55px;
            background: linear-gradient(135deg, var(--accent-purple) 0%, var(--accent-blue) 100%);
            border-radius: 14px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.6rem;
            flex-shrink: 0;
        }

        .agent-info { flex: 1; }
        .agent-name { font-size: 1.15rem; font-weight: 700; color: var(--text-primary); margin-bottom: 5px; }
        .agent-type { font-size: 0.8rem; color: var(--accent-purple); font-weight: 600; text-transform: uppercase; letter-spacing: 0.05em; }

        .agent-priority {
            padding: 6px 12px;
            border-radius: 20px;
            font-size: 0.75rem;
            font-weight: 700;
            text-transform: uppercase;
        }

        .agent-priority.critical { background: rgba(239, 68, 68, 0.15); color: #ef4444; }
        .agent-priority.high { background: rgba(249, 115, 22, 0.15); color: #f97316; }
        .agent-priority.medium { background: rgba(234, 179, 8, 0.15); color: #eab308; }
        .agent-priority.low { background: rgba(34, 197, 94, 0.15); color: #22c55e; }

        .agent-card-body { padding: 22px; }
        .agent-description { font-size: 0.95rem; color: var(--text-secondary); line-height: 1.6; margin-bottom: 20px; }

        .agent-flow {
            background: rgba(0,0,0,0.3);
            border: 1px solid var(--border-subtle);
            border-radius: 10px;
            padding: 18px;
            margin-bottom: 20px;
        }

        .agent-flow-title { font-size: 0.85rem; color: var(--text-muted); margin-bottom: 12px; font-weight: 600; text-transform: uppercase; letter-spacing: 0.05em; }

        .agent-flow-diagram { display: flex; align-items: center; flex-wrap: wrap; gap: 8px; justify-content: center; }

        .agent-step {
            background: linear-gradient(135deg, var(--accent-purple) 0%, var(--accent-blue) 100%);
            color: white;
            padding: 8px 14px;
            border-radius: 6px;
            font-size: 0.8rem;
            font-weight: 600;
            white-space: nowrap;
        }

        .agent-arrow { color: var(--accent-purple); font-size: 1.2rem; }

        .agent-stats { display: grid; grid-template-columns: repeat(3, 1fr); gap: 12px; }

        .agent-stat {
            background: rgba(0,0,0,0.2);
            border-radius: 8px;
            padding: 12px;
            text-align: center;
        }

        .agent-stat-value {
            font-size: 1.3rem;
            font-weight: 800;
            background: linear-gradient(135deg, var(--accent-purple) 0%, var(--accent-amber) 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .agent-stat-label { font-size: 0.7rem; color: var(--text-muted); text-transform: uppercase; letter-spacing: 0.05em; margin-top: 4px; }

        /* View Prompt Button */
        .agent-prompt-btn {
            width: 100%;
            margin-top: 18px;
            padding: 14px 20px;
            background: linear-gradient(135deg, rgba(139, 92, 246, 0.2) 0%, rgba(59, 130, 246, 0.2) 100%);
            border: 1px solid rgba(139, 92, 246, 0.4);
            border-radius: 10px;
            color: var(--accent-purple);
            font-weight: 700;
            cursor: pointer;
            transition: all 0.2s;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
            font-size: 0.9rem;
        }

        .agent-prompt-btn:hover {
            background: linear-gradient(135deg, rgba(139, 92, 246, 0.3) 0%, rgba(59, 130, 246, 0.3) 100%);
            border-color: var(--accent-purple);
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(139, 92, 246, 0.25);
        }

        /* Summary Stats */
        .agent-summary {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin-bottom: 35px;
        }

        .agent-summary-card {
            background: var(--bg-card);
            border: 1px solid var(--border-subtle);
            border-radius: 14px;
            padding: 25px;
            text-align: center;
        }

        .agent-summary-value {
            font-size: 2.5rem;
            font-weight: 800;
            background: linear-gradient(135deg, var(--accent-purple) 0%, var(--accent-amber) 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .agent-summary-label { font-size: 0.9rem; color: var(--text-muted); margin-top: 8px; }

        /* Heat Map Legend */
        .heat-legend {
            display: flex;
            gap: 25px;
            padding: 18px 22px;
            background: var(--bg-card);
            border: 1px solid var(--border-subtle);
            border-radius: 12px;
            margin-bottom: 25px;
            flex-wrap: wrap;
        }

        .heat-legend-item { display: flex; align-items: center; gap: 10px; font-size: 0.9rem; color: var(--text-secondary); }
        .heat-legend-color { width: 24px; height: 24px; border-radius: 6px; }

        /* Modal */
        .modal-overlay {
            display: none;
            position: fixed;
            top: 0; left: 0; right: 0; bottom: 0;
            background: rgba(10, 15, 26, 0.9);
            z-index: 2000;
            justify-content: center;
            align-items: center;
            padding: 20px;
            backdrop-filter: blur(5px);
        }

        .modal-overlay.show { display: flex; }

        .modal {
            background: var(--bg-card);
            border: 1px solid var(--border-subtle);
            border-radius: 16px;
            width: 100%;
            max-width: 950px;
            max-height: 90vh;
            display: flex;
            flex-direction: column;
            box-shadow: 0 25px 80px rgba(0,0,0,0.5);
        }

        .modal-header {
            background: linear-gradient(135deg, var(--accent-blue) 0%, var(--accent-teal) 100%);
            color: white;
            padding: 22px 28px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            border-radius: 16px 16px 0 0;
        }

        .modal-header h3 { font-size: 1.25rem; font-weight: 700; }
        .modal-actions { display: flex; gap: 12px; }

        .modal-btn {
            padding: 10px 18px;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-weight: 700;
            transition: transform 0.2s;
            font-size: 0.9rem;
        }

        .modal-btn:hover { transform: scale(1.05); }
        .modal-btn.copy { background: white; color: var(--accent-blue); }
        .modal-btn.close { background: rgba(255,255,255,0.2); color: white; }

        .modal-body { padding: 28px; overflow-y: auto; flex: 1; }

        .modal-body pre {
            background: rgba(0,0,0,0.3);
            border: 1px solid var(--border-subtle);
            padding: 22px;
            border-radius: 10px;
            font-family: 'JetBrains Mono', monospace;
            font-size: 0.9rem;
            line-height: 1.7;
            white-space: pre-wrap;
            word-wrap: break-word;
            color: var(--text-secondary);
        }

        .copy-success {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: var(--accent-green);
            color: white;
            padding: 18px 35px;
            border-radius: 10px;
            font-weight: 700;
            z-index: 3000;
            display: none;
            animation: fadeInOut 2s ease;
        }

        @keyframes fadeInOut { 0%, 100% { opacity: 0; } 10%, 90% { opacity: 1; } }

        /* Prompt Modal */
        .prompt-modal .modal { max-width: 800px; }
        .prompt-modal .modal-header { background: linear-gradient(135deg, var(--accent-purple) 0%, var(--accent-blue) 100%); }

        .prompt-section { margin-bottom: 25px; }
        .prompt-section h4 { color: var(--accent-purple); font-size: 1rem; margin-bottom: 12px; display: flex; align-items: center; gap: 8px; }

        .prompt-box {
            background: rgba(0,0,0,0.4);
            border: 1px solid var(--border-subtle);
            border-radius: 10px;
            padding: 20px;
            font-family: 'JetBrains Mono', monospace;
            font-size: 0.85rem;
            line-height: 1.7;
            color: var(--text-secondary);
            white-space: pre-wrap;
            word-wrap: break-word;
        }

        .prompt-tags { display: flex; gap: 10px; flex-wrap: wrap; margin-bottom: 20px; }
        .prompt-tag { background: rgba(139, 92, 246, 0.15); color: var(--accent-purple); padding: 6px 14px; border-radius: 20px; font-size: 0.8rem; font-weight: 600; }

        .copy-prompt-btn {
            background: linear-gradient(135deg, var(--accent-purple) 0%, var(--accent-blue) 100%);
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 8px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.2s;
            margin-top: 15px;
        }

        .copy-prompt-btn:hover { transform: scale(1.05); box-shadow: 0 5px 20px rgba(139, 92, 246, 0.3); }

        @media (max-width: 900px) {
            .sidebar { display: none; }
            .main-content { margin-left: 0; padding: 75px 20px 30px 20px; }
            .agent-grid { grid-template-columns: 1fr; }
        }
            .breadcrumb-logo-link { display: flex; align-items: center; padding: 4px 8px; background: rgba(255,255,255,0.08); border-radius: 8px; border: 1px solid rgba(255,255,255,0.12); transition: all 0.2s; }
        .breadcrumb-logo-link:hover { background: rgba(255,255,255,0.15); }
        .breadcrumb-logo { height: 28px; width: auto; }
    </style>
</head>
<body>
    <!-- Breadcrumb -->
    <nav class="breadcrumb">
        <a href="../../index.html" class="breadcrumb-logo-link"><img src="../../images/clear-ai-logo.png" alt="Clear AI" class="breadcrumb-logo"></a>
        <a href="../../index.html">Portal Home</a>
        <span class="separator">></span>
        <a href="./index.html">Mortgage Fundamentals</a>
        <span class="separator">></span>
        <span class="current">FHA Case Number for Single-Unit Approval</span>
    </nav>

    <!-- Fixed Sidebar -->
    <aside class="sidebar">
        <div class="sidebar-header">
            <h2>FHA SUA Case Number</h2>
            <p>Interactive Workflow Guide</p>
        </div>

        <!-- Tab Switcher -->
        <div class="sidebar-tabs">
            <button class="sidebar-tab active" onclick="switchTab('workflow')">Workflow</button>
            <button class="sidebar-tab agent-tab" onclick="switchTab('agents')">AI Agents</button>
        </div>

        <!-- Workflow Navigation -->
        <nav class="sidebar-nav" id="workflow-nav">
            <a href="#section-1" class="nav-item active">
                <span class="nav-number">1</span>
                <span class="nav-label">Overview</span>
            </a>
            <a href="#section-2" class="nav-item">
                <span class="nav-number">2</span>
                <span class="nav-label">Condo ID Selection</span>
            </a>
            <a href="#section-3" class="nav-item">
                <span class="nav-number">3</span>
                <span class="nav-label">Site Condo Selection</span>
            </a>
            <a href="#section-4" class="nav-item">
                <span class="nav-number">4</span>
                <span class="nav-label">Condo Questionnaire</span>
            </a>
            <a href="#section-5" class="nav-item">
                <span class="nav-number">5</span>
                <span class="nav-label">HUD Processing</span>
            </a>
            <a href="#section-6" class="nav-item">
                <span class="nav-number">6</span>
                <span class="nav-label">Error Handling</span>
            </a>
            <a href="#quick-ref" class="nav-item">
                <span class="nav-number">*</span>
                <span class="nav-label">Quick Reference</span>
            </a>
        </nav>

        <!-- Agent Navigation -->
        <nav class="sidebar-nav" id="agents-nav" style="display: none;">
            <a href="#agent-summary" class="nav-item active">
                <span class="nav-number">S</span>
                <span class="nav-label">Summary</span>
            </a>
            <a href="#agent-heatmap" class="nav-item">
                <span class="nav-number">H</span>
                <span class="nav-label">Heat Map</span>
            </a>
            <a href="#agent-details" class="nav-item">
                <span class="nav-number">A</span>
                <span class="nav-label">Agent Details</span>
            </a>
        </nav>

        <div class="sidebar-footer">
            <button class="doc-btn" onclick="openDocModal()">
                View Workflow Markdown
            </button>
        </div>
    </aside>

    <!-- Main Content -->
    <main class="main-content">

        <!-- ==================== WORKFLOW TAB ==================== -->
        <div id="workflow-panel" class="tab-panel active">
            <!-- Header -->
            <div class="header">
                <h1>How to Pull a Case Number for FHA SUA</h1>
                <p class="subtitle">Complete guide for requesting FHA Case Number Assignment for Single-Unit Approval condominium loans</p>
                <div class="meta">
                    <span class="meta-item">System: FHA Connection</span>
                    <span class="meta-item">Role: Processor / Setup</span>
                    <span class="meta-item">Updated: May 3, 2024</span>
                    <span class="meta-item">Contact: condo@cmgfi.com</span>
                </div>
            </div>

            <!-- Legend -->
            <div class="legend">
                <div class="legend-item"><div class="legend-color" style="background: linear-gradient(135deg, #22c55e, #16a34a);"></div><span>Start/End</span></div>
                <div class="legend-item"><div class="legend-color" style="background: linear-gradient(135deg, #3b82f6, #2563eb);"></div><span>Action Step</span></div>
                <div class="legend-item"><div class="legend-color" style="background: linear-gradient(135deg, #f59e0b, #d97706);"></div><span>Decision Point</span></div>
                <div class="legend-item"><div class="legend-color" style="background: #111827; border: 2px solid #3b82f6;"></div><span>User Input</span></div>
                <div class="legend-item"><div class="legend-color" style="background: linear-gradient(135deg, #f43f5e, #dc2626);"></div><span>Exception</span></div>
                <div class="legend-item"><div class="legend-color" style="background: linear-gradient(135deg, #14b8a6, #0d9488);"></div><span>Output</span></div>
            </div>

            <!-- Section 1: Overview -->
            <section id="section-1" class="section">
                <div class="section-header">
                    <div class="section-number">1</div>
                    <div class="section-title"><h2>Overview</h2><span>Understanding the FHA Single-Unit Approval process</span></div>
                </div>
                <div class="section-content">
                    <div class="workflow-diagram">
                        <div class="flow-row">
                            <div class="flow-node start">Start SUA Process</div>
                            <span class="flow-arrow">-></span>
                            <div class="flow-node action">Access FHA Connection</div>
                            <span class="flow-arrow">-></span>
                            <div class="flow-node action">Case Number Assignment Screen</div>
                            <span class="flow-arrow">-></span>
                            <div class="flow-node output">Complete Required Fields</div>
                        </div>
                    </div>
                    <div class="info-box">
                        <h4>What is Single-Unit Approval (SUA)?</h4>
                        <p>Single-Unit Approval is an FHA process that allows individual condominium units to be eligible for FHA financing even when the entire condominium project is not FHA-approved. This process requires specific documentation and HUD verification.</p>
                    </div>
                    <div class="tip-box">
                        <h4>Standard Process</h4>
                        <p>To process a Case Number Assignment for a Single-Unit Approval, the Mortgagee will follow the standard process for requesting a case number for a condominium loan and complete specific fields in the Case Number Assignment screen.</p>
                    </div>
                </div>
            </section>

            <!-- Section 2: Condo ID Selection -->
            <section id="section-2" class="section">
                <div class="section-header">
                    <div class="section-number">2</div>
                    <div class="section-title"><h2>Step 1: Select Condo ID</h2><span>Select the associated Condo ID in FHA Connection</span></div>
                </div>
                <div class="section-content">
                    <div class="workflow-diagram">
                        <div class="flow-row">
                            <div class="flow-node action">Open Case Number Assignment</div>
                            <span class="flow-arrow">-></span>
                            <div class="flow-node decision">Condo ID Exists?</div>
                        </div>
                        <div class="decision-branch">
                            <div class="branch">
                                <span class="branch-label">YES</span>
                                <div class="flow-node input">Select Condo ID in PUD/Condo ID Field</div>
                            </div>
                            <div class="branch">
                                <span class="branch-label">NO</span>
                                <div class="flow-node exception">Leave PUD/Condo Fields Blank</div>
                            </div>
                        </div>
                    </div>
                    <table class="field-table">
                        <thead>
                            <tr>
                                <th>Field</th>
                                <th>Description</th>
                                <th>When Condo ID Exists</th>
                                <th>When No Condo ID</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td><strong>PUD/Condo ID</strong></td>
                                <td>FHA's identifier for the condominium project</td>
                                <td><span class="badge required-badge">Select ID</span></td>
                                <td><span class="badge optional-badge">Leave Blank</span></td>
                            </tr>
                            <tr>
                                <td><strong>PUD/Condo Indicator</strong></td>
                                <td>Indicator field for project type</td>
                                <td><span class="badge calculated-badge">Auto-Set</span></td>
                                <td><span class="badge optional-badge">Leave Blank</span></td>
                            </tr>
                            <tr>
                                <td><strong>Submission</strong></td>
                                <td>Submission type field</td>
                                <td><span class="badge calculated-badge">Auto-Set</span></td>
                                <td><span class="badge optional-badge">Leave Blank</span></td>
                            </tr>
                        </tbody>
                    </table>
                    <div class="warning-box">
                        <h4>Important: No Condo ID Scenario</h4>
                        <p>If a Condo ID doesn't exist, leave the "PUD/Condo Indicator" blank and the "Submission" blank, but make sure the "Site Condo" drop-down is still selected as "Single-Unit Approval".</p>
                    </div>
                </div>
            </section>

            <!-- Section 3: Site Condo Selection -->
            <section id="section-3" class="section">
                <div class="section-header">
                    <div class="section-number">3</div>
                    <div class="section-title"><h2>Step 2: Select Single-Unit Approval</h2><span>Configure the Site Condo field for SUA processing</span></div>
                </div>
                <div class="section-content">
                    <div class="workflow-diagram">
                        <div class="flow-row">
                            <div class="flow-node action">Locate Site Condo Field</div>
                            <span class="flow-arrow">-></span>
                            <div class="flow-node input">Select "Single-Unit Approval"</div>
                            <span class="flow-arrow">-></span>
                            <div class="flow-node output">Request Goes to Holds Tracking</div>
                        </div>
                    </div>
                    <ul class="step-list">
                        <li><strong>Step 2a:</strong> Locate the "Site Condo" field in the Case Number Assignment screen</li>
                        <li><strong>Step 2b:</strong> Select <strong>"Single-Unit Approval"</strong> from the drop-down menu</li>
                        <li><strong>Step 2c:</strong> The Single-Unit Approval Case Number Assignment request will default into Holds Tracking</li>
                        <li><strong>Step 2d:</strong> The user will be prompted to send the required information to the FHA Resource Center</li>
                    </ul>
                    <div class="info-box">
                        <h4>Holds Tracking</h4>
                        <p>When "Single-Unit Approval" is selected, the request automatically enters Holds Tracking status. This indicates that additional documentation and HUD verification is required before the case number can be issued.</p>
                    </div>
                    <div class="exception-box">
                        <h4>CRITICAL: Timing Requirements</h4>
                        <p><strong>Do not pull the case number until:</strong></p>
                        <ul style="margin-top: 10px; margin-left: 20px;">
                            <li>The condo docs have been submitted to <strong>condo@cmgfi.com</strong></li>
                            <li>Documents are ready for review</li>
                            <li>The case number pull must be within <strong>3 business days</strong> of when the condo underwriting team emails the 9991 form to HUD</li>
                        </ul>
                    </div>
                </div>
            </section>

            <!-- Section 4: Condo Questionnaire -->
            <section id="section-4" class="section">
                <div class="section-header">
                    <div class="section-number">4</div>
                    <div class="section-title"><h2>Step 3: Condo Questionnaire & Form 9991</h2><span>Process the condo questionnaire and submit Form 9991 to HUD</span></div>
                </div>
                <div class="section-content">
                    <div class="workflow-diagram">
                        <div class="flow-row">
                            <div class="flow-node action">Obtain Condo Questionnaire</div>
                            <span class="flow-arrow">-></span>
                            <div class="flow-node action">Condo UW Reviews</div>
                            <span class="flow-arrow">-></span>
                            <div class="flow-node action">Complete Form 9991</div>
                            <span class="flow-arrow">-></span>
                            <div class="flow-node output">Submit to HUD</div>
                        </div>
                    </div>
                    <div class="decision-tree">
                        <h3>Questionnaire Processing Flow</h3>
                        <ul class="step-list">
                            <li><strong>Step 3a:</strong> The condo processor or processing staff obtains the condo questionnaire from the project</li>
                            <li><strong>Step 3b:</strong> The condo underwriter reviews the questionnaire for completeness and compliance</li>
                            <li><strong>Step 3c:</strong> The condo underwriter completes <strong>Form 9991</strong> based on the questionnaire information</li>
                            <li><strong>Step 3d:</strong> Form 9991 is submitted to HUD via email</li>
                            <li><strong>Step 3e:</strong> If there are any changes required to the form, HUD will provide further instructions</li>
                        </ul>
                    </div>
                    <table class="field-table">
                        <thead>
                            <tr>
                                <th>Role</th>
                                <th>Responsibility</th>
                                <th>Action</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td><strong>Condo Processor</strong></td>
                                <td>Obtain questionnaire from property</td>
                                <td>Collect and submit to condo@cmgfi.com</td>
                            </tr>
                            <tr>
                                <td><strong>Processing Staff</strong></td>
                                <td>Alternative questionnaire collection</td>
                                <td>Collect and submit to condo@cmgfi.com</td>
                            </tr>
                            <tr>
                                <td><strong>Condo Underwriter</strong></td>
                                <td>Review questionnaire and complete 9991</td>
                                <td>Submit Form 9991 to HUD</td>
                            </tr>
                        </tbody>
                    </table>
                    <div class="tip-box">
                        <h4>Form 9991</h4>
                        <p>Form 9991 is the HUD form used to request Single-Unit Approval. It contains project information, financial data, and certifications that HUD uses to determine eligibility for case number issuance.</p>
                    </div>
                </div>
            </section>

            <!-- Section 5: HUD Processing -->
            <section id="section-5" class="section">
                <div class="section-header">
                    <div class="section-number">5</div>
                    <div class="section-title"><h2>Steps 4-5: HUD Processing & Response</h2><span>Homeownership Center verification and case number determination</span></div>
                </div>
                <div class="section-content">
                    <div class="workflow-diagram">
                        <div class="flow-row">
                            <div class="flow-node action">HOC Receives Request</div>
                            <span class="flow-arrow">-></span>
                            <div class="flow-node decision">Project History Check</div>
                        </div>
                        <div class="decision-branch">
                            <div class="branch">
                                <span class="branch-label">CLEAN HISTORY</span>
                                <div class="flow-node action">Process Verifications</div>
                                <span class="flow-arrow down">v</span>
                                <div class="flow-node output">Issue Case Number</div>
                            </div>
                            <div class="branch">
                                <span class="branch-label">WITHDRAWN/REJECTED</span>
                                <div class="flow-node exception">May Deny Case Number</div>
                                <span class="flow-arrow down">v</span>
                                <div class="flow-node exception">SUA Process Ends</div>
                            </div>
                        </div>
                    </div>

                    <div class="decision-tree">
                        <h3>Step 4: Homeownership Center Processing</h3>
                        <ul class="step-list">
                            <li><strong>Step 4a:</strong> The Homeownership Center (HOC) receives the SUA request and Form 9991</li>
                            <li><strong>Step 4b:</strong> HOC processes the information to determine if a case number can be issued</li>
                            <li><strong>Step 4c:</strong> Appropriate verifications are completed by HUD</li>
                            <li><strong>Step 4d:</strong> HOC provides response when Holds Tracking is removed</li>
                            <li><strong>Step 4e:</strong> The case binder must contain all documentation relied upon by the Mortgagee to justify its decision to approve the Mortgage</li>
                        </ul>
                    </div>

                    <div class="decision-tree">
                        <h3>Step 5: Project History Review</h3>
                        <ul class="step-list">
                            <li><strong>Step 5a:</strong> When HUD receives the email, they will check if the project has been withdrawn or rejected in the past</li>
                            <li><strong>Step 5b:</strong> If the project has a history of withdrawal or rejection, HUD may not issue a case number</li>
                            <li><strong>Step 5c:</strong> The reason for prior withdrawal or rejection determines eligibility</li>
                            <li><strong>Step 5d:</strong> If denied due to history, the SUA process would end</li>
                        </ul>
                    </div>

                    <div class="exception-box">
                        <h4>Project History Warning</h4>
                        <p>If the condominium project has been previously withdrawn or rejected from FHA approval, HUD will review the reason for that status. Depending on the circumstances, HUD may decline to issue a case number for Single-Unit Approval, effectively ending the SUA process for that unit.</p>
                    </div>

                    <div class="info-box">
                        <h4>Case Binder Requirements</h4>
                        <p>The case binder must contain <strong>all documentation</strong> relied upon by the Mortgagee to justify its decision to approve the Mortgage. This includes the condo questionnaire, Form 9991, and any supporting documentation.</p>
                    </div>
                </div>
            </section>

            <!-- Section 6: Error Handling -->
            <section id="section-6" class="section">
                <div class="section-header">
                    <div class="section-number">6</div>
                    <div class="section-title"><h2>Error Handling</h2><span>Understanding and resolving Case Number Assignment errors</span></div>
                </div>
                <div class="section-content">
                    <div class="info-box">
                        <h4>Request with Errors Example</h4>
                        <p>When a Case Number Assignment request encounters issues, the FHA Connection system will display error messages that require attention before the case number can be issued.</p>
                    </div>

                    <table class="field-table">
                        <thead>
                            <tr>
                                <th>Error Message</th>
                                <th>Meaning</th>
                                <th>Resolution</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td><strong>REQUEST PLACED ON HOLD PENDING HOC PROCESSING</strong></td>
                                <td>SUA request requires Homeownership Center review</td>
                                <td>Normal for SUA - await HOC response</td>
                            </tr>
                            <tr>
                                <td><strong>HELD FOR SINGLE-UNIT APPROVAL</strong></td>
                                <td>Indicates SUA processing is required</td>
                                <td>Submit required docs to answers@hud.gov</td>
                            </tr>
                            <tr>
                                <td><strong>PLEASE EMAIL CONDOMINIUM LL SUA QUESTIONNAIRE</strong></td>
                                <td>HUD requesting questionnaire documentation</td>
                                <td>Email questionnaire per HUD instructions</td>
                            </tr>
                        </tbody>
                    </table>

                    <div class="decision-tree">
                        <h3>Example Case Number Assignment Screen Fields</h3>
                        <p style="color: var(--text-secondary); margin-bottom: 15px;">Based on the request with errors example shown in the training document:</p>
                        <table class="field-table">
                            <thead>
                                <tr>
                                    <th>Field</th>
                                    <th>Example Value</th>
                                    <th>Notes</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td><strong>PUD/Condo Indicator</strong></td>
                                    <td>Condominium</td>
                                    <td>Property type selection</td>
                                </tr>
                                <tr>
                                    <td><strong>PUD/Condo ID</strong></td>
                                    <td>S006079</td>
                                    <td>FHA project identifier</td>
                                </tr>
                                <tr>
                                    <td><strong>Submission</strong></td>
                                    <td>011</td>
                                    <td>Submission code</td>
                                </tr>
                                <tr>
                                    <td><strong>Site Condo</strong></td>
                                    <td>Single-Unit Approval</td>
                                    <td>Required for SUA</td>
                                </tr>
                                <tr>
                                    <td><strong>Name</strong></td>
                                    <td>ARBOR PASS CONDOMINIUMS</td>
                                    <td>Project name</td>
                                </tr>
                                <tr>
                                    <td><strong>Month/Yr Completed</strong></td>
                                    <td>01/2008</td>
                                    <td>Project completion date</td>
                                </tr>
                            </tbody>
                        </table>
                    </div>

                    <div class="tip-box">
                        <h4>Need Help?</h4>
                        <p>For assistance with FHA SUA Case Number requests, contact the condo team at <strong>condo@cmgfi.com</strong></p>
                    </div>
                </div>
            </section>

            <!-- Quick Reference -->
            <div id="quick-ref" class="quick-ref">
                <h3>FHA SUA Case Number Quick Reference</h3>
                <pre>
FHA SINGLE-UNIT APPROVAL CASE NUMBER PROCESS
=============================================

PRE-REQUISITES
--------------
[ ] Condo docs submitted to condo@cmgfi.com
[ ] Documents ready for condo underwriter review
[ ] Timing: Within 3 business days of 9991 form submission to HUD

STEP 1: CONDO ID SELECTION
--------------------------
IF Condo ID EXISTS:
  - Select Condo ID in "PUD/Condo ID" field
  - Other fields auto-populate

IF NO Condo ID:
  - Leave "PUD/Condo Indicator" BLANK
  - Leave "Submission" BLANK
  - Still select "Single-Unit Approval" in Site Condo

STEP 2: SITE CONDO FIELD
------------------------
- Select "Single-Unit Approval" from drop-down
- Request enters Holds Tracking automatically
- User prompted to send info to FHA Resource Center

STEP 3: FORM 9991 PROCESS
-------------------------
1. Condo processor obtains questionnaire
2. Submit to condo@cmgfi.com for review
3. Condo underwriter reviews questionnaire
4. Condo underwriter completes Form 9991
5. Form 9991 emailed to HUD

STEPS 4-5: HUD PROCESSING
-------------------------
- Homeownership Center processes request
- HUD checks for prior withdrawals/rejections
- Verifications completed
- Holds Tracking removed when response ready
- Case number issued (or denied if history issues)

KEY CONTACTS
------------
CMG Condo Team:     condo@cmgfi.com
HUD Questions:      answers@hud.gov

CASE BINDER REQUIREMENTS
------------------------
Must contain ALL documentation relied upon to approve:
- Condo questionnaire
- Form 9991
- Supporting documentation
- Verification records

WARNING: PROJECT HISTORY
------------------------
If project previously withdrawn/rejected:
- HUD reviews reason for prior status
- May decline case number issuance
- SUA process ends if denied

COMMON ERROR MESSAGES
---------------------
"REQUEST PLACED ON HOLD PENDING HOC PROCESSING"
  -> Normal for SUA, await HOC response

"HELD FOR SINGLE-UNIT APPROVAL"
  -> Submit required docs to answers@hud.gov

"PLEASE EMAIL CONDOMINIUM LL SUA QUESTIONNAIRE"
  -> Email questionnaire per instructions
                </pre>
            </div>
        </div>

        <!-- ==================== AI AGENTS TAB ==================== -->
        <div id="agents-panel" class="tab-panel">
            <!-- Agent Header -->
            <div class="agent-header">
                <h1>AI Agent Opportunities</h1>
                <p class="subtitle">Automation opportunities identified for the FHA SUA Case Number process</p>
            </div>

            <!-- Summary Stats -->
            <div class="agent-summary" id="agent-summary">
                <div class="agent-summary-card">
                    <div class="agent-summary-value">4</div>
                    <div class="agent-summary-label">Agent Opportunities</div>
                </div>
                <div class="agent-summary-card">
                    <div class="agent-summary-value">65%</div>
                    <div class="agent-summary-label">Automation Potential</div>
                </div>
                <div class="agent-summary-card">
                    <div class="agent-summary-value">15 min</div>
                    <div class="agent-summary-label">Est. Time Saved</div>
                </div>
                <div class="agent-summary-card">
                    <div class="agent-summary-value">High</div>
                    <div class="agent-summary-label">Compliance Impact</div>
                </div>
            </div>

            <!-- Heat Map Legend -->
            <div class="heat-legend">
                <div class="heat-legend-item">
                    <div class="heat-legend-color" style="background: linear-gradient(90deg, #ef4444, #f97316);"></div>
                    <span>Critical Priority (9-10)</span>
                </div>
                <div class="heat-legend-item">
                    <div class="heat-legend-color" style="background: linear-gradient(90deg, #f97316, #eab308);"></div>
                    <span>High Priority (7-8)</span>
                </div>
                <div class="heat-legend-item">
                    <div class="heat-legend-color" style="background: linear-gradient(90deg, #eab308, #22c55e);"></div>
                    <span>Medium Priority (5-6)</span>
                </div>
                <div class="heat-legend-item">
                    <div class="heat-legend-color" style="background: linear-gradient(90deg, #22c55e, #14b8a6);"></div>
                    <span>Low Priority (1-4)</span>
                </div>
            </div>

            <!-- Heat Map Grid -->
            <div class="heat-map-container" id="agent-heatmap">
                <div class="heat-map-title">Priority Heat Map</div>
                <div class="heat-map-grid">
                    <div class="heat-item critical" onclick="scrollToAgent('agent-timing')">
                        <div class="heat-score">9.0</div>
                        <div class="heat-name">Timing Compliance Agent</div>
                        <div class="heat-desc">Monitor 3-day window for case number pull after 9991 submission</div>
                        <div class="heat-metrics">
                            <div class="heat-metric">Time: <span>N/A</span></div>
                            <div class="heat-metric">Complexity: <span>Low</span></div>
                        </div>
                    </div>
                    <div class="heat-item high" onclick="scrollToAgent('agent-condoid')">
                        <div class="heat-score">8.2</div>
                        <div class="heat-name">Condo ID Lookup Agent</div>
                        <div class="heat-desc">Auto-search FHA database for existing Condo IDs</div>
                        <div class="heat-metrics">
                            <div class="heat-metric">Time: <span>5 min</span></div>
                            <div class="heat-metric">Complexity: <span>Medium</span></div>
                        </div>
                    </div>
                    <div class="heat-item high" onclick="scrollToAgent('agent-history')">
                        <div class="heat-score">7.8</div>
                        <div class="heat-name">Project History Agent</div>
                        <div class="heat-desc">Pre-check project withdrawal/rejection history</div>
                        <div class="heat-metrics">
                            <div class="heat-metric">Time: <span>10 min</span></div>
                            <div class="heat-metric">Complexity: <span>Medium</span></div>
                        </div>
                    </div>
                    <div class="heat-item medium" onclick="scrollToAgent('agent-doctrack')">
                        <div class="heat-score">6.5</div>
                        <div class="heat-name">Doc Tracking Agent</div>
                        <div class="heat-desc">Track questionnaire and 9991 form status</div>
                        <div class="heat-metrics">
                            <div class="heat-metric">Time: <span>3 min</span></div>
                            <div class="heat-metric">Complexity: <span>Low</span></div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Agent Details -->
            <div id="agent-details">
                <h2 style="color: var(--text-primary); margin-bottom: 25px; font-size: 1.5rem;">Agent Details</h2>
                <div class="agent-grid">
                    <!-- Timing Compliance Agent -->
                    <div class="agent-card" id="agent-timing">
                        <div class="agent-card-header">
                            <div class="agent-icon">T</div>
                            <div class="agent-info">
                                <div class="agent-name">Timing Compliance Agent</div>
                                <div class="agent-type">Monitoring / Alerts</div>
                            </div>
                            <span class="agent-priority critical">Critical</span>
                        </div>
                        <div class="agent-card-body">
                            <p class="agent-description">Monitors the critical 3-business-day window between Form 9991 submission to HUD and case number pull. Sends proactive alerts to ensure compliance with FHA timing requirements and prevent process failures.</p>
                            <div class="agent-flow">
                                <div class="agent-flow-title">Agent Flow</div>
                                <div class="agent-flow-diagram">
                                    <span class="agent-step">9991 Sent</span>
                                    <span class="agent-arrow">-></span>
                                    <span class="agent-step">Start Timer</span>
                                    <span class="agent-arrow">-></span>
                                    <span class="agent-step">Monitor Days</span>
                                    <span class="agent-arrow">-></span>
                                    <span class="agent-step">Alert on Day 2</span>
                                </div>
                            </div>
                            <div class="agent-stats">
                                <div class="agent-stat">
                                    <div class="agent-stat-value">N/A</div>
                                    <div class="agent-stat-label">Time Saved</div>
                                </div>
                                <div class="agent-stat">
                                    <div class="agent-stat-value">99%</div>
                                    <div class="agent-stat-label">Accuracy</div>
                                </div>
                                <div class="agent-stat">
                                    <div class="agent-stat-value">Low</div>
                                    <div class="agent-stat-label">Complexity</div>
                                </div>
                            </div>
                            <button class="agent-prompt-btn" onclick="showAgentPrompt('timing')">
                                View Build Prompt
                            </button>
                        </div>
                    </div>

                    <!-- Condo ID Lookup Agent -->
                    <div class="agent-card" id="agent-condoid">
                        <div class="agent-card-header">
                            <div class="agent-icon">C</div>
                            <div class="agent-info">
                                <div class="agent-name">Condo ID Lookup Agent</div>
                                <div class="agent-type">Data Integration / Search</div>
                            </div>
                            <span class="agent-priority high">High</span>
                        </div>
                        <div class="agent-card-body">
                            <p class="agent-description">Automatically searches FHA Connection database and public FHA condo lookup tools to find existing Condo IDs for condominium projects. Pre-populates fields and alerts processor if ID exists or recommends leaving blank.</p>
                            <div class="agent-flow">
                                <div class="agent-flow-title">Agent Flow</div>
                                <div class="agent-flow-diagram">
                                    <span class="agent-step">Property Address</span>
                                    <span class="agent-arrow">-></span>
                                    <span class="agent-step">Search FHA DB</span>
                                    <span class="agent-arrow">-></span>
                                    <span class="agent-step">Match Project</span>
                                    <span class="agent-arrow">-></span>
                                    <span class="agent-step">Return Condo ID</span>
                                </div>
                            </div>
                            <div class="agent-stats">
                                <div class="agent-stat">
                                    <div class="agent-stat-value">5 min</div>
                                    <div class="agent-stat-label">Time Saved</div>
                                </div>
                                <div class="agent-stat">
                                    <div class="agent-stat-value">92%</div>
                                    <div class="agent-stat-label">Accuracy</div>
                                </div>
                                <div class="agent-stat">
                                    <div class="agent-stat-value">Med</div>
                                    <div class="agent-stat-label">Complexity</div>
                                </div>
                            </div>
                            <button class="agent-prompt-btn" onclick="showAgentPrompt('condoid')">
                                View Build Prompt
                            </button>
                        </div>
                    </div>

                    <!-- Project History Agent -->
                    <div class="agent-card" id="agent-history">
                        <div class="agent-card-header">
                            <div class="agent-icon">H</div>
                            <div class="agent-info">
                                <div class="agent-name">Project History Agent</div>
                                <div class="agent-type">Risk Assessment / Research</div>
                            </div>
                            <span class="agent-priority high">High</span>
                        </div>
                        <div class="agent-card-body">
                            <p class="agent-description">Pre-checks condominium project history for prior withdrawals or rejections from FHA approval before initiating SUA process. Provides early warning to avoid wasted effort on ineligible projects.</p>
                            <div class="agent-flow">
                                <div class="agent-flow-title">Agent Flow</div>
                                <div class="agent-flow-diagram">
                                    <span class="agent-step">Project Name</span>
                                    <span class="agent-arrow">-></span>
                                    <span class="agent-step">Query HUD Records</span>
                                    <span class="agent-arrow">-></span>
                                    <span class="agent-step">Check Status</span>
                                    <span class="agent-arrow">-></span>
                                    <span class="agent-step">Risk Assessment</span>
                                </div>
                            </div>
                            <div class="agent-stats">
                                <div class="agent-stat">
                                    <div class="agent-stat-value">10 min</div>
                                    <div class="agent-stat-label">Time Saved</div>
                                </div>
                                <div class="agent-stat">
                                    <div class="agent-stat-value">95%</div>
                                    <div class="agent-stat-label">Accuracy</div>
                                </div>
                                <div class="agent-stat">
                                    <div class="agent-stat-value">Med</div>
                                    <div class="agent-stat-label">Complexity</div>
                                </div>
                            </div>
                            <button class="agent-prompt-btn" onclick="showAgentPrompt('history')">
                                View Build Prompt
                            </button>
                        </div>
                    </div>

                    <!-- Doc Tracking Agent -->
                    <div class="agent-card" id="agent-doctrack">
                        <div class="agent-card-header">
                            <div class="agent-icon">D</div>
                            <div class="agent-info">
                                <div class="agent-name">Doc Tracking Agent</div>
                                <div class="agent-type">Workflow Management</div>
                            </div>
                            <span class="agent-priority medium">Medium</span>
                        </div>
                        <div class="agent-card-body">
                            <p class="agent-description">Tracks the status of condo questionnaire and Form 9991 through the SUA workflow. Monitors submission to condo@cmgfi.com, underwriter review, and HUD submission status with automated status updates.</p>
                            <div class="agent-flow">
                                <div class="agent-flow-title">Agent Flow</div>
                                <div class="agent-flow-diagram">
                                    <span class="agent-step">Monitor Inbox</span>
                                    <span class="agent-arrow">-></span>
                                    <span class="agent-step">Track Review</span>
                                    <span class="agent-arrow">-></span>
                                    <span class="agent-step">Confirm Submit</span>
                                    <span class="agent-arrow">-></span>
                                    <span class="agent-step">Update Status</span>
                                </div>
                            </div>
                            <div class="agent-stats">
                                <div class="agent-stat">
                                    <div class="agent-stat-value">3 min</div>
                                    <div class="agent-stat-label">Time Saved</div>
                                </div>
                                <div class="agent-stat">
                                    <div class="agent-stat-value">98%</div>
                                    <div class="agent-stat-label">Accuracy</div>
                                </div>
                                <div class="agent-stat">
                                    <div class="agent-stat-value">Low</div>
                                    <div class="agent-stat-label">Complexity</div>
                                </div>
                            </div>
                            <button class="agent-prompt-btn" onclick="showAgentPrompt('doctrack')">
                                View Build Prompt
                            </button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </main>

    <!-- Documentation Modal -->
    <div class="modal-overlay" id="docModal">
        <div class="modal">
            <div class="modal-header">
                <h3>FHA SUA Case Number Workflow Documentation</h3>
                <div class="modal-actions">
                    <button class="modal-btn copy" onclick="copyToClipboard()">Copy</button>
                    <button class="modal-btn close" onclick="closeDocModal()">Close</button>
                </div>
            </div>
            <div class="modal-body">
                <pre id="docContent"># How to Pull a Case Number for FHA SUA

## Overview
Single-Unit Approval (SUA) allows individual condo units to be FHA-eligible even when the project is not FHA-approved.

## Process Steps

### Step 1: Select Condo ID
- If Condo ID exists: Select in "PUD/Condo ID" field
- If no Condo ID: Leave PUD/Condo Indicator and Submission blank
- Always ensure Site Condo is set to "Single-Unit Approval"

### Step 2: Select Single-Unit Approval
- Select "Single-Unit Approval" from Site Condo drop-down
- Request enters Holds Tracking automatically
- System prompts for FHA Resource Center submission

### Step 3: Condo Questionnaire & Form 9991
- Condo processor obtains questionnaire
- Submit to condo@cmgfi.com for review
- Condo underwriter completes Form 9991
- Form 9991 submitted to HUD

### Steps 4-5: HUD Processing
- Homeownership Center processes request
- HUD checks project history for withdrawals/rejections
- Verifications completed
- Case number issued or denied

## Critical Timing
- Do not pull case number until docs submitted to condo@cmgfi.com
- Case number pull must be within 3 business days of 9991 submission to HUD

## Key Contacts
- CMG Condo Team: condo@cmgfi.com
- HUD Questions: answers@hud.gov

## Documentation Requirements
Case binder must contain ALL documentation relied upon to approve the Mortgage.

Updated: May 3, 2024</pre>
            </div>
        </div>
    </div>

    <!-- AI Prompt Modal -->
    <div class="modal-overlay prompt-modal" id="promptModal">
        <div class="modal">
            <div class="modal-header">
                <h3 id="promptModalTitle">AI Agent Build Prompt</h3>
                <div class="modal-actions">
                    <button class="modal-btn copy" onclick="copyPromptToClipboard()">Copy Prompt</button>
                    <button class="modal-btn close" onclick="closePromptModal()">Close</button>
                </div>
            </div>
            <div class="modal-body">
                <div class="prompt-tags" id="promptTags"></div>
                <div class="prompt-section">
                    <h4>Agent Purpose</h4>
                    <div class="prompt-box" id="promptPurpose"></div>
                </div>
                <div class="prompt-section">
                    <h4>Full Build Prompt</h4>
                    <div class="prompt-box" id="promptContent"></div>
                </div>
                <div class="prompt-section">
                    <h4>Integration Points</h4>
                    <div class="prompt-box" id="promptIntegration"></div>
                </div>
            </div>
        </div>
    </div>

    <div class="copy-success" id="copySuccess">Copied to clipboard!</div>

    <script>
        // Tab switching
        function switchTab(tab) {
            document.querySelectorAll('.sidebar-tab').forEach(t => t.classList.remove('active'));
            document.querySelectorAll('.tab-panel').forEach(p => p.classList.remove('active'));

            if (tab === 'workflow') {
                document.querySelector('.sidebar-tab:not(.agent-tab)').classList.add('active');
                document.getElementById('workflow-panel').classList.add('active');
                document.getElementById('workflow-nav').style.display = 'block';
                document.getElementById('agents-nav').style.display = 'none';
            } else {
                document.querySelector('.sidebar-tab.agent-tab').classList.add('active');
                document.getElementById('agents-panel').classList.add('active');
                document.getElementById('workflow-nav').style.display = 'none';
                document.getElementById('agents-nav').style.display = 'block';
            }

            window.scrollTo(0, 0);
        }

        // Scroll spy with isScrolling flag and 1000ms timeout
        const sections = document.querySelectorAll('.section, .quick-ref');
        const navItems = document.querySelectorAll('#workflow-nav .nav-item');
        let isScrolling = false;
        let scrollTimeout;

        function updateActiveNav() {
            if (isScrolling) return;

            let current = '';
            sections.forEach(section => {
                const sectionTop = section.offsetTop - 100;
                if (window.scrollY >= sectionTop) current = section.getAttribute('id');
            });
            navItems.forEach(item => {
                item.classList.remove('active');
                if (item.getAttribute('href') === '#' + current) item.classList.add('active');
            });
        }

        // Handle nav click to temporarily disable scroll spy
        navItems.forEach(item => {
            item.addEventListener('click', function(e) {
                isScrolling = true;
                clearTimeout(scrollTimeout);

                // Remove active from all, add to clicked
                navItems.forEach(nav => nav.classList.remove('active'));
                this.classList.add('active');

                // Re-enable scroll spy after 1000ms
                scrollTimeout = setTimeout(() => {
                    isScrolling = false;
                }, 1000);
            });
        });

        window.addEventListener('scroll', updateActiveNav);

        // Modal
        function openDocModal() {
            document.getElementById('docModal').classList.add('show');
            document.body.style.overflow = 'hidden';
        }

        function closeDocModal() {
            document.getElementById('docModal').classList.remove('show');
            document.body.style.overflow = '';
        }

        async function copyToClipboard() {
            try {
                await navigator.clipboard.writeText(document.getElementById('docContent').textContent);
                const success = document.getElementById('copySuccess');
                success.style.display = 'block';
                setTimeout(() => { success.style.display = 'none'; }, 2000);
            } catch (e) { alert('Failed to copy.'); }
        }

        document.addEventListener('keydown', (e) => { if (e.key === 'Escape') { closeDocModal(); closePromptModal(); } });
        document.getElementById('docModal').addEventListener('click', (e) => { if (e.target.id === 'docModal') closeDocModal(); });

        document.addEventListener('DOMContentLoaded', () => { updateActiveNav(); });

        // Scroll to agent card and highlight
        function scrollToAgent(agentId) {
            const agentCard = document.getElementById(agentId);
            if (agentCard) {
                document.querySelectorAll('.agent-card.highlight').forEach(card => {
                    card.classList.remove('highlight');
                });

                agentCard.scrollIntoView({ behavior: 'smooth', block: 'center' });

                setTimeout(() => {
                    agentCard.classList.add('highlight');
                }, 300);

                setTimeout(() => {
                    agentCard.classList.remove('highlight');
                }, 2500);
            }
        }

        // Agent Prompt System
        const agentPrompts = {
            timing: {
                name: 'Timing Compliance Agent',
                tags: ['Monitoring', 'Alerts', 'Low Complexity', 'Critical Priority'],
                purpose: `This agent monitors the critical 3-business-day window between Form 9991 submission to HUD and case number pull. It ensures compliance with FHA timing requirements by sending proactive alerts to processors and supervisors, preventing process failures and potential loan denials.`,
                prompt: `You are building a Compliance Monitoring Agent for CMG Financial's FHA SUA Case Number process.

AGENT NAME: Timing Compliance Agent
TYPE: Monitoring / Push Notifications

OBJECTIVE:
Monitor the critical timing window between Form 9991 submission to HUD and FHA case number pull, ensuring the 3-business-day requirement is met.

TRIGGERING EVENT:
- Email sent from condo@cmgfi.com to HUD (answers@hud.gov) containing Form 9991
- Parse email for loan number, borrower name, project name

MONITORING LOGIC:
1. Capture timestamp when 9991 email is sent to HUD
2. Calculate 3 business days (exclude weekends, federal holidays)
3. Track case number pull status in FHA Connection
4. Trigger alerts based on remaining time

ALERT THRESHOLDS:
- Day 1 (after submission): INFO - "9991 submitted, case number pull due by [date]"
- Day 2: WARNING - "URGENT: Case number pull due tomorrow"
- Day 3 (morning): CRITICAL - "FINAL DAY: Case number must be pulled today"
- Day 3 (afternoon, no action): ESCALATION - Notify supervisor + manager

ALERT CHANNELS:
- Email to assigned processor
- Byte task/notification
- Microsoft Teams message
- SMS for CRITICAL alerts

ALERT MESSAGE FORMAT:
{
  "loan_number": "2026-001234",
  "borrower_name": "John Smith",
  "project_name": "ARBOR PASS CONDOMINIUMS",
  "condo_id": "S006079",
  "9991_sent_date": "2026-01-24",
  "deadline_date": "2026-01-29",
  "days_remaining": 2,
  "alert_level": "WARNING",
  "processor": "Jane Doe",
  "action_required": "Pull FHA case number in FHA Connection before 01/29/2026"
}

BUSINESS DAY CALCULATION:
- Exclude Saturday and Sunday
- Exclude federal holidays (New Year's, MLK Day, Presidents Day, etc.)
- Start counting from day after 9991 submission`,
                integration: `INTEGRATION POINTS:
1. Email Monitoring
   - Monitor condo@cmgfi.com outbox
   - Parse emails to HUD for 9991 forms
   - Extract loan details from email body/attachments

2. FHA Connection Integration
   - Check case number status via FHA API
   - Detect when case number is pulled
   - Clear alerts upon successful pull

3. Notification Services
   - SendGrid for email alerts
   - Twilio for SMS (CRITICAL only)
   - MS Teams webhooks
   - Byte notification API

4. Calendar Service
   - Federal holiday API for business day calculation
   - Timezone handling for deadline accuracy

5. Tracking Database
   - Log all 9991 submissions
   - Track alert history
   - Generate compliance reports`
            },
            condoid: {
                name: 'Condo ID Lookup Agent',
                tags: ['Data Integration', 'Search', 'Medium Complexity', 'High Priority'],
                purpose: `This agent automatically searches FHA Connection database and public FHA condo lookup tools to find existing Condo IDs for condominium projects. It pre-populates case number assignment fields and provides guidance on whether to use an existing ID or leave fields blank.`,
                prompt: `You are building a Data Lookup Agent for CMG Financial's FHA SUA Case Number process.

AGENT NAME: Condo ID Lookup Agent
TYPE: Data Integration / Automated Search

OBJECTIVE:
Automatically search for existing FHA Condo IDs when processing Single-Unit Approval requests, reducing manual lookup time and ensuring accurate field population.

INPUT DATA:
- Property Address (street, city, state, zip)
- Project/Condominium Name
- County

SEARCH SOURCES (in priority order):
1. FHA Connection CHUMS Database
   - Direct API query if available
   - Screen scrape as fallback
2. HUD Condo Lookup Tool (entp.hud.gov/idapp/html/condolook.cfm)
3. State condo registry databases

SEARCH LOGIC:
1. Normalize address format
2. Search by exact project name
3. Search by address with fuzzy matching
4. Search by partial name + city/state
5. Return all potential matches with confidence scores

OUTPUT:
{
  "condo_id_found": true,
  "condo_id": "S006079",
  "project_name": "ARBOR PASS CONDOMINIUMS",
  "address_match_score": 0.95,
  "name_match_score": 0.88,
  "recommendation": "USE_EXISTING_ID",
  "alternatives": [],
  "notes": "Exact match found in FHA Connection"
}

OR (when not found):
{
  "condo_id_found": false,
  "recommendation": "LEAVE_BLANK",
  "search_performed": ["FHA Connection", "HUD Lookup", "State Registry"],
  "notes": "No matching Condo ID found - proceed with blank PUD/Condo fields"
}

FIELD MAPPING RECOMMENDATIONS:
IF condo_id_found = true:
  - PUD/Condo ID: [condo_id]
  - PUD/Condo Indicator: "Condominium"
  - Submission: [auto-populate based on project]

IF condo_id_found = false:
  - PUD/Condo Indicator: LEAVE BLANK
  - Submission: LEAVE BLANK
  - Site Condo: "Single-Unit Approval" (still required)`,
                integration: `INTEGRATION POINTS:
1. FHA Connection
   - API integration for CHUMS database
   - Session management for authenticated searches
   - Rate limiting to avoid lockouts

2. HUD Public Tools
   - Web scraping for condo lookup tool
   - Puppeteer/Playwright for dynamic pages
   - Result parsing and normalization

3. Address Normalization
   - USPS Address API for standardization
   - Fuzzy matching library (fuzzywuzzy)
   - Address component parsing

4. LOS Integration
   - Auto-populate fields in Byte
   - Display confidence scores to user
   - Allow manual override

5. Caching
   - Cache successful lookups for 90 days
   - Cache "not found" results for 30 days
   - Invalidate on project status change`
            },
            history: {
                name: 'Project History Agent',
                tags: ['Risk Assessment', 'Research', 'Medium Complexity', 'High Priority'],
                purpose: `This agent pre-checks condominium project history for prior withdrawals or rejections from FHA approval before initiating the SUA process. It provides early warning to processors about potential roadblocks and saves time on projects that are likely to be denied.`,
                prompt: `You are building a Risk Assessment Agent for CMG Financial's FHA SUA Case Number process.

AGENT NAME: Project History Agent
TYPE: Risk Assessment / Historical Research

OBJECTIVE:
Pre-check condominium project history for prior FHA withdrawals, rejections, or other adverse status before initiating Single-Unit Approval, preventing wasted effort on ineligible projects.

INPUT DATA:
- Project/Condominium Name
- Property Address
- Condo ID (if known)
- State/Jurisdiction

SEARCH SOURCES:
1. FHA Connection Historical Records
2. HUD Mortgagee Letters (for project-specific actions)
3. HUD enforcement actions database
4. State condo regulatory filings

HISTORY CHECK CRITERIA:
- Prior FHA project approval withdrawal
- Prior FHA project approval rejection
- Enforcement actions against project
- Recent litigation (HOA lawsuits, construction defects)
- Financial distress indicators (special assessments, reserve issues)

RISK ASSESSMENT OUTPUT:
{
  "project_name": "ARBOR PASS CONDOMINIUMS",
  "condo_id": "S006079",
  "risk_level": "HIGH" | "MEDIUM" | "LOW" | "CLEAR",
  "history_found": true,
  "history_items": [
    {
      "type": "WITHDRAWAL",
      "date": "2020-03-15",
      "reason": "Financial documentation issues",
      "source": "FHA Connection",
      "impact": "HUD may deny SUA based on prior withdrawal"
    }
  ],
  "recommendation": "PROCEED_WITH_CAUTION" | "DO_NOT_PROCEED" | "PROCEED",
  "suggested_actions": [
    "Contact HUD prior to submission to discuss prior withdrawal",
    "Gather additional documentation addressing prior issues"
  ]
}

RISK LEVEL DEFINITIONS:
- HIGH: Prior rejection or multiple withdrawals - likely denial
- MEDIUM: Single prior withdrawal with resolution path
- LOW: Minor historical issues, likely approvable
- CLEAR: No adverse history found

PROCESSOR NOTIFICATION:
- Display risk assessment prominently before case number pull
- Require acknowledgment for HIGH risk projects
- Suggest supervisor review for MEDIUM+ risk`,
                integration: `INTEGRATION POINTS:
1. FHA Connection
   - Query historical project records
   - Access withdrawal/rejection reasons
   - Track approval timeline

2. HUD Data Sources
   - Mortgagee letter database
   - Enforcement actions API
   - Public records portal

3. Risk Scoring Engine
   - Weight historical factors
   - Calculate composite risk score
   - Apply CMG-specific risk thresholds

4. Workflow Integration
   - Block or warn on case number pull
   - Route HIGH risk to supervisor
   - Capture acknowledgments

5. Reporting
   - Track SUA success rates by risk level
   - Identify patterns in denials
   - Refine risk model over time`
            },
            doctrack: {
                name: 'Doc Tracking Agent',
                tags: ['Workflow Management', 'Status Tracking', 'Low Complexity', 'Medium Priority'],
                purpose: `This agent tracks the status of condo questionnaire and Form 9991 through the complete SUA workflow. It monitors submission to condo@cmgfi.com, underwriter review status, and HUD submission confirmation with automated status updates to all stakeholders.`,
                prompt: `You are building a Workflow Tracking Agent for CMG Financial's FHA SUA Case Number process.

AGENT NAME: SUA Doc Tracking Agent
TYPE: Workflow Management / Status Tracking

OBJECTIVE:
Track all documentation through the SUA process from initial questionnaire submission through HUD response, providing visibility and status updates to all stakeholders.

WORKFLOW STAGES:
1. QUESTIONNAIRE_PENDING - Waiting for condo questionnaire
2. QUESTIONNAIRE_RECEIVED - Docs received at condo@cmgfi.com
3. UW_REVIEW - Condo underwriter reviewing questionnaire
4. FORM_9991_DRAFT - 9991 being prepared
5. FORM_9991_COMPLETE - 9991 ready for submission
6. SUBMITTED_TO_HUD - 9991 emailed to HUD
7. HOC_PROCESSING - Awaiting Homeownership Center review
8. RESPONSE_RECEIVED - HUD responded
9. CASE_NUMBER_ISSUED - Success
10. CASE_NUMBER_DENIED - Denied (with reason)

TRACKING DATA MODEL:
{
  "loan_number": "2026-001234",
  "borrower_name": "John Smith",
  "project_name": "ARBOR PASS CONDOMINIUMS",
  "status": "UW_REVIEW",
  "status_history": [
    { "status": "QUESTIONNAIRE_PENDING", "timestamp": "2026-01-20T09:00:00Z", "actor": "system" },
    { "status": "QUESTIONNAIRE_RECEIVED", "timestamp": "2026-01-21T14:30:00Z", "actor": "condo@cmgfi.com" },
    { "status": "UW_REVIEW", "timestamp": "2026-01-21T15:00:00Z", "actor": "Jane Doe (Condo UW)" }
  ],
  "current_owner": "Jane Doe",
  "days_in_status": 2,
  "sla_status": "ON_TRACK" | "AT_RISK" | "BREACHED"
}

EMAIL MONITORING:
- Monitor condo@cmgfi.com inbox for questionnaire submissions
- Detect 9991 submissions to answers@hud.gov
- Parse HUD response emails

STATUS UPDATE TRIGGERS:
- Email received at condo@cmgfi.com -> QUESTIONNAIRE_RECEIVED
- Underwriter opens file -> UW_REVIEW
- 9991 drafted in system -> FORM_9991_DRAFT
- 9991 sent to HUD -> SUBMITTED_TO_HUD
- HUD response email -> RESPONSE_RECEIVED
- Case number in FHA Connection -> CASE_NUMBER_ISSUED

NOTIFICATIONS:
- Status change notifications to processor
- SLA warnings to supervisor
- Daily digest of all in-progress SUA loans`,
                integration: `INTEGRATION POINTS:
1. Email Integration
   - condo@cmgfi.com inbox monitoring
   - Email parsing for document detection
   - HUD response email detection

2. LOS Integration
   - Track loan milestone updates
   - Update loan status in Byte
   - Display status in loan dashboard

3. Assignment Tracking
   - Track current document owner
   - Measure time in each stage
   - Generate SLA reports

4. Notification Hub
   - Real-time status updates
   - Configurable notification preferences
   - Escalation rules for delays

5. Reporting Dashboard
   - Pipeline view of all SUA loans
   - Stage duration analytics
   - Bottleneck identification`
            }
        };

        // Show agent prompt modal
        let currentPromptContent = '';

        function showAgentPrompt(agentKey) {
            const agent = agentPrompts[agentKey];
            if (!agent) return;

            document.getElementById('promptModalTitle').textContent = agent.name + ' - Build Prompt';

            const tagsHtml = agent.tags.map(tag => '<span class="prompt-tag">' + tag + '</span>').join('');
            document.getElementById('promptTags').innerHTML = tagsHtml;

            document.getElementById('promptPurpose').textContent = agent.purpose;
            document.getElementById('promptContent').textContent = agent.prompt;
            document.getElementById('promptIntegration').textContent = agent.integration;

            currentPromptContent = '# ' + agent.name + '\n\n## Purpose\n' + agent.purpose + '\n\n## Build Prompt\n' + agent.prompt + '\n\n## Integration Points\n' + agent.integration;

            document.getElementById('promptModal').classList.add('show');
            document.body.style.overflow = 'hidden';
        }

        function closePromptModal() {
            document.getElementById('promptModal').classList.remove('show');
            document.body.style.overflow = '';
        }

        async function copyPromptToClipboard() {
            try {
                await navigator.clipboard.writeText(currentPromptContent);
                const success = document.getElementById('copySuccess');
                success.style.display = 'block';
                setTimeout(() => { success.style.display = 'none'; }, 2000);
            } catch (e) {
                alert('Failed to copy prompt.');
            }
        }

        document.getElementById('promptModal').addEventListener('click', (e) => {
            if (e.target.id === 'promptModal') closePromptModal();
        });
    </script>
</body>
</html>
