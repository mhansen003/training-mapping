<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>First-Time Homebuyer Do's & Don'ts - Process Workflow</title>
    <link href="https://fonts.googleapis.com/css2?family=Plus+Jakarta+Sans:wght@400;500;600;700;800&family=JetBrains+Mono:wght@400;500&display=swap" rel="stylesheet">
    <style>
        :root {
            --bg-primary: #0a0f1a;
            --bg-secondary: #111827;
            --bg-card: #1a2234;
            --accent-blue: #3b82f6;
            --accent-teal: #14b8a6;
            --accent-amber: #f59e0b;
            --accent-rose: #f43f5e;
            --accent-green: #22c55e;
            --accent-purple: #8b5cf6;
            --text-primary: #f1f5f9;
            --text-secondary: #94a3b8;
            --text-muted: #64748b;
            --border-subtle: rgba(255,255,255,0.08);
            --sidebar-width: 280px;
        }

        * { box-sizing: border-box; margin: 0; padding: 0; }
        html { scroll-behavior: smooth; }
        body {
            font-family: 'Plus Jakarta Sans', -apple-system, BlinkMacSystemFont, sans-serif;
            background: var(--bg-primary);
            color: var(--text-primary);
            min-height: 100vh;
        }

        /* Breadcrumb */
        .breadcrumb {
            background: linear-gradient(90deg, #0d1525 0%, #1a2234 100%);
            padding: 14px 25px;
            display: flex;
            align-items: center;
            gap: 12px;
            font-size: 0.95rem;
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            z-index: 1001;
            border-bottom: 1px solid var(--border-subtle);
        }

        .breadcrumb a {
            color: var(--text-secondary);
            text-decoration: none;
            font-weight: 600;
            padding: 8px 16px;
            background: rgba(255,255,255,0.05);
            border-radius: 8px;
            transition: all 0.2s;
            border: 1px solid var(--border-subtle);
        }

        .breadcrumb a:hover {
            background: rgba(59, 130, 246, 0.15);
            color: var(--accent-blue);
            border-color: rgba(59, 130, 246, 0.3);
        }

        .breadcrumb .separator { color: var(--text-muted); font-size: 1.2rem; }
        .breadcrumb .current { color: var(--accent-amber); font-weight: 600; padding: 8px 16px; }

        /* Sidebar */
        .sidebar {
            position: fixed;
            top: 54px;
            left: 0;
            width: var(--sidebar-width);
            height: calc(100vh - 54px);
            background: var(--bg-secondary);
            overflow-y: auto;
            z-index: 1000;
            border-right: 1px solid var(--border-subtle);
            display: flex;
            flex-direction: column;
        }

        .sidebar-header {
            padding: 25px 20px;
            background: rgba(0,0,0,0.3);
            border-bottom: 1px solid var(--border-subtle);
        }

        .sidebar-header h2 { color: var(--text-primary); font-size: 1.2rem; font-weight: 700; margin-bottom: 5px; }
        .sidebar-header p { color: var(--text-muted); font-size: 0.85rem; }

        /* Tab Switch */
        .sidebar-tabs {
            display: flex;
            border-bottom: 1px solid var(--border-subtle);
        }

        .sidebar-tab {
            flex: 1;
            padding: 14px 10px;
            text-align: center;
            font-size: 0.8rem;
            font-weight: 700;
            color: var(--text-muted);
            cursor: pointer;
            transition: all 0.2s;
            border-bottom: 3px solid transparent;
            background: none;
            border-left: none;
            border-right: none;
            border-top: none;
        }

        .sidebar-tab:hover { background: rgba(255,255,255,0.03); color: var(--text-secondary); }
        .sidebar-tab.active { color: var(--accent-blue); border-bottom-color: var(--accent-blue); background: rgba(59, 130, 246, 0.08); }
        .sidebar-tab.agent-tab.active { color: var(--accent-purple); border-bottom-color: var(--accent-purple); background: rgba(139, 92, 246, 0.08); }

        .sidebar-nav { padding: 15px 0; flex: 1; overflow-y: auto; }

        .nav-item {
            display: flex;
            align-items: center;
            gap: 12px;
            padding: 14px 20px;
            color: var(--text-secondary);
            text-decoration: none;
            border-left: 3px solid transparent;
            transition: all 0.2s ease;
            cursor: pointer;
        }

        .nav-item:hover { background: rgba(255,255,255,0.03); color: var(--text-primary); }
        .nav-item.active { background: rgba(59, 130, 246, 0.1); border-left-color: var(--accent-blue); color: var(--text-primary); }

        .nav-number {
            background: rgba(255,255,255,0.1);
            color: var(--text-secondary);
            width: 28px;
            height: 28px;
            border-radius: 8px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 700;
            font-size: 0.85rem;
            flex-shrink: 0;
        }

        .nav-item.active .nav-number { background: var(--accent-blue); color: white; }
        .nav-label { font-size: 0.95rem; font-weight: 500; }

        .sidebar-footer {
            padding: 20px;
            border-top: 1px solid var(--border-subtle);
            background: rgba(0,0,0,0.2);
        }

        .doc-btn {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
            width: 100%;
            padding: 14px 20px;
            background: linear-gradient(135deg, var(--accent-blue) 0%, var(--accent-teal) 100%);
            color: white;
            border: none;
            border-radius: 10px;
            font-weight: 600;
            cursor: pointer;
            transition: transform 0.2s, box-shadow 0.2s;
            text-decoration: none;
            font-size: 0.95rem;
        }

        .doc-btn:hover { transform: translateY(-2px); box-shadow: 0 8px 25px rgba(59, 130, 246, 0.3); }

        /* Main Content */
        .main-content { margin-left: var(--sidebar-width); padding: 80px 40px 40px 40px; }

        /* Tab Panels */
        .tab-panel { display: none; }
        .tab-panel.active { display: block; }

        .header {
            background: var(--bg-card);
            border: 1px solid var(--border-subtle);
            padding: 35px;
            border-radius: 16px;
            margin-bottom: 30px;
            position: relative;
            overflow: hidden;
        }

        .header::before {
            content: '';
            position: absolute;
            top: 0; left: 0; right: 0; bottom: 0;
            background:
                radial-gradient(ellipse at 20% 20%, rgba(59, 130, 246, 0.1) 0%, transparent 50%),
                radial-gradient(ellipse at 80% 80%, rgba(20, 184, 166, 0.08) 0%, transparent 50%);
            pointer-events: none;
        }

        .header h1 {
            font-size: 2.2rem;
            font-weight: 800;
            margin-bottom: 10px;
            position: relative;
            background: linear-gradient(135deg, var(--text-primary) 0%, var(--accent-blue) 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .header .subtitle { color: var(--text-secondary); font-size: 1.1rem; position: relative; }

        .header .meta { display: flex; gap: 15px; margin-top: 20px; flex-wrap: wrap; position: relative; }

        .header .meta-item {
            background: rgba(255,255,255,0.05);
            border: 1px solid var(--border-subtle);
            padding: 8px 16px;
            border-radius: 8px;
            font-size: 0.9rem;
            color: var(--text-secondary);
        }

        /* Legend */
        .legend {
            display: flex;
            flex-wrap: wrap;
            gap: 15px;
            padding: 18px 22px;
            background: var(--bg-card);
            border: 1px solid var(--border-subtle);
            border-radius: 12px;
            margin-bottom: 25px;
        }

        .legend-item { display: flex; align-items: center; gap: 8px; font-size: 0.85rem; color: var(--text-secondary); }
        .legend-color { width: 18px; height: 18px; border-radius: 4px; }

        /* Sections */
        .section {
            background: var(--bg-card);
            border: 1px solid var(--border-subtle);
            border-radius: 16px;
            margin-bottom: 25px;
            overflow: hidden;
            scroll-margin-top: 75px;
        }

        .section-header {
            background: linear-gradient(135deg, var(--bg-secondary) 0%, rgba(59, 130, 246, 0.1) 100%);
            border-bottom: 1px solid var(--border-subtle);
            padding: 22px 25px;
            display: flex;
            align-items: center;
            gap: 18px;
        }

        .section-number {
            background: linear-gradient(135deg, var(--accent-blue) 0%, var(--accent-teal) 100%);
            color: white;
            width: 48px;
            height: 48px;
            border-radius: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 800;
            font-size: 1.3rem;
            flex-shrink: 0;
        }

        .section-title h2 { font-size: 1.35rem; font-weight: 700; margin-bottom: 4px; color: var(--text-primary); }
        .section-title span { font-size: 0.9rem; color: var(--text-muted); }
        .section-content { padding: 28px; }

        /* Workflow Diagrams */
        .workflow-diagram {
            background: rgba(0,0,0,0.3);
            border: 1px solid var(--border-subtle);
            border-radius: 12px;
            padding: 28px;
            margin-bottom: 22px;
        }

        .flow-row { display: flex; align-items: center; justify-content: center; flex-wrap: wrap; gap: 12px; margin: 15px 0; }

        .flow-node {
            padding: 14px 22px;
            border-radius: 10px;
            text-align: center;
            font-size: 0.9rem;
            font-weight: 600;
            min-width: 150px;
            border: 1px solid var(--border-subtle);
        }

        .flow-node.start { background: linear-gradient(135deg, var(--accent-green) 0%, #16a34a 100%); color: white; border-radius: 25px; border: none; }
        .flow-node.action { background: linear-gradient(135deg, var(--accent-blue) 0%, #2563eb 100%); color: white; border: none; }
        .flow-node.decision { background: linear-gradient(135deg, var(--accent-amber) 0%, #d97706 100%); color: var(--bg-primary); border: none; }
        .flow-node.input { background: var(--bg-secondary); border: 2px solid var(--accent-blue); color: var(--text-primary); }
        .flow-node.output { background: linear-gradient(135deg, var(--accent-teal) 0%, #0d9488 100%); color: white; border: none; }
        .flow-node.exception { background: linear-gradient(135deg, var(--accent-rose) 0%, #dc2626 100%); color: white; border: none; }

        .flow-arrow { color: var(--accent-blue); font-size: 1.5rem; }
        .flow-arrow.down { transform: rotate(90deg); }

        .decision-branch { display: flex; gap: 40px; justify-content: center; margin: 20px 0; flex-wrap: wrap; }
        .branch { display: flex; flex-direction: column; align-items: center; gap: 10px; }

        .branch-label {
            background: var(--bg-secondary);
            border: 1px solid var(--border-subtle);
            padding: 6px 16px;
            border-radius: 20px;
            font-size: 0.8rem;
            font-weight: 700;
            color: var(--text-secondary);
        }

        /* Tables */
        .field-table { width: 100%; border-collapse: collapse; margin: 18px 0; }

        .field-table th {
            background: rgba(59, 130, 246, 0.15);
            color: var(--accent-blue);
            padding: 14px 18px;
            text-align: left;
            font-weight: 600;
            font-size: 0.9rem;
            text-transform: uppercase;
            letter-spacing: 0.05em;
            border-bottom: 1px solid var(--border-subtle);
        }

        .field-table td { padding: 14px 18px; border-bottom: 1px solid var(--border-subtle); color: var(--text-secondary); }
        .field-table tr:hover { background: rgba(255,255,255,0.02); }

        .badge { display: inline-block; padding: 4px 12px; border-radius: 6px; font-size: 0.75rem; font-weight: 700; text-transform: uppercase; letter-spacing: 0.05em; }
        .badge.required-badge { background: rgba(244, 63, 94, 0.15); color: var(--accent-rose); }
        .badge.optional-badge { background: rgba(34, 197, 94, 0.15); color: var(--accent-green); }
        .badge.calculated-badge { background: rgba(59, 130, 246, 0.15); color: var(--accent-blue); }
        .badge.warning-badge { background: rgba(245, 158, 11, 0.15); color: var(--accent-amber); }

        /* Info Boxes */
        .exception-box, .tip-box, .info-box {
            padding: 18px 22px;
            margin: 18px 0;
            border-radius: 0 10px 10px 0;
            border-left-width: 4px;
            border-left-style: solid;
        }

        .exception-box { background: rgba(244, 63, 94, 0.08); border-color: var(--accent-rose); border: 1px solid rgba(244, 63, 94, 0.2); border-left: 4px solid var(--accent-rose); }
        .exception-box h4 { color: var(--accent-rose); margin-bottom: 10px; font-size: 1rem; }
        .exception-box p, .exception-box li { color: var(--text-secondary); }

        .tip-box { background: rgba(34, 197, 94, 0.08); border-color: var(--accent-green); border: 1px solid rgba(34, 197, 94, 0.2); border-left: 4px solid var(--accent-green); }
        .tip-box h4 { color: var(--accent-green); margin-bottom: 10px; font-size: 1rem; }
        .tip-box p, .tip-box li { color: var(--text-secondary); }

        .info-box { background: rgba(59, 130, 246, 0.08); border-color: var(--accent-blue); border: 1px solid rgba(59, 130, 246, 0.2); border-left: 4px solid var(--accent-blue); }
        .info-box h4 { color: var(--accent-blue); margin-bottom: 10px; font-size: 1rem; }
        .info-box p, .info-box li { color: var(--text-secondary); }

        /* Do/Don't Cards */
        .do-dont-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(320px, 1fr)); gap: 25px; margin: 22px 0; }

        .do-card, .dont-card {
            background: rgba(0,0,0,0.2);
            border: 1px solid var(--border-subtle);
            border-radius: 12px;
            overflow: hidden;
        }

        .do-card .card-header {
            background: linear-gradient(135deg, var(--accent-green) 0%, #16a34a 100%);
            color: white;
            padding: 16px 20px;
            font-weight: 700;
            font-size: 1.1rem;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .dont-card .card-header {
            background: linear-gradient(135deg, var(--accent-rose) 0%, #dc2626 100%);
            color: white;
            padding: 16px 20px;
            font-weight: 700;
            font-size: 1.1rem;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .do-card .card-body, .dont-card .card-body { padding: 20px; }

        .do-card ul, .dont-card ul { list-style: none; padding: 0; margin: 0; }

        .do-card li, .dont-card li {
            padding: 12px 0;
            border-bottom: 1px solid var(--border-subtle);
            color: var(--text-secondary);
            display: flex;
            align-items: flex-start;
            gap: 12px;
        }

        .do-card li:last-child, .dont-card li:last-child { border-bottom: none; }

        .check-icon { color: var(--accent-green); font-weight: bold; font-size: 1.1rem; flex-shrink: 0; }
        .x-icon { color: var(--accent-rose); font-weight: bold; font-size: 1.1rem; flex-shrink: 0; }

        /* Decision Tree */
        .decision-tree {
            background: rgba(0,0,0,0.2);
            border: 1px solid var(--border-subtle);
            border-radius: 12px;
            padding: 22px;
            margin: 22px 0;
        }

        .decision-tree h3 { color: var(--accent-blue); margin-bottom: 18px; padding-bottom: 12px; border-bottom: 1px solid var(--border-subtle); font-size: 1.1rem; }

        .tree-node { margin-left: 20px; padding: 12px; border-left: 2px solid var(--accent-teal); position: relative; color: var(--text-secondary); }
        .tree-node::before { content: ''; position: absolute; left: -2px; top: 22px; width: 15px; height: 2px; background: var(--accent-teal); }
        .tree-node.level-1 { margin-left: 0; border-left: none; }
        .tree-node.level-1::before { display: none; }

        .tree-label { background: var(--accent-amber); color: var(--bg-primary); padding: 6px 14px; border-radius: 6px; font-weight: 700; display: inline-block; margin-bottom: 6px; font-size: 0.9rem; }

        /* Summary Grid */
        .summary-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(180px, 1fr)); gap: 18px; margin: 22px 0; }

        .summary-card { background: rgba(0,0,0,0.3); border: 1px solid var(--border-subtle); border-radius: 12px; padding: 22px; text-align: center; }
        .summary-card h4 { color: var(--text-secondary); margin-bottom: 12px; font-size: 0.9rem; }
        .summary-card .value {
            font-size: 2.2rem;
            font-weight: 800;
            background: linear-gradient(135deg, var(--accent-blue) 0%, var(--accent-teal) 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }
        .summary-card .label { font-size: 0.85rem; color: var(--text-muted); margin-top: 8px; }

        /* Step List */
        .step-list { list-style: none; padding: 0; margin: 18px 0; }
        .step-list li {
            padding: 14px 18px;
            border-left: 3px solid var(--accent-blue);
            background: rgba(0,0,0,0.2);
            margin-bottom: 10px;
            border-radius: 0 8px 8px 0;
            color: var(--text-secondary);
        }
        .step-list li strong { color: var(--text-primary); }

        /* Quick Reference */
        .quick-ref {
            background: linear-gradient(135deg, var(--bg-secondary) 0%, var(--bg-card) 100%);
            border: 1px solid var(--border-subtle);
            padding: 28px;
            border-radius: 16px;
            margin-top: 30px;
            font-family: 'JetBrains Mono', monospace;
            scroll-margin-top: 75px;
        }

        .quick-ref h3 { color: var(--accent-amber); margin-bottom: 18px; font-family: 'Plus Jakarta Sans', sans-serif; }
        .quick-ref pre { background: rgba(0,0,0,0.4); border: 1px solid var(--border-subtle); padding: 20px; border-radius: 10px; overflow-x: auto; font-size: 0.85rem; line-height: 1.7; color: var(--text-secondary); }

        /* ====== AGENT OPPORTUNITIES STYLES ====== */
        .agent-header {
            background: var(--bg-card);
            border: 1px solid var(--border-subtle);
            padding: 35px;
            border-radius: 16px;
            margin-bottom: 30px;
            position: relative;
            overflow: hidden;
        }

        .agent-header::before {
            content: '';
            position: absolute;
            top: 0; left: 0; right: 0; bottom: 0;
            background:
                radial-gradient(ellipse at 20% 20%, rgba(139, 92, 246, 0.12) 0%, transparent 50%),
                radial-gradient(ellipse at 80% 80%, rgba(245, 158, 11, 0.1) 0%, transparent 50%);
            pointer-events: none;
        }

        .agent-header h1 {
            font-size: 2.2rem;
            font-weight: 800;
            margin-bottom: 10px;
            position: relative;
            background: linear-gradient(135deg, var(--accent-purple) 0%, var(--accent-amber) 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .agent-header .subtitle { color: var(--text-secondary); font-size: 1.1rem; position: relative; }

        /* Heat Map */
        .heat-map-container { margin-bottom: 35px; }
        .heat-map-title { font-size: 1.3rem; font-weight: 700; color: var(--text-primary); margin-bottom: 20px; display: flex; align-items: center; gap: 12px; }

        .heat-map-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
        }

        .heat-item {
            background: var(--bg-card);
            border: 1px solid var(--border-subtle);
            border-radius: 12px;
            padding: 20px;
            position: relative;
            overflow: hidden;
            transition: transform 0.2s, box-shadow 0.2s;
            cursor: pointer;
        }

        .heat-item:hover { transform: translateY(-3px); box-shadow: 0 10px 30px rgba(0,0,0,0.3); }
        .heat-item:active { transform: scale(0.98); }

        .heat-item::before {
            content: '';
            position: absolute;
            top: 0; left: 0; right: 0; height: 4px;
        }

        .heat-item.critical::before { background: linear-gradient(90deg, #ef4444, #f97316); }
        .heat-item.high::before { background: linear-gradient(90deg, #f97316, #eab308); }
        .heat-item.medium::before { background: linear-gradient(90deg, #eab308, #22c55e); }
        .heat-item.low::before { background: linear-gradient(90deg, #22c55e, #14b8a6); }

        .heat-score {
            position: absolute;
            top: 15px;
            right: 15px;
            font-size: 1.8rem;
            font-weight: 800;
        }

        .heat-item.critical .heat-score { color: #ef4444; }
        .heat-item.high .heat-score { color: #f97316; }
        .heat-item.medium .heat-score { color: #eab308; }
        .heat-item.low .heat-score { color: #22c55e; }

        .heat-name { font-size: 1rem; font-weight: 700; color: var(--text-primary); margin-bottom: 6px; padding-right: 50px; }
        .heat-desc { font-size: 0.85rem; color: var(--text-muted); margin-bottom: 12px; }

        .heat-metrics { display: flex; gap: 15px; margin-top: 12px; }
        .heat-metric { font-size: 0.75rem; color: var(--text-muted); }
        .heat-metric span { color: var(--text-secondary); font-weight: 600; }

        /* Agent Cards */
        .agent-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(380px, 1fr)); gap: 25px; margin-bottom: 35px; }

        .agent-card {
            background: var(--bg-card);
            border: 1px solid var(--border-subtle);
            border-radius: 16px;
            overflow: hidden;
            transition: transform 0.2s, box-shadow 0.2s;
        }

        .agent-card:hover { transform: translateY(-5px); box-shadow: 0 15px 50px rgba(0,0,0,0.3); }

        .agent-card.highlight {
            animation: highlightPulse 2s ease;
            box-shadow: 0 0 0 3px var(--accent-purple), 0 15px 50px rgba(139, 92, 246, 0.4);
        }

        @keyframes highlightPulse {
            0% { box-shadow: 0 0 0 3px var(--accent-purple), 0 15px 50px rgba(139, 92, 246, 0.6); }
            50% { box-shadow: 0 0 0 6px rgba(139, 92, 246, 0.5), 0 15px 50px rgba(139, 92, 246, 0.3); }
            100% { box-shadow: 0 0 0 0px transparent, 0 15px 50px rgba(0,0,0,0.3); }
        }

        .agent-card-header {
            padding: 22px;
            display: flex;
            align-items: flex-start;
            gap: 18px;
            border-bottom: 1px solid var(--border-subtle);
        }

        .agent-icon {
            width: 55px;
            height: 55px;
            background: linear-gradient(135deg, var(--accent-purple) 0%, var(--accent-blue) 100%);
            border-radius: 14px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.6rem;
            flex-shrink: 0;
        }

        .agent-info { flex: 1; }
        .agent-name { font-size: 1.15rem; font-weight: 700; color: var(--text-primary); margin-bottom: 5px; }
        .agent-type { font-size: 0.8rem; color: var(--accent-purple); font-weight: 600; text-transform: uppercase; letter-spacing: 0.05em; }

        .agent-priority {
            padding: 6px 12px;
            border-radius: 20px;
            font-size: 0.75rem;
            font-weight: 700;
            text-transform: uppercase;
        }

        .agent-priority.critical { background: rgba(239, 68, 68, 0.15); color: #ef4444; }
        .agent-priority.high { background: rgba(249, 115, 22, 0.15); color: #f97316; }
        .agent-priority.medium { background: rgba(234, 179, 8, 0.15); color: #eab308; }
        .agent-priority.low { background: rgba(34, 197, 94, 0.15); color: #22c55e; }

        .agent-card-body { padding: 22px; }
        .agent-description { font-size: 0.95rem; color: var(--text-secondary); line-height: 1.6; margin-bottom: 20px; }

        .agent-flow {
            background: rgba(0,0,0,0.3);
            border: 1px solid var(--border-subtle);
            border-radius: 10px;
            padding: 18px;
            margin-bottom: 20px;
        }

        .agent-flow-title { font-size: 0.85rem; color: var(--text-muted); margin-bottom: 12px; font-weight: 600; text-transform: uppercase; letter-spacing: 0.05em; }

        .agent-flow-diagram { display: flex; align-items: center; flex-wrap: wrap; gap: 8px; justify-content: center; }

        .agent-step {
            background: linear-gradient(135deg, var(--accent-purple) 0%, var(--accent-blue) 100%);
            color: white;
            padding: 8px 14px;
            border-radius: 6px;
            font-size: 0.8rem;
            font-weight: 600;
            white-space: nowrap;
        }

        .agent-arrow { color: var(--accent-purple); font-size: 1.2rem; }

        .agent-stats { display: grid; grid-template-columns: repeat(3, 1fr); gap: 12px; }

        .agent-stat {
            background: rgba(0,0,0,0.2);
            border-radius: 8px;
            padding: 12px;
            text-align: center;
        }

        .agent-stat-value {
            font-size: 1.3rem;
            font-weight: 800;
            background: linear-gradient(135deg, var(--accent-purple) 0%, var(--accent-amber) 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .agent-stat-label { font-size: 0.7rem; color: var(--text-muted); text-transform: uppercase; letter-spacing: 0.05em; margin-top: 4px; }

        /* View Prompt Button */
        .agent-prompt-btn {
            width: 100%;
            margin-top: 18px;
            padding: 14px 20px;
            background: linear-gradient(135deg, rgba(139, 92, 246, 0.2) 0%, rgba(59, 130, 246, 0.2) 100%);
            border: 1px solid rgba(139, 92, 246, 0.4);
            border-radius: 10px;
            color: var(--accent-purple);
            font-weight: 700;
            cursor: pointer;
            transition: all 0.2s;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
            font-size: 0.9rem;
        }

        .agent-prompt-btn:hover {
            background: linear-gradient(135deg, rgba(139, 92, 246, 0.3) 0%, rgba(59, 130, 246, 0.3) 100%);
            border-color: var(--accent-purple);
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(139, 92, 246, 0.25);
        }

        /* Summary Stats */
        .agent-summary {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin-bottom: 35px;
        }

        .agent-summary-card {
            background: var(--bg-card);
            border: 1px solid var(--border-subtle);
            border-radius: 14px;
            padding: 25px;
            text-align: center;
        }

        .agent-summary-value {
            font-size: 2.5rem;
            font-weight: 800;
            background: linear-gradient(135deg, var(--accent-purple) 0%, var(--accent-amber) 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .agent-summary-label { font-size: 0.9rem; color: var(--text-muted); margin-top: 8px; }

        /* Heat Map Legend */
        .heat-legend {
            display: flex;
            gap: 25px;
            padding: 18px 22px;
            background: var(--bg-card);
            border: 1px solid var(--border-subtle);
            border-radius: 12px;
            margin-bottom: 25px;
            flex-wrap: wrap;
        }

        .heat-legend-item { display: flex; align-items: center; gap: 10px; font-size: 0.9rem; color: var(--text-secondary); }
        .heat-legend-color { width: 24px; height: 24px; border-radius: 6px; }

        /* Modal */
        .modal-overlay {
            display: none;
            position: fixed;
            top: 0; left: 0; right: 0; bottom: 0;
            background: rgba(10, 15, 26, 0.9);
            z-index: 2000;
            justify-content: center;
            align-items: center;
            padding: 20px;
            backdrop-filter: blur(5px);
        }

        .modal-overlay.show { display: flex; }

        .modal {
            background: var(--bg-card);
            border: 1px solid var(--border-subtle);
            border-radius: 16px;
            width: 100%;
            max-width: 950px;
            max-height: 90vh;
            display: flex;
            flex-direction: column;
            box-shadow: 0 25px 80px rgba(0,0,0,0.5);
        }

        .modal-header {
            background: linear-gradient(135deg, var(--accent-blue) 0%, var(--accent-teal) 100%);
            color: white;
            padding: 22px 28px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            border-radius: 16px 16px 0 0;
        }

        .modal-header h3 { font-size: 1.25rem; font-weight: 700; }
        .modal-actions { display: flex; gap: 12px; }

        .modal-btn {
            padding: 10px 18px;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-weight: 700;
            transition: transform 0.2s;
            font-size: 0.9rem;
        }

        .modal-btn:hover { transform: scale(1.05); }
        .modal-btn.copy { background: white; color: var(--accent-blue); }
        .modal-btn.close { background: rgba(255,255,255,0.2); color: white; }

        .modal-body { padding: 28px; overflow-y: auto; flex: 1; }

        .modal-body pre {
            background: rgba(0,0,0,0.3);
            border: 1px solid var(--border-subtle);
            padding: 22px;
            border-radius: 10px;
            font-family: 'JetBrains Mono', monospace;
            font-size: 0.9rem;
            line-height: 1.7;
            white-space: pre-wrap;
            word-wrap: break-word;
            color: var(--text-secondary);
        }

        .copy-success {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: var(--accent-green);
            color: white;
            padding: 18px 35px;
            border-radius: 10px;
            font-weight: 700;
            z-index: 3000;
            display: none;
            animation: fadeInOut 2s ease;
        }

        @keyframes fadeInOut { 0%, 100% { opacity: 0; } 10%, 90% { opacity: 1; } }

        /* Prompt Modal */
        .prompt-modal .modal { max-width: 800px; }
        .prompt-modal .modal-header { background: linear-gradient(135deg, var(--accent-purple) 0%, var(--accent-blue) 100%); }

        .prompt-section { margin-bottom: 25px; }
        .prompt-section h4 { color: var(--accent-purple); font-size: 1rem; margin-bottom: 12px; display: flex; align-items: center; gap: 8px; }

        .prompt-box {
            background: rgba(0,0,0,0.4);
            border: 1px solid var(--border-subtle);
            border-radius: 10px;
            padding: 20px;
            font-family: 'JetBrains Mono', monospace;
            font-size: 0.85rem;
            line-height: 1.7;
            color: var(--text-secondary);
            white-space: pre-wrap;
            word-wrap: break-word;
        }

        .prompt-tags { display: flex; gap: 10px; flex-wrap: wrap; margin-bottom: 20px; }
        .prompt-tag { background: rgba(139, 92, 246, 0.15); color: var(--accent-purple); padding: 6px 14px; border-radius: 20px; font-size: 0.8rem; font-weight: 600; }

        .copy-prompt-btn {
            background: linear-gradient(135deg, var(--accent-purple) 0%, var(--accent-blue) 100%);
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 8px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.2s;
            margin-top: 15px;
        }

        .copy-prompt-btn:hover { transform: scale(1.05); box-shadow: 0 5px 20px rgba(139, 92, 246, 0.3); }

        @media (max-width: 900px) {
            .sidebar { display: none; }
            .main-content { margin-left: 0; padding: 75px 20px 30px 20px; }
            .agent-grid { grid-template-columns: 1fr; }
        }
    </style>
</head>
<body>
    <!-- Breadcrumb -->
    <nav class="breadcrumb">
        <a href="../../index.html">Portal Home</a>
        <span class="separator">></span>
        <a href="./index.html">Mortgage Fundamentals</a>
        <span class="separator">></span>
        <span class="current">First-Time Homebuyer Do's & Don'ts</span>
    </nav>

    <!-- Fixed Sidebar -->
    <aside class="sidebar">
        <div class="sidebar-header">
            <h2>FTHB Do's & Don'ts</h2>
            <p>Interactive Workflow Guide</p>
        </div>

        <!-- Tab Switcher -->
        <div class="sidebar-tabs">
            <button class="sidebar-tab active" onclick="switchTab('workflow')">Workflow</button>
            <button class="sidebar-tab agent-tab" onclick="switchTab('agents')">AI Agents</button>
        </div>

        <!-- Workflow Navigation -->
        <nav class="sidebar-nav" id="workflow-nav">
            <a href="#section-1" class="nav-item active">
                <span class="nav-number">1</span>
                <span class="nav-label">Overview</span>
            </a>
            <a href="#section-2" class="nav-item">
                <span class="nav-number">2</span>
                <span class="nav-label">Do's When Planning</span>
            </a>
            <a href="#section-3" class="nav-item">
                <span class="nav-number">3</span>
                <span class="nav-label">Don'ts After Applying</span>
            </a>
            <a href="#section-4" class="nav-item">
                <span class="nav-number">4</span>
                <span class="nav-label">Documentation Requirements</span>
            </a>
            <a href="#section-5" class="nav-item">
                <span class="nav-number">5</span>
                <span class="nav-label">Credit Management</span>
            </a>
            <a href="#section-6" class="nav-item">
                <span class="nav-number">6</span>
                <span class="nav-label">Communication Best Practices</span>
            </a>
            <a href="#section-7" class="nav-item">
                <span class="nav-number">7</span>
                <span class="nav-label">PMI Information</span>
            </a>
            <a href="#quick-ref" class="nav-item">
                <span class="nav-number">*</span>
                <span class="nav-label">Quick Reference</span>
            </a>
        </nav>

        <!-- Agent Navigation -->
        <nav class="sidebar-nav" id="agents-nav" style="display: none;">
            <a href="#agent-summary" class="nav-item active">
                <span class="nav-number">S</span>
                <span class="nav-label">Summary</span>
            </a>
            <a href="#agent-heatmap" class="nav-item">
                <span class="nav-number">H</span>
                <span class="nav-label">Heat Map</span>
            </a>
            <a href="#agent-details" class="nav-item">
                <span class="nav-number">A</span>
                <span class="nav-label">Agent Details</span>
            </a>
        </nav>

        <div class="sidebar-footer">
            <button class="doc-btn" onclick="openDocModal()">
                View Workflow Markdown
            </button>
        </div>
    </aside>

    <!-- Main Content -->
    <main class="main-content">

        <!-- ==================== WORKFLOW TAB ==================== -->
        <div id="workflow-panel" class="tab-panel active">
            <!-- Header -->
            <div class="header">
                <h1>First-Time Homebuyer Do's & Don'ts</h1>
                <p class="subtitle">Essential guidance for borrowers navigating the mortgage application process - what to do and what to avoid</p>
                <div class="meta">
                    <span class="meta-item">Source: Enact MI</span>
                    <span class="meta-item">Audience: Borrowers / LOs</span>
                    <span class="meta-item">Doc ID: 01754.CB.0323</span>
                    <span class="meta-item">Category: FTHB Education</span>
                </div>
            </div>

            <!-- Legend -->
            <div class="legend">
                <div class="legend-item"><div class="legend-color" style="background: linear-gradient(135deg, #22c55e, #16a34a);"></div><span>Recommended Action (DO)</span></div>
                <div class="legend-item"><div class="legend-color" style="background: linear-gradient(135deg, #f43f5e, #dc2626);"></div><span>Avoid Action (DON'T)</span></div>
                <div class="legend-item"><div class="legend-color" style="background: linear-gradient(135deg, #3b82f6, #2563eb);"></div><span>Information</span></div>
                <div class="legend-item"><div class="legend-color" style="background: linear-gradient(135deg, #f59e0b, #d97706);"></div><span>Warning/Caution</span></div>
            </div>

            <!-- Section 1: Overview -->
            <section id="section-1" class="section">
                <div class="section-header">
                    <div class="section-number">1</div>
                    <div class="section-title"><h2>Overview</h2><span>Understanding the mortgage application journey</span></div>
                </div>
                <div class="section-content">
                    <div class="workflow-diagram">
                        <div class="flow-row">
                            <div class="flow-node start">Planning Phase</div>
                            <span class="flow-arrow">-></span>
                            <div class="flow-node action">Application</div>
                            <span class="flow-arrow">-></span>
                            <div class="flow-node action">Processing</div>
                            <span class="flow-arrow">-></span>
                            <div class="flow-node action">Underwriting</div>
                            <span class="flow-arrow">-></span>
                            <div class="flow-node output">Closing</div>
                        </div>
                    </div>

                    <div class="info-box">
                        <h4>Key Principle</h4>
                        <p>Your mortgage loan application process can be easier with a little bit of advance planning. Your post-application process can also be smoother when you keep in mind what activities can slow down your closing.</p>
                    </div>

                    <div class="summary-grid">
                        <div class="summary-card">
                            <h4>Do's Count</h4>
                            <div class="value">6</div>
                            <div class="label">Pre-Application Best Practices</div>
                        </div>
                        <div class="summary-card">
                            <h4>Don'ts Count</h4>
                            <div class="value">6</div>
                            <div class="label">Post-Application Pitfalls</div>
                        </div>
                        <div class="summary-card">
                            <h4>Focus Areas</h4>
                            <div class="value">4</div>
                            <div class="label">Documentation, Employment, Credit, Communication</div>
                        </div>
                    </div>
                </div>
            </section>

            <!-- Section 2: Do's When Planning -->
            <section id="section-2" class="section">
                <div class="section-header">
                    <div class="section-number">2</div>
                    <div class="section-title"><h2>Do's When You Plan to Apply</h2><span>Essential actions before and during the mortgage application</span></div>
                </div>
                <div class="section-content">
                    <div class="do-card" style="margin-bottom: 25px;">
                        <div class="card-header">
                            <span style="font-size: 1.3rem;">&#10003;</span> Recommended Actions
                        </div>
                        <div class="card-body">
                            <ul>
                                <li>
                                    <span class="check-icon">&#10003;</span>
                                    <div>
                                        <strong>Keep an ongoing paper trail</strong><br>
                                        Maintain ongoing documentation related to income, employment verification and current debts/obligations -- keeping your W2s, tax return documents, pay stubs and bank statements handy.
                                    </div>
                                </li>
                                <li>
                                    <span class="check-icon">&#10003;</span>
                                    <div>
                                        <strong>Provide money deposit receipts</strong><br>
                                        This includes an earnest money deposit from your personal bank account or gift funds. Gift funds are acceptable only if certain criteria are met -- reach out to your loan originator for clarification.
                                    </div>
                                </li>
                                <li>
                                    <span class="check-icon">&#10003;</span>
                                    <div>
                                        <strong>Maintain employment and income</strong><br>
                                        Show stability through the mortgage application period. This process goes much smoother if you keep your income steady and avoid major changes. Pay raises/promotions are exceptions to this expectation.
                                    </div>
                                </li>
                                <li>
                                    <span class="check-icon">&#10003;</span>
                                    <div>
                                        <strong>Create a savings plan</strong><br>
                                        Buying a house is exciting, but focusing on saving during this period is key. You'll need funds for an earnest money deposit, down payment and/or closing costs, and major purchases could impact your credit. Pay your bills on time and be mindful of spending habits.
                                    </div>
                                </li>
                                <li>
                                    <span class="check-icon">&#10003;</span>
                                    <div>
                                        <strong>Understand credit pulls</strong><br>
                                        Your lender may pull a new credit report just prior to closing to check for new debt. If your recent credit activity raises a concern, you may be asked to explain.
                                    </div>
                                </li>
                                <li>
                                    <span class="check-icon">&#10003;</span>
                                    <div>
                                        <strong>Ask questions and communicate</strong><br>
                                        At any point in the process, your team is there to help you and answer any question that might come up. Trust their expertise, communicate effectively and often, and learn what you can about the loan process to set yourself up for success.
                                    </div>
                                </li>
                            </ul>
                        </div>
                    </div>

                    <table class="field-table">
                        <thead>
                            <tr>
                                <th>Document Type</th>
                                <th>Purpose</th>
                                <th>Status</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td><strong>W2s</strong></td>
                                <td>Verify annual income and employment</td>
                                <td><span class="badge required-badge">Required</span></td>
                            </tr>
                            <tr>
                                <td><strong>Tax Returns</strong></td>
                                <td>Verify income history and consistency</td>
                                <td><span class="badge required-badge">Required</span></td>
                            </tr>
                            <tr>
                                <td><strong>Pay Stubs</strong></td>
                                <td>Verify current income</td>
                                <td><span class="badge required-badge">Required</span></td>
                            </tr>
                            <tr>
                                <td><strong>Bank Statements</strong></td>
                                <td>Verify assets and deposit sources</td>
                                <td><span class="badge required-badge">Required</span></td>
                            </tr>
                            <tr>
                                <td><strong>Gift Letter</strong></td>
                                <td>Document gift funds source and terms</td>
                                <td><span class="badge optional-badge">If Applicable</span></td>
                            </tr>
                        </tbody>
                    </table>

                    <div class="tip-box">
                        <h4>Pro Tip: Paper Trail Organization</h4>
                        <p>Create a dedicated folder (physical or digital) for all mortgage-related documents. Organize by category: Income, Assets, Identity, and Property. This makes it easy to respond quickly to document requests.</p>
                    </div>
                </div>
            </section>

            <!-- Section 3: Don'ts After Applying -->
            <section id="section-3" class="section">
                <div class="section-header">
                    <div class="section-number">3</div>
                    <div class="section-title"><h2>Don'ts After You Apply</h2><span>Critical actions to avoid during the loan process</span></div>
                </div>
                <div class="section-content">
                    <div class="dont-card" style="margin-bottom: 25px;">
                        <div class="card-header">
                            <span style="font-size: 1.3rem;">&#10007;</span> Actions to Avoid
                        </div>
                        <div class="card-body">
                            <ul>
                                <li>
                                    <span class="x-icon">&#10007;</span>
                                    <div>
                                        <strong>Close or open bank accounts</strong><br>
                                        Before you open, close, or transfer money across accounts, check with your Loan Officer on how this may affect your qualification or documentation. Changes could result in a delay for the loan origination.
                                    </div>
                                </li>
                                <li>
                                    <span class="x-icon">&#10007;</span>
                                    <div>
                                        <strong>Make large bank deposits</strong><br>
                                        If you deposit any money outside of your automated payroll deposits, especially cash, check with your Loan Officer on the documentation you will need to provide to verify their sources.
                                    </div>
                                </li>
                                <li>
                                    <span class="x-icon">&#10007;</span>
                                    <div>
                                        <strong>Change jobs, employer or employment</strong><br>
                                        You can change jobs, as well as amend any tax returns, but you'll need to make your Loan Officer aware because it may impact your qualification and documentation. If shifts do occur, you may need a new loan approval.
                                    </div>
                                </li>
                                <li>
                                    <span class="x-icon">&#10007;</span>
                                    <div>
                                        <strong>Make major purchases</strong><br>
                                        This involves large spending prior to or during the contract period. It's tempting to get new furniture, a car or house appliances, but these purchases will hurt your savings, debt-to-income ratio and credit utilization.
                                    </div>
                                </li>
                                <li>
                                    <span class="x-icon">&#10007;</span>
                                    <div>
                                        <strong>Open a new line of credit</strong><br>
                                        This also includes closing credit lines, co-signing on loans, or making major purchases on credit cards.
                                    </div>
                                </li>
                                <li>
                                    <span class="x-icon">&#10007;</span>
                                    <div>
                                        <strong>Panic, stress or isolate</strong><br>
                                        Your team wants you to be successful, knowledgeable and confident during this process. Whatever your finances, be sure to include all debts and liabilities on your mortgage application. Keep the lines of communication open and trust they want you to get across the finish line.
                                    </div>
                                </li>
                            </ul>
                        </div>
                    </div>

                    <div class="exception-box">
                        <h4>Critical Warning: Credit Re-Pull</h4>
                        <p>Your lender may pull a new credit report just prior to closing. Any new debt, credit inquiries, or changes to your credit profile could trigger additional underwriting review or even loan denial. When in doubt, always consult your Loan Officer BEFORE making any financial changes.</p>
                    </div>

                    <div class="workflow-diagram">
                        <div class="flow-row">
                            <div class="flow-node decision">Financial Change?</div>
                        </div>
                        <div class="decision-branch">
                            <div class="branch">
                                <span class="branch-label">Major Change</span>
                                <div class="flow-node exception">Contact LO Immediately</div>
                            </div>
                            <div class="branch">
                                <span class="branch-label">Minor Change</span>
                                <div class="flow-node action">Document Everything</div>
                            </div>
                            <div class="branch">
                                <span class="branch-label">No Change</span>
                                <div class="flow-node output">Continue Process</div>
                            </div>
                        </div>
                    </div>
                </div>
            </section>

            <!-- Section 4: Documentation Requirements -->
            <section id="section-4" class="section">
                <div class="section-header">
                    <div class="section-number">4</div>
                    <div class="section-title"><h2>Documentation Requirements</h2><span>Understanding what documents you'll need and when</span></div>
                </div>
                <div class="section-content">
                    <div class="decision-tree">
                        <h3>Documentation Categories</h3>
                        <div class="tree-node level-1">
                            <span class="tree-label">Income Verification</span>
                            <div class="tree-node">W2s (2 years), Pay Stubs (30 days), Tax Returns (2 years if self-employed)</div>
                        </div>
                        <div class="tree-node level-1">
                            <span class="tree-label">Employment Verification</span>
                            <div class="tree-node">Current employer name, address, phone number, dates of employment</div>
                        </div>
                        <div class="tree-node level-1">
                            <span class="tree-label">Asset Documentation</span>
                            <div class="tree-node">Bank statements (2-3 months), Investment accounts, Retirement accounts</div>
                        </div>
                        <div class="tree-node level-1">
                            <span class="tree-label">Debt/Obligation Records</span>
                            <div class="tree-node">Current credit card statements, Loan statements, Alimony/Child support documents</div>
                        </div>
                    </div>

                    <table class="field-table">
                        <thead>
                            <tr>
                                <th>Deposit Type</th>
                                <th>Documentation Needed</th>
                                <th>Alert Level</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td><strong>Payroll Direct Deposit</strong></td>
                                <td>Pay stub showing matching amount</td>
                                <td><span class="badge optional-badge">Standard</span></td>
                            </tr>
                            <tr>
                                <td><strong>Gift Funds</strong></td>
                                <td>Gift letter, donor bank statements, transfer proof</td>
                                <td><span class="badge warning-badge">Requires Verification</span></td>
                            </tr>
                            <tr>
                                <td><strong>Cash Deposit</strong></td>
                                <td>Source documentation, letter of explanation</td>
                                <td><span class="badge required-badge">High Scrutiny</span></td>
                            </tr>
                            <tr>
                                <td><strong>Transfer from Another Account</strong></td>
                                <td>Statements from both accounts showing transfer</td>
                                <td><span class="badge warning-badge">Paper Trail Required</span></td>
                            </tr>
                            <tr>
                                <td><strong>Earnest Money</strong></td>
                                <td>Copy of check, receipt, bank statement</td>
                                <td><span class="badge required-badge">Required</span></td>
                            </tr>
                        </tbody>
                    </table>

                    <div class="info-box">
                        <h4>Gift Funds Criteria</h4>
                        <p>Gift funds are acceptable only if certain criteria are met. Common requirements include:</p>
                        <ul style="margin-top: 10px; margin-left: 20px;">
                            <li>Gift must be from an acceptable donor (typically family member)</li>
                            <li>Signed gift letter stating the gift requires no repayment</li>
                            <li>Paper trail showing funds transfer from donor to borrower</li>
                            <li>Donor bank statements may be required</li>
                        </ul>
                        <p style="margin-top: 10px;"><strong>Always reach out to your loan originator for clarification on gift fund requirements.</strong></p>
                    </div>
                </div>
            </section>

            <!-- Section 5: Credit Management -->
            <section id="section-5" class="section">
                <div class="section-header">
                    <div class="section-number">5</div>
                    <div class="section-title"><h2>Credit Management</h2><span>Protecting your credit profile during the loan process</span></div>
                </div>
                <div class="section-content">
                    <div class="workflow-diagram">
                        <div class="flow-row">
                            <div class="flow-node action">Initial Credit Pull</div>
                            <span class="flow-arrow">-></span>
                            <div class="flow-node input">Maintain Status Quo</div>
                            <span class="flow-arrow">-></span>
                            <div class="flow-node decision">Pre-Closing Credit Check</div>
                        </div>
                        <div class="decision-branch">
                            <div class="branch">
                                <span class="branch-label">No Changes</span>
                                <div class="flow-node output">Proceed to Closing</div>
                            </div>
                            <div class="branch">
                                <span class="branch-label">New Activity</span>
                                <div class="flow-node exception">Explain & Possible Re-Qualification</div>
                            </div>
                        </div>
                    </div>

                    <div class="do-dont-grid">
                        <div class="do-card">
                            <div class="card-header">
                                <span style="font-size: 1.3rem;">&#10003;</span> Credit DO's
                            </div>
                            <div class="card-body">
                                <ul>
                                    <li><span class="check-icon">&#10003;</span><div>Pay all bills on time</div></li>
                                    <li><span class="check-icon">&#10003;</span><div>Keep credit card balances low</div></li>
                                    <li><span class="check-icon">&#10003;</span><div>Continue using existing credit responsibly</div></li>
                                    <li><span class="check-icon">&#10003;</span><div>Monitor your credit report</div></li>
                                    <li><span class="check-icon">&#10003;</span><div>Notify LO of any credit alerts</div></li>
                                </ul>
                            </div>
                        </div>
                        <div class="dont-card">
                            <div class="card-header">
                                <span style="font-size: 1.3rem;">&#10007;</span> Credit DON'Ts
                            </div>
                            <div class="card-body">
                                <ul>
                                    <li><span class="x-icon">&#10007;</span><div>Open new credit cards or loans</div></li>
                                    <li><span class="x-icon">&#10007;</span><div>Close existing credit accounts</div></li>
                                    <li><span class="x-icon">&#10007;</span><div>Co-sign for anyone</div></li>
                                    <li><span class="x-icon">&#10007;</span><div>Max out credit cards</div></li>
                                    <li><span class="x-icon">&#10007;</span><div>Apply for store financing</div></li>
                                </ul>
                            </div>
                        </div>
                    </div>

                    <div class="exception-box">
                        <h4>Impact on Debt-to-Income Ratio</h4>
                        <p>Major purchases and new credit lines directly impact your debt-to-income (DTI) ratio. Even if you have excellent credit, new debt can push your DTI beyond acceptable limits, potentially disqualifying you for the loan or requiring a smaller loan amount.</p>
                    </div>

                    <div class="tip-box">
                        <h4>Credit Utilization Best Practice</h4>
                        <p>Keep credit card utilization below 30% of your available credit. For example, if you have a $10,000 credit limit, try to keep your balance below $3,000. Lower utilization demonstrates responsible credit management.</p>
                    </div>
                </div>
            </section>

            <!-- Section 6: Communication Best Practices -->
            <section id="section-6" class="section">
                <div class="section-header">
                    <div class="section-number">6</div>
                    <div class="section-title"><h2>Communication Best Practices</h2><span>Staying connected with your loan team throughout the process</span></div>
                </div>
                <div class="section-content">
                    <div class="info-box">
                        <h4>Your Team is Here to Help</h4>
                        <p>At any point in the process, your team is there to help you and answer any question that might come up. Trust their expertise, communicate effectively and often, and learn what you can about the loan process to set yourself up for success.</p>
                    </div>

                    <ul class="step-list">
                        <li><strong>Step 1:</strong> Establish primary contact method with your Loan Officer (email, phone, text)</li>
                        <li><strong>Step 2:</strong> Respond promptly to document requests - delays can extend your closing timeline</li>
                        <li><strong>Step 3:</strong> Proactively inform your LO of ANY financial changes (job, income, expenses, accounts)</li>
                        <li><strong>Step 4:</strong> Ask questions when you don't understand something - no question is too basic</li>
                        <li><strong>Step 5:</strong> Keep all communication documented for your records</li>
                        <li><strong>Step 6:</strong> Don't panic, stress, or isolate - your team wants you to succeed</li>
                    </ul>

                    <table class="field-table">
                        <thead>
                            <tr>
                                <th>When to Contact Your LO</th>
                                <th>Urgency</th>
                                <th>Method</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td><strong>Job change or loss</strong></td>
                                <td><span class="badge required-badge">Immediate</span></td>
                                <td>Phone call</td>
                            </tr>
                            <tr>
                                <td><strong>Large deposit or withdrawal</strong></td>
                                <td><span class="badge required-badge">Same Day</span></td>
                                <td>Phone or email</td>
                            </tr>
                            <tr>
                                <td><strong>Credit inquiry or new account</strong></td>
                                <td><span class="badge required-badge">Same Day</span></td>
                                <td>Phone or email</td>
                            </tr>
                            <tr>
                                <td><strong>Address change</strong></td>
                                <td><span class="badge warning-badge">Within 24 Hours</span></td>
                                <td>Email</td>
                            </tr>
                            <tr>
                                <td><strong>General questions</strong></td>
                                <td><span class="badge optional-badge">Standard</span></td>
                                <td>Email or portal</td>
                            </tr>
                        </tbody>
                    </table>

                    <div class="tip-box">
                        <h4>Full Disclosure is Essential</h4>
                        <p>Whatever your finances, be sure to include <strong>all debts and liabilities</strong> on your mortgage application. Undisclosed debts discovered later can cause significant delays or even loan denial. Honesty upfront leads to smoother closings.</p>
                    </div>
                </div>
            </section>

            <!-- Section 7: PMI Information -->
            <section id="section-7" class="section">
                <div class="section-header">
                    <div class="section-number">7</div>
                    <div class="section-title"><h2>Private Mortgage Insurance (PMI)</h2><span>Understanding how PMI can help you achieve homeownership faster</span></div>
                </div>
                <div class="section-content">
                    <div class="info-box">
                        <h4>Homeownership Doesn't Have to Be a Dream</h4>
                        <p>Private mortgage insurance can get you into a house faster with less than a 20% down payment. Talk to your loan officer to learn more about the value of mortgage insurance from Enact.</p>
                    </div>

                    <div class="summary-grid">
                        <div class="summary-card">
                            <h4>Traditional Down Payment</h4>
                            <div class="value">20%</div>
                            <div class="label">Required to avoid PMI</div>
                        </div>
                        <div class="summary-card">
                            <h4>With PMI</h4>
                            <div class="value">3-5%</div>
                            <div class="label">Minimum down payment possible</div>
                        </div>
                        <div class="summary-card">
                            <h4>PMI Removal</h4>
                            <div class="value">78%</div>
                            <div class="label">LTV when PMI auto-terminates</div>
                        </div>
                    </div>

                    <div class="decision-tree">
                        <h3>Benefits of PMI</h3>
                        <div class="tree-node level-1">
                            <span class="tree-label">Lower Barrier to Entry</span>
                            <div class="tree-node">Buy a home sooner with a smaller down payment</div>
                        </div>
                        <div class="tree-node level-1">
                            <span class="tree-label">Build Equity Faster</span>
                            <div class="tree-node">Start building equity instead of paying rent</div>
                        </div>
                        <div class="tree-node level-1">
                            <span class="tree-label">Not Permanent</span>
                            <div class="tree-node">PMI can be removed once you reach 20% equity</div>
                        </div>
                        <div class="tree-node level-1">
                            <span class="tree-label">Tax Considerations</span>
                            <div class="tree-node">PMI may be tax-deductible (consult tax advisor)</div>
                        </div>
                    </div>

                    <div class="tip-box">
                        <h4>Talk to Your Loan Officer</h4>
                        <p>Your loan officer can explain the specific PMI options available for your situation, including different payment structures (monthly, single premium, lender-paid) and help you calculate the true cost versus waiting to save a larger down payment.</p>
                    </div>
                </div>
            </section>

            <!-- Quick Reference -->
            <div id="quick-ref" class="quick-ref">
                <h3>First-Time Homebuyer Quick Reference</h3>
                <pre>
FIRST-TIME HOMEBUYER DO'S & DON'TS SUMMARY
==========================================

DO'S WHEN PLANNING TO APPLY
===========================
[x] Keep an ongoing paper trail (W2s, tax returns, pay stubs, bank statements)
[x] Provide money deposit receipts (earnest money, gift funds with documentation)
[x] Maintain employment and income stability (raises/promotions OK)
[x] Create a savings plan (earnest money, down payment, closing costs)
[x] Understand credit pulls (pre-closing credit check is standard)
[x] Ask questions and communicate (your team is here to help)

DON'TS AFTER YOU APPLY
======================
[ ] Close or open bank accounts without LO approval
[ ] Make large bank deposits (especially cash) without documentation
[ ] Change jobs, employer or employment without notifying LO
[ ] Make major purchases (furniture, car, appliances)
[ ] Open new lines of credit or co-sign loans
[ ] Panic, stress or isolate (communicate with your team!)

DOCUMENTATION CHECKLIST
=======================
[ ] W2s - Last 2 years
[ ] Tax Returns - Last 2 years (especially if self-employed)
[ ] Pay Stubs - Most recent 30 days
[ ] Bank Statements - Last 2-3 months
[ ] Gift Letter & Documentation (if applicable)
[ ] Earnest Money Receipt

WHEN TO CONTACT YOUR LOAN OFFICER
=================================
- Job change or loss           -> IMMEDIATELY
- Large deposit/withdrawal     -> Same Day
- Credit inquiry/new account   -> Same Day
- Address change               -> Within 24 Hours
- General questions            -> As Needed

CREDIT MANAGEMENT TIPS
======================
- Pay all bills on time
- Keep credit utilization under 30%
- Don't open new accounts
- Don't close existing accounts
- Don't co-sign for anyone
- Avoid store financing

PMI QUICK FACTS
===============
- Allows down payment as low as 3-5%
- Auto-terminates at 78% LTV
- Can be removed at 80% LTV (request required)
- May be tax-deductible

Source: Enact Mortgage Insurance (01754.CB.0323)
                </pre>
            </div>
        </div>

        <!-- ==================== AI AGENTS TAB ==================== -->
        <div id="agents-panel" class="tab-panel">
            <!-- Agent Header -->
            <div class="agent-header">
                <h1>AI Agent Opportunities</h1>
                <p class="subtitle">Automation opportunities identified for borrower education and application monitoring</p>
            </div>

            <!-- Summary Stats -->
            <div class="agent-summary" id="agent-summary">
                <div class="agent-summary-card">
                    <div class="agent-summary-value">4</div>
                    <div class="agent-summary-label">Agent Opportunities</div>
                </div>
                <div class="agent-summary-card">
                    <div class="agent-summary-value">65%</div>
                    <div class="agent-summary-label">Automation Potential</div>
                </div>
                <div class="agent-summary-card">
                    <div class="agent-summary-value">High</div>
                    <div class="agent-summary-label">Borrower Experience Impact</div>
                </div>
                <div class="agent-summary-card">
                    <div class="agent-summary-value">Low</div>
                    <div class="agent-summary-label">Fallout Risk Reduction</div>
                </div>
            </div>

            <!-- Heat Map Legend -->
            <div class="heat-legend">
                <div class="heat-legend-item">
                    <div class="heat-legend-color" style="background: linear-gradient(90deg, #ef4444, #f97316);"></div>
                    <span>Critical Priority (9-10)</span>
                </div>
                <div class="heat-legend-item">
                    <div class="heat-legend-color" style="background: linear-gradient(90deg, #f97316, #eab308);"></div>
                    <span>High Priority (7-8)</span>
                </div>
                <div class="heat-legend-item">
                    <div class="heat-legend-color" style="background: linear-gradient(90deg, #eab308, #22c55e);"></div>
                    <span>Medium Priority (5-6)</span>
                </div>
                <div class="heat-legend-item">
                    <div class="heat-legend-color" style="background: linear-gradient(90deg, #22c55e, #14b8a6);"></div>
                    <span>Low Priority (1-4)</span>
                </div>
            </div>

            <!-- Heat Map Grid -->
            <div class="heat-map-container" id="agent-heatmap">
                <div class="heat-map-title">Priority Heat Map</div>
                <div class="heat-map-grid">
                    <div class="heat-item critical" onclick="scrollToAgent('agent-creditmonitor')">
                        <div class="heat-score">9.1</div>
                        <div class="heat-name">Credit Monitor Agent</div>
                        <div class="heat-desc">Real-time credit activity alerts during loan process</div>
                        <div class="heat-metrics">
                            <div class="heat-metric">Impact: <span>High</span></div>
                            <div class="heat-metric">Complexity: <span>Medium</span></div>
                        </div>
                    </div>
                    <div class="heat-item high" onclick="scrollToAgent('agent-docreminder')">
                        <div class="heat-score">8.3</div>
                        <div class="heat-name">Document Reminder Agent</div>
                        <div class="heat-desc">Proactive document collection and reminders</div>
                        <div class="heat-metrics">
                            <div class="heat-metric">Impact: <span>High</span></div>
                            <div class="heat-metric">Complexity: <span>Low</span></div>
                        </div>
                    </div>
                    <div class="heat-item high" onclick="scrollToAgent('agent-education')">
                        <div class="heat-score">7.8</div>
                        <div class="heat-name">Borrower Education Agent</div>
                        <div class="heat-desc">Automated FTHB guidance and tips</div>
                        <div class="heat-metrics">
                            <div class="heat-metric">Impact: <span>Medium</span></div>
                            <div class="heat-metric">Complexity: <span>Low</span></div>
                        </div>
                    </div>
                    <div class="heat-item medium" onclick="scrollToAgent('agent-deposit')">
                        <div class="heat-score">6.5</div>
                        <div class="heat-name">Deposit Tracker Agent</div>
                        <div class="heat-desc">Flag unusual deposits requiring documentation</div>
                        <div class="heat-metrics">
                            <div class="heat-metric">Impact: <span>Medium</span></div>
                            <div class="heat-metric">Complexity: <span>Medium</span></div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Agent Details -->
            <div id="agent-details">
                <h2 style="color: var(--text-primary); margin-bottom: 25px; font-size: 1.5rem;">Agent Details</h2>
                <div class="agent-grid">
                    <!-- Credit Monitor Agent -->
                    <div class="agent-card" id="agent-creditmonitor">
                        <div class="agent-card-header">
                            <div class="agent-icon">C</div>
                            <div class="agent-info">
                                <div class="agent-name">Credit Monitor Agent</div>
                                <div class="agent-type">Monitoring / Alerts</div>
                            </div>
                            <span class="agent-priority critical">Critical</span>
                        </div>
                        <div class="agent-card-body">
                            <p class="agent-description">Continuously monitors borrower credit activity during the loan process and immediately alerts LO/Processor of any new inquiries, accounts, or significant balance changes that could impact qualification.</p>
                            <div class="agent-flow">
                                <div class="agent-flow-title">Agent Flow</div>
                                <div class="agent-flow-diagram">
                                    <span class="agent-step">Monitor Credit</span>
                                    <span class="agent-arrow">-></span>
                                    <span class="agent-step">Detect Change</span>
                                    <span class="agent-arrow">-></span>
                                    <span class="agent-step">Assess Impact</span>
                                    <span class="agent-arrow">-></span>
                                    <span class="agent-step">Alert Team</span>
                                </div>
                            </div>
                            <div class="agent-stats">
                                <div class="agent-stat">
                                    <div class="agent-stat-value">15%</div>
                                    <div class="agent-stat-label">Fallout Reduction</div>
                                </div>
                                <div class="agent-stat">
                                    <div class="agent-stat-value">Real</div>
                                    <div class="agent-stat-label">Time Alerts</div>
                                </div>
                                <div class="agent-stat">
                                    <div class="agent-stat-value">Med</div>
                                    <div class="agent-stat-label">Complexity</div>
                                </div>
                            </div>
                            <button class="agent-prompt-btn" onclick="showAgentPrompt('creditmonitor')">
                                View Build Prompt
                            </button>
                        </div>
                    </div>

                    <!-- Document Reminder Agent -->
                    <div class="agent-card" id="agent-docreminder">
                        <div class="agent-card-header">
                            <div class="agent-icon">D</div>
                            <div class="agent-info">
                                <div class="agent-name">Document Reminder Agent</div>
                                <div class="agent-type">Communication / Automation</div>
                            </div>
                            <span class="agent-priority high">High</span>
                        </div>
                        <div class="agent-card-body">
                            <p class="agent-description">Sends personalized reminders to borrowers about outstanding document needs, with clear instructions on what to provide and why. Reduces time-to-close by ensuring faster document collection.</p>
                            <div class="agent-flow">
                                <div class="agent-flow-title">Agent Flow</div>
                                <div class="agent-flow-diagram">
                                    <span class="agent-step">Check Conditions</span>
                                    <span class="agent-arrow">-></span>
                                    <span class="agent-step">Identify Missing</span>
                                    <span class="agent-arrow">-></span>
                                    <span class="agent-step">Send Reminder</span>
                                    <span class="agent-arrow">-></span>
                                    <span class="agent-step">Track Response</span>
                                </div>
                            </div>
                            <div class="agent-stats">
                                <div class="agent-stat">
                                    <div class="agent-stat-value">3 days</div>
                                    <div class="agent-stat-label">Faster Collection</div>
                                </div>
                                <div class="agent-stat">
                                    <div class="agent-stat-value">85%</div>
                                    <div class="agent-stat-label">Response Rate</div>
                                </div>
                                <div class="agent-stat">
                                    <div class="agent-stat-value">Low</div>
                                    <div class="agent-stat-label">Complexity</div>
                                </div>
                            </div>
                            <button class="agent-prompt-btn" onclick="showAgentPrompt('docreminder')">
                                View Build Prompt
                            </button>
                        </div>
                    </div>

                    <!-- Borrower Education Agent -->
                    <div class="agent-card" id="agent-education">
                        <div class="agent-card-header">
                            <div class="agent-icon">E</div>
                            <div class="agent-info">
                                <div class="agent-name">Borrower Education Agent</div>
                                <div class="agent-type">Communication / Content</div>
                            </div>
                            <span class="agent-priority high">High</span>
                        </div>
                        <div class="agent-card-body">
                            <p class="agent-description">Delivers timely educational content to first-time homebuyers at key milestones, including Do's and Don'ts tips, process explanations, and milestone celebrations to keep borrowers engaged and informed.</p>
                            <div class="agent-flow">
                                <div class="agent-flow-title">Agent Flow</div>
                                <div class="agent-flow-diagram">
                                    <span class="agent-step">Detect Milestone</span>
                                    <span class="agent-arrow">-></span>
                                    <span class="agent-step">Select Content</span>
                                    <span class="agent-arrow">-></span>
                                    <span class="agent-step">Personalize</span>
                                    <span class="agent-arrow">-></span>
                                    <span class="agent-step">Deliver</span>
                                </div>
                            </div>
                            <div class="agent-stats">
                                <div class="agent-stat">
                                    <div class="agent-stat-value">92%</div>
                                    <div class="agent-stat-label">Satisfaction</div>
                                </div>
                                <div class="agent-stat">
                                    <div class="agent-stat-value">20%</div>
                                    <div class="agent-stat-label">Less Support Calls</div>
                                </div>
                                <div class="agent-stat">
                                    <div class="agent-stat-value">Low</div>
                                    <div class="agent-stat-label">Complexity</div>
                                </div>
                            </div>
                            <button class="agent-prompt-btn" onclick="showAgentPrompt('education')">
                                View Build Prompt
                            </button>
                        </div>
                    </div>

                    <!-- Deposit Tracker Agent -->
                    <div class="agent-card" id="agent-deposit">
                        <div class="agent-card-header">
                            <div class="agent-icon">$</div>
                            <div class="agent-info">
                                <div class="agent-name">Deposit Tracker Agent</div>
                                <div class="agent-type">Data Analysis / Compliance</div>
                            </div>
                            <span class="agent-priority medium">Medium</span>
                        </div>
                        <div class="agent-card-body">
                            <p class="agent-description">Analyzes bank statements to identify non-payroll deposits that require source documentation, automatically notifying processors and borrowers of documentation requirements before underwriting.</p>
                            <div class="agent-flow">
                                <div class="agent-flow-title">Agent Flow</div>
                                <div class="agent-flow-diagram">
                                    <span class="agent-step">Parse Statements</span>
                                    <span class="agent-arrow">-></span>
                                    <span class="agent-step">Flag Deposits</span>
                                    <span class="agent-arrow">-></span>
                                    <span class="agent-step">Request Docs</span>
                                    <span class="agent-arrow">-></span>
                                    <span class="agent-step">Track Status</span>
                                </div>
                            </div>
                            <div class="agent-stats">
                                <div class="agent-stat">
                                    <div class="agent-stat-value">95%</div>
                                    <div class="agent-stat-label">Detection Rate</div>
                                </div>
                                <div class="agent-stat">
                                    <div class="agent-stat-value">2 hrs</div>
                                    <div class="agent-stat-label">Time Saved</div>
                                </div>
                                <div class="agent-stat">
                                    <div class="agent-stat-value">Med</div>
                                    <div class="agent-stat-label">Complexity</div>
                                </div>
                            </div>
                            <button class="agent-prompt-btn" onclick="showAgentPrompt('deposit')">
                                View Build Prompt
                            </button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </main>

    <!-- Documentation Modal -->
    <div class="modal-overlay" id="docModal">
        <div class="modal">
            <div class="modal-header">
                <h3>FTHB Do's & Don'ts Documentation</h3>
                <div class="modal-actions">
                    <button class="modal-btn copy" onclick="copyToClipboard()">Copy</button>
                    <button class="modal-btn close" onclick="closeDocModal()">Close</button>
                </div>
            </div>
            <div class="modal-body">
                <pre id="docContent"># First-Time Homebuyer Do's & Don'ts

## Overview
Your mortgage loan application process can be easier with advance planning.
Your post-application process can also be smoother when you keep in mind what
activities can slow down your closing.

## DO's When You Plan to Apply

### Keep an ongoing paper trail
- W2s, tax returns, pay stubs, bank statements
- Documentation for income, employment, and debts

### Provide money deposit receipts
- Earnest money from personal account
- Gift funds (with proper documentation)

### Maintain employment and income
- Show stability through application period
- Pay raises/promotions are acceptable

### Create a savings plan
- Earnest money deposit
- Down payment and closing costs
- Avoid major purchases

### Understand credit pulls
- Lender may pull new report before closing
- Be prepared to explain new activity

### Ask questions and communicate
- Trust your team's expertise
- Stay engaged and informed

## DON'Ts After You Apply

### Don't close or open bank accounts
- Could delay loan origination
- Check with LO before any changes

### Don't make large bank deposits
- Especially cash deposits
- Need documentation for sources

### Don't change jobs or employment
- Notify LO of any changes
- May require new loan approval

### Don't make major purchases
- Affects DTI ratio and credit utilization
- Wait until after closing

### Don't open new lines of credit
- No new cards, loans, or co-signing
- Avoid store financing

### Don't panic, stress or isolate
- Your team wants you to succeed
- Disclose all debts and liabilities

## PMI Information
Private mortgage insurance allows homeownership with less than 20% down.
Talk to your loan officer about PMI options from Enact.

Source: Enact Mortgage Insurance (01754.CB.0323)</pre>
            </div>
        </div>
    </div>

    <!-- AI Prompt Modal -->
    <div class="modal-overlay prompt-modal" id="promptModal">
        <div class="modal">
            <div class="modal-header">
                <h3 id="promptModalTitle">AI Agent Build Prompt</h3>
                <div class="modal-actions">
                    <button class="modal-btn copy" onclick="copyPromptToClipboard()">Copy Prompt</button>
                    <button class="modal-btn close" onclick="closePromptModal()">Close</button>
                </div>
            </div>
            <div class="modal-body">
                <div class="prompt-tags" id="promptTags"></div>
                <div class="prompt-section">
                    <h4>Agent Purpose</h4>
                    <div class="prompt-box" id="promptPurpose"></div>
                </div>
                <div class="prompt-section">
                    <h4>Full Build Prompt</h4>
                    <div class="prompt-box" id="promptContent"></div>
                </div>
                <div class="prompt-section">
                    <h4>Integration Points</h4>
                    <div class="prompt-box" id="promptIntegration"></div>
                </div>
            </div>
        </div>
    </div>

    <div class="copy-success" id="copySuccess">Copied to clipboard!</div>

    <script>
        // Tab switching
        function switchTab(tab) {
            document.querySelectorAll('.sidebar-tab').forEach(t => t.classList.remove('active'));
            document.querySelectorAll('.tab-panel').forEach(p => p.classList.remove('active'));

            if (tab === 'workflow') {
                document.querySelector('.sidebar-tab:not(.agent-tab)').classList.add('active');
                document.getElementById('workflow-panel').classList.add('active');
                document.getElementById('workflow-nav').style.display = 'block';
                document.getElementById('agents-nav').style.display = 'none';
            } else {
                document.querySelector('.sidebar-tab.agent-tab').classList.add('active');
                document.getElementById('agents-panel').classList.add('active');
                document.getElementById('workflow-nav').style.display = 'none';
                document.getElementById('agents-nav').style.display = 'block';
            }

            window.scrollTo(0, 0);
        }

        // Scroll spy with isScrolling flag and 1000ms timeout
        const sections = document.querySelectorAll('.section, .quick-ref');
        const navItems = document.querySelectorAll('#workflow-nav .nav-item');
        let isScrolling = false;
        let scrollTimeout;

        function updateActiveNav() {
            if (isScrolling) return;

            let current = '';
            sections.forEach(section => {
                const sectionTop = section.offsetTop - 100;
                if (window.scrollY >= sectionTop) current = section.getAttribute('id');
            });
            navItems.forEach(item => {
                item.classList.remove('active');
                if (item.getAttribute('href') === '#' + current) item.classList.add('active');
            });
        }

        // Handle nav click to temporarily disable scroll spy
        navItems.forEach(item => {
            item.addEventListener('click', function(e) {
                isScrolling = true;
                clearTimeout(scrollTimeout);

                // Remove active from all, add to clicked
                navItems.forEach(nav => nav.classList.remove('active'));
                this.classList.add('active');

                // Re-enable scroll spy after 1000ms
                scrollTimeout = setTimeout(() => {
                    isScrolling = false;
                }, 1000);
            });
        });

        window.addEventListener('scroll', updateActiveNav);

        // Modal
        function openDocModal() {
            document.getElementById('docModal').classList.add('show');
            document.body.style.overflow = 'hidden';
        }

        function closeDocModal() {
            document.getElementById('docModal').classList.remove('show');
            document.body.style.overflow = '';
        }

        async function copyToClipboard() {
            try {
                await navigator.clipboard.writeText(document.getElementById('docContent').textContent);
                const success = document.getElementById('copySuccess');
                success.style.display = 'block';
                setTimeout(() => { success.style.display = 'none'; }, 2000);
            } catch (e) { alert('Failed to copy.'); }
        }

        document.addEventListener('keydown', (e) => { if (e.key === 'Escape') { closeDocModal(); closePromptModal(); } });
        document.getElementById('docModal').addEventListener('click', (e) => { if (e.target.id === 'docModal') closeDocModal(); });

        document.addEventListener('DOMContentLoaded', () => { updateActiveNav(); });

        // Scroll to agent card and highlight
        function scrollToAgent(agentId) {
            const agentCard = document.getElementById(agentId);
            if (agentCard) {
                document.querySelectorAll('.agent-card.highlight').forEach(card => {
                    card.classList.remove('highlight');
                });

                agentCard.scrollIntoView({ behavior: 'smooth', block: 'center' });

                setTimeout(() => {
                    agentCard.classList.add('highlight');
                }, 300);

                setTimeout(() => {
                    agentCard.classList.remove('highlight');
                }, 2500);
            }
        }

        // Agent Prompt System
        const agentPrompts = {
            creditmonitor: {
                name: 'Credit Monitor Agent',
                tags: ['Monitoring', 'Alerts', 'Medium Complexity', 'Critical Priority'],
                purpose: `This agent continuously monitors borrower credit activity during the loan process and immediately alerts the LO/Processor of any new inquiries, accounts opened, or significant balance changes that could impact loan qualification or require re-underwriting.`,
                prompt: `You are building a Credit Monitoring Agent for CMG Financial's loan process.

AGENT NAME: Credit Monitor Agent
TYPE: Real-time Monitoring / Push Alerts

OBJECTIVE:
Monitor borrower credit profiles from application through closing and alert the loan team immediately when credit activity is detected that could impact qualification.

MONITORING TRIGGERS:
1. New credit inquiries (hard pulls)
2. New accounts opened (credit cards, loans, lines of credit)
3. Balance increases > $500 on existing accounts
4. Late payments reported
5. Collections or derogatory marks
6. Account closures

ALERT THRESHOLDS:
- New Inquiry: INFO alert to LO
- New Account: WARNING alert to LO + Processor
- Balance Increase > $2,000: WARNING alert
- Late Payment: CRITICAL alert to LO + Processor + Manager
- New Collection: CRITICAL alert with loan hold

DATA SOURCES:
- Soft credit monitoring services (Credit Karma API, Experian Connect)
- Pre-closing credit refresh triggers
- Borrower-authorized credit monitoring

ALERT MESSAGE FORMAT:
{
  "loan_number": "2026-001234",
  "borrower_name": "John Smith",
  "alert_type": "NEW_ACCOUNT",
  "severity": "WARNING",
  "details": "New credit card opened: Chase Freedom, $5,000 limit",
  "dti_impact": "+2.3%",
  "action_required": "Request explanation letter, recalculate DTI"
}`,
                integration: `INTEGRATION POINTS:
1. Credit Bureau APIs
   - Soft pull monitoring services
   - Pre-closing refresh integration
   - Alert webhook endpoints

2. LOS Integration
   - Update loan notes with alerts
   - Trigger condition creation
   - DTI recalculation

3. Notification System
   - Email to loan team
   - SMS for critical alerts
   - Dashboard notifications

4. Compliance Logging
   - All alerts logged for audit
   - Borrower communication tracking
   - Resolution documentation`
            },
            docreminder: {
                name: 'Document Reminder Agent',
                tags: ['Communication', 'Automation', 'Low Complexity', 'High Priority'],
                purpose: `This agent sends personalized, timely reminders to borrowers about outstanding document needs. It explains what documents are needed, why they're needed, and how to submit them, reducing processor follow-up time and accelerating document collection.`,
                prompt: `You are building a Document Reminder Agent for CMG Financial's loan process.

AGENT NAME: Document Reminder Agent
TYPE: Automated Communication / Follow-up

OBJECTIVE:
Proactively remind borrowers of outstanding document needs with clear, helpful instructions to accelerate document collection and reduce processor workload.

REMINDER SCHEDULE:
- Day 0: Initial request with full instructions
- Day 2: Friendly reminder (if not received)
- Day 5: Urgent reminder with escalation warning
- Day 7: Final notice + LO notified

MESSAGE PERSONALIZATION:
- Borrower first name
- Specific document name
- Why it's needed (plain language)
- How to submit (upload link, email, fax)
- Who to contact with questions

DOCUMENT-SPECIFIC INSTRUCTIONS:
{
  "pay_stubs": {
    "what": "Most recent 30 days of pay stubs",
    "why": "Verify your current income and employment",
    "tips": "Include all pages, ensure employer name visible"
  },
  "bank_statements": {
    "what": "Last 2 months of bank statements (all pages)",
    "why": "Verify funds for down payment and closing costs",
    "tips": "Include all pages even if blank, all accounts used for funds"
  },
  "gift_letter": {
    "what": "Signed gift letter from donor",
    "why": "Document that funds are a gift with no repayment",
    "tips": "Use provided template, donor signature required"
  }
}

TRACKING:
- Log all reminders sent
- Track borrower opens/clicks
- Flag non-responsive borrowers
- Escalate to LO after Day 7`,
                integration: `INTEGRATION POINTS:
1. LOS Condition System
   - Query outstanding conditions
   - Filter by document type
   - Update when received

2. Email/SMS Platform
   - SendGrid for email
   - Twilio for SMS
   - Template management

3. Document Portal
   - Direct upload links
   - Status tracking
   - Receipt confirmation

4. Reporting
   - Collection time metrics
   - Response rates by document type
   - Processor time saved`
            },
            education: {
                name: 'Borrower Education Agent',
                tags: ['Communication', 'Content', 'Low Complexity', 'High Priority'],
                purpose: `This agent delivers timely, relevant educational content to first-time homebuyers at key milestones in their loan journey. It includes Do's and Don'ts tips, process explanations, and milestone celebrations to keep borrowers informed and engaged.`,
                prompt: `You are building a Borrower Education Agent for CMG Financial.

AGENT NAME: Borrower Education Agent
TYPE: Automated Content Delivery / Engagement

OBJECTIVE:
Keep first-time homebuyers informed and engaged throughout the loan process by delivering relevant educational content at key milestones.

MILESTONE TRIGGERS:
1. Application Submitted: Welcome + What to Expect
2. Processing Started: Do's and Don'ts Reminder
3. Submitted to UW: What Underwriting Means
4. Conditionally Approved: Celebration + Final Steps
5. Clear to Close: Closing Day Preparation
6. Funded: Congratulations + Homeowner Tips

CONTENT LIBRARY:
{
  "dos_donts": {
    "trigger": "processing_started",
    "subject": "Important Tips While Your Loan is Processing",
    "content": [
      "DO: Keep paying bills on time",
      "DO: Maintain current employment",
      "DO: Keep documents organized",
      "DON'T: Open new credit accounts",
      "DON'T: Make large purchases",
      "DON'T: Change jobs without telling us"
    ]
  },
  "closing_prep": {
    "trigger": "clear_to_close",
    "subject": "You're Almost There! Closing Day Checklist",
    "content": [
      "What to bring to closing",
      "Wire fraud warning",
      "Final walk-through tips",
      "What happens at the closing table"
    ]
  }
}

PERSONALIZATION:
- Borrower name
- LO name and contact
- Loan milestone dates
- Property address (when available)`,
                integration: `INTEGRATION POINTS:
1. LOS Milestone Events
   - Subscribe to status changes
   - Trigger content delivery
   - Track delivery status

2. Content Management
   - Template library
   - Version control
   - A/B testing capability

3. Delivery Channels
   - Email (primary)
   - SMS (opt-in)
   - Borrower portal

4. Analytics
   - Open rates
   - Click-through rates
   - Satisfaction surveys
   - Support call reduction metrics`
            },
            deposit: {
                name: 'Deposit Tracker Agent',
                tags: ['Data Analysis', 'Compliance', 'Medium Complexity', 'Medium Priority'],
                purpose: `This agent analyzes bank statements to identify non-payroll deposits that require source documentation for compliance. It automatically flags unusual deposits, categorizes them, and initiates documentation requests before underwriting review.`,
                prompt: `You are building a Deposit Tracker Agent for CMG Financial.

AGENT NAME: Deposit Tracker Agent
TYPE: Document Analysis / Compliance Automation

OBJECTIVE:
Automatically analyze bank statements to identify deposits requiring source documentation, flag them for review, and initiate documentation requests before underwriting.

DEPOSIT CLASSIFICATION:
{
  "payroll": {
    "pattern": "Direct deposit, recurring, matches pay stub amount",
    "documentation": "None (covered by pay stubs)",
    "flag": false
  },
  "transfer": {
    "pattern": "Transfer from another account",
    "documentation": "Statement from source account",
    "flag": true
  },
  "cash": {
    "pattern": "Cash deposit, ATM cash, branch deposit",
    "documentation": "LOE, source documentation",
    "flag": true,
    "alert_level": "HIGH"
  },
  "gift": {
    "pattern": "Large non-recurring deposit, check from individual",
    "documentation": "Gift letter, donor bank statement",
    "flag": true
  },
  "unknown": {
    "pattern": "Cannot categorize automatically",
    "documentation": "LOE required",
    "flag": true
  }
}

ANALYSIS RULES:
1. Parse all deposits > $500 in 2-month statement period
2. Match recurring deposits to pay stub amounts
3. Flag all non-payroll deposits
4. Calculate total flagged amount vs. assets needed
5. Generate documentation request list

OUTPUT:
{
  "loan_number": "2026-001234",
  "total_deposits": "$15,750",
  "payroll_deposits": "$12,000",
  "flagged_deposits": [
    {
      "date": "01/15/2026",
      "amount": "$2,500",
      "description": "Mobile Deposit Check",
      "classification": "gift_or_unknown",
      "documentation_needed": "LOE, check copy, source documentation"
    }
  ],
  "action_items": ["Request LOE for $2,500 deposit", "Request gift letter if applicable"]
}`,
                integration: `INTEGRATION POINTS:
1. Document OCR/Parsing
   - Bank statement OCR
   - Transaction extraction
   - Pattern matching

2. LOS Integration
   - Create conditions automatically
   - Link to asset documentation
   - Update loan notes

3. Borrower Communication
   - Automated documentation requests
   - Clear explanation of requirements
   - Upload link generation

4. Compliance Reporting
   - Audit trail of all flagged deposits
   - Documentation tracking
   - Underwriter pre-check`
            }
        };

        // Show agent prompt modal
        let currentPromptContent = '';

        function showAgentPrompt(agentKey) {
            const agent = agentPrompts[agentKey];
            if (!agent) return;

            document.getElementById('promptModalTitle').textContent = agent.name + ' - Build Prompt';

            const tagsHtml = agent.tags.map(tag => '<span class="prompt-tag">' + tag + '</span>').join('');
            document.getElementById('promptTags').innerHTML = tagsHtml;

            document.getElementById('promptPurpose').textContent = agent.purpose;
            document.getElementById('promptContent').textContent = agent.prompt;
            document.getElementById('promptIntegration').textContent = agent.integration;

            currentPromptContent = '# ' + agent.name + '\n\n## Purpose\n' + agent.purpose + '\n\n## Build Prompt\n' + agent.prompt + '\n\n## Integration Points\n' + agent.integration;

            document.getElementById('promptModal').classList.add('show');
            document.body.style.overflow = 'hidden';
        }

        function closePromptModal() {
            document.getElementById('promptModal').classList.remove('show');
            document.body.style.overflow = '';
        }

        async function copyPromptToClipboard() {
            try {
                await navigator.clipboard.writeText(currentPromptContent);
                const success = document.getElementById('copySuccess');
                success.style.display = 'block';
                setTimeout(() => { success.style.display = 'none'; }, 2000);
            } catch (e) {
                alert('Failed to copy prompt.');
            }
        }

        document.getElementById('promptModal').addEventListener('click', (e) => {
            if (e.target.id === 'promptModal') closePromptModal();
        });
    </script>
</body>
</html>
