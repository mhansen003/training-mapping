<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Status Change Permissions - Joint Venture</title>
    <link href="https://fonts.googleapis.com/css2?family=Plus+Jakarta+Sans:wght@400;500;600;700;800&family=JetBrains+Mono:wght@400;500&display=swap" rel="stylesheet">
    <style>
        :root {
            --bg-primary: #0a0f1a;
            --bg-secondary: #111827;
            --bg-card: #1a2234;
            --accent-blue: #3b82f6;
            --accent-teal: #14b8a6;
            --accent-amber: #f59e0b;
            --accent-rose: #f43f5e;
            --accent-green: #22c55e;
            --accent-purple: #8b5cf6;
            --text-primary: #f1f5f9;
            --text-secondary: #94a3b8;
            --text-muted: #64748b;
            --border-subtle: rgba(255,255,255,0.08);
            --sidebar-width: 280px;
        }

        * { box-sizing: border-box; margin: 0; padding: 0; }
        html { scroll-behavior: smooth; }
        body {
            font-family: 'Plus Jakarta Sans', -apple-system, BlinkMacSystemFont, sans-serif;
            background: var(--bg-primary);
            color: var(--text-primary);
            min-height: 100vh;
        }

        /* Breadcrumb */
        .breadcrumb {
            background: linear-gradient(90deg, #0d1525 0%, #1a2234 100%);
            padding: 14px 25px;
            display: flex;
            align-items: center;
            gap: 12px;
            font-size: 0.95rem;
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            z-index: 1001;
            border-bottom: 1px solid var(--border-subtle);
        }

        .breadcrumb a {
            color: var(--text-secondary);
            text-decoration: none;
            font-weight: 600;
            padding: 8px 16px;
            background: rgba(255,255,255,0.05);
            border-radius: 8px;
            transition: all 0.2s;
            border: 1px solid var(--border-subtle);
        }

        .breadcrumb a:hover {
            background: rgba(59, 130, 246, 0.15);
            color: var(--accent-blue);
            border-color: rgba(59, 130, 246, 0.3);
        }

        .breadcrumb .separator { color: var(--text-muted); font-size: 1.2rem; }
        .breadcrumb .current { color: var(--accent-amber); font-weight: 600; padding: 8px 16px; }

        /* Sidebar */
        .sidebar {
            position: fixed;
            top: 54px;
            left: 0;
            width: var(--sidebar-width);
            height: calc(100vh - 54px);
            background: var(--bg-secondary);
            overflow-y: auto;
            z-index: 1000;
            border-right: 1px solid var(--border-subtle);
            display: flex;
            flex-direction: column;
        }

        .sidebar-header {
            padding: 25px 20px;
            background: rgba(0,0,0,0.3);
            border-bottom: 1px solid var(--border-subtle);
        }

        .sidebar-header h2 { color: var(--text-primary); font-size: 1.2rem; font-weight: 700; margin-bottom: 5px; }
        .sidebar-header p { color: var(--text-muted); font-size: 0.85rem; }

        /* Tab Switch */
        .sidebar-tabs {
            display: flex;
            border-bottom: 1px solid var(--border-subtle);
        }

        .sidebar-tab {
            flex: 1;
            padding: 14px 10px;
            text-align: center;
            font-size: 0.8rem;
            font-weight: 700;
            color: var(--text-muted);
            cursor: pointer;
            transition: all 0.2s;
            border-bottom: 3px solid transparent;
            background: none;
            border-left: none;
            border-right: none;
            border-top: none;
        }

        .sidebar-tab:hover { background: rgba(255,255,255,0.03); color: var(--text-secondary); }
        .sidebar-tab.active { color: var(--accent-blue); border-bottom-color: var(--accent-blue); background: rgba(59, 130, 246, 0.08); }
        .sidebar-tab.agent-tab.active { color: var(--accent-purple); border-bottom-color: var(--accent-purple); background: rgba(139, 92, 246, 0.08); }

        .sidebar-nav { padding: 15px 0; flex: 1; overflow-y: auto; }

        .nav-item {
            display: flex;
            align-items: center;
            gap: 12px;
            padding: 14px 20px;
            color: var(--text-secondary);
            text-decoration: none;
            border-left: 3px solid transparent;
            transition: all 0.2s ease;
            cursor: pointer;
        }

        .nav-item:hover { background: rgba(255,255,255,0.03); color: var(--text-primary); }
        .nav-item.active { background: rgba(59, 130, 246, 0.1); border-left-color: var(--accent-blue); color: var(--text-primary); }

        .nav-number {
            background: rgba(255,255,255,0.1);
            color: var(--text-secondary);
            width: 28px;
            height: 28px;
            border-radius: 8px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 700;
            font-size: 0.85rem;
            flex-shrink: 0;
        }

        .nav-item.active .nav-number { background: var(--accent-blue); color: white; }
        .nav-label { font-size: 0.95rem; font-weight: 500; }

        .sidebar-footer {
            padding: 20px;
            border-top: 1px solid var(--border-subtle);
            background: rgba(0,0,0,0.2);
        }

        .doc-btn {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
            width: 100%;
            padding: 14px 20px;
            background: linear-gradient(135deg, var(--accent-blue) 0%, var(--accent-teal) 100%);
            color: white;
            border: none;
            border-radius: 10px;
            font-weight: 600;
            cursor: pointer;
            transition: transform 0.2s, box-shadow 0.2s;
            text-decoration: none;
            font-size: 0.95rem;
        }

        .doc-btn:hover { transform: translateY(-2px); box-shadow: 0 8px 25px rgba(59, 130, 246, 0.3); }

        /* Main Content */
        .main-content { margin-left: var(--sidebar-width); padding: 80px 40px 40px 40px; }

        /* Tab Panels */
        .tab-panel { display: none; }
        .tab-panel.active { display: block; }

        .header {
            background: var(--bg-card);
            border: 1px solid var(--border-subtle);
            padding: 35px;
            border-radius: 16px;
            margin-bottom: 30px;
            position: relative;
            overflow: hidden;
        }

        .header::before {
            content: '';
            position: absolute;
            top: 0; left: 0; right: 0; bottom: 0;
            background:
                radial-gradient(ellipse at 20% 20%, rgba(59, 130, 246, 0.1) 0%, transparent 50%),
                radial-gradient(ellipse at 80% 80%, rgba(20, 184, 166, 0.08) 0%, transparent 50%);
            pointer-events: none;
        }

        .header h1 {
            font-size: 2.2rem;
            font-weight: 800;
            margin-bottom: 10px;
            position: relative;
            background: linear-gradient(135deg, var(--text-primary) 0%, var(--accent-blue) 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .header .subtitle { color: var(--text-secondary); font-size: 1.1rem; position: relative; }

        .header .meta { display: flex; gap: 15px; margin-top: 20px; flex-wrap: wrap; position: relative; }

        .header .meta-item {
            background: rgba(255,255,255,0.05);
            border: 1px solid var(--border-subtle);
            padding: 8px 16px;
            border-radius: 8px;
            font-size: 0.9rem;
            color: var(--text-secondary);
        }

        /* Legend */
        .legend {
            display: flex;
            flex-wrap: wrap;
            gap: 15px;
            padding: 18px 22px;
            background: var(--bg-card);
            border: 1px solid var(--border-subtle);
            border-radius: 12px;
            margin-bottom: 25px;
        }

        .legend-item { display: flex; align-items: center; gap: 8px; font-size: 0.85rem; color: var(--text-secondary); }
        .legend-color { width: 18px; height: 18px; border-radius: 4px; }

        /* Sections */
        .section {
            background: var(--bg-card);
            border: 1px solid var(--border-subtle);
            border-radius: 16px;
            margin-bottom: 25px;
            overflow: hidden;
            scroll-margin-top: 75px;
        }

        .section-header {
            background: linear-gradient(135deg, var(--bg-secondary) 0%, rgba(59, 130, 246, 0.1) 100%);
            border-bottom: 1px solid var(--border-subtle);
            padding: 22px 25px;
            display: flex;
            align-items: center;
            gap: 18px;
        }

        .section-number {
            background: linear-gradient(135deg, var(--accent-blue) 0%, var(--accent-teal) 100%);
            color: white;
            width: 48px;
            height: 48px;
            border-radius: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 800;
            font-size: 1.3rem;
            flex-shrink: 0;
        }

        .section-title h2 { font-size: 1.35rem; font-weight: 700; margin-bottom: 4px; color: var(--text-primary); }
        .section-title span { font-size: 0.9rem; color: var(--text-muted); }
        .section-content { padding: 28px; }

        /* Tables */
        .field-table { width: 100%; border-collapse: collapse; margin: 18px 0; }

        .field-table th {
            background: rgba(59, 130, 246, 0.15);
            color: var(--accent-blue);
            padding: 14px 18px;
            text-align: left;
            font-weight: 600;
            font-size: 0.9rem;
            text-transform: uppercase;
            letter-spacing: 0.05em;
            border-bottom: 1px solid var(--border-subtle);
        }

        .field-table td { padding: 14px 18px; border-bottom: 1px solid var(--border-subtle); color: var(--text-secondary); }
        .field-table tr:hover { background: rgba(255,255,255,0.02); }

        .badge { display: inline-block; padding: 4px 12px; border-radius: 6px; font-size: 0.75rem; font-weight: 700; text-transform: uppercase; letter-spacing: 0.05em; }
        .badge.role-badge { background: rgba(59, 130, 246, 0.15); color: var(--accent-blue); }
        .badge.status-badge { background: rgba(34, 197, 94, 0.15); color: var(--accent-green); }
        .badge.warning-badge { background: rgba(244, 63, 94, 0.15); color: var(--accent-rose); }

        /* Info Boxes */
        .exception-box, .tip-box, .info-box {
            padding: 18px 22px;
            margin: 18px 0;
            border-radius: 0 10px 10px 0;
            border-left-width: 4px;
            border-left-style: solid;
        }

        .exception-box { background: rgba(244, 63, 94, 0.08); border-color: var(--accent-rose); border: 1px solid rgba(244, 63, 94, 0.2); border-left: 4px solid var(--accent-rose); }
        .exception-box h4 { color: var(--accent-rose); margin-bottom: 10px; font-size: 1rem; }
        .exception-box p, .exception-box li { color: var(--text-secondary); }

        .tip-box { background: rgba(34, 197, 94, 0.08); border-color: var(--accent-green); border: 1px solid rgba(34, 197, 94, 0.2); border-left: 4px solid var(--accent-green); }
        .tip-box h4 { color: var(--accent-green); margin-bottom: 10px; font-size: 1rem; }
        .tip-box p, .tip-box li { color: var(--text-secondary); }

        .info-box { background: rgba(59, 130, 246, 0.08); border-color: var(--accent-blue); border: 1px solid rgba(59, 130, 246, 0.2); border-left: 4px solid var(--accent-blue); }
        .info-box h4 { color: var(--accent-blue); margin-bottom: 10px; font-size: 1rem; }
        .info-box p, .info-box li { color: var(--text-secondary); }

        /* Role Cards */
        .role-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(320px, 1fr)); gap: 20px; margin: 22px 0; }

        .role-card { background: rgba(0,0,0,0.2); border: 1px solid var(--border-subtle); border-radius: 12px; overflow: hidden; }
        .role-card-header { background: linear-gradient(135deg, var(--accent-blue) 0%, var(--accent-teal) 100%); color: white; padding: 18px; text-align: center; }
        .role-card-header h4 { font-size: 1.05rem; }
        .role-card-body { padding: 22px; max-height: 400px; overflow-y: auto; }

        .permission-item {
            padding: 10px 0;
            border-bottom: 1px solid var(--border-subtle);
            display: flex;
            align-items: center;
            gap: 12px;
            color: var(--text-secondary);
            font-size: 0.9rem;
        }
        .permission-item:last-child { border-bottom: none; }
        .arrow-icon { color: var(--accent-teal); font-weight: bold; min-width: 30px; }

        /* Quick Reference */
        .quick-ref {
            background: linear-gradient(135deg, var(--bg-secondary) 0%, var(--bg-card) 100%);
            border: 1px solid var(--border-subtle);
            padding: 28px;
            border-radius: 16px;
            margin-top: 30px;
            font-family: 'JetBrains Mono', monospace;
            scroll-margin-top: 75px;
        }

        .quick-ref h3 { color: var(--accent-amber); margin-bottom: 18px; font-family: 'Plus Jakarta Sans', sans-serif; }
        .quick-ref pre { background: rgba(0,0,0,0.4); border: 1px solid var(--border-subtle); padding: 20px; border-radius: 10px; overflow-x: auto; font-size: 0.85rem; line-height: 1.7; color: var(--text-secondary); }

        /* ====== AGENT OPPORTUNITIES STYLES ====== */
        .agent-header {
            background: var(--bg-card);
            border: 1px solid var(--border-subtle);
            padding: 35px;
            border-radius: 16px;
            margin-bottom: 30px;
            position: relative;
            overflow: hidden;
        }

        .agent-header::before {
            content: '';
            position: absolute;
            top: 0; left: 0; right: 0; bottom: 0;
            background:
                radial-gradient(ellipse at 20% 20%, rgba(139, 92, 246, 0.12) 0%, transparent 50%),
                radial-gradient(ellipse at 80% 80%, rgba(245, 158, 11, 0.1) 0%, transparent 50%);
            pointer-events: none;
        }

        .agent-header h1 {
            font-size: 2.2rem;
            font-weight: 800;
            margin-bottom: 10px;
            position: relative;
            background: linear-gradient(135deg, var(--accent-purple) 0%, var(--accent-amber) 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .agent-header .subtitle { color: var(--text-secondary); font-size: 1.1rem; position: relative; }

        /* Heat Map */
        .heat-map-container { margin-bottom: 35px; }
        .heat-map-title { font-size: 1.3rem; font-weight: 700; color: var(--text-primary); margin-bottom: 20px; display: flex; align-items: center; gap: 12px; }

        .heat-map-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
        }

        .heat-item {
            background: var(--bg-card);
            border: 1px solid var(--border-subtle);
            border-radius: 12px;
            padding: 20px;
            position: relative;
            overflow: hidden;
            transition: transform 0.2s, box-shadow 0.2s;
            cursor: pointer;
        }

        .heat-item:hover { transform: translateY(-3px); box-shadow: 0 10px 30px rgba(0,0,0,0.3); }
        .heat-item:active { transform: scale(0.98); }

        .heat-item::before {
            content: '';
            position: absolute;
            top: 0; left: 0; right: 0; height: 4px;
        }

        .heat-item.critical::before { background: linear-gradient(90deg, #ef4444, #f97316); }
        .heat-item.high::before { background: linear-gradient(90deg, #f97316, #eab308); }
        .heat-item.medium::before { background: linear-gradient(90deg, #eab308, #22c55e); }
        .heat-item.low::before { background: linear-gradient(90deg, #22c55e, #14b8a6); }

        .heat-score {
            position: absolute;
            top: 15px;
            right: 15px;
            font-size: 1.8rem;
            font-weight: 800;
        }

        .heat-item.critical .heat-score { color: #ef4444; }
        .heat-item.high .heat-score { color: #f97316; }
        .heat-item.medium .heat-score { color: #eab308; }
        .heat-item.low .heat-score { color: #22c55e; }

        .heat-name { font-size: 1rem; font-weight: 700; color: var(--text-primary); margin-bottom: 6px; padding-right: 50px; }
        .heat-desc { font-size: 0.85rem; color: var(--text-muted); margin-bottom: 12px; }

        .heat-metrics { display: flex; gap: 15px; margin-top: 12px; }
        .heat-metric { font-size: 0.75rem; color: var(--text-muted); }
        .heat-metric span { color: var(--text-secondary); font-weight: 600; }

        /* Agent Cards */
        .agent-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(380px, 1fr)); gap: 25px; margin-bottom: 35px; }

        .agent-card {
            background: var(--bg-card);
            border: 1px solid var(--border-subtle);
            border-radius: 16px;
            overflow: hidden;
            transition: transform 0.2s, box-shadow 0.2s;
        }

        .agent-card:hover { transform: translateY(-5px); box-shadow: 0 15px 50px rgba(0,0,0,0.3); }

        .agent-card.highlight {
            animation: highlightPulse 2s ease;
            box-shadow: 0 0 0 3px var(--accent-purple), 0 15px 50px rgba(139, 92, 246, 0.4);
        }

        @keyframes highlightPulse {
            0% { box-shadow: 0 0 0 3px var(--accent-purple), 0 15px 50px rgba(139, 92, 246, 0.6); }
            50% { box-shadow: 0 0 0 6px rgba(139, 92, 246, 0.5), 0 15px 50px rgba(139, 92, 246, 0.3); }
            100% { box-shadow: 0 0 0 0px transparent, 0 15px 50px rgba(0,0,0,0.3); }
        }

        .agent-card-header {
            padding: 22px;
            display: flex;
            align-items: flex-start;
            gap: 18px;
            border-bottom: 1px solid var(--border-subtle);
        }

        .agent-icon {
            width: 55px;
            height: 55px;
            background: linear-gradient(135deg, var(--accent-purple) 0%, var(--accent-blue) 100%);
            border-radius: 14px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.6rem;
            flex-shrink: 0;
        }

        .agent-info { flex: 1; }
        .agent-name { font-size: 1.15rem; font-weight: 700; color: var(--text-primary); margin-bottom: 5px; }
        .agent-type { font-size: 0.8rem; color: var(--accent-purple); font-weight: 600; text-transform: uppercase; letter-spacing: 0.05em; }

        .agent-priority {
            padding: 6px 12px;
            border-radius: 20px;
            font-size: 0.75rem;
            font-weight: 700;
            text-transform: uppercase;
        }

        .agent-priority.critical { background: rgba(239, 68, 68, 0.15); color: #ef4444; }
        .agent-priority.high { background: rgba(249, 115, 22, 0.15); color: #f97316; }
        .agent-priority.medium { background: rgba(234, 179, 8, 0.15); color: #eab308; }
        .agent-priority.low { background: rgba(34, 197, 94, 0.15); color: #22c55e; }

        .agent-card-body { padding: 22px; }
        .agent-description { font-size: 0.95rem; color: var(--text-secondary); line-height: 1.6; margin-bottom: 20px; }

        .agent-flow {
            background: rgba(0,0,0,0.3);
            border: 1px solid var(--border-subtle);
            border-radius: 10px;
            padding: 18px;
            margin-bottom: 20px;
        }

        .agent-flow-title { font-size: 0.85rem; color: var(--text-muted); margin-bottom: 12px; font-weight: 600; text-transform: uppercase; letter-spacing: 0.05em; }

        .agent-flow-diagram { display: flex; align-items: center; flex-wrap: wrap; gap: 8px; justify-content: center; }

        .agent-step {
            background: linear-gradient(135deg, var(--accent-purple) 0%, var(--accent-blue) 100%);
            color: white;
            padding: 8px 14px;
            border-radius: 6px;
            font-size: 0.8rem;
            font-weight: 600;
            white-space: nowrap;
        }

        .agent-arrow { color: var(--accent-purple); font-size: 1.2rem; }

        .agent-stats { display: grid; grid-template-columns: repeat(3, 1fr); gap: 12px; }

        .agent-stat {
            background: rgba(0,0,0,0.2);
            border-radius: 8px;
            padding: 12px;
            text-align: center;
        }

        .agent-stat-value {
            font-size: 1.3rem;
            font-weight: 800;
            background: linear-gradient(135deg, var(--accent-purple) 0%, var(--accent-amber) 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .agent-stat-label { font-size: 0.7rem; color: var(--text-muted); text-transform: uppercase; letter-spacing: 0.05em; margin-top: 4px; }

        /* View Prompt Button */
        .agent-prompt-btn {
            width: 100%;
            margin-top: 18px;
            padding: 14px 20px;
            background: linear-gradient(135deg, rgba(139, 92, 246, 0.2) 0%, rgba(59, 130, 246, 0.2) 100%);
            border: 1px solid rgba(139, 92, 246, 0.4);
            border-radius: 10px;
            color: var(--accent-purple);
            font-weight: 700;
            cursor: pointer;
            transition: all 0.2s;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
            font-size: 0.9rem;
        }

        .agent-prompt-btn:hover {
            background: linear-gradient(135deg, rgba(139, 92, 246, 0.3) 0%, rgba(59, 130, 246, 0.3) 100%);
            border-color: var(--accent-purple);
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(139, 92, 246, 0.25);
        }

        /* Summary Stats */
        .agent-summary {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin-bottom: 35px;
        }

        .agent-summary-card {
            background: var(--bg-card);
            border: 1px solid var(--border-subtle);
            border-radius: 14px;
            padding: 25px;
            text-align: center;
        }

        .agent-summary-value {
            font-size: 2.5rem;
            font-weight: 800;
            background: linear-gradient(135deg, var(--accent-purple) 0%, var(--accent-amber) 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .agent-summary-label { font-size: 0.9rem; color: var(--text-muted); margin-top: 8px; }

        /* Heat Map Legend */
        .heat-legend {
            display: flex;
            gap: 25px;
            padding: 18px 22px;
            background: var(--bg-card);
            border: 1px solid var(--border-subtle);
            border-radius: 12px;
            margin-bottom: 25px;
            flex-wrap: wrap;
        }

        .heat-legend-item { display: flex; align-items: center; gap: 10px; font-size: 0.9rem; color: var(--text-secondary); }
        .heat-legend-color { width: 24px; height: 24px; border-radius: 6px; }

        /* Modal */
        .modal-overlay {
            display: none;
            position: fixed;
            top: 0; left: 0; right: 0; bottom: 0;
            background: rgba(10, 15, 26, 0.9);
            z-index: 2000;
            justify-content: center;
            align-items: center;
            padding: 20px;
            backdrop-filter: blur(5px);
        }

        .modal-overlay.show { display: flex; }

        .modal {
            background: var(--bg-card);
            border: 1px solid var(--border-subtle);
            border-radius: 16px;
            width: 100%;
            max-width: 950px;
            max-height: 90vh;
            display: flex;
            flex-direction: column;
            box-shadow: 0 25px 80px rgba(0,0,0,0.5);
        }

        .modal-header {
            background: linear-gradient(135deg, var(--accent-blue) 0%, var(--accent-teal) 100%);
            color: white;
            padding: 22px 28px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            border-radius: 16px 16px 0 0;
        }

        .modal-header h3 { font-size: 1.25rem; font-weight: 700; }
        .modal-actions { display: flex; gap: 12px; }

        .modal-btn {
            padding: 10px 18px;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-weight: 700;
            transition: transform 0.2s;
            font-size: 0.9rem;
        }

        .modal-btn:hover { transform: scale(1.05); }
        .modal-btn.copy { background: white; color: var(--accent-blue); }
        .modal-btn.close { background: rgba(255,255,255,0.2); color: white; }

        .modal-body { padding: 28px; overflow-y: auto; flex: 1; }

        .modal-body pre {
            background: rgba(0,0,0,0.3);
            border: 1px solid var(--border-subtle);
            padding: 22px;
            border-radius: 10px;
            font-family: 'JetBrains Mono', monospace;
            font-size: 0.9rem;
            line-height: 1.7;
            white-space: pre-wrap;
            word-wrap: break-word;
            color: var(--text-secondary);
        }

        .copy-success {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: var(--accent-green);
            color: white;
            padding: 18px 35px;
            border-radius: 10px;
            font-weight: 700;
            z-index: 3000;
            display: none;
            animation: fadeInOut 2s ease;
        }

        @keyframes fadeInOut { 0%, 100% { opacity: 0; } 10%, 90% { opacity: 1; } }

        /* Prompt Modal */
        .prompt-modal .modal { max-width: 800px; }
        .prompt-modal .modal-header { background: linear-gradient(135deg, var(--accent-purple) 0%, var(--accent-blue) 100%); }

        .prompt-section { margin-bottom: 25px; }
        .prompt-section h4 { color: var(--accent-purple); font-size: 1rem; margin-bottom: 12px; display: flex; align-items: center; gap: 8px; }

        .prompt-box {
            background: rgba(0,0,0,0.4);
            border: 1px solid var(--border-subtle);
            border-radius: 10px;
            padding: 20px;
            font-family: 'JetBrains Mono', monospace;
            font-size: 0.85rem;
            line-height: 1.7;
            color: var(--text-secondary);
            white-space: pre-wrap;
            word-wrap: break-word;
        }

        .prompt-tags { display: flex; gap: 10px; flex-wrap: wrap; margin-bottom: 20px; }
        .prompt-tag { background: rgba(139, 92, 246, 0.15); color: var(--accent-purple); padding: 6px 14px; border-radius: 20px; font-size: 0.8rem; font-weight: 600; }

        @media (max-width: 900px) {
            .sidebar { display: none; }
            .main-content { margin-left: 0; padding: 75px 20px 30px 20px; }
            .agent-grid { grid-template-columns: 1fr; }
            .role-grid { grid-template-columns: 1fr; }
        }
            .breadcrumb-logo-link { display: flex; align-items: center; padding: 4px 8px; background: rgba(255,255,255,0.08); border-radius: 8px; border: 1px solid rgba(255,255,255,0.12); transition: all 0.2s; }
        .breadcrumb-logo-link:hover { background: rgba(255,255,255,0.15); }
        .breadcrumb-logo { height: 28px; width: auto; }
    </style>
</head>
<body>
    <!-- Breadcrumb -->
    <nav class="breadcrumb">
        <a href="../../index.html" class="breadcrumb-logo-link"><img src="../../images/clear-ai-logo.png" alt="Clear AI" class="breadcrumb-logo"></a>
        <a href="../../index.html">Home</a>
        <span class="separator">></span>
        <a href="./index.html">Mortgage Fundamentals</a>
        <span class="separator">></span>
        <span class="current">Status Change Permissions JV</span>
    </nav>

    <!-- Fixed Sidebar -->
    <aside class="sidebar">
        <div class="sidebar-header">
            <h2>Status Change Permissions</h2>
            <p>Joint Venture Role Guide</p>
        </div>

        <!-- Tab Switcher -->
        <div class="sidebar-tabs">
            <button class="sidebar-tab active" onclick="switchTab('workflow')">Workflow</button>
            <button class="sidebar-tab agent-tab" onclick="switchTab('agents')">AI Agents</button>
        </div>

        <!-- Workflow Navigation -->
        <nav class="sidebar-nav" id="workflow-nav">
            <a href="#section-1" class="nav-item active">
                <span class="nav-number">1</span>
                <span class="nav-label">JV Loan Officer</span>
            </a>
            <a href="#section-2" class="nav-item">
                <span class="nav-number">2</span>
                <span class="nav-label">JV Manager</span>
            </a>
            <a href="#section-3" class="nav-item">
                <span class="nav-number">3</span>
                <span class="nav-label">JV Production Assistant</span>
            </a>
            <a href="#section-4" class="nav-item">
                <span class="nav-number">4</span>
                <span class="nav-label">JV Loan Processor</span>
            </a>
            <a href="#section-5" class="nav-item">
                <span class="nav-number">5</span>
                <span class="nav-label">JV Ops Manager</span>
            </a>
            <a href="#section-6" class="nav-item">
                <span class="nav-number">6</span>
                <span class="nav-label">Underwriter</span>
            </a>
            <a href="#section-7" class="nav-item">
                <span class="nav-number">7</span>
                <span class="nav-label">Team Lead</span>
            </a>
            <a href="#section-8" class="nav-item">
                <span class="nav-number">8</span>
                <span class="nav-label">Closer</span>
            </a>
            <a href="#section-9" class="nav-item">
                <span class="nav-number">9</span>
                <span class="nav-label">Funder</span>
            </a>
            <a href="#quick-ref" class="nav-item">
                <span class="nav-number">*</span>
                <span class="nav-label">Quick Reference</span>
            </a>
        </nav>

        <!-- Agent Navigation -->
        <nav class="sidebar-nav" id="agents-nav" style="display: none;">
            <a href="#agent-summary" class="nav-item active">
                <span class="nav-number">S</span>
                <span class="nav-label">Summary</span>
            </a>
            <a href="#agent-heatmap" class="nav-item">
                <span class="nav-number">H</span>
                <span class="nav-label">Heat Map</span>
            </a>
            <a href="#agent-details" class="nav-item">
                <span class="nav-number">A</span>
                <span class="nav-label">Agent Details</span>
            </a>
        </nav>

        <div class="sidebar-footer">
            <button class="doc-btn" onclick="openDocModal()">
                View Permissions Matrix
            </button>
        </div>
    </aside>

    <!-- Main Content -->
    <main class="main-content">

        <!-- ==================== WORKFLOW TAB ==================== -->
        <div id="workflow-panel" class="tab-panel active">
            <!-- Header -->
            <div class="header">
                <h1>Status Change Permissions - Joint Venture</h1>
                <p class="subtitle">Complete reference guide for loan status change permissions by JV role in the Loan Origination System</p>
                <div class="meta">
                    <span class="meta-item">System: LOS</span>
                    <span class="meta-item">Channel: Joint Venture</span>
                    <span class="meta-item">Roles: 9 Defined</span>
                    <span class="meta-item">Updated: Jan 2026</span>
                </div>
            </div>

            <!-- Legend -->
            <div class="legend">
                <div class="legend-item"><div class="legend-color" style="background: linear-gradient(135deg, #3b82f6, #2563eb);"></div><span>Production Roles</span></div>
                <div class="legend-item"><div class="legend-color" style="background: linear-gradient(135deg, #14b8a6, #0d9488);"></div><span>Processing Roles</span></div>
                <div class="legend-item"><div class="legend-color" style="background: linear-gradient(135deg, #8b5cf6, #7c3aed);"></div><span>Underwriting</span></div>
                <div class="legend-item"><div class="legend-color" style="background: linear-gradient(135deg, #f59e0b, #d97706);"></div><span>Closing/Funding</span></div>
            </div>

            <!-- Section 1: JV Loan Officer -->
            <section id="section-1" class="section">
                <div class="section-header">
                    <div class="section-number">1</div>
                    <div class="section-title"><h2>JV Loan Officer</h2><span>Production role with initial loan setup and early-stage status changes</span></div>
                </div>
                <div class="section-content">
                    <div class="info-box">
                        <h4>Role Overview</h4>
                        <p>JV Loan Officers handle initial loan origination and can manage status changes through the early stages of the loan lifecycle, including prospect management and disclosure handling.</p>
                    </div>
                    <table class="field-table">
                        <thead>
                            <tr>
                                <th>From Status</th>
                                <th>To Status</th>
                                <th>Stage</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr><td>Not Assigned</td><td>Prospect</td><td><span class="badge role-badge">Intake</span></td></tr>
                            <tr><td>Prospect</td><td>Withdrawn</td><td><span class="badge warning-badge">Exit</span></td></tr>
                            <tr><td>Prospect</td><td>Declined</td><td><span class="badge warning-badge">Exit</span></td></tr>
                            <tr><td>Prospect</td><td>Credit Only</td><td><span class="badge role-badge">Processing</span></td></tr>
                            <tr><td>Pre Approved</td><td>Approved Not Accepted</td><td><span class="badge warning-badge">Exit</span></td></tr>
                            <tr><td>LE Pending</td><td>Withdrawn</td><td><span class="badge warning-badge">Exit</span></td></tr>
                            <tr><td>LE Pending</td><td>Approved Not Accepted</td><td><span class="badge warning-badge">Exit</span></td></tr>
                            <tr><td>Disclosed</td><td>File Received</td><td><span class="badge status-badge">Progress</span></td></tr>
                            <tr><td>Disclosed</td><td>Withdrawn</td><td><span class="badge warning-badge">Exit</span></td></tr>
                            <tr><td>File Received</td><td>Withdrawn</td><td><span class="badge warning-badge">Exit</span></td></tr>
                            <tr><td>Approved</td><td>Loan Re-Structure</td><td><span class="badge role-badge">Restructure</span></td></tr>
                            <tr><td>Approved</td><td>Approved Not Accepted</td><td><span class="badge warning-badge">Exit</span></td></tr>
                            <tr><td>Loan Re-Structure</td><td>Conditions for Review</td><td><span class="badge status-badge">Progress</span></td></tr>
                            <tr><td>Conditions for Review</td><td>Loan Re-Structure</td><td><span class="badge role-badge">Restructure</span></td></tr>
                            <tr><td>Clear to Close</td><td>Loan Re-Structure</td><td><span class="badge role-badge">Restructure</span></td></tr>
                        </tbody>
                    </table>
                </div>
            </section>

            <!-- Section 2: JV Manager -->
            <section id="section-2" class="section">
                <div class="section-header">
                    <div class="section-number">2</div>
                    <div class="section-title"><h2>JV Manager</h2><span>Management role with disclosure and file receipt permissions</span></div>
                </div>
                <div class="section-content">
                    <div class="info-box">
                        <h4>Role Overview</h4>
                        <p>JV Managers oversee the loan process and have permissions to manage disclosure phases and file receipt status changes within the Joint Venture channel.</p>
                    </div>
                    <table class="field-table">
                        <thead>
                            <tr>
                                <th>From Status</th>
                                <th>To Status</th>
                                <th>Stage</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr><td>Not Assigned</td><td>Prospect</td><td><span class="badge role-badge">Intake</span></td></tr>
                            <tr><td>Prospect</td><td>LE Pending</td><td><span class="badge status-badge">Progress</span></td></tr>
                            <tr><td>Prospect</td><td>Withdrawn</td><td><span class="badge warning-badge">Exit</span></td></tr>
                            <tr><td>LE Pending</td><td>Withdrawn</td><td><span class="badge warning-badge">Exit</span></td></tr>
                            <tr><td>Disclosed</td><td>File Received</td><td><span class="badge status-badge">Progress</span></td></tr>
                            <tr><td>Disclosed</td><td>Withdrawn</td><td><span class="badge warning-badge">Exit</span></td></tr>
                            <tr><td>File Received</td><td>Withdrawn</td><td><span class="badge warning-badge">Exit</span></td></tr>
                        </tbody>
                    </table>
                </div>
            </section>

            <!-- Section 3: JV Production Assistant -->
            <section id="section-3" class="section">
                <div class="section-header">
                    <div class="section-number">3</div>
                    <div class="section-title"><h2>JV Production Assistant</h2><span>Support role with extensive status change capabilities</span></div>
                </div>
                <div class="section-content">
                    <div class="info-box">
                        <h4>Role Overview</h4>
                        <p>JV Production Assistants have the most comprehensive permissions among production roles, including advance lock capabilities and full loan lifecycle status management through Clear to Close.</p>
                    </div>
                    <table class="field-table">
                        <thead>
                            <tr>
                                <th>From Status</th>
                                <th>To Status</th>
                                <th>Stage</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr><td>Not Assigned</td><td>Prospect</td><td><span class="badge role-badge">Intake</span></td></tr>
                            <tr><td>Prospect</td><td>Advance Lock</td><td><span class="badge status-badge">Lock</span></td></tr>
                            <tr><td>Prospect</td><td>Withdrawn</td><td><span class="badge warning-badge">Exit</span></td></tr>
                            <tr><td>Prospect</td><td>Declined</td><td><span class="badge warning-badge">Exit</span></td></tr>
                            <tr><td>Prospect</td><td>Credit Only</td><td><span class="badge role-badge">Processing</span></td></tr>
                            <tr><td>LE Pending</td><td>Withdrawn</td><td><span class="badge warning-badge">Exit</span></td></tr>
                            <tr><td>Disclosed</td><td>File Received</td><td><span class="badge status-badge">Progress</span></td></tr>
                            <tr><td>Disclosed</td><td>Withdrawn</td><td><span class="badge warning-badge">Exit</span></td></tr>
                            <tr><td>Pre Approved</td><td>Approved Not Accepted</td><td><span class="badge warning-badge">Exit</span></td></tr>
                            <tr><td>File Received</td><td>Withdrawn</td><td><span class="badge warning-badge">Exit</span></td></tr>
                            <tr><td>Conditions for Review</td><td>Loan Re-Structure</td><td><span class="badge role-badge">Restructure</span></td></tr>
                            <tr><td>Loan Re-Structure</td><td>Conditions for Review</td><td><span class="badge status-badge">Progress</span></td></tr>
                            <tr><td>Approved</td><td>Loan Re-Structure</td><td><span class="badge role-badge">Restructure</span></td></tr>
                            <tr><td>Approved</td><td>Changes to UW</td><td><span class="badge role-badge">UW Review</span></td></tr>
                            <tr><td>Approved</td><td>Approved Not Accepted</td><td><span class="badge warning-badge">Exit</span></td></tr>
                            <tr><td>Clear to Close</td><td>Loan Re-Structure</td><td><span class="badge role-badge">Restructure</span></td></tr>
                            <tr><td>Clear to Close</td><td>Changes to UW</td><td><span class="badge role-badge">UW Review</span></td></tr>
                        </tbody>
                    </table>
                </div>
            </section>

            <!-- Section 4: JV Loan Processor -->
            <section id="section-4" class="section">
                <div class="section-header">
                    <div class="section-number">4</div>
                    <div class="section-title"><h2>JV Loan Processor</h2><span>Processing role with underwriting submission and condition management</span></div>
                </div>
                <div class="section-content">
                    <div class="info-box">
                        <h4>Role Overview</h4>
                        <p>JV Loan Processors manage the file from disclosure through underwriting, with permissions to submit to UW, manage conditions, handle suspensions, and progress files through the approval stages.</p>
                    </div>
                    <table class="field-table">
                        <thead>
                            <tr>
                                <th>From Status</th>
                                <th>To Status</th>
                                <th>Stage</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr><td>Prospect</td><td>Credit Only</td><td><span class="badge role-badge">Processing</span></td></tr>
                            <tr><td>Prospect</td><td>Declined</td><td><span class="badge warning-badge">Exit</span></td></tr>
                            <tr><td>LE Pending</td><td>Approved Not Accepted</td><td><span class="badge warning-badge">Exit</span></td></tr>
                            <tr><td>Disclosed</td><td>File Received</td><td><span class="badge status-badge">Progress</span></td></tr>
                            <tr><td>Disclosed</td><td>Canceled for Incompleteness</td><td><span class="badge warning-badge">Exit</span></td></tr>
                            <tr><td>Disclosed</td><td>Withdrawn</td><td><span class="badge warning-badge">Exit</span></td></tr>
                            <tr><td>Pre Approved</td><td>Canceled for Incompleteness</td><td><span class="badge warning-badge">Exit</span></td></tr>
                            <tr><td>Pre Approved</td><td>Conditions for Review</td><td><span class="badge status-badge">Progress</span></td></tr>
                            <tr><td>File Received</td><td>Canceled for Incompleteness</td><td><span class="badge warning-badge">Exit</span></td></tr>
                            <tr><td>File Received</td><td>UW Received</td><td><span class="badge status-badge">Submit UW</span></td></tr>
                            <tr><td>File Received</td><td>Conditions for Review</td><td><span class="badge status-badge">Progress</span></td></tr>
                            <tr><td>File Received</td><td>Withdrawn</td><td><span class="badge warning-badge">Exit</span></td></tr>
                            <tr><td>UW Received</td><td>File Received</td><td><span class="badge role-badge">Return</span></td></tr>
                            <tr><td>UW Received</td><td>Withdrawn</td><td><span class="badge warning-badge">Exit</span></td></tr>
                            <tr><td>Conditions for Review</td><td>Loan Re-Structure</td><td><span class="badge role-badge">Restructure</span></td></tr>
                            <tr><td>Conditions for Review</td><td>Changes to UW</td><td><span class="badge role-badge">UW Review</span></td></tr>
                            <tr><td>Loan Re-Structure</td><td>Conditions for Review</td><td><span class="badge status-badge">Progress</span></td></tr>
                            <tr><td>Suspended</td><td>Conditions for Review</td><td><span class="badge status-badge">Progress</span></td></tr>
                            <tr><td>Suspended</td><td>Loan Re-Structure</td><td><span class="badge role-badge">Restructure</span></td></tr>
                            <tr><td>Approved</td><td>Canceled for Incompleteness</td><td><span class="badge warning-badge">Exit</span></td></tr>
                            <tr><td>Approved</td><td>Conditions for Review</td><td><span class="badge status-badge">Progress</span></td></tr>
                            <tr><td>Approved</td><td>Loan Re-Structure</td><td><span class="badge role-badge">Restructure</span></td></tr>
                            <tr><td>Approved</td><td>Changes to UW</td><td><span class="badge role-badge">UW Review</span></td></tr>
                            <tr><td>Changes UW</td><td>Conditions for Review</td><td><span class="badge status-badge">Progress</span></td></tr>
                            <tr><td>Clear to Close</td><td>Conditions for Review</td><td><span class="badge status-badge">Progress</span></td></tr>
                            <tr><td>Clear to Close</td><td>Docs Ordered</td><td><span class="badge status-badge">Closing</span></td></tr>
                            <tr><td>Clear to Close</td><td>Loan Re-Structure</td><td><span class="badge role-badge">Restructure</span></td></tr>
                            <tr><td>Clear to Close</td><td>Changes to UW</td><td><span class="badge role-badge">UW Review</span></td></tr>
                            <tr><td>Docs Ordered</td><td>Changes to UW</td><td><span class="badge role-badge">UW Review</span></td></tr>
                        </tbody>
                    </table>
                </div>
            </section>

            <!-- Section 5: JV Ops Manager -->
            <section id="section-5" class="section">
                <div class="section-header">
                    <div class="section-number">5</div>
                    <div class="section-title"><h2>JV Ops Manager</h2><span>Operations management with full pipeline visibility and control</span></div>
                </div>
                <div class="section-content">
                    <div class="info-box">
                        <h4>Role Overview</h4>
                        <p>JV Ops Managers have extensive permissions spanning the entire loan lifecycle, from prospect through document stages, including ability to manage suspensions, approvals, and document ordering.</p>
                    </div>
                    <table class="field-table">
                        <thead>
                            <tr>
                                <th>From Status</th>
                                <th>To Status</th>
                                <th>Stage</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr><td>Prospect</td><td>Credit Only</td><td><span class="badge role-badge">Processing</span></td></tr>
                            <tr><td>Prospect</td><td>Declined</td><td><span class="badge warning-badge">Exit</span></td></tr>
                            <tr><td>Prospect</td><td>Withdrawn</td><td><span class="badge warning-badge">Exit</span></td></tr>
                            <tr><td>Credit Only</td><td>File Received</td><td><span class="badge status-badge">Progress</span></td></tr>
                            <tr><td>Pre Approved</td><td>Approved Not Accepted</td><td><span class="badge warning-badge">Exit</span></td></tr>
                            <tr><td>Pre Approved</td><td>Conditions for Review</td><td><span class="badge status-badge">Progress</span></td></tr>
                            <tr><td>LE Pending</td><td>Withdrawn</td><td><span class="badge warning-badge">Exit</span></td></tr>
                            <tr><td>LE Pending</td><td>Approved Not Accepted</td><td><span class="badge warning-badge">Exit</span></td></tr>
                            <tr><td>Disclosed</td><td>Declined</td><td><span class="badge warning-badge">Exit</span></td></tr>
                            <tr><td>Disclosed</td><td>File Received</td><td><span class="badge status-badge">Progress</span></td></tr>
                            <tr><td>Disclosed</td><td>Withdrawn</td><td><span class="badge warning-badge">Exit</span></td></tr>
                            <tr><td>File Received</td><td>Canceled for Incompleteness</td><td><span class="badge warning-badge">Exit</span></td></tr>
                            <tr><td>File Received</td><td>Disclosed</td><td><span class="badge role-badge">Return</span></td></tr>
                            <tr><td>File Received</td><td>UW Received</td><td><span class="badge status-badge">Submit UW</span></td></tr>
                            <tr><td>File Received</td><td>Withdrawn</td><td><span class="badge warning-badge">Exit</span></td></tr>
                            <tr><td>UW Received</td><td>Approved</td><td><span class="badge status-badge">Approved</span></td></tr>
                            <tr><td>UW Received</td><td>File Received</td><td><span class="badge role-badge">Return</span></td></tr>
                            <tr><td>Approved</td><td>Approved Not Accepted</td><td><span class="badge warning-badge">Exit</span></td></tr>
                            <tr><td>Approved</td><td>Changes to UW</td><td><span class="badge role-badge">UW Review</span></td></tr>
                            <tr><td>Approved</td><td>Conditions for Review</td><td><span class="badge status-badge">Progress</span></td></tr>
                            <tr><td>Approved</td><td>Docs Out</td><td><span class="badge status-badge">Closing</span></td></tr>
                            <tr><td>Approved</td><td>Loan Re-Structure</td><td><span class="badge role-badge">Restructure</span></td></tr>
                            <tr><td>Conditions for Review</td><td>Loan Re-Structure</td><td><span class="badge role-badge">Restructure</span></td></tr>
                            <tr><td>Loan Re-Structure</td><td>Conditions for Review</td><td><span class="badge status-badge">Progress</span></td></tr>
                            <tr><td>Suspended</td><td>Conditions for Review</td><td><span class="badge status-badge">Progress</span></td></tr>
                            <tr><td>Clear to Close</td><td>Approved Not Accepted</td><td><span class="badge warning-badge">Exit</span></td></tr>
                            <tr><td>Clear to Close</td><td>Changes to UW</td><td><span class="badge role-badge">UW Review</span></td></tr>
                            <tr><td>Clear to Close</td><td>Conditions for Review</td><td><span class="badge status-badge">Progress</span></td></tr>
                            <tr><td>Clear to Close</td><td>Docs Ordered</td><td><span class="badge status-badge">Closing</span></td></tr>
                            <tr><td>Docs Ordered</td><td>Approved Not Accepted</td><td><span class="badge warning-badge">Exit</span></td></tr>
                            <tr><td>Docs Ordered</td><td>Changes to UW</td><td><span class="badge role-badge">UW Review</span></td></tr>
                            <tr><td>Docs Out</td><td>Approved Not Accepted</td><td><span class="badge warning-badge">Exit</span></td></tr>
                            <tr><td>Docs Back</td><td>Approved Not Accepted</td><td><span class="badge warning-badge">Exit</span></td></tr>
                            <tr><td>Docs Back</td><td>Docs Ordered</td><td><span class="badge role-badge">Return</span></td></tr>
                        </tbody>
                    </table>
                </div>
            </section>

            <!-- Section 6: Underwriter -->
            <section id="section-6" class="section">
                <div class="section-header">
                    <div class="section-number">6</div>
                    <div class="section-title"><h2>Underwriter</h2><span>Credit decision role with comprehensive approval and condition authority</span></div>
                </div>
                <div class="section-content">
                    <div class="info-box">
                        <h4>Role Overview</h4>
                        <p>Underwriters have the most extensive permissions for credit decisions, including all approval pathways, suspensions, declines, condition management, and CORR audit processes. This role controls the critical decision points in the loan lifecycle.</p>
                    </div>
                    <table class="field-table">
                        <thead>
                            <tr>
                                <th>From Status</th>
                                <th>To Status</th>
                                <th>Stage</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr><td>Credit Only</td><td>Pre Approved</td><td><span class="badge status-badge">Progress</span></td></tr>
                            <tr><td>Credit Only</td><td>Suspended</td><td><span class="badge warning-badge">Suspend</span></td></tr>
                            <tr><td>Credit Only</td><td>Registered</td><td><span class="badge status-badge">Progress</span></td></tr>
                            <tr><td>Credit Only</td><td>Canceled for Incompleteness</td><td><span class="badge warning-badge">Exit</span></td></tr>
                            <tr><td>Credit Only</td><td>Declined</td><td><span class="badge warning-badge">Exit</span></td></tr>
                            <tr><td>Pre Approved</td><td>Approved Not Accepted</td><td><span class="badge warning-badge">Exit</span></td></tr>
                            <tr><td>Pre Approved</td><td>Suspended</td><td><span class="badge warning-badge">Suspend</span></td></tr>
                            <tr><td>CORR-Credit Audit in Process</td><td>Corr-Credit Only Completed</td><td><span class="badge status-badge">Progress</span></td></tr>
                            <tr><td>CORR-Credit Audit in Process</td><td>Suspended</td><td><span class="badge warning-badge">Suspend</span></td></tr>
                            <tr><td>CORR-Credit Audit in Process</td><td>CORR-Legal Audit in Process</td><td><span class="badge status-badge">Progress</span></td></tr>
                            <tr><td>CORR-Credit Only Completed</td><td>CORR-Legal Audit in Process</td><td><span class="badge status-badge">Progress</span></td></tr>
                            <tr><td>Disclosed</td><td>Approved</td><td><span class="badge status-badge">Approved</span></td></tr>
                            <tr><td>LE Pending</td><td>Approved</td><td><span class="badge status-badge">Approved</span></td></tr>
                            <tr><td>UW Received</td><td>File Received</td><td><span class="badge role-badge">Return</span></td></tr>
                            <tr><td>UW Received</td><td>Approved</td><td><span class="badge status-badge">Approved</span></td></tr>
                            <tr><td>UW Received</td><td>Suspended</td><td><span class="badge warning-badge">Suspend</span></td></tr>
                            <tr><td>UW Received</td><td>Declined</td><td><span class="badge warning-badge">Exit</span></td></tr>
                            <tr><td>UW Received</td><td>Canceled for Incompleteness</td><td><span class="badge warning-badge">Exit</span></td></tr>
                            <tr><td>Approved</td><td>Clear to Close</td><td><span class="badge status-badge">CTC</span></td></tr>
                            <tr><td>Approved</td><td>Suspended</td><td><span class="badge warning-badge">Suspend</span></td></tr>
                            <tr><td>Approved</td><td>Declined</td><td><span class="badge warning-badge">Exit</span></td></tr>
                            <tr><td>Approved</td><td>Approved Not Accepted</td><td><span class="badge warning-badge">Exit</span></td></tr>
                            <tr><td>Changes to UW</td><td>Approved</td><td><span class="badge status-badge">Approved</span></td></tr>
                            <tr><td>Changes to UW</td><td>Conditions for Review</td><td><span class="badge status-badge">Progress</span></td></tr>
                            <tr><td>Changes to UW</td><td>Suspended</td><td><span class="badge warning-badge">Suspend</span></td></tr>
                            <tr><td>Changes to UW</td><td>Docs Ordered</td><td><span class="badge status-badge">Closing</span></td></tr>
                            <tr><td>Changes to UW</td><td>Docs Out</td><td><span class="badge status-badge">Closing</span></td></tr>
                            <tr><td>Changes to UW</td><td>Clear to Close</td><td><span class="badge status-badge">CTC</span></td></tr>
                            <tr><td>Conditions for Review</td><td>Approved</td><td><span class="badge status-badge">Approved</span></td></tr>
                            <tr><td>Conditions for Review</td><td>Suspended</td><td><span class="badge warning-badge">Suspend</span></td></tr>
                            <tr><td>Conditions for Review</td><td>Clear to Close</td><td><span class="badge status-badge">CTC</span></td></tr>
                            <tr><td>Conditions for Review</td><td>Declined</td><td><span class="badge warning-badge">Exit</span></td></tr>
                            <tr><td>Conditions for Review</td><td>Pre Approved</td><td><span class="badge role-badge">Return</span></td></tr>
                            <tr><td>Conditions for Review</td><td>Approved Not Accepted</td><td><span class="badge warning-badge">Exit</span></td></tr>
                            <tr><td>Conditions for Review</td><td>Corr-Credit Only Completed</td><td><span class="badge status-badge">CORR</span></td></tr>
                            <tr><td>Conditions for Review</td><td>CORR-Legal Audit in Process</td><td><span class="badge status-badge">CORR</span></td></tr>
                            <tr><td>Suspended</td><td>Approved</td><td><span class="badge status-badge">Approved</span></td></tr>
                            <tr><td>Suspended</td><td>Declined</td><td><span class="badge warning-badge">Exit</span></td></tr>
                            <tr><td>Suspended</td><td>Pre Approved</td><td><span class="badge role-badge">Return</span></td></tr>
                            <tr><td>Clear to Close</td><td>Approved</td><td><span class="badge role-badge">Return</span></td></tr>
                            <tr><td>Clear to Close</td><td>Suspended</td><td><span class="badge warning-badge">Suspend</span></td></tr>
                            <tr><td>Clear to Close</td><td>Declined</td><td><span class="badge warning-badge">Exit</span></td></tr>
                        </tbody>
                    </table>
                </div>
            </section>

            <!-- Section 7: Team Lead -->
            <section id="section-7" class="section">
                <div class="section-header">
                    <div class="section-number">7</div>
                    <div class="section-title"><h2>Team Lead</h2><span>Supervisory role with full pipeline management capabilities</span></div>
                </div>
                <div class="section-content">
                    <div class="info-box">
                        <h4>Role Overview</h4>
                        <p>Team Leads have comprehensive permissions across all loan stages, from prospect through document handling. This role can manage exceptions, restructures, and has authority over most status transitions in the pipeline.</p>
                    </div>
                    <table class="field-table">
                        <thead>
                            <tr>
                                <th>From Status</th>
                                <th>To Status</th>
                                <th>Stage</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr><td>Prospect</td><td>Credit Only</td><td><span class="badge role-badge">Processing</span></td></tr>
                            <tr><td>Prospect</td><td>Declined</td><td><span class="badge warning-badge">Exit</span></td></tr>
                            <tr><td>Prospect</td><td>Withdrawn</td><td><span class="badge warning-badge">Exit</span></td></tr>
                            <tr><td>Credit Only</td><td>File Received</td><td><span class="badge status-badge">Progress</span></td></tr>
                            <tr><td>Pre Approved</td><td>Approved Not Accepted</td><td><span class="badge warning-badge">Exit</span></td></tr>
                            <tr><td>Pre Approved</td><td>Conditions for Review</td><td><span class="badge status-badge">Progress</span></td></tr>
                            <tr><td>LE Pending</td><td>Declined</td><td><span class="badge warning-badge">Exit</span></td></tr>
                            <tr><td>LE Pending</td><td>Disclosed</td><td><span class="badge status-badge">Progress</span></td></tr>
                            <tr><td>LE Pending</td><td>Withdrawn</td><td><span class="badge warning-badge">Exit</span></td></tr>
                            <tr><td>LE Pending</td><td>Approved Not Accepted</td><td><span class="badge warning-badge">Exit</span></td></tr>
                            <tr><td>Disclosed</td><td>Approved Not Accepted</td><td><span class="badge warning-badge">Exit</span></td></tr>
                            <tr><td>Disclosed</td><td>Declined</td><td><span class="badge warning-badge">Exit</span></td></tr>
                            <tr><td>Disclosed</td><td>File Received</td><td><span class="badge status-badge">Progress</span></td></tr>
                            <tr><td>Disclosed</td><td>Withdrawn</td><td><span class="badge warning-badge">Exit</span></td></tr>
                            <tr><td>File Received</td><td>Approved Not Accepted</td><td><span class="badge warning-badge">Exit</span></td></tr>
                            <tr><td>File Received</td><td>Canceled for Incompleteness</td><td><span class="badge warning-badge">Exit</span></td></tr>
                            <tr><td>File Received</td><td>Declined</td><td><span class="badge warning-badge">Exit</span></td></tr>
                            <tr><td>File Received</td><td>Disclosed</td><td><span class="badge role-badge">Return</span></td></tr>
                            <tr><td>File Received</td><td>UW Received</td><td><span class="badge status-badge">Submit UW</span></td></tr>
                            <tr><td>File Received</td><td>Withdrawn</td><td><span class="badge warning-badge">Exit</span></td></tr>
                            <tr><td>File Received</td><td>Conditions for Review</td><td><span class="badge status-badge">Progress</span></td></tr>
                            <tr><td>UW Received</td><td>File Received</td><td><span class="badge role-badge">Return</span></td></tr>
                            <tr><td>Approved</td><td>Approved Not Accepted</td><td><span class="badge warning-badge">Exit</span></td></tr>
                            <tr><td>Approved</td><td>Changes to UW</td><td><span class="badge role-badge">UW Review</span></td></tr>
                            <tr><td>Approved</td><td>Conditions for Review</td><td><span class="badge status-badge">Progress</span></td></tr>
                            <tr><td>Approved</td><td>Loan Re-Structure</td><td><span class="badge role-badge">Restructure</span></td></tr>
                            <tr><td>Conditions for Review</td><td>Loan Re-Structure</td><td><span class="badge role-badge">Restructure</span></td></tr>
                            <tr><td>Loan Re-Structure</td><td>UW Received</td><td><span class="badge status-badge">Submit UW</span></td></tr>
                            <tr><td>Loan Re-Structure</td><td>Conditions for Review</td><td><span class="badge status-badge">Progress</span></td></tr>
                            <tr><td>Suspended</td><td>Conditions for Review</td><td><span class="badge status-badge">Progress</span></td></tr>
                            <tr><td>Suspended</td><td>Loan Re-Structure</td><td><span class="badge role-badge">Restructure</span></td></tr>
                            <tr><td>Clear to Close</td><td>Approved</td><td><span class="badge role-badge">Return</span></td></tr>
                            <tr><td>Clear to Close</td><td>Approved Not Accepted</td><td><span class="badge warning-badge">Exit</span></td></tr>
                            <tr><td>Clear to Close</td><td>Changes to UW</td><td><span class="badge role-badge">UW Review</span></td></tr>
                            <tr><td>Clear to Close</td><td>Conditions for Review</td><td><span class="badge status-badge">Progress</span></td></tr>
                            <tr><td>Docs Ordered</td><td>Approved Not Accepted</td><td><span class="badge warning-badge">Exit</span></td></tr>
                            <tr><td>Docs Ordered</td><td>Changes to UW</td><td><span class="badge role-badge">UW Review</span></td></tr>
                            <tr><td>Docs Ordered</td><td>Clear To Close</td><td><span class="badge role-badge">Return</span></td></tr>
                            <tr><td>Docs Out</td><td>Approved Not Accepted</td><td><span class="badge warning-badge">Exit</span></td></tr>
                            <tr><td>Docs Out</td><td>Docs Ordered</td><td><span class="badge role-badge">Return</span></td></tr>
                            <tr><td>Docs Back</td><td>Approved Not Accepted</td><td><span class="badge warning-badge">Exit</span></td></tr>
                            <tr><td>Docs Back</td><td>Docs Ordered</td><td><span class="badge role-badge">Return</span></td></tr>
                            <tr><td>Docs Back</td><td>Docs Out</td><td><span class="badge role-badge">Return</span></td></tr>
                        </tbody>
                    </table>
                </div>
            </section>

            <!-- Section 8: Closer -->
            <section id="section-8" class="section">
                <div class="section-header">
                    <div class="section-number">8</div>
                    <div class="section-title"><h2>Closer</h2><span>Closing specialist with document stage management</span></div>
                </div>
                <div class="section-content">
                    <div class="info-box">
                        <h4>Role Overview</h4>
                        <p>Closers manage the final stages of the loan process, with permissions focused on document ordering, document out/back stages, and funding preparation. This role handles the critical closing timeline management.</p>
                    </div>
                    <table class="field-table">
                        <thead>
                            <tr>
                                <th>From Status</th>
                                <th>To Status</th>
                                <th>Stage</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr><td>Clear to Close</td><td>Docs Ordered</td><td><span class="badge status-badge">Closing</span></td></tr>
                            <tr><td>Docs Ordered</td><td>Docs Out</td><td><span class="badge status-badge">Progress</span></td></tr>
                            <tr><td>Docs Ordered</td><td>Changes to UW</td><td><span class="badge role-badge">UW Review</span></td></tr>
                            <tr><td>Docs Out</td><td>Docs Out</td><td><span class="badge role-badge">Refresh</span></td></tr>
                            <tr><td>Docs Out</td><td>Funds Ordered</td><td><span class="badge status-badge">Funding</span></td></tr>
                            <tr><td>Docs Out</td><td>Changes to UW</td><td><span class="badge role-badge">UW Review</span></td></tr>
                            <tr><td>Docs Back</td><td>Funds Ordered</td><td><span class="badge status-badge">Funding</span></td></tr>
                            <tr><td>Funds Ordered</td><td>Docs Out</td><td><span class="badge role-badge">Return</span></td></tr>
                        </tbody>
                    </table>
                </div>
            </section>

            <!-- Section 9: Funder -->
            <section id="section-9" class="section">
                <div class="section-header">
                    <div class="section-number">9</div>
                    <div class="section-title"><h2>Funder</h2><span>Funding specialist with final disbursement authority</span></div>
                </div>
                <div class="section-content">
                    <div class="info-box">
                        <h4>Role Overview</h4>
                        <p>Funders control the final funding stages of the loan, with permissions to manage funds ordering, funds sent, funded status, and the final purchased status. This role completes the loan lifecycle.</p>
                    </div>
                    <table class="field-table">
                        <thead>
                            <tr>
                                <th>From Status</th>
                                <th>To Status</th>
                                <th>Stage</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr><td>Docs Out</td><td>Docs Back</td><td><span class="badge status-badge">Progress</span></td></tr>
                            <tr><td>Docs Out</td><td>Funds Ordered</td><td><span class="badge status-badge">Funding</span></td></tr>
                            <tr><td>Docs Back</td><td>Funds Ordered</td><td><span class="badge status-badge">Funding</span></td></tr>
                            <tr><td>Funds Ordered</td><td>Docs Back</td><td><span class="badge role-badge">Return</span></td></tr>
                            <tr><td>Funds Ordered</td><td>Docs Out</td><td><span class="badge role-badge">Return</span></td></tr>
                            <tr><td>Funds Sent</td><td>Funded</td><td><span class="badge status-badge">Complete</span></td></tr>
                            <tr><td>Funded</td><td>Purchased</td><td><span class="badge status-badge">Final</span></td></tr>
                        </tbody>
                    </table>
                </div>
            </section>

            <!-- Quick Reference -->
            <div id="quick-ref" class="quick-ref">
                <h3>Status Change Permissions Quick Reference</h3>
                <pre>
JV STATUS CHANGE PERMISSIONS MATRIX
====================================

ROLE                    | KEY PERMISSIONS                           | SCOPE
------------------------|-------------------------------------------|------------------
JV Loan Officer         | Prospect mgmt, Early exits, Restructures  | Production
JV Manager              | Disclosures, File receipt, Withdrawals    | Management
JV Production Assistant | Advance Lock, Full lifecycle, CTC changes | Production Support
JV Loan Processor       | UW submission, Conditions, Doc ordering   | Processing
JV Ops Manager          | Full pipeline, Suspensions, All docs      | Operations
Underwriter             | Approvals, CTC, Suspends, Declines, CORR  | Credit Decision
Team Lead               | Full pipeline, Exceptions, Restructures   | Supervisory
Closer                  | Doc ordering, Docs out/back, Funds order  | Closing
Funder                  | Funds ordered/sent, Funded, Purchased     | Funding

COMMON STATUS TRANSITIONS
=========================
Not Assigned -> Prospect        (LO, Manager, Prod Asst)
Prospect -> Credit Only         (LO, Prod Asst, Processor, Team Lead)
File Received -> UW Received    (Processor, Ops Mgr, Team Lead)
UW Received -> Approved         (Ops Mgr, Underwriter)
Approved -> Clear to Close      (Underwriter)
Clear to Close -> Docs Ordered  (Processor, Ops Mgr, Closer)
Docs Out -> Funds Ordered       (Closer, Funder)
Funded -> Purchased             (Funder)

EXIT STATUS PERMISSIONS
=======================
Withdrawn           - Most roles
Declined            - LO, Prod Asst, Processor, Ops Mgr, UW, Team Lead
Approved Not Accept - Most roles (after approval stage)
Canceled for Incomp - Processor, Ops Mgr, UW, Team Lead

SPECIAL PERMISSIONS
===================
Advance Lock        - JV Production Assistant only
CORR Audit statuses - Underwriter only
Suspended -> status - UW, Processor, Ops Mgr, Team Lead
Loan Re-Structure   - LO, Prod Asst, Processor, Ops Mgr, Team Lead
                </pre>
            </div>
        </div>

        <!-- ==================== AI AGENTS TAB ==================== -->
        <div id="agents-panel" class="tab-panel">
            <!-- Agent Header -->
            <div class="agent-header">
                <h1>AI Agent Opportunities</h1>
                <p class="subtitle">Automation opportunities identified for Status Change Permission management</p>
            </div>

            <!-- Summary Stats -->
            <div class="agent-summary" id="agent-summary">
                <div class="agent-summary-card">
                    <div class="agent-summary-value">3</div>
                    <div class="agent-summary-label">Agent Opportunities</div>
                </div>
                <div class="agent-summary-card">
                    <div class="agent-summary-value">65%</div>
                    <div class="agent-summary-label">Automation Potential</div>
                </div>
                <div class="agent-summary-card">
                    <div class="agent-summary-value">15 min</div>
                    <div class="agent-summary-label">Est. Time Saved/Day</div>
                </div>
                <div class="agent-summary-card">
                    <div class="agent-summary-value">High</div>
                    <div class="agent-summary-label">Compliance Impact</div>
                </div>
            </div>

            <!-- Heat Map Legend -->
            <div class="heat-legend">
                <div class="heat-legend-item">
                    <div class="heat-legend-color" style="background: linear-gradient(90deg, #ef4444, #f97316);"></div>
                    <span>Critical Priority (9-10)</span>
                </div>
                <div class="heat-legend-item">
                    <div class="heat-legend-color" style="background: linear-gradient(90deg, #f97316, #eab308);"></div>
                    <span>High Priority (7-8)</span>
                </div>
                <div class="heat-legend-item">
                    <div class="heat-legend-color" style="background: linear-gradient(90deg, #eab308, #22c55e);"></div>
                    <span>Medium Priority (5-6)</span>
                </div>
                <div class="heat-legend-item">
                    <div class="heat-legend-color" style="background: linear-gradient(90deg, #22c55e, #14b8a6);"></div>
                    <span>Low Priority (1-4)</span>
                </div>
            </div>

            <!-- Heat Map Grid -->
            <div class="heat-map-container" id="agent-heatmap">
                <div class="heat-map-title">Priority Heat Map</div>
                <div class="heat-map-grid">
                    <div class="heat-item high" onclick="scrollToAgent('agent-validator')">
                        <div class="heat-score">8.5</div>
                        <div class="heat-name">Permission Validator</div>
                        <div class="heat-desc">Real-time validation of status change permissions</div>
                        <div class="heat-metrics">
                            <div class="heat-metric">Time: <span>5 min</span></div>
                            <div class="heat-metric">Complexity: <span>Medium</span></div>
                        </div>
                    </div>
                    <div class="heat-item high" onclick="scrollToAgent('agent-auditor')">
                        <div class="heat-score">7.8</div>
                        <div class="heat-name">Audit Trail Agent</div>
                        <div class="heat-desc">Track and report unauthorized status change attempts</div>
                        <div class="heat-metrics">
                            <div class="heat-metric">Time: <span>8 min</span></div>
                            <div class="heat-metric">Complexity: <span>Low</span></div>
                        </div>
                    </div>
                    <div class="heat-item medium" onclick="scrollToAgent('agent-workflow')">
                        <div class="heat-score">6.2</div>
                        <div class="heat-name">Workflow Optimizer</div>
                        <div class="heat-desc">Suggest optimal status progression paths</div>
                        <div class="heat-metrics">
                            <div class="heat-metric">Time: <span>2 min</span></div>
                            <div class="heat-metric">Complexity: <span>Medium</span></div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Agent Details -->
            <div id="agent-details">
                <h2 style="color: var(--text-primary); margin-bottom: 25px; font-size: 1.5rem;">Agent Details</h2>
                <div class="agent-grid">
                    <!-- Permission Validator Agent -->
                    <div class="agent-card" id="agent-validator">
                        <div class="agent-card-header">
                            <div class="agent-icon">V</div>
                            <div class="agent-info">
                                <div class="agent-name">Permission Validator</div>
                                <div class="agent-type">Access Control / Validation</div>
                            </div>
                            <span class="agent-priority high">High</span>
                        </div>
                        <div class="agent-card-body">
                            <p class="agent-description">Real-time validation agent that checks user role permissions before allowing status changes. Prevents unauthorized transitions, provides instant feedback, and suggests alternative actions when permissions are denied.</p>
                            <div class="agent-flow">
                                <div class="agent-flow-title">Agent Flow</div>
                                <div class="agent-flow-diagram">
                                    <span class="agent-step">Status Request</span>
                                    <span class="agent-arrow">-></span>
                                    <span class="agent-step">Check Role</span>
                                    <span class="agent-arrow">-></span>
                                    <span class="agent-step">Validate</span>
                                    <span class="agent-arrow">-></span>
                                    <span class="agent-step">Allow/Deny</span>
                                </div>
                            </div>
                            <div class="agent-stats">
                                <div class="agent-stat">
                                    <div class="agent-stat-value">5 min</div>
                                    <div class="agent-stat-label">Time Saved</div>
                                </div>
                                <div class="agent-stat">
                                    <div class="agent-stat-value">99%</div>
                                    <div class="agent-stat-label">Accuracy</div>
                                </div>
                                <div class="agent-stat">
                                    <div class="agent-stat-value">Med</div>
                                    <div class="agent-stat-label">Complexity</div>
                                </div>
                            </div>
                            <button class="agent-prompt-btn" onclick="showAgentPrompt('validator')">
                                View Build Prompt
                            </button>
                        </div>
                    </div>

                    <!-- Audit Trail Agent -->
                    <div class="agent-card" id="agent-auditor">
                        <div class="agent-card-header">
                            <div class="agent-icon">A</div>
                            <div class="agent-info">
                                <div class="agent-name">Audit Trail Agent</div>
                                <div class="agent-type">Compliance / Monitoring</div>
                            </div>
                            <span class="agent-priority high">High</span>
                        </div>
                        <div class="agent-card-body">
                            <p class="agent-description">Comprehensive audit logging agent that tracks all status change attempts, captures user context, and generates compliance reports. Alerts supervisors to patterns of unauthorized access attempts.</p>
                            <div class="agent-flow">
                                <div class="agent-flow-title">Agent Flow</div>
                                <div class="agent-flow-diagram">
                                    <span class="agent-step">Log Event</span>
                                    <span class="agent-arrow">-></span>
                                    <span class="agent-step">Analyze Pattern</span>
                                    <span class="agent-arrow">-></span>
                                    <span class="agent-step">Flag Issues</span>
                                    <span class="agent-arrow">-></span>
                                    <span class="agent-step">Report</span>
                                </div>
                            </div>
                            <div class="agent-stats">
                                <div class="agent-stat">
                                    <div class="agent-stat-value">8 min</div>
                                    <div class="agent-stat-label">Time Saved</div>
                                </div>
                                <div class="agent-stat">
                                    <div class="agent-stat-value">100%</div>
                                    <div class="agent-stat-label">Accuracy</div>
                                </div>
                                <div class="agent-stat">
                                    <div class="agent-stat-value">Low</div>
                                    <div class="agent-stat-label">Complexity</div>
                                </div>
                            </div>
                            <button class="agent-prompt-btn" onclick="showAgentPrompt('auditor')">
                                View Build Prompt
                            </button>
                        </div>
                    </div>

                    <!-- Workflow Optimizer Agent -->
                    <div class="agent-card" id="agent-workflow">
                        <div class="agent-card-header">
                            <div class="agent-icon">W</div>
                            <div class="agent-info">
                                <div class="agent-name">Workflow Optimizer</div>
                                <div class="agent-type">Process Optimization</div>
                            </div>
                            <span class="agent-priority medium">Medium</span>
                        </div>
                        <div class="agent-card-body">
                            <p class="agent-description">Intelligent workflow assistant that analyzes current loan status and user role to suggest the most efficient next status transitions. Identifies bottlenecks and recommends role escalations when needed.</p>
                            <div class="agent-flow">
                                <div class="agent-flow-title">Agent Flow</div>
                                <div class="agent-flow-diagram">
                                    <span class="agent-step">Analyze Status</span>
                                    <span class="agent-arrow">-></span>
                                    <span class="agent-step">Check Options</span>
                                    <span class="agent-arrow">-></span>
                                    <span class="agent-step">Recommend</span>
                                    <span class="agent-arrow">-></span>
                                    <span class="agent-step">Guide User</span>
                                </div>
                            </div>
                            <div class="agent-stats">
                                <div class="agent-stat">
                                    <div class="agent-stat-value">2 min</div>
                                    <div class="agent-stat-label">Time Saved</div>
                                </div>
                                <div class="agent-stat">
                                    <div class="agent-stat-value">92%</div>
                                    <div class="agent-stat-label">Accuracy</div>
                                </div>
                                <div class="agent-stat">
                                    <div class="agent-stat-value">Med</div>
                                    <div class="agent-stat-label">Complexity</div>
                                </div>
                            </div>
                            <button class="agent-prompt-btn" onclick="showAgentPrompt('workflow')">
                                View Build Prompt
                            </button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </main>

    <!-- Documentation Modal -->
    <div class="modal-overlay" id="docModal">
        <div class="modal">
            <div class="modal-header">
                <h3>Status Change Permissions Matrix</h3>
                <div class="modal-actions">
                    <button class="modal-btn copy" onclick="copyToClipboard()">Copy</button>
                    <button class="modal-btn close" onclick="closeDocModal()">Close</button>
                </div>
            </div>
            <div class="modal-body">
                <pre id="docContent"># Status Change Permissions - Joint Venture

## Overview
This document defines the loan status change permissions for each role within the Joint Venture (JV) channel of the Loan Origination System.

## Roles Covered
1. JV Loan Officer
2. JV Manager
3. JV Production Assistant
4. JV Loan Processor
5. JV Ops Manager
6. Underwriter
7. Team Lead
8. Closer
9. Funder

## Key Permission Categories

### Production Roles (LO, Manager, Prod Asst)
- Initial loan setup (Not Assigned -> Prospect)
- Early-stage withdrawals and declines
- Disclosure management
- Loan restructure requests

### Processing Roles (Processor, Ops Manager)
- File submission to underwriting
- Condition management
- Document ordering
- Suspension handling

### Credit Decision (Underwriter)
- All approval decisions
- Clear to Close authority
- Suspension and decline decisions
- CORR audit processes

### Closing/Funding (Closer, Funder)
- Document stage management
- Funds ordering and disbursement
- Final funded and purchased status

## Compliance Notes
- All status changes are logged for audit purposes
- Unauthorized attempts are flagged and reported
- Role permissions are enforced at the system level</pre>
            </div>
        </div>
    </div>

    <!-- AI Prompt Modal -->
    <div class="modal-overlay prompt-modal" id="promptModal">
        <div class="modal">
            <div class="modal-header">
                <h3 id="promptModalTitle">AI Agent Build Prompt</h3>
                <div class="modal-actions">
                    <button class="modal-btn copy" onclick="copyPromptToClipboard()">Copy Prompt</button>
                    <button class="modal-btn close" onclick="closePromptModal()">Close</button>
                </div>
            </div>
            <div class="modal-body">
                <div class="prompt-tags" id="promptTags"></div>
                <div class="prompt-section">
                    <h4>Agent Purpose</h4>
                    <div class="prompt-box" id="promptPurpose"></div>
                </div>
                <div class="prompt-section">
                    <h4>Full Build Prompt</h4>
                    <div class="prompt-box" id="promptContent"></div>
                </div>
                <div class="prompt-section">
                    <h4>Integration Points</h4>
                    <div class="prompt-box" id="promptIntegration"></div>
                </div>
            </div>
        </div>
    </div>

    <div class="copy-success" id="copySuccess">Copied to clipboard!</div>

    <script>
        // Tab switching
        function switchTab(tab) {
            document.querySelectorAll('.sidebar-tab').forEach(t => t.classList.remove('active'));
            document.querySelectorAll('.tab-panel').forEach(p => p.classList.remove('active'));

            if (tab === 'workflow') {
                document.querySelector('.sidebar-tab:not(.agent-tab)').classList.add('active');
                document.getElementById('workflow-panel').classList.add('active');
                document.getElementById('workflow-nav').style.display = 'block';
                document.getElementById('agents-nav').style.display = 'none';
            } else {
                document.querySelector('.sidebar-tab.agent-tab').classList.add('active');
                document.getElementById('agents-panel').classList.add('active');
                document.getElementById('workflow-nav').style.display = 'none';
                document.getElementById('agents-nav').style.display = 'block';
            }

            window.scrollTo(0, 0);
        }

        // Scroll spy with isScrolling flag and 1000ms timeout
        const sections = document.querySelectorAll('.section, .quick-ref');
        const navItems = document.querySelectorAll('#workflow-nav .nav-item');
        let isScrolling = false;
        let scrollTimeout;

        function updateActiveNav() {
            if (isScrolling) return;

            let current = '';
            sections.forEach(section => {
                const sectionTop = section.offsetTop - 100;
                if (window.scrollY >= sectionTop) current = section.getAttribute('id');
            });
            navItems.forEach(item => {
                item.classList.remove('active');
                if (item.getAttribute('href') === '#' + current) item.classList.add('active');
            });
        }

        // Handle nav click to temporarily disable scroll spy
        navItems.forEach(item => {
            item.addEventListener('click', function(e) {
                isScrolling = true;
                clearTimeout(scrollTimeout);

                // Remove active from all, add to clicked
                navItems.forEach(nav => nav.classList.remove('active'));
                this.classList.add('active');

                // Re-enable scroll spy after 1000ms
                scrollTimeout = setTimeout(() => {
                    isScrolling = false;
                }, 1000);
            });
        });

        window.addEventListener('scroll', updateActiveNav);

        // Modal
        function openDocModal() {
            document.getElementById('docModal').classList.add('show');
            document.body.style.overflow = 'hidden';
        }

        function closeDocModal() {
            document.getElementById('docModal').classList.remove('show');
            document.body.style.overflow = '';
        }

        async function copyToClipboard() {
            try {
                await navigator.clipboard.writeText(document.getElementById('docContent').textContent);
                const success = document.getElementById('copySuccess');
                success.style.display = 'block';
                setTimeout(() => { success.style.display = 'none'; }, 2000);
            } catch (e) { alert('Failed to copy.'); }
        }

        document.addEventListener('keydown', (e) => { if (e.key === 'Escape') { closeDocModal(); closePromptModal(); } });
        document.getElementById('docModal').addEventListener('click', (e) => { if (e.target.id === 'docModal') closeDocModal(); });

        document.addEventListener('DOMContentLoaded', () => { updateActiveNav(); });

        // Scroll to agent card and highlight
        function scrollToAgent(agentId) {
            const agentCard = document.getElementById(agentId);
            if (agentCard) {
                document.querySelectorAll('.agent-card.highlight').forEach(card => {
                    card.classList.remove('highlight');
                });

                agentCard.scrollIntoView({ behavior: 'smooth', block: 'center' });

                setTimeout(() => {
                    agentCard.classList.add('highlight');
                }, 300);

                setTimeout(() => {
                    agentCard.classList.remove('highlight');
                }, 2500);
            }
        }

        // Agent Prompt System
        const agentPrompts = {
            validator: {
                name: 'Permission Validator Agent',
                tags: ['Access Control', 'Validation', 'Medium Complexity', 'High Priority'],
                purpose: `This agent provides real-time validation of status change permissions based on user role. It prevents unauthorized transitions, provides instant feedback to users, and suggests alternative actions when permissions are denied.`,
                prompt: `You are building an Access Control Agent for the LOS Status Change Permission system.

AGENT NAME: Permission Validator Agent
TYPE: Access Control / Real-time Validation

OBJECTIVE:
Create an agent that validates status change requests in real-time against the JV role permission matrix before allowing any loan status transition.

INPUT DATA:
- Current user role (JV Loan Officer, JV Manager, etc.)
- Current loan status
- Requested new status
- Loan ID

PERMISSION MATRIX:
Load the complete permission matrix from the Status Change Permissions document. Each role has a defined set of allowed From -> To transitions.

VALIDATION LOGIC:
1. Identify user's current role
2. Look up allowed transitions for that role
3. Check if requested transition exists in allowed list
4. Return validation result

RESPONSE FORMAT:
{
  "allowed": true/false,
  "user_role": "JV Loan Processor",
  "from_status": "File Received",
  "to_status": "UW Received",
  "message": "Transition allowed" / "Permission denied",
  "alternatives": ["status1", "status2"],
  "escalation_role": "Team Lead"
}

ERROR HANDLING:
- Invalid role: Return error with valid role list
- Invalid status: Return error with valid status list
- Permission denied: Suggest alternative transitions or escalation path`,
                integration: `INTEGRATION POINTS:
1. LOS Database
   - Query user role from session
   - Validate loan status exists
   - Log validation attempts

2. Permission Matrix
   - Store as JSON configuration
   - Cache for performance
   - Version control for updates

3. UI Integration
   - Pre-validate before showing status options
   - Disable non-permitted transitions
   - Show tooltips explaining restrictions

4. Audit Trail
   - Log all validation requests
   - Track denied attempts
   - Alert on suspicious patterns`
            },
            auditor: {
                name: 'Audit Trail Agent',
                tags: ['Compliance', 'Monitoring', 'Low Complexity', 'High Priority'],
                purpose: `This agent provides comprehensive audit logging for all status change attempts, successful or denied. It analyzes patterns, flags potential compliance issues, and generates reports for supervisors and compliance teams.`,
                prompt: `You are building a Compliance Monitoring Agent for the LOS Status Change system.

AGENT NAME: Audit Trail Agent
TYPE: Compliance / Monitoring

OBJECTIVE:
Create an agent that logs all status change events, analyzes patterns for compliance issues, and generates actionable reports.

LOGGING SCHEMA:
{
  "event_id": "uuid",
  "timestamp": "ISO8601",
  "user_id": "string",
  "user_role": "string",
  "loan_id": "string",
  "from_status": "string",
  "to_status": "string",
  "result": "allowed" | "denied",
  "reason": "string",
  "ip_address": "string",
  "session_id": "string"
}

PATTERN ANALYSIS:
1. Multiple denied attempts by same user
2. Unusual time-of-day activity
3. High volume of status changes
4. Attempts to bypass workflow
5. Role misalignment patterns

ALERT THRESHOLDS:
- 3+ denied attempts in 1 hour: WARNING
- 5+ denied attempts in 1 day: ESCALATE
- After-hours activity: FLAG
- Unusual role-status combinations: REVIEW

REPORT TYPES:
1. Daily summary by user
2. Weekly compliance report
3. Real-time alert dashboard
4. Monthly audit package`,
                integration: `INTEGRATION POINTS:
1. Event Streaming
   - Kafka/EventBridge for real-time logging
   - Batch processing for analytics
   - Long-term storage in data warehouse

2. Alert System
   - Email notifications
   - Slack/Teams webhooks
   - LOS dashboard alerts

3. Reporting
   - Scheduled report generation
   - On-demand queries
   - Export to PDF/Excel

4. Compliance Systems
   - Integration with GRC tools
   - SOX compliance tracking
   - Audit package generation`
            },
            workflow: {
                name: 'Workflow Optimizer Agent',
                tags: ['Process Optimization', 'AI Assistance', 'Medium Complexity', 'Medium Priority'],
                purpose: `This agent analyzes the current loan status and user role to suggest the most efficient next status transitions. It helps users understand their options, identifies bottlenecks, and recommends when to escalate to other roles.`,
                prompt: `You are building a Process Optimization Agent for the LOS Status Change system.

AGENT NAME: Workflow Optimizer Agent
TYPE: Process Optimization / AI Assistance

OBJECTIVE:
Create an intelligent assistant that guides users through optimal status progression paths based on their role and the loan's current state.

INPUT:
- Current loan status
- User role
- Loan type/program
- Days in current status
- Pending conditions

OPTIMIZATION LOGIC:
1. Identify all possible next statuses for user role
2. Rank by business priority:
   - Progress toward closing (highest)
   - Condition resolution
   - Restructure options
   - Exit paths (lowest)
3. Consider loan context (days pending, conditions)
4. Suggest optimal path

RESPONSE FORMAT:
{
  "current_status": "Approved",
  "user_role": "JV Loan Processor",
  "recommended_next": "Clear to Close",
  "can_perform": false,
  "escalation_needed": true,
  "escalation_role": "Underwriter",
  "available_actions": [
    {"status": "Conditions for Review", "priority": 2},
    {"status": "Changes to UW", "priority": 3},
    {"status": "Loan Re-Structure", "priority": 4}
  ],
  "bottleneck_alert": "Loan has been in Approved status for 5 days"
}

BOTTLENECK DETECTION:
- Days in status vs. average
- Pending conditions count
- Role availability
- Compliance deadlines`,
                integration: `INTEGRATION POINTS:
1. LOS Data
   - Loan status history
   - Condition tracking
   - Role assignments

2. Analytics
   - Average time per status
   - Bottleneck identification
   - Throughput metrics

3. UI Integration
   - Status change wizard
   - Next-best-action suggestions
   - Progress indicators

4. Notifications
   - Proactive status recommendations
   - Deadline warnings
   - Escalation suggestions`
            }
        };

        // Show agent prompt modal
        let currentPromptContent = '';

        function showAgentPrompt(agentKey) {
            const agent = agentPrompts[agentKey];
            if (!agent) return;

            document.getElementById('promptModalTitle').textContent = agent.name + ' - Build Prompt';

            const tagsHtml = agent.tags.map(tag => '<span class="prompt-tag">' + tag + '</span>').join('');
            document.getElementById('promptTags').innerHTML = tagsHtml;

            document.getElementById('promptPurpose').textContent = agent.purpose;
            document.getElementById('promptContent').textContent = agent.prompt;
            document.getElementById('promptIntegration').textContent = agent.integration;

            currentPromptContent = '# ' + agent.name + '\n\n## Purpose\n' + agent.purpose + '\n\n## Build Prompt\n' + agent.prompt + '\n\n## Integration Points\n' + agent.integration;

            document.getElementById('promptModal').classList.add('show');
            document.body.style.overflow = 'hidden';
        }

        function closePromptModal() {
            document.getElementById('promptModal').classList.remove('show');
            document.body.style.overflow = '';
        }

        async function copyPromptToClipboard() {
            try {
                await navigator.clipboard.writeText(currentPromptContent);
                const success = document.getElementById('copySuccess');
                success.style.display = 'block';
                setTimeout(() => { success.style.display = 'none'; }, 2000);
            } catch (e) {
                alert('Failed to copy prompt.');
            }
        }

        document.getElementById('promptModal').addEventListener('click', (e) => {
            if (e.target.id === 'promptModal') closePromptModal();
        });
    </script>
</body>
</html>
