<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>NY Subprime Fail - Disclosure Process Workflow</title>
    <link href="https://fonts.googleapis.com/css2?family=Plus+Jakarta+Sans:wght@400;500;600;700;800&family=JetBrains+Mono:wght@400;500&display=swap" rel="stylesheet">
    <style>
        :root {
            --bg-primary: #0a0f1a;
            --bg-secondary: #111827;
            --bg-card: #1a2234;
            --accent-blue: #3b82f6;
            --accent-teal: #14b8a6;
            --accent-amber: #f59e0b;
            --accent-rose: #f43f5e;
            --accent-green: #22c55e;
            --accent-purple: #8b5cf6;
            --text-primary: #f1f5f9;
            --text-secondary: #94a3b8;
            --text-muted: #64748b;
            --border-subtle: rgba(255,255,255,0.08);
            --sidebar-width: 280px;
        }

        * { box-sizing: border-box; margin: 0; padding: 0; }
        html { scroll-behavior: smooth; }
        body {
            font-family: 'Plus Jakarta Sans', -apple-system, BlinkMacSystemFont, sans-serif;
            background: var(--bg-primary);
            color: var(--text-primary);
            min-height: 100vh;
        }

        /* Breadcrumb */
        .breadcrumb {
            background: linear-gradient(90deg, #0d1525 0%, #1a2234 100%);
            padding: 14px 25px;
            display: flex;
            align-items: center;
            gap: 12px;
            font-size: 0.95rem;
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            z-index: 1001;
            border-bottom: 1px solid var(--border-subtle);
        }

        .breadcrumb a {
            color: var(--text-secondary);
            text-decoration: none;
            font-weight: 600;
            padding: 8px 16px;
            background: rgba(255,255,255,0.05);
            border-radius: 8px;
            transition: all 0.2s;
            border: 1px solid var(--border-subtle);
        }

        .breadcrumb a:hover {
            background: rgba(59, 130, 246, 0.15);
            color: var(--accent-blue);
            border-color: rgba(59, 130, 246, 0.3);
        }

        .breadcrumb .separator { color: var(--text-muted); font-size: 1.2rem; }
        .breadcrumb .current { color: var(--accent-amber); font-weight: 600; padding: 8px 16px; }

        /* Sidebar */
        .sidebar {
            position: fixed;
            top: 54px;
            left: 0;
            width: var(--sidebar-width);
            height: calc(100vh - 54px);
            background: var(--bg-secondary);
            overflow-y: auto;
            z-index: 1000;
            border-right: 1px solid var(--border-subtle);
            display: flex;
            flex-direction: column;
        }

        .sidebar-header {
            padding: 25px 20px;
            background: rgba(0,0,0,0.3);
            border-bottom: 1px solid var(--border-subtle);
        }

        .sidebar-header h2 { color: var(--text-primary); font-size: 1.2rem; font-weight: 700; margin-bottom: 5px; }
        .sidebar-header p { color: var(--text-muted); font-size: 0.85rem; }

        /* Tab Switch */
        .sidebar-tabs {
            display: flex;
            border-bottom: 1px solid var(--border-subtle);
        }

        .sidebar-tab {
            flex: 1;
            padding: 14px 10px;
            text-align: center;
            font-size: 0.8rem;
            font-weight: 700;
            color: var(--text-muted);
            cursor: pointer;
            transition: all 0.2s;
            border-bottom: 3px solid transparent;
            background: none;
            border-left: none;
            border-right: none;
            border-top: none;
        }

        .sidebar-tab:hover { background: rgba(255,255,255,0.03); color: var(--text-secondary); }
        .sidebar-tab.active { color: var(--accent-blue); border-bottom-color: var(--accent-blue); background: rgba(59, 130, 246, 0.08); }
        .sidebar-tab.agent-tab.active { color: var(--accent-purple); border-bottom-color: var(--accent-purple); background: rgba(139, 92, 246, 0.08); }

        .sidebar-nav { padding: 15px 0; flex: 1; overflow-y: auto; }

        .nav-item {
            display: flex;
            align-items: center;
            gap: 12px;
            padding: 14px 20px;
            color: var(--text-secondary);
            text-decoration: none;
            border-left: 3px solid transparent;
            transition: all 0.2s ease;
            cursor: pointer;
        }

        .nav-item:hover { background: rgba(255,255,255,0.03); color: var(--text-primary); }
        .nav-item.active { background: rgba(59, 130, 246, 0.1); border-left-color: var(--accent-blue); color: var(--text-primary); }

        .nav-number {
            background: rgba(255,255,255,0.1);
            color: var(--text-secondary);
            width: 28px;
            height: 28px;
            border-radius: 8px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 700;
            font-size: 0.85rem;
            flex-shrink: 0;
        }

        .nav-item.active .nav-number { background: var(--accent-blue); color: white; }
        .nav-label { font-size: 0.95rem; font-weight: 500; }

        .sidebar-footer {
            padding: 20px;
            border-top: 1px solid var(--border-subtle);
            background: rgba(0,0,0,0.2);
        }

        .doc-btn {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
            width: 100%;
            padding: 14px 20px;
            background: linear-gradient(135deg, var(--accent-blue) 0%, var(--accent-teal) 100%);
            color: white;
            border: none;
            border-radius: 10px;
            font-weight: 600;
            cursor: pointer;
            transition: transform 0.2s, box-shadow 0.2s;
            text-decoration: none;
            font-size: 0.95rem;
        }

        .doc-btn:hover { transform: translateY(-2px); box-shadow: 0 8px 25px rgba(59, 130, 246, 0.3); }

        /* Main Content */
        .main-content { margin-left: var(--sidebar-width); padding: 80px 40px 40px 40px; }

        /* Tab Panels */
        .tab-panel { display: none; }
        .tab-panel.active { display: block; }

        .header {
            background: var(--bg-card);
            border: 1px solid var(--border-subtle);
            padding: 35px;
            border-radius: 16px;
            margin-bottom: 30px;
            position: relative;
            overflow: hidden;
        }

        .header::before {
            content: '';
            position: absolute;
            top: 0; left: 0; right: 0; bottom: 0;
            background:
                radial-gradient(ellipse at 20% 20%, rgba(59, 130, 246, 0.1) 0%, transparent 50%),
                radial-gradient(ellipse at 80% 80%, rgba(20, 184, 166, 0.08) 0%, transparent 50%);
            pointer-events: none;
        }

        .header h1 {
            font-size: 2.2rem;
            font-weight: 800;
            margin-bottom: 10px;
            position: relative;
            background: linear-gradient(135deg, var(--text-primary) 0%, var(--accent-blue) 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .header .subtitle { color: var(--text-secondary); font-size: 1.1rem; position: relative; }

        .header .meta { display: flex; gap: 15px; margin-top: 20px; flex-wrap: wrap; position: relative; }

        .header .meta-item {
            background: rgba(255,255,255,0.05);
            border: 1px solid var(--border-subtle);
            padding: 8px 16px;
            border-radius: 8px;
            font-size: 0.9rem;
            color: var(--text-secondary);
        }

        /* Legend */
        .legend {
            display: flex;
            flex-wrap: wrap;
            gap: 15px;
            padding: 18px 22px;
            background: var(--bg-card);
            border: 1px solid var(--border-subtle);
            border-radius: 12px;
            margin-bottom: 25px;
        }

        .legend-item { display: flex; align-items: center; gap: 8px; font-size: 0.85rem; color: var(--text-secondary); }
        .legend-color { width: 18px; height: 18px; border-radius: 4px; }

        /* Sections */
        .section {
            background: var(--bg-card);
            border: 1px solid var(--border-subtle);
            border-radius: 16px;
            margin-bottom: 25px;
            overflow: hidden;
            scroll-margin-top: 75px;
        }

        .section-header {
            background: linear-gradient(135deg, var(--bg-secondary) 0%, rgba(59, 130, 246, 0.1) 100%);
            border-bottom: 1px solid var(--border-subtle);
            padding: 22px 25px;
            display: flex;
            align-items: center;
            gap: 18px;
        }

        .section-number {
            background: linear-gradient(135deg, var(--accent-blue) 0%, var(--accent-teal) 100%);
            color: white;
            width: 48px;
            height: 48px;
            border-radius: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 800;
            font-size: 1.3rem;
            flex-shrink: 0;
        }

        .section-title h2 { font-size: 1.35rem; font-weight: 700; margin-bottom: 4px; color: var(--text-primary); }
        .section-title span { font-size: 0.9rem; color: var(--text-muted); }
        .section-content { padding: 28px; }

        /* Workflow Diagrams */
        .workflow-diagram {
            background: rgba(0,0,0,0.3);
            border: 1px solid var(--border-subtle);
            border-radius: 12px;
            padding: 28px;
            margin-bottom: 22px;
        }

        .flow-row { display: flex; align-items: center; justify-content: center; flex-wrap: wrap; gap: 12px; margin: 15px 0; }

        .flow-node {
            padding: 14px 22px;
            border-radius: 10px;
            text-align: center;
            font-size: 0.9rem;
            font-weight: 600;
            min-width: 150px;
            border: 1px solid var(--border-subtle);
        }

        .flow-node.start { background: linear-gradient(135deg, var(--accent-green) 0%, #16a34a 100%); color: white; border-radius: 25px; border: none; }
        .flow-node.action { background: linear-gradient(135deg, var(--accent-blue) 0%, #2563eb 100%); color: white; border: none; }
        .flow-node.decision { background: linear-gradient(135deg, var(--accent-amber) 0%, #d97706 100%); color: var(--bg-primary); border: none; }
        .flow-node.input { background: var(--bg-secondary); border: 2px solid var(--accent-blue); color: var(--text-primary); }
        .flow-node.output { background: linear-gradient(135deg, var(--accent-teal) 0%, #0d9488 100%); color: white; border: none; }
        .flow-node.exception { background: linear-gradient(135deg, var(--accent-rose) 0%, #dc2626 100%); color: white; border: none; }

        .flow-arrow { color: var(--accent-blue); font-size: 1.5rem; }
        .flow-arrow.down { transform: rotate(90deg); }

        .decision-branch { display: flex; gap: 40px; justify-content: center; margin: 20px 0; flex-wrap: wrap; }
        .branch { display: flex; flex-direction: column; align-items: center; gap: 10px; }

        .branch-label {
            background: var(--bg-secondary);
            border: 1px solid var(--border-subtle);
            padding: 6px 16px;
            border-radius: 20px;
            font-size: 0.8rem;
            font-weight: 700;
            color: var(--text-secondary);
        }

        /* Tables */
        .field-table { width: 100%; border-collapse: collapse; margin: 18px 0; }

        .field-table th {
            background: rgba(59, 130, 246, 0.15);
            color: var(--accent-blue);
            padding: 14px 18px;
            text-align: left;
            font-weight: 600;
            font-size: 0.9rem;
            text-transform: uppercase;
            letter-spacing: 0.05em;
            border-bottom: 1px solid var(--border-subtle);
        }

        .field-table td { padding: 14px 18px; border-bottom: 1px solid var(--border-subtle); color: var(--text-secondary); }
        .field-table tr:hover { background: rgba(255,255,255,0.02); }

        .badge { display: inline-block; padding: 4px 12px; border-radius: 6px; font-size: 0.75rem; font-weight: 700; text-transform: uppercase; letter-spacing: 0.05em; }
        .badge.required-badge { background: rgba(244, 63, 94, 0.15); color: var(--accent-rose); }
        .badge.optional-badge { background: rgba(34, 197, 94, 0.15); color: var(--accent-green); }
        .badge.calculated-badge { background: rgba(59, 130, 246, 0.15); color: var(--accent-blue); }
        .badge.warning-badge { background: rgba(245, 158, 11, 0.15); color: var(--accent-amber); }

        /* Info Boxes */
        .exception-box, .tip-box, .info-box, .warning-box {
            padding: 18px 22px;
            margin: 18px 0;
            border-radius: 0 10px 10px 0;
            border-left-width: 4px;
            border-left-style: solid;
        }

        .exception-box { background: rgba(244, 63, 94, 0.08); border-color: var(--accent-rose); border: 1px solid rgba(244, 63, 94, 0.2); border-left: 4px solid var(--accent-rose); }
        .exception-box h4 { color: var(--accent-rose); margin-bottom: 10px; font-size: 1rem; }
        .exception-box p, .exception-box li { color: var(--text-secondary); }

        .tip-box { background: rgba(34, 197, 94, 0.08); border-color: var(--accent-green); border: 1px solid rgba(34, 197, 94, 0.2); border-left: 4px solid var(--accent-green); }
        .tip-box h4 { color: var(--accent-green); margin-bottom: 10px; font-size: 1rem; }
        .tip-box p, .tip-box li { color: var(--text-secondary); }

        .info-box { background: rgba(59, 130, 246, 0.08); border-color: var(--accent-blue); border: 1px solid rgba(59, 130, 246, 0.2); border-left: 4px solid var(--accent-blue); }
        .info-box h4 { color: var(--accent-blue); margin-bottom: 10px; font-size: 1rem; }
        .info-box p, .info-box li { color: var(--text-secondary); }

        .warning-box { background: rgba(245, 158, 11, 0.08); border-color: var(--accent-amber); border: 1px solid rgba(245, 158, 11, 0.2); border-left: 4px solid var(--accent-amber); }
        .warning-box h4 { color: var(--accent-amber); margin-bottom: 10px; font-size: 1rem; }
        .warning-box p, .warning-box li { color: var(--text-secondary); }

        /* Decision Tree */
        .decision-tree {
            background: rgba(0,0,0,0.2);
            border: 1px solid var(--border-subtle);
            border-radius: 12px;
            padding: 22px;
            margin: 22px 0;
        }

        .decision-tree h3 { color: var(--accent-blue); margin-bottom: 18px; padding-bottom: 12px; border-bottom: 1px solid var(--border-subtle); font-size: 1.1rem; }

        .tree-node { margin-left: 20px; padding: 12px; border-left: 2px solid var(--accent-teal); position: relative; color: var(--text-secondary); }
        .tree-node::before { content: ''; position: absolute; left: -2px; top: 22px; width: 15px; height: 2px; background: var(--accent-teal); }
        .tree-node.level-1 { margin-left: 0; border-left: none; }
        .tree-node.level-1::before { display: none; }

        .tree-label { background: var(--accent-amber); color: var(--bg-primary); padding: 6px 14px; border-radius: 6px; font-weight: 700; display: inline-block; margin-bottom: 6px; font-size: 0.9rem; }

        /* Summary Grid */
        .summary-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(180px, 1fr)); gap: 18px; margin: 22px 0; }

        .summary-card { background: rgba(0,0,0,0.3); border: 1px solid var(--border-subtle); border-radius: 12px; padding: 22px; text-align: center; }
        .summary-card h4 { color: var(--text-secondary); margin-bottom: 12px; font-size: 0.9rem; }
        .summary-card .value {
            font-size: 2.2rem;
            font-weight: 800;
            background: linear-gradient(135deg, var(--accent-blue) 0%, var(--accent-teal) 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }
        .summary-card .label { font-size: 0.85rem; color: var(--text-muted); margin-top: 8px; }

        /* Package Cards */
        .package-comparison { display: grid; grid-template-columns: repeat(auto-fit, minmax(280px, 1fr)); gap: 20px; margin: 22px 0; }

        .package-card { background: rgba(0,0,0,0.2); border: 1px solid var(--border-subtle); border-radius: 12px; overflow: hidden; }
        .package-card-header { background: linear-gradient(135deg, var(--accent-blue) 0%, var(--accent-teal) 100%); color: white; padding: 18px; text-align: center; }
        .package-card-header h4 { font-size: 1.05rem; }
        .package-card-body { padding: 22px; }
        .package-card ul { list-style: none; padding: 0; }
        .package-card li { padding: 10px 0; border-bottom: 1px solid var(--border-subtle); display: flex; align-items: center; gap: 12px; color: var(--text-secondary); font-size: 0.95rem; }
        .package-card li:last-child { border-bottom: none; }
        .check-icon { color: var(--accent-green); font-weight: bold; }
        .x-icon { color: var(--accent-rose); font-weight: bold; }

        /* Quick Reference */
        .quick-ref {
            background: linear-gradient(135deg, var(--bg-secondary) 0%, var(--bg-card) 100%);
            border: 1px solid var(--border-subtle);
            padding: 28px;
            border-radius: 16px;
            margin-top: 30px;
            font-family: 'JetBrains Mono', monospace;
            scroll-margin-top: 75px;
        }

        .quick-ref h3 { color: var(--accent-amber); margin-bottom: 18px; font-family: 'Plus Jakarta Sans', sans-serif; }
        .quick-ref pre { background: rgba(0,0,0,0.4); border: 1px solid var(--border-subtle); padding: 20px; border-radius: 10px; overflow-x: auto; font-size: 0.85rem; line-height: 1.7; color: var(--text-secondary); }

        /* ====== AGENT OPPORTUNITIES STYLES ====== */
        .agent-header {
            background: var(--bg-card);
            border: 1px solid var(--border-subtle);
            padding: 35px;
            border-radius: 16px;
            margin-bottom: 30px;
            position: relative;
            overflow: hidden;
        }

        .agent-header::before {
            content: '';
            position: absolute;
            top: 0; left: 0; right: 0; bottom: 0;
            background:
                radial-gradient(ellipse at 20% 20%, rgba(139, 92, 246, 0.12) 0%, transparent 50%),
                radial-gradient(ellipse at 80% 80%, rgba(245, 158, 11, 0.1) 0%, transparent 50%);
            pointer-events: none;
        }

        .agent-header h1 {
            font-size: 2.2rem;
            font-weight: 800;
            margin-bottom: 10px;
            position: relative;
            background: linear-gradient(135deg, var(--accent-purple) 0%, var(--accent-amber) 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .agent-header .subtitle { color: var(--text-secondary); font-size: 1.1rem; position: relative; }

        /* Heat Map */
        .heat-map-container { margin-bottom: 35px; }
        .heat-map-title { font-size: 1.3rem; font-weight: 700; color: var(--text-primary); margin-bottom: 20px; display: flex; align-items: center; gap: 12px; }

        .heat-map-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
        }

        .heat-item {
            background: var(--bg-card);
            border: 1px solid var(--border-subtle);
            border-radius: 12px;
            padding: 20px;
            position: relative;
            overflow: hidden;
            transition: transform 0.2s, box-shadow 0.2s;
            cursor: pointer;
        }

        .heat-item:hover { transform: translateY(-3px); box-shadow: 0 10px 30px rgba(0,0,0,0.3); }
        .heat-item:active { transform: scale(0.98); }

        .heat-item::before {
            content: '';
            position: absolute;
            top: 0; left: 0; right: 0; height: 4px;
        }

        .heat-item.critical::before { background: linear-gradient(90deg, #ef4444, #f97316); }
        .heat-item.high::before { background: linear-gradient(90deg, #f97316, #eab308); }
        .heat-item.medium::before { background: linear-gradient(90deg, #eab308, #22c55e); }
        .heat-item.low::before { background: linear-gradient(90deg, #22c55e, #14b8a6); }

        .heat-score {
            position: absolute;
            top: 15px;
            right: 15px;
            font-size: 1.8rem;
            font-weight: 800;
        }

        .heat-item.critical .heat-score { color: #ef4444; }
        .heat-item.high .heat-score { color: #f97316; }
        .heat-item.medium .heat-score { color: #eab308; }
        .heat-item.low .heat-score { color: #22c55e; }

        .heat-name { font-size: 1rem; font-weight: 700; color: var(--text-primary); margin-bottom: 6px; padding-right: 50px; }
        .heat-desc { font-size: 0.85rem; color: var(--text-muted); margin-bottom: 12px; }

        .heat-metrics { display: flex; gap: 15px; margin-top: 12px; }
        .heat-metric { font-size: 0.75rem; color: var(--text-muted); }
        .heat-metric span { color: var(--text-secondary); font-weight: 600; }

        /* Agent Cards */
        .agent-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(380px, 1fr)); gap: 25px; margin-bottom: 35px; }

        .agent-card {
            background: var(--bg-card);
            border: 1px solid var(--border-subtle);
            border-radius: 16px;
            overflow: hidden;
            transition: transform 0.2s, box-shadow 0.2s;
        }

        .agent-card:hover { transform: translateY(-5px); box-shadow: 0 15px 50px rgba(0,0,0,0.3); }

        .agent-card.highlight {
            animation: highlightPulse 2s ease;
            box-shadow: 0 0 0 3px var(--accent-purple), 0 15px 50px rgba(139, 92, 246, 0.4);
        }

        @keyframes highlightPulse {
            0% { box-shadow: 0 0 0 3px var(--accent-purple), 0 15px 50px rgba(139, 92, 246, 0.6); }
            50% { box-shadow: 0 0 0 6px rgba(139, 92, 246, 0.5), 0 15px 50px rgba(139, 92, 246, 0.3); }
            100% { box-shadow: 0 0 0 0px transparent, 0 15px 50px rgba(0,0,0,0.3); }
        }

        .agent-card-header {
            padding: 22px;
            display: flex;
            align-items: flex-start;
            gap: 18px;
            border-bottom: 1px solid var(--border-subtle);
        }

        .agent-icon {
            width: 55px;
            height: 55px;
            background: linear-gradient(135deg, var(--accent-purple) 0%, var(--accent-blue) 100%);
            border-radius: 14px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.6rem;
            flex-shrink: 0;
        }

        .agent-info { flex: 1; }
        .agent-name { font-size: 1.15rem; font-weight: 700; color: var(--text-primary); margin-bottom: 5px; }
        .agent-type { font-size: 0.8rem; color: var(--accent-purple); font-weight: 600; text-transform: uppercase; letter-spacing: 0.05em; }

        .agent-priority {
            padding: 6px 12px;
            border-radius: 20px;
            font-size: 0.75rem;
            font-weight: 700;
            text-transform: uppercase;
        }

        .agent-priority.critical { background: rgba(239, 68, 68, 0.15); color: #ef4444; }
        .agent-priority.high { background: rgba(249, 115, 22, 0.15); color: #f97316; }
        .agent-priority.medium { background: rgba(234, 179, 8, 0.15); color: #eab308; }
        .agent-priority.low { background: rgba(34, 197, 94, 0.15); color: #22c55e; }

        .agent-card-body { padding: 22px; }
        .agent-description { font-size: 0.95rem; color: var(--text-secondary); line-height: 1.6; margin-bottom: 20px; }

        .agent-flow {
            background: rgba(0,0,0,0.3);
            border: 1px solid var(--border-subtle);
            border-radius: 10px;
            padding: 18px;
            margin-bottom: 20px;
        }

        .agent-flow-title { font-size: 0.85rem; color: var(--text-muted); margin-bottom: 12px; font-weight: 600; text-transform: uppercase; letter-spacing: 0.05em; }

        .agent-flow-diagram { display: flex; align-items: center; flex-wrap: wrap; gap: 8px; justify-content: center; }

        .agent-step {
            background: linear-gradient(135deg, var(--accent-purple) 0%, var(--accent-blue) 100%);
            color: white;
            padding: 8px 14px;
            border-radius: 6px;
            font-size: 0.8rem;
            font-weight: 600;
            white-space: nowrap;
        }

        .agent-arrow { color: var(--accent-purple); font-size: 1.2rem; }

        .agent-stats { display: grid; grid-template-columns: repeat(3, 1fr); gap: 12px; }

        .agent-stat {
            background: rgba(0,0,0,0.2);
            border-radius: 8px;
            padding: 12px;
            text-align: center;
        }

        .agent-stat-value {
            font-size: 1.3rem;
            font-weight: 800;
            background: linear-gradient(135deg, var(--accent-purple) 0%, var(--accent-amber) 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .agent-stat-label { font-size: 0.7rem; color: var(--text-muted); text-transform: uppercase; letter-spacing: 0.05em; margin-top: 4px; }

        /* View Prompt Button */
        .agent-prompt-btn {
            width: 100%;
            margin-top: 18px;
            padding: 14px 20px;
            background: linear-gradient(135deg, rgba(139, 92, 246, 0.2) 0%, rgba(59, 130, 246, 0.2) 100%);
            border: 1px solid rgba(139, 92, 246, 0.4);
            border-radius: 10px;
            color: var(--accent-purple);
            font-weight: 700;
            cursor: pointer;
            transition: all 0.2s;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
            font-size: 0.9rem;
        }

        .agent-prompt-btn:hover {
            background: linear-gradient(135deg, rgba(139, 92, 246, 0.3) 0%, rgba(59, 130, 246, 0.3) 100%);
            border-color: var(--accent-purple);
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(139, 92, 246, 0.25);
        }

        /* Summary Stats */
        .agent-summary {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin-bottom: 35px;
        }

        .agent-summary-card {
            background: var(--bg-card);
            border: 1px solid var(--border-subtle);
            border-radius: 14px;
            padding: 25px;
            text-align: center;
        }

        .agent-summary-value {
            font-size: 2.5rem;
            font-weight: 800;
            background: linear-gradient(135deg, var(--accent-purple) 0%, var(--accent-amber) 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .agent-summary-label { font-size: 0.9rem; color: var(--text-muted); margin-top: 8px; }

        /* Heat Map Legend */
        .heat-legend {
            display: flex;
            gap: 25px;
            padding: 18px 22px;
            background: var(--bg-card);
            border: 1px solid var(--border-subtle);
            border-radius: 12px;
            margin-bottom: 25px;
            flex-wrap: wrap;
        }

        .heat-legend-item { display: flex; align-items: center; gap: 10px; font-size: 0.9rem; color: var(--text-secondary); }
        .heat-legend-color { width: 24px; height: 24px; border-radius: 6px; }

        /* Modal */
        .modal-overlay {
            display: none;
            position: fixed;
            top: 0; left: 0; right: 0; bottom: 0;
            background: rgba(10, 15, 26, 0.9);
            z-index: 2000;
            justify-content: center;
            align-items: center;
            padding: 20px;
            backdrop-filter: blur(5px);
        }

        .modal-overlay.show { display: flex; }

        .modal {
            background: var(--bg-card);
            border: 1px solid var(--border-subtle);
            border-radius: 16px;
            width: 100%;
            max-width: 950px;
            max-height: 90vh;
            display: flex;
            flex-direction: column;
            box-shadow: 0 25px 80px rgba(0,0,0,0.5);
        }

        .modal-header {
            background: linear-gradient(135deg, var(--accent-blue) 0%, var(--accent-teal) 100%);
            color: white;
            padding: 22px 28px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            border-radius: 16px 16px 0 0;
        }

        .modal-header h3 { font-size: 1.25rem; font-weight: 700; }
        .modal-actions { display: flex; gap: 12px; }

        .modal-btn {
            padding: 10px 18px;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-weight: 700;
            transition: transform 0.2s;
            font-size: 0.9rem;
        }

        .modal-btn:hover { transform: scale(1.05); }
        .modal-btn.copy { background: white; color: var(--accent-blue); }
        .modal-btn.close { background: rgba(255,255,255,0.2); color: white; }

        .modal-body { padding: 28px; overflow-y: auto; flex: 1; }

        .modal-body pre {
            background: rgba(0,0,0,0.3);
            border: 1px solid var(--border-subtle);
            padding: 22px;
            border-radius: 10px;
            font-family: 'JetBrains Mono', monospace;
            font-size: 0.9rem;
            line-height: 1.7;
            white-space: pre-wrap;
            word-wrap: break-word;
            color: var(--text-secondary);
        }

        .copy-success {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: var(--accent-green);
            color: white;
            padding: 18px 35px;
            border-radius: 10px;
            font-weight: 700;
            z-index: 3000;
            display: none;
            animation: fadeInOut 2s ease;
        }

        @keyframes fadeInOut { 0%, 100% { opacity: 0; } 10%, 90% { opacity: 1; } }

        /* Prompt Modal */
        .prompt-modal .modal { max-width: 800px; }
        .prompt-modal .modal-header { background: linear-gradient(135deg, var(--accent-purple) 0%, var(--accent-blue) 100%); }

        .prompt-section { margin-bottom: 25px; }
        .prompt-section h4 { color: var(--accent-purple); font-size: 1rem; margin-bottom: 12px; display: flex; align-items: center; gap: 8px; }

        .prompt-box {
            background: rgba(0,0,0,0.4);
            border: 1px solid var(--border-subtle);
            border-radius: 10px;
            padding: 20px;
            font-family: 'JetBrains Mono', monospace;
            font-size: 0.85rem;
            line-height: 1.7;
            color: var(--text-secondary);
            white-space: pre-wrap;
            word-wrap: break-word;
        }

        .prompt-tags { display: flex; gap: 10px; flex-wrap: wrap; margin-bottom: 20px; }
        .prompt-tag { background: rgba(139, 92, 246, 0.15); color: var(--accent-purple); padding: 6px 14px; border-radius: 20px; font-size: 0.8rem; font-weight: 600; }

        .copy-prompt-btn {
            background: linear-gradient(135deg, var(--accent-purple) 0%, var(--accent-blue) 100%);
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 8px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.2s;
            margin-top: 15px;
        }

        .copy-prompt-btn:hover { transform: scale(1.05); box-shadow: 0 5px 20px rgba(139, 92, 246, 0.3); }

        /* Step List */
        .step-list { list-style: none; padding: 0; margin: 18px 0; }
        .step-list li {
            padding: 14px 18px;
            border-left: 3px solid var(--accent-blue);
            background: rgba(0,0,0,0.2);
            margin-bottom: 10px;
            border-radius: 0 8px 8px 0;
            color: var(--text-secondary);
        }
        .step-list li strong { color: var(--text-primary); }

        /* System Indicators */
        .system-indicator {
            display: inline-flex;
            align-items: center;
            gap: 6px;
            padding: 4px 10px;
            border-radius: 6px;
            font-size: 0.75rem;
            font-weight: 700;
        }

        .system-indicator.byte { background: rgba(59, 130, 246, 0.15); color: var(--accent-blue); }
        .system-indicator.ce { background: rgba(139, 92, 246, 0.15); color: var(--accent-purple); }

        @media (max-width: 900px) {
            .sidebar { display: none; }
            .main-content { margin-left: 0; padding: 75px 20px 30px 20px; }
            .agent-grid { grid-template-columns: 1fr; }
        }
        .breadcrumb-logo-link { display: inline-flex; align-items: center; padding: 4px 8px; background: rgba(255,255,255,0.08); border-radius: 8px; border: 1px solid rgba(255,255,255,0.12); transition: all 0.2s; flex-shrink: 0; margin-right: 4px; }
        .breadcrumb-logo-link:hover { background: rgba(255,255,255,0.15); }
        .breadcrumb-logo { height: 24px; width: auto; display: block; }
    </style>
</head>
<body>
    <!-- Breadcrumb -->
    <nav class="breadcrumb">
<a href="../../index.html" class="breadcrumb-logo-link"><img src="../../images/clear-ai-logo.png" alt="Clear AI" class="breadcrumb-logo"></a>
        <a href="../../index.html">Portal Home</a>
        <span class="separator">></span>
        <a href="./index.html">Mortgage Fundamentals</a>
        <span class="separator">></span>
        <span class="current">NY Subprime Fail - Disclosure Process</span>
    </nav>

    <!-- Fixed Sidebar -->
    <aside class="sidebar">
        <div class="sidebar-header">
            <h2>NY Subprime Disclosure</h2>
            <p>Interactive Workflow Guide</p>
        </div>

        <!-- Tab Switcher -->
        <div class="sidebar-tabs">
            <button class="sidebar-tab active" onclick="switchTab('workflow')">Workflow</button>
            <button class="sidebar-tab agent-tab" onclick="switchTab('agents')">AI Agents</button>
        </div>

        <!-- Workflow Navigation -->
        <nav class="sidebar-nav" id="workflow-nav">
            <a href="#section-1" class="nav-item active">
                <span class="nav-number">1</span>
                <span class="nav-label">Overview</span>
            </a>
            <a href="#section-2" class="nav-item">
                <span class="nav-number">2</span>
                <span class="nav-label">At Initial Disclosure</span>
            </a>
            <a href="#section-3" class="nav-item">
                <span class="nav-number">3</span>
                <span class="nav-label">After Initial Disclosure</span>
            </a>
            <a href="#section-4" class="nav-item">
                <span class="nav-number">4</span>
                <span class="nav-label">Alt Doc Package</span>
            </a>
            <a href="#section-5" class="nav-item">
                <span class="nav-number">5</span>
                <span class="nav-label">Common Triggers</span>
            </a>
            <a href="#section-6" class="nav-item">
                <span class="nav-number">6</span>
                <span class="nav-label">Identifying in Byte</span>
            </a>
            <a href="#section-7" class="nav-item">
                <span class="nav-number">7</span>
                <span class="nav-label">ComplianceEase Fail</span>
            </a>
            <a href="#quick-ref" class="nav-item">
                <span class="nav-number">*</span>
                <span class="nav-label">Quick Reference</span>
            </a>
        </nav>

        <!-- Agent Navigation -->
        <nav class="sidebar-nav" id="agents-nav" style="display: none;">
            <a href="#agent-summary" class="nav-item active">
                <span class="nav-number">S</span>
                <span class="nav-label">Summary</span>
            </a>
            <a href="#agent-heatmap" class="nav-item">
                <span class="nav-number">H</span>
                <span class="nav-label">Heat Map</span>
            </a>
            <a href="#agent-details" class="nav-item">
                <span class="nav-number">A</span>
                <span class="nav-label">Agent Details</span>
            </a>
        </nav>

        <div class="sidebar-footer">
            <button class="doc-btn" onclick="openDocModal()">
                View Workflow Markdown
            </button>
        </div>
    </aside>

    <!-- Main Content -->
    <main class="main-content">

        <!-- ==================== WORKFLOW TAB ==================== -->
        <div id="workflow-panel" class="tab-panel active">
            <!-- Header -->
            <div class="header">
                <h1>NY Subprime Fail - Disclosure Process</h1>
                <p class="subtitle">Required disclosures, timelines, and system considerations for Disclosure Coordinators when a loan fails the New York Subprime test</p>
                <div class="meta">
                    <span class="meta-item">Systems: Byte LOS, ComplianceEase</span>
                    <span class="meta-item">Role: Disclosure Coordinator</span>
                    <span class="meta-item">Updated: January 8, 2026</span>
                    <span class="meta-item">Timeline: 3 Business Days</span>
                </div>
            </div>

            <!-- Legend -->
            <div class="legend">
                <div class="legend-item"><div class="legend-color" style="background: linear-gradient(135deg, #22c55e, #16a34a);"></div><span>Start/End</span></div>
                <div class="legend-item"><div class="legend-color" style="background: linear-gradient(135deg, #3b82f6, #2563eb);"></div><span>Action Step</span></div>
                <div class="legend-item"><div class="legend-color" style="background: linear-gradient(135deg, #f59e0b, #d97706);"></div><span>Decision Point</span></div>
                <div class="legend-item"><div class="legend-color" style="background: #111827; border: 2px solid #3b82f6;"></div><span>User Input</span></div>
                <div class="legend-item"><div class="legend-color" style="background: linear-gradient(135deg, #f43f5e, #dc2626);"></div><span>Exception</span></div>
                <div class="legend-item"><div class="legend-color" style="background: linear-gradient(135deg, #14b8a6, #0d9488);"></div><span>Output</span></div>
            </div>

            <!-- Section 1: Overview -->
            <section id="section-1" class="section">
                <div class="section-header">
                    <div class="section-number">1</div>
                    <div class="section-title"><h2>Process Overview</h2><span>Understanding the NY Subprime Test and disclosure requirements</span></div>
                </div>
                <div class="section-content">
                    <div class="info-box">
                        <h4>Purpose of This Job Aid</h4>
                        <p>This job aid outlines the required disclosures, timelines, and system considerations for Disclosure Coordinators when a loan fails the New York Subprime test at initial disclosure or due to a post-disclosure change.</p>
                    </div>

                    <div class="summary-grid">
                        <div class="summary-card">
                            <h4>Disclosure Deadline</h4>
                            <div class="value">3</div>
                            <div class="label">Business Days</div>
                        </div>
                        <div class="summary-card">
                            <h4>Systems Involved</h4>
                            <div class="value">2</div>
                            <div class="label">Byte + ComplianceEase</div>
                        </div>
                        <div class="summary-card">
                            <h4>Key Disclosure</h4>
                            <div class="value">HPML</div>
                            <div class="label">NY Subprime Counseling</div>
                        </div>
                        <div class="summary-card">
                            <h4>Regulation</h4>
                            <div class="value">NY</div>
                            <div class="label">State Regulation</div>
                        </div>
                    </div>

                    <div class="decision-tree">
                        <h3>Two Scenarios for NY Subprime Fail</h3>
                        <div class="tree-node level-1">
                            <span class="tree-label">Scenario 1</span>
                            <p><strong>NY Subprime Fail AT Initial Disclosure</strong> - Loan fails the test at the time of initial disclosure</p>
                        </div>
                        <div class="tree-node level-1">
                            <span class="tree-label">Scenario 2</span>
                            <p><strong>NY Subprime Fail AFTER Initial Disclosure</strong> - Loan did NOT initially fail but later fails due to changes</p>
                        </div>
                    </div>
                </div>
            </section>

            <!-- Section 2: At Initial Disclosure -->
            <section id="section-2" class="section">
                <div class="section-header">
                    <div class="section-number">2</div>
                    <div class="section-title"><h2>NY Subprime Fail AT Initial Disclosure</h2><span>When the loan fails the test at the time of initial disclosure</span></div>
                </div>
                <div class="section-content">
                    <div class="workflow-diagram">
                        <div class="flow-row">
                            <div class="flow-node start">Loan Application</div>
                            <span class="flow-arrow">-></span>
                            <div class="flow-node decision">HPML Fail in Byte?</div>
                        </div>
                        <div class="decision-branch">
                            <div class="branch">
                                <span class="branch-label">YES + CE Subprime Fail</span>
                                <div class="flow-node action">Auto-Generate NY Subprime Disclosure</div>
                                <span class="flow-arrow down">|</span>
                                <div class="flow-node action">Confirm Included in Package</div>
                                <span class="flow-arrow down">|</span>
                                <div class="flow-node output">Send Within 3 Days of App Date</div>
                            </div>
                            <div class="branch">
                                <span class="branch-label">NO</span>
                                <div class="flow-node output">Standard Disclosure Process</div>
                            </div>
                        </div>
                    </div>

                    <div class="warning-box">
                        <h4>Conditions for Auto-Generation</h4>
                        <ul style="margin-top: 10px; padding-left: 20px;">
                            <li>Loan has an <strong>HPML Fail</strong> in Byte</li>
                            <li>ComplianceEase shows a <strong>failure of the NY Subprime test</strong> at the time of initial disclosure</li>
                        </ul>
                    </div>

                    <div class="tip-box">
                        <h4>Action Required</h4>
                        <p>The NY Subprime Home Counseling Disclosure should <strong>automatically generate</strong> with the initial disclosures. Please confirm that the Subprime Disclosure has been generated correctly and is included in the initial disclosure package.</p>
                    </div>

                    <div class="exception-box">
                        <h4>Compliance Requirement</h4>
                        <p>This disclosure <strong>MUST</strong> be provided to the borrower within <strong>3 days of the Application Date</strong> to comply with State Regulation.</p>
                    </div>
                </div>
            </section>

            <!-- Section 3: After Initial Disclosure -->
            <section id="section-3" class="section">
                <div class="section-header">
                    <div class="section-number">3</div>
                    <div class="section-title"><h2>NY Subprime Fail AFTER Initial Disclosure</h2><span>When the loan fails the test due to post-disclosure changes</span></div>
                </div>
                <div class="section-content">
                    <div class="workflow-diagram">
                        <div class="flow-row">
                            <div class="flow-node start">Change Occurs</div>
                            <span class="flow-arrow">-></span>
                            <div class="flow-node decision">Now Fails NY Subprime?</div>
                        </div>
                        <div class="decision-branch">
                            <div class="branch">
                                <span class="branch-label">YES</span>
                                <div class="flow-node action">Generate Alt Doc NY Subprime Package</div>
                                <span class="flow-arrow down">|</span>
                                <div class="flow-node action">Generate COC Disclosure Package</div>
                                <span class="flow-arrow down">|</span>
                                <div class="flow-node output">Send Both Within 3 Business Days</div>
                            </div>
                        </div>
                    </div>

                    <div class="info-box">
                        <h4>Scenario Description</h4>
                        <p>If the loan did <strong>NOT</strong> initially fail the NY Subprime test but later fails due to changes in the loan terms or pricing.</p>
                    </div>

                    <div class="exception-box">
                        <h4>Critical Action Required</h4>
                        <p>Within <strong>3 business days</strong> of the change, you <strong>MUST</strong> generate the <strong>Alt Doc NY Subprime package</strong>.</p>
                    </div>

                    <div class="warning-box">
                        <h4>IMPORTANT: Change of Circumstance (COC) Required</h4>
                        <p>Ensure the <strong>Change of Circumstance (COC)</strong> disclosure package is also sent. The COC reason must correlate with the increase in APR, resulting in the loan failing the test.</p>
                    </div>
                </div>
            </section>

            <!-- Section 4: Alt Doc Package -->
            <section id="section-4" class="section">
                <div class="section-header">
                    <div class="section-number">4</div>
                    <div class="section-title"><h2>Alt Doc NY Subprime Package</h2><span>Documents included in the alternate disclosure package</span></div>
                </div>
                <div class="section-content">
                    <div class="package-comparison">
                        <div class="package-card">
                            <div class="package-card-header">
                                <h4>Alt Doc NY Subprime Package Contents</h4>
                            </div>
                            <div class="package-card-body">
                                <ul>
                                    <li><span class="check-icon">1.</span> <strong>URLA</strong> - Uniform Residential Loan Application</li>
                                    <li><span class="check-icon">2.</span> <strong>NY Subprime Home Counseling Disclosure</strong></li>
                                </ul>
                            </div>
                        </div>
                        <div class="package-card">
                            <div class="package-card-header" style="background: linear-gradient(135deg, var(--accent-amber) 0%, #d97706 100%);">
                                <h4>Also Required: COC Package</h4>
                            </div>
                            <div class="package-card-body">
                                <ul>
                                    <li><span class="check-icon">+</span> <strong>Change of Circumstance Disclosure</strong></li>
                                    <li><span class="x-icon">!</span> COC reason must correlate with APR increase</li>
                                </ul>
                            </div>
                        </div>
                    </div>

                    <div class="tip-box">
                        <h4>Best Practice</h4>
                        <p>Always send both packages together to ensure complete compliance with NY State regulations and federal disclosure requirements.</p>
                    </div>
                </div>
            </section>

            <!-- Section 5: Common Triggers -->
            <section id="section-5" class="section">
                <div class="section-header">
                    <div class="section-number">5</div>
                    <div class="section-title"><h2>Common Triggers for NY Subprime Fail</h2><span>Factors that cause a loan to fail the test after initial disclosure</span></div>
                </div>
                <div class="section-content">
                    <table class="field-table">
                        <thead>
                            <tr>
                                <th>Trigger Category</th>
                                <th>Specific Cause</th>
                                <th>Impact</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td><strong>Program Change</strong></td>
                                <td>Loan program modification</td>
                                <td><span class="badge required-badge">High Impact</span></td>
                            </tr>
                            <tr>
                                <td rowspan="4"><strong>Pricing Changes</strong></td>
                                <td>Credit score updates</td>
                                <td><span class="badge warning-badge">APR Increase</span></td>
                            </tr>
                            <tr>
                                <td>Property value changes</td>
                                <td><span class="badge warning-badge">APR Increase</span></td>
                            </tr>
                            <tr>
                                <td>Occupancy changes</td>
                                <td><span class="badge warning-badge">APR Increase</span></td>
                            </tr>
                            <tr>
                                <td>Any other factor impacting pricing</td>
                                <td><span class="badge warning-badge">APR Increase</span></td>
                            </tr>
                        </tbody>
                    </table>

                    <div class="info-box">
                        <h4>Understanding the Connection</h4>
                        <p>The NY Subprime test is tied to the loan's APR. Any change that increases the APR could potentially trigger a fail if it crosses the threshold set by NY State regulations.</p>
                    </div>
                </div>
            </section>

            <!-- Section 6: Identifying in Byte -->
            <section id="section-6" class="section">
                <div class="section-header">
                    <div class="section-number">6</div>
                    <div class="section-title"><h2>How to Identify NY Subprime Fail in Byte</h2><span>Using the HPML trigger to identify disclosure requirements</span></div>
                </div>
                <div class="section-content">
                    <div class="info-box">
                        <h4><span class="system-indicator byte">BYTE</span> HPML Trigger</h4>
                        <p>The <strong>HPML Alert</strong> in Byte will trigger the Disclosure to generate in the Initial Disclosure Package.</p>
                    </div>

                    <div class="workflow-diagram">
                        <div class="flow-row">
                            <div class="flow-node input">Loan File Open</div>
                            <span class="flow-arrow">-></span>
                            <div class="flow-node action">Check Compliance Indicators</div>
                            <span class="flow-arrow">-></span>
                            <div class="flow-node decision">HPML Flag?</div>
                        </div>
                        <div class="decision-branch">
                            <div class="branch">
                                <span class="branch-label">YES (Red X)</span>
                                <div class="flow-node exception">HPML Fail - Check CE</div>
                            </div>
                            <div class="branch">
                                <span class="branch-label">NO (Green Check)</span>
                                <div class="flow-node output">No NY Subprime Action</div>
                            </div>
                        </div>
                    </div>

                    <div class="tip-box">
                        <h4>Byte Compliance Bar Indicators</h4>
                        <p>Look at the compliance indicator bar in Byte. The fields shown include: <strong>App, LE, CD, Fees, Cure, QM, SH, HCM, HPML, E-Sign, Reprice</strong>. A red X on the HPML indicator means further investigation in ComplianceEase is required.</p>
                    </div>
                </div>
            </section>

            <!-- Section 7: ComplianceEase Fail -->
            <section id="section-7" class="section">
                <div class="section-header">
                    <div class="section-number">7</div>
                    <div class="section-title"><h2>ComplianceEase NY Subprime Fail</h2><span>Understanding and resolving ComplianceEase failures</span></div>
                </div>
                <div class="section-content">
                    <div class="info-box">
                        <h4><span class="system-indicator ce">COMPLIANCEEASE</span> NY Subprime Fail Example</h4>
                        <p>This is the fail you will see in ComplianceEase. This fail will <strong>never clear</strong>, but we need to ensure that all requirements are met to receive an <strong>Exception</strong> for the CE failure.</p>
                    </div>

                    <table class="field-table">
                        <thead>
                            <tr>
                                <th>Test Name</th>
                                <th>Result</th>
                                <th>Loan Data</th>
                                <th>Comparison Data</th>
                                <th>Variance</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td><strong>NY Subprime Home Loan Test</strong></td>
                                <td><span class="badge required-badge">FAIL</span></td>
                                <td>8.559%</td>
                                <td>8.100%</td>
                                <td>+0.459%</td>
                            </tr>
                            <tr>
                                <td><strong>NY Subprime Lending Policies Alert</strong></td>
                                <td><span class="badge warning-badge">ALERT</span></td>
                                <td colspan="3">--</td>
                            </tr>
                        </tbody>
                    </table>

                    <div class="warning-box">
                        <h4>Important Note: Initial Loan Estimate Delivery Date Validation</h4>
                        <p>The <strong>NY Subprime Home Loan Initial Loan Estimate Delivery Date Validation Test</strong> fail is <strong>OK and expected</strong> at the time of initial disclosure.</p>
                        <p style="margin-top: 10px;">This initial fail <strong>clears</strong> once:</p>
                        <ul style="margin-top: 10px; padding-left: 20px;">
                            <li>One borrower has signed, OR</li>
                            <li>Disclosures have been delivered via mail</li>
                        </ul>
                    </div>

                    <div class="exception-box">
                        <h4>Obtaining an Exception</h4>
                        <p>The NY Subprime Home Loan Test fail will <strong>never automatically clear</strong> in ComplianceEase. To proceed, ensure all disclosure requirements have been met to receive an Exception for this compliance failure.</p>
                    </div>
                </div>
            </section>

            <!-- Quick Reference -->
            <div id="quick-ref" class="quick-ref">
                <h3>NY Subprime Fail Quick Reference</h3>
                <pre>
NY SUBPRIME FAIL - DISCLOSURE PROCESS SUMMARY
==============================================

SCENARIO 1: FAIL AT INITIAL DISCLOSURE
--------------------------------------
Trigger:    HPML Fail in Byte + NY Subprime Fail in ComplianceEase
Action:     Confirm NY Subprime Home Counseling Disclosure auto-generated
Deadline:   Within 3 days of Application Date
Compliance: NY State Regulation

SCENARIO 2: FAIL AFTER INITIAL DISCLOSURE
-----------------------------------------
Trigger:    Change causing loan to now fail NY Subprime test
Action:     Generate Alt Doc NY Subprime Package + COC Package
Deadline:   Within 3 business days of the change
Important:  COC reason must correlate with APR increase

ALT DOC NY SUBPRIME PACKAGE
---------------------------
1. URLA (Uniform Residential Loan Application)
2. NY Subprime Home Counseling Disclosure
+ Change of Circumstance (COC) disclosure package

COMMON TRIGGERS FOR POST-DISCLOSURE FAIL
----------------------------------------
- Program change
- Credit score updates
- Property value changes
- Occupancy changes
- Any other factor impacting pricing (APR)

SYSTEM INDICATORS
-----------------
Byte:           HPML indicator (red X = fail)
ComplianceEase: NY Subprime Home Loan Test (FAIL)
                NY Subprime Lending Policies Alert (ALERT)

COMPLIANCEEASE FAIL BEHAVIOR
----------------------------
- NY Subprime Test fail will NEVER clear automatically
- Requires Exception once all requirements met
- Initial LE Delivery Date Validation fail:
  * OK and expected at initial disclosure
  * Clears when borrower signs OR mail delivery confirmed

CHECKLIST
---------
[ ] Check Byte HPML indicator
[ ] Check ComplianceEase NY Subprime test
[ ] Confirm disclosure auto-generated (initial) or generate Alt Doc (post)
[ ] Send within 3 (business) days
[ ] Include COC package if post-disclosure fail
[ ] Document compliance for Exception request
                </pre>
            </div>
        </div>

        <!-- ==================== AI AGENTS TAB ==================== -->
        <div id="agents-panel" class="tab-panel">
            <!-- Agent Header -->
            <div class="agent-header">
                <h1>AI Agent Opportunities</h1>
                <p class="subtitle">Automation opportunities identified for the NY Subprime Disclosure process</p>
            </div>

            <!-- Summary Stats -->
            <div class="agent-summary" id="agent-summary">
                <div class="agent-summary-card">
                    <div class="agent-summary-value">3</div>
                    <div class="agent-summary-label">Agent Opportunities</div>
                </div>
                <div class="agent-summary-card">
                    <div class="agent-summary-value">85%</div>
                    <div class="agent-summary-label">Automation Potential</div>
                </div>
                <div class="agent-summary-card">
                    <div class="agent-summary-value">15 min</div>
                    <div class="agent-summary-label">Est. Time Saved</div>
                </div>
                <div class="agent-summary-card">
                    <div class="agent-summary-value">Critical</div>
                    <div class="agent-summary-label">Compliance Impact</div>
                </div>
            </div>

            <!-- Heat Map Legend -->
            <div class="heat-legend">
                <div class="heat-legend-item">
                    <div class="heat-legend-color" style="background: linear-gradient(90deg, #ef4444, #f97316);"></div>
                    <span>Critical Priority (9-10)</span>
                </div>
                <div class="heat-legend-item">
                    <div class="heat-legend-color" style="background: linear-gradient(90deg, #f97316, #eab308);"></div>
                    <span>High Priority (7-8)</span>
                </div>
                <div class="heat-legend-item">
                    <div class="heat-legend-color" style="background: linear-gradient(90deg, #eab308, #22c55e);"></div>
                    <span>Medium Priority (5-6)</span>
                </div>
                <div class="heat-legend-item">
                    <div class="heat-legend-color" style="background: linear-gradient(90deg, #22c55e, #14b8a6);"></div>
                    <span>Low Priority (1-4)</span>
                </div>
            </div>

            <!-- Heat Map Grid -->
            <div class="heat-map-container" id="agent-heatmap">
                <div class="heat-map-title">Priority Heat Map</div>
                <div class="heat-map-grid">
                    <div class="heat-item critical" onclick="scrollToAgent('agent-autodetect')">
                        <div class="heat-score">9.5</div>
                        <div class="heat-name">Subprime Auto-Detect Agent</div>
                        <div class="heat-desc">Automatically detect NY Subprime fails and trigger disclosures</div>
                        <div class="heat-metrics">
                            <div class="heat-metric">Time: <span>10 min</span></div>
                            <div class="heat-metric">Complexity: <span>Medium</span></div>
                        </div>
                    </div>
                    <div class="heat-item high" onclick="scrollToAgent('agent-deadline')">
                        <div class="heat-score">8.7</div>
                        <div class="heat-name">Deadline Monitor Agent</div>
                        <div class="heat-desc">Track 3-day disclosure deadlines and send alerts</div>
                        <div class="heat-metrics">
                            <div class="heat-metric">Time: <span>N/A</span></div>
                            <div class="heat-metric">Complexity: <span>Low</span></div>
                        </div>
                    </div>
                    <div class="heat-item high" onclick="scrollToAgent('agent-package')">
                        <div class="heat-score">7.8</div>
                        <div class="heat-name">Package Generator Agent</div>
                        <div class="heat-desc">Auto-generate Alt Doc NY Subprime and COC packages</div>
                        <div class="heat-metrics">
                            <div class="heat-metric">Time: <span>5 min</span></div>
                            <div class="heat-metric">Complexity: <span>Low</span></div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Agent Details -->
            <div id="agent-details">
                <h2 style="color: var(--text-primary); margin-bottom: 25px; font-size: 1.5rem;">Agent Details</h2>
                <div class="agent-grid">
                    <!-- Subprime Auto-Detect Agent -->
                    <div class="agent-card" id="agent-autodetect">
                        <div class="agent-card-header">
                            <div class="agent-icon">S</div>
                            <div class="agent-info">
                                <div class="agent-name">Subprime Auto-Detect Agent</div>
                                <div class="agent-type">Compliance Monitoring / Integration</div>
                            </div>
                            <span class="agent-priority critical">Critical</span>
                        </div>
                        <div class="agent-card-body">
                            <p class="agent-description">Monitors loan files for HPML triggers in Byte and NY Subprime test failures in ComplianceEase. Automatically detects when a loan transitions from passing to failing the NY Subprime test after initial disclosure, triggering immediate alerts and disclosure workflows.</p>
                            <div class="agent-flow">
                                <div class="agent-flow-title">Agent Flow</div>
                                <div class="agent-flow-diagram">
                                    <span class="agent-step">Monitor Byte HPML</span>
                                    <span class="agent-arrow">-></span>
                                    <span class="agent-step">Query CE Status</span>
                                    <span class="agent-arrow">-></span>
                                    <span class="agent-step">Detect Change</span>
                                    <span class="agent-arrow">-></span>
                                    <span class="agent-step">Trigger Workflow</span>
                                </div>
                            </div>
                            <div class="agent-stats">
                                <div class="agent-stat">
                                    <div class="agent-stat-value">10 min</div>
                                    <div class="agent-stat-label">Time Saved</div>
                                </div>
                                <div class="agent-stat">
                                    <div class="agent-stat-value">99%</div>
                                    <div class="agent-stat-label">Accuracy</div>
                                </div>
                                <div class="agent-stat">
                                    <div class="agent-stat-value">Med</div>
                                    <div class="agent-stat-label">Complexity</div>
                                </div>
                            </div>
                            <button class="agent-prompt-btn" onclick="showAgentPrompt('autodetect')">
                                View Build Prompt
                            </button>
                        </div>
                    </div>

                    <!-- Deadline Monitor Agent -->
                    <div class="agent-card" id="agent-deadline">
                        <div class="agent-card-header">
                            <div class="agent-icon">D</div>
                            <div class="agent-info">
                                <div class="agent-name">Deadline Monitor Agent</div>
                                <div class="agent-type">Compliance Tracking / Alerts</div>
                            </div>
                            <span class="agent-priority high">High</span>
                        </div>
                        <div class="agent-card-body">
                            <p class="agent-description">Tracks the 3-day and 3-business-day disclosure deadlines for NY Subprime disclosures. Sends escalating alerts to Disclosure Coordinators as deadlines approach, ensuring compliance with NY State regulations and preventing costly violations.</p>
                            <div class="agent-flow">
                                <div class="agent-flow-title">Agent Flow</div>
                                <div class="agent-flow-diagram">
                                    <span class="agent-step">Detect Trigger Date</span>
                                    <span class="agent-arrow">-></span>
                                    <span class="agent-step">Calculate Deadline</span>
                                    <span class="agent-arrow">-></span>
                                    <span class="agent-step">Monitor Status</span>
                                    <span class="agent-arrow">-></span>
                                    <span class="agent-step">Send Alerts</span>
                                </div>
                            </div>
                            <div class="agent-stats">
                                <div class="agent-stat">
                                    <div class="agent-stat-value">N/A</div>
                                    <div class="agent-stat-label">Time Saved</div>
                                </div>
                                <div class="agent-stat">
                                    <div class="agent-stat-value">100%</div>
                                    <div class="agent-stat-label">Accuracy</div>
                                </div>
                                <div class="agent-stat">
                                    <div class="agent-stat-value">Low</div>
                                    <div class="agent-stat-label">Complexity</div>
                                </div>
                            </div>
                            <button class="agent-prompt-btn" onclick="showAgentPrompt('deadline')">
                                View Build Prompt
                            </button>
                        </div>
                    </div>

                    <!-- Package Generator Agent -->
                    <div class="agent-card" id="agent-package">
                        <div class="agent-card-header">
                            <div class="agent-icon">P</div>
                            <div class="agent-info">
                                <div class="agent-name">Package Generator Agent</div>
                                <div class="agent-type">Document Generation / Workflow</div>
                            </div>
                            <span class="agent-priority high">High</span>
                        </div>
                        <div class="agent-card-body">
                            <p class="agent-description">Automatically generates the Alt Doc NY Subprime package (URLA + NY Subprime Home Counseling Disclosure) and the corresponding Change of Circumstance package with the correct COC reason correlating to the APR increase that triggered the fail.</p>
                            <div class="agent-flow">
                                <div class="agent-flow-title">Agent Flow</div>
                                <div class="agent-flow-diagram">
                                    <span class="agent-step">Identify Trigger</span>
                                    <span class="agent-arrow">-></span>
                                    <span class="agent-step">Generate URLA</span>
                                    <span class="agent-arrow">-></span>
                                    <span class="agent-step">Generate Disclosure</span>
                                    <span class="agent-arrow">-></span>
                                    <span class="agent-step">Create COC</span>
                                </div>
                            </div>
                            <div class="agent-stats">
                                <div class="agent-stat">
                                    <div class="agent-stat-value">5 min</div>
                                    <div class="agent-stat-label">Time Saved</div>
                                </div>
                                <div class="agent-stat">
                                    <div class="agent-stat-value">98%</div>
                                    <div class="agent-stat-label">Accuracy</div>
                                </div>
                                <div class="agent-stat">
                                    <div class="agent-stat-value">Low</div>
                                    <div class="agent-stat-label">Complexity</div>
                                </div>
                            </div>
                            <button class="agent-prompt-btn" onclick="showAgentPrompt('package')">
                                View Build Prompt
                            </button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </main>

    <!-- Documentation Modal -->
    <div class="modal-overlay" id="docModal">
        <div class="modal">
            <div class="modal-header">
                <h3>NY Subprime Fail - Disclosure Workflow Documentation</h3>
                <div class="modal-actions">
                    <button class="modal-btn copy" onclick="copyToClipboard()">Copy</button>
                    <button class="modal-btn close" onclick="closeDocModal()">Close</button>
                </div>
            </div>
            <div class="modal-body">
                <pre id="docContent"># NY Subprime Fail - Disclosure Process

## Overview
This job aid outlines the required disclosures, timelines, and system considerations for Disclosure Coordinators when a loan fails the New York Subprime test at initial disclosure or due to a post-disclosure change.

## Scenario 1: NY Subprime Fail AT Initial Disclosure

### Conditions
- Loan has an HPML Fail in Byte
- ComplianceEase shows a failure of the NY Subprime test at initial disclosure

### Actions
1. NY Subprime Home Counseling Disclosure should auto-generate with initial disclosures
2. Confirm Subprime Disclosure is included in initial disclosure package
3. Provide to borrower within 3 days of Application Date (State Regulation)

## Scenario 2: NY Subprime Fail AFTER Initial Disclosure

### Conditions
- Loan did NOT initially fail the NY Subprime test
- Later fails due to changes affecting APR

### Actions
1. Within 3 business days of the change, generate Alt Doc NY Subprime package
2. Also send Change of Circumstance (COC) disclosure package
3. COC reason must correlate with APR increase

### Alt Doc NY Subprime Package Contents
- URLA (Uniform Residential Loan Application)
- NY Subprime Home Counseling Disclosure

## Common Triggers for Post-Disclosure Fail
- Program change
- Pricing changes due to:
  - Credit score updates
  - Property value changes
  - Occupancy changes
  - Any other factor impacting pricing

## How to Identify NY Subprime Fail

### Byte: HPML Trigger
The HPML Alert in Byte triggers disclosure generation in Initial Disclosure Package

### ComplianceEase: NY Subprime Fail
- NY Subprime Home Loan Test: FAIL
- NY Subprime Lending Policies Alert: ALERT
- This fail will NEVER clear - requires Exception once requirements met

### Important Note
The NY Subprime Home Loan Initial Loan Estimate Delivery Date Validation Test fail is OK and expected at initial disclosure. It clears once one borrower has signed or disclosures have been delivered via mail.</pre>
            </div>
        </div>
    </div>

    <!-- AI Prompt Modal -->
    <div class="modal-overlay prompt-modal" id="promptModal">
        <div class="modal">
            <div class="modal-header">
                <h3 id="promptModalTitle">AI Agent Build Prompt</h3>
                <div class="modal-actions">
                    <button class="modal-btn copy" onclick="copyPromptToClipboard()">Copy Prompt</button>
                    <button class="modal-btn close" onclick="closePromptModal()">Close</button>
                </div>
            </div>
            <div class="modal-body">
                <div class="prompt-tags" id="promptTags"></div>
                <div class="prompt-section">
                    <h4>Agent Purpose</h4>
                    <div class="prompt-box" id="promptPurpose"></div>
                </div>
                <div class="prompt-section">
                    <h4>Full Build Prompt</h4>
                    <div class="prompt-box" id="promptContent"></div>
                </div>
                <div class="prompt-section">
                    <h4>Integration Points</h4>
                    <div class="prompt-box" id="promptIntegration"></div>
                </div>
            </div>
        </div>
    </div>

    <div class="copy-success" id="copySuccess">Copied to clipboard!</div>

    <script>
        // Tab switching
        function switchTab(tab) {
            document.querySelectorAll('.sidebar-tab').forEach(t => t.classList.remove('active'));
            document.querySelectorAll('.tab-panel').forEach(p => p.classList.remove('active'));

            if (tab === 'workflow') {
                document.querySelector('.sidebar-tab:not(.agent-tab)').classList.add('active');
                document.getElementById('workflow-panel').classList.add('active');
                document.getElementById('workflow-nav').style.display = 'block';
                document.getElementById('agents-nav').style.display = 'none';
            } else {
                document.querySelector('.sidebar-tab.agent-tab').classList.add('active');
                document.getElementById('agents-panel').classList.add('active');
                document.getElementById('workflow-nav').style.display = 'none';
                document.getElementById('agents-nav').style.display = 'block';
            }

            window.scrollTo(0, 0);
        }

        // Scroll spy with isScrolling flag and 1000ms timeout
        const sections = document.querySelectorAll('.section, .quick-ref');
        const navItems = document.querySelectorAll('#workflow-nav .nav-item');
        let isScrolling = false;
        let scrollTimeout;

        function updateActiveNav() {
            if (isScrolling) return;

            let current = '';
            sections.forEach(section => {
                const sectionTop = section.offsetTop - 100;
                if (window.scrollY >= sectionTop) current = section.getAttribute('id');
            });
            navItems.forEach(item => {
                item.classList.remove('active');
                if (item.getAttribute('href') === '#' + current) item.classList.add('active');
            });
        }

        // Handle nav click to temporarily disable scroll spy
        navItems.forEach(item => {
            item.addEventListener('click', function(e) {
                isScrolling = true;
                clearTimeout(scrollTimeout);

                // Remove active from all, add to clicked
                navItems.forEach(nav => nav.classList.remove('active'));
                this.classList.add('active');

                // Re-enable scroll spy after 1000ms
                scrollTimeout = setTimeout(() => {
                    isScrolling = false;
                }, 1000);
            });
        });

        window.addEventListener('scroll', updateActiveNav);

        // Modal
        function openDocModal() {
            document.getElementById('docModal').classList.add('show');
            document.body.style.overflow = 'hidden';
        }

        function closeDocModal() {
            document.getElementById('docModal').classList.remove('show');
            document.body.style.overflow = '';
        }

        async function copyToClipboard() {
            try {
                await navigator.clipboard.writeText(document.getElementById('docContent').textContent);
                const success = document.getElementById('copySuccess');
                success.style.display = 'block';
                setTimeout(() => { success.style.display = 'none'; }, 2000);
            } catch (e) { alert('Failed to copy.'); }
        }

        document.addEventListener('keydown', (e) => { if (e.key === 'Escape') { closeDocModal(); closePromptModal(); } });
        document.getElementById('docModal').addEventListener('click', (e) => { if (e.target.id === 'docModal') closeDocModal(); });

        document.addEventListener('DOMContentLoaded', () => { updateActiveNav(); });

        // Scroll to agent card and highlight
        function scrollToAgent(agentId) {
            const agentCard = document.getElementById(agentId);
            if (agentCard) {
                document.querySelectorAll('.agent-card.highlight').forEach(card => {
                    card.classList.remove('highlight');
                });

                agentCard.scrollIntoView({ behavior: 'smooth', block: 'center' });

                setTimeout(() => {
                    agentCard.classList.add('highlight');
                }, 300);

                setTimeout(() => {
                    agentCard.classList.remove('highlight');
                }, 2500);
            }
        }

        // Agent Prompt System
        const agentPrompts = {
            autodetect: {
                name: 'Subprime Auto-Detect Agent',
                tags: ['Compliance Monitoring', 'System Integration', 'Medium Complexity', 'Critical Priority'],
                purpose: `This agent monitors loan files in real-time for HPML triggers in Byte and NY Subprime test failures in ComplianceEase. It automatically detects when a loan transitions from passing to failing the NY Subprime test, whether at initial disclosure or due to subsequent changes, triggering immediate alerts and disclosure workflows.`,
                prompt: `You are building a Compliance Monitoring Agent for CMG Financial's NY Subprime Disclosure process.

AGENT NAME: Subprime Auto-Detect Agent
TYPE: Compliance Monitoring / System Integration

OBJECTIVE:
Create an agent that monitors loan files across Byte and ComplianceEase to automatically detect NY Subprime test failures and trigger appropriate disclosure workflows.

MONITORING TRIGGERS:
1. Initial Disclosure Detection:
   - Monitor Byte HPML indicator status
   - Query ComplianceEase for NY Subprime Home Loan Test result
   - If both FAIL: Flag for initial disclosure requirement

2. Post-Disclosure Change Detection:
   - Track loan modifications that impact APR:
     * Program changes
     * Credit score updates
     * Property value changes
     * Occupancy changes
     * Pricing adjustments
   - Re-query ComplianceEase after each change
   - Detect PASS-to-FAIL transitions

INTEGRATION POINTS:
- Byte LOS API: Monitor HPML indicator field
- ComplianceEase API: Query NY Subprime test results
- Event triggers: Loan update webhooks

OUTPUT ACTIONS:
{
  "loan_number": "2026-001234",
  "detection_type": "INITIAL" | "POST_DISCLOSURE_CHANGE",
  "trigger_date": "2026-01-27",
  "disclosure_deadline": "2026-01-30",
  "byte_hpml_status": "FAIL",
  "ce_subprime_status": "FAIL",
  "ce_variance": "+0.459%",
  "change_trigger": "Credit score update" | null,
  "required_packages": ["ALT_DOC_NY_SUBPRIME", "COC"]
}

ERROR HANDLING:
- If Byte API unavailable: Queue for retry, alert supervisor
- If ComplianceEase mismatch: Log discrepancy, require manual review
- If change trigger unclear: Flag for Disclosure Coordinator review`,
                integration: `INTEGRATION POINTS:

1. Byte LOS
   - Read HPML indicator from compliance bar
   - Monitor loan modification events
   - Access loan data for change detection

2. ComplianceEase
   - Query NY Subprime Home Loan Test results
   - Monitor NY Subprime Lending Policies Alert
   - Track variance calculations

3. Workflow Orchestration
   - Trigger disclosure generation workflows
   - Notify Disclosure Coordinators
   - Create audit trail for compliance

4. Alert System
   - Email notifications to assigned DC
   - Dashboard alerts in loan file
   - Escalation to supervisor if deadline approaching

DEPLOYMENT:
- Event-driven triggers on loan updates
- Scheduled daily scan for missed changes
- Real-time ComplianceEase sync`
            },
            deadline: {
                name: 'Deadline Monitor Agent',
                tags: ['Compliance Tracking', 'Alerts', 'Low Complexity', 'High Priority'],
                purpose: `This agent tracks the critical 3-day (calendar) and 3-business-day disclosure deadlines for NY Subprime disclosures. It sends escalating alerts to Disclosure Coordinators as deadlines approach, calculates business days accounting for holidays, and ensures compliance with NY State regulations.`,
                prompt: `You are building a Deadline Monitor Agent for CMG Financial's NY Subprime Disclosure process.

AGENT NAME: NY Subprime Deadline Monitor
TYPE: Compliance Tracking / Push Notifications

OBJECTIVE:
Track disclosure deadlines for NY Subprime requirements and alert Disclosure Coordinators with escalating urgency as deadlines approach.

DEADLINE CALCULATIONS:
1. Initial Disclosure (At Application):
   - Deadline: 3 calendar days from Application Date
   - Example: App Date 01/27/2026 -> Deadline 01/30/2026

2. Post-Disclosure Change:
   - Deadline: 3 business days from change date
   - Exclude: Weekends, Federal holidays, NY State holidays
   - Example: Change 01/27/2026 (Mon) -> Deadline 01/30/2026 (Thu)

HOLIDAY CALENDAR:
- Maintain Federal holiday calendar
- Include NY State-specific holidays
- Auto-update annually

ALERT THRESHOLDS:
Initial Disclosure (3 calendar days):
- Day 1: INFO - "Disclosure due in 2 days"
- Day 2: WARNING - "Disclosure due tomorrow"
- Day 3: URGENT - "Disclosure due TODAY"
- Day 4+: CRITICAL - "OVERDUE - Compliance violation"

Post-Disclosure (3 business days):
- 2 biz days remaining: INFO
- 1 biz day remaining: WARNING
- Due today: URGENT
- Overdue: CRITICAL with escalation

ALERT MESSAGE FORMAT:
{
  "loan_number": "2026-001234",
  "borrower_name": "John Smith",
  "scenario": "INITIAL" | "POST_DISCLOSURE",
  "trigger_date": "2026-01-27",
  "deadline_date": "2026-01-30",
  "days_remaining": 2,
  "business_days_remaining": 2,
  "disclosure_coordinator": "Jane Doe",
  "alert_level": "WARNING",
  "required_action": "Generate and send Alt Doc NY Subprime + COC packages"
}

ESCALATION RULES:
- WARNING ignored 24hr: Escalate to supervisor
- URGENT ignored 4hr: Escalate to manager
- CRITICAL: Immediate escalation to compliance`,
                integration: `INTEGRATION POINTS:

1. Loan Tracking Database
   - Track NY Subprime detection dates
   - Record disclosure sent dates
   - Calculate remaining time

2. Calendar Service
   - Federal holiday API
   - NY State holiday calendar
   - Business day calculations

3. Notification Services
   - Email (SendGrid/internal)
   - Byte dashboard notifications
   - SMS for CRITICAL alerts
   - Microsoft Teams webhooks

4. Compliance Dashboard
   - Real-time deadline status
   - Color-coded urgency indicators
   - Pipeline view by Disclosure Coordinator
   - Compliance audit reports

BATCH PROCESSING:
- Run at 6:00 AM for daily summary
- Real-time monitoring throughout day
- End-of-day compliance report`
            },
            package: {
                name: 'Package Generator Agent',
                tags: ['Document Generation', 'Workflow Automation', 'Low Complexity', 'High Priority'],
                purpose: `This agent automatically generates the complete Alt Doc NY Subprime package including the URLA and NY Subprime Home Counseling Disclosure, along with the corresponding Change of Circumstance package. It automatically determines the correct COC reason based on the trigger that caused the APR increase.`,
                prompt: `You are building a Package Generator Agent for CMG Financial's NY Subprime Disclosure process.

AGENT NAME: NY Subprime Package Generator
TYPE: Document Generation / Workflow Automation

OBJECTIVE:
Automatically generate the required disclosure packages when a loan fails the NY Subprime test after initial disclosure, including proper COC reason mapping.

PACKAGE COMPONENTS:

1. Alt Doc NY Subprime Package:
   - URLA (Uniform Residential Loan Application)
     * Pull current loan data from Byte
     * Generate fresh URLA with updated information
   - NY Subprime Home Counseling Disclosure
     * Use approved template
     * Populate borrower/loan details
     * Include required counseling information

2. Change of Circumstance (COC) Package:
   - COC Disclosure form
   - Revised Loan Estimate (if applicable)
   - Supporting documentation

COC REASON MAPPING:
{
  "program_change": "Changed Circumstance - Loan Program Change",
  "credit_score_update": "Changed Circumstance - Credit Report Information",
  "property_value_change": "Changed Circumstance - Property Value Revision",
  "occupancy_change": "Changed Circumstance - Occupancy Type Change",
  "rate_lock_extension": "Changed Circumstance - Rate Lock Extension",
  "other_pricing": "Changed Circumstance - Other Pricing Adjustment"
}

GENERATION WORKFLOW:
1. Receive trigger event with change reason
2. Query Byte for current loan data
3. Generate URLA with updated data
4. Generate NY Subprime Home Counseling Disclosure
5. Determine COC reason from trigger
6. Generate COC package with correct reason
7. Bundle documents into single package
8. Queue for Disclosure Coordinator review
9. Log generation for audit trail

OUTPUT:
{
  "package_id": "PKG-2026-001234-001",
  "loan_number": "2026-001234",
  "generation_date": "2026-01-27T10:30:00Z",
  "documents": [
    { "type": "URLA", "pages": 5, "status": "GENERATED" },
    { "type": "NY_SUBPRIME_COUNSELING", "pages": 2, "status": "GENERATED" },
    { "type": "COC_DISCLOSURE", "pages": 1, "status": "GENERATED" }
  ],
  "coc_reason": "Changed Circumstance - Credit Report Information",
  "trigger_cause": "credit_score_update",
  "ready_for_delivery": true
}`,
                integration: `INTEGRATION POINTS:

1. Byte LOS
   - Read loan data for URLA generation
   - Access document templates
   - Store generated documents
   - Update disclosure tracking

2. Document Generation Engine
   - PDF generation library
   - Template population
   - Document merging
   - Digital signature preparation

3. Compliance Verification
   - Validate all required fields populated
   - Check regulatory requirements met
   - Confirm COC reason matches trigger

4. Delivery Queue
   - Queue for DC review
   - Prepare for e-signature (DocuSign/Blend)
   - Track delivery status
   - Record borrower acknowledgment

TEMPLATES REQUIRED:
- URLA template (Fannie Mae form)
- NY Subprime Home Counseling Disclosure
- COC disclosure template
- Package cover sheet`
            }
        };

        function showAgentPrompt(agentKey) {
            const agent = agentPrompts[agentKey];
            if (!agent) return;

            document.getElementById('promptModalTitle').textContent = agent.name + ' - Build Prompt';
            document.getElementById('promptTags').innerHTML = agent.tags.map(t => `<span class="prompt-tag">${t}</span>`).join('');
            document.getElementById('promptPurpose').textContent = agent.purpose;
            document.getElementById('promptContent').textContent = agent.prompt;
            document.getElementById('promptIntegration').textContent = agent.integration;

            document.getElementById('promptModal').classList.add('show');
            document.body.style.overflow = 'hidden';
        }

        function closePromptModal() {
            document.getElementById('promptModal').classList.remove('show');
            document.body.style.overflow = '';
        }

        async function copyPromptToClipboard() {
            const content = document.getElementById('promptContent').textContent;
            try {
                await navigator.clipboard.writeText(content);
                const success = document.getElementById('copySuccess');
                success.style.display = 'block';
                setTimeout(() => { success.style.display = 'none'; }, 2000);
            } catch (e) { alert('Failed to copy.'); }
        }

        document.getElementById('promptModal').addEventListener('click', (e) => { if (e.target.id === 'promptModal') closePromptModal(); });
    </script>
</body>
</html>
