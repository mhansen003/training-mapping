<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>TBD Checklist - Process Workflow</title>
    <link href="https://fonts.googleapis.com/css2?family=Plus+Jakarta+Sans:wght@400;500;600;700;800&family=JetBrains+Mono:wght@400;500&display=swap" rel="stylesheet">
    <style>
        :root {
            --bg-primary: #0a0f1a;
            --bg-secondary: #111827;
            --bg-card: #1a2234;
            --accent-blue: #3b82f6;
            --accent-teal: #14b8a6;
            --accent-amber: #f59e0b;
            --accent-rose: #f43f5e;
            --accent-green: #22c55e;
            --accent-purple: #8b5cf6;
            --text-primary: #f1f5f9;
            --text-secondary: #94a3b8;
            --text-muted: #64748b;
            --border-subtle: rgba(255,255,255,0.08);
            --sidebar-width: 280px;
        }

        * { box-sizing: border-box; margin: 0; padding: 0; }
        html { scroll-behavior: smooth; }
        body {
            font-family: 'Plus Jakarta Sans', -apple-system, BlinkMacSystemFont, sans-serif;
            background: var(--bg-primary);
            color: var(--text-primary);
            min-height: 100vh;
        }

        /* Breadcrumb */
        .breadcrumb {
            background: linear-gradient(90deg, #0d1525 0%, #1a2234 100%);
            padding: 14px 25px;
            display: flex;
            align-items: center;
            gap: 12px;
            font-size: 0.95rem;
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            z-index: 1001;
            border-bottom: 1px solid var(--border-subtle);
        }

        .breadcrumb a {
            color: var(--text-secondary);
            text-decoration: none;
            font-weight: 600;
            padding: 8px 16px;
            background: rgba(255,255,255,0.05);
            border-radius: 8px;
            transition: all 0.2s;
            border: 1px solid var(--border-subtle);
        }

        .breadcrumb a:hover {
            background: rgba(59, 130, 246, 0.15);
            color: var(--accent-blue);
            border-color: rgba(59, 130, 246, 0.3);
        }

        .breadcrumb .separator { color: var(--text-muted); font-size: 1.2rem; }
        .breadcrumb .current { color: var(--accent-amber); font-weight: 600; padding: 8px 16px; }

        /* Sidebar */
        .sidebar {
            position: fixed;
            top: 54px;
            left: 0;
            width: var(--sidebar-width);
            height: calc(100vh - 54px);
            background: var(--bg-secondary);
            overflow-y: auto;
            z-index: 1000;
            border-right: 1px solid var(--border-subtle);
            display: flex;
            flex-direction: column;
        }

        .sidebar-header {
            padding: 25px 20px;
            background: rgba(0,0,0,0.3);
            border-bottom: 1px solid var(--border-subtle);
        }

        .sidebar-header h2 { color: var(--text-primary); font-size: 1.2rem; font-weight: 700; margin-bottom: 5px; }
        .sidebar-header p { color: var(--text-muted); font-size: 0.85rem; }

        /* Tab Switch */
        .sidebar-tabs {
            display: flex;
            border-bottom: 1px solid var(--border-subtle);
        }

        .sidebar-tab {
            flex: 1;
            padding: 14px 10px;
            text-align: center;
            font-size: 0.8rem;
            font-weight: 700;
            color: var(--text-muted);
            cursor: pointer;
            transition: all 0.2s;
            border-bottom: 3px solid transparent;
            background: none;
            border-left: none;
            border-right: none;
            border-top: none;
        }

        .sidebar-tab:hover { background: rgba(255,255,255,0.03); color: var(--text-secondary); }
        .sidebar-tab.active { color: var(--accent-blue); border-bottom-color: var(--accent-blue); background: rgba(59, 130, 246, 0.08); }
        .sidebar-tab.agent-tab.active { color: var(--accent-purple); border-bottom-color: var(--accent-purple); background: rgba(139, 92, 246, 0.08); }

        .sidebar-nav { padding: 15px 0; flex: 1; overflow-y: auto; }

        .nav-item {
            display: flex;
            align-items: center;
            gap: 12px;
            padding: 14px 20px;
            color: var(--text-secondary);
            text-decoration: none;
            border-left: 3px solid transparent;
            transition: all 0.2s ease;
            cursor: pointer;
        }

        .nav-item:hover { background: rgba(255,255,255,0.03); color: var(--text-primary); }
        .nav-item.active { background: rgba(59, 130, 246, 0.1); border-left-color: var(--accent-blue); color: var(--text-primary); }

        .nav-number {
            background: rgba(255,255,255,0.1);
            color: var(--text-secondary);
            width: 28px;
            height: 28px;
            border-radius: 8px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 700;
            font-size: 0.85rem;
            flex-shrink: 0;
        }

        .nav-item.active .nav-number { background: var(--accent-blue); color: white; }
        .nav-label { font-size: 0.95rem; font-weight: 500; }

        .sidebar-footer {
            padding: 20px;
            border-top: 1px solid var(--border-subtle);
            background: rgba(0,0,0,0.2);
        }

        .doc-btn {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
            width: 100%;
            padding: 14px 20px;
            background: linear-gradient(135deg, var(--accent-blue) 0%, var(--accent-teal) 100%);
            color: white;
            border: none;
            border-radius: 10px;
            font-weight: 600;
            cursor: pointer;
            transition: transform 0.2s, box-shadow 0.2s;
            text-decoration: none;
            font-size: 0.95rem;
        }

        .doc-btn:hover { transform: translateY(-2px); box-shadow: 0 8px 25px rgba(59, 130, 246, 0.3); }

        /* Main Content */
        .main-content { margin-left: var(--sidebar-width); padding: 80px 40px 40px 40px; }

        /* Tab Panels */
        .tab-panel { display: none; }
        .tab-panel.active { display: block; }

        .header {
            background: var(--bg-card);
            border: 1px solid var(--border-subtle);
            padding: 35px;
            border-radius: 16px;
            margin-bottom: 30px;
            position: relative;
            overflow: hidden;
        }

        .header::before {
            content: '';
            position: absolute;
            top: 0; left: 0; right: 0; bottom: 0;
            background:
                radial-gradient(ellipse at 20% 20%, rgba(59, 130, 246, 0.1) 0%, transparent 50%),
                radial-gradient(ellipse at 80% 80%, rgba(20, 184, 166, 0.08) 0%, transparent 50%);
            pointer-events: none;
        }

        .header h1 {
            font-size: 2.2rem;
            font-weight: 800;
            margin-bottom: 10px;
            position: relative;
            background: linear-gradient(135deg, var(--text-primary) 0%, var(--accent-blue) 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .header .subtitle { color: var(--text-secondary); font-size: 1.1rem; position: relative; }

        .header .meta { display: flex; gap: 15px; margin-top: 20px; flex-wrap: wrap; position: relative; }

        .header .meta-item {
            background: rgba(255,255,255,0.05);
            border: 1px solid var(--border-subtle);
            padding: 8px 16px;
            border-radius: 8px;
            font-size: 0.9rem;
            color: var(--text-secondary);
        }

        /* Legend */
        .legend {
            display: flex;
            flex-wrap: wrap;
            gap: 15px;
            padding: 18px 22px;
            background: var(--bg-card);
            border: 1px solid var(--border-subtle);
            border-radius: 12px;
            margin-bottom: 25px;
        }

        .legend-item { display: flex; align-items: center; gap: 8px; font-size: 0.85rem; color: var(--text-secondary); }
        .legend-color { width: 18px; height: 18px; border-radius: 4px; }

        /* Sections */
        .section {
            background: var(--bg-card);
            border: 1px solid var(--border-subtle);
            border-radius: 16px;
            margin-bottom: 25px;
            overflow: hidden;
            scroll-margin-top: 75px;
        }

        .section-header {
            background: linear-gradient(135deg, var(--bg-secondary) 0%, rgba(59, 130, 246, 0.1) 100%);
            border-bottom: 1px solid var(--border-subtle);
            padding: 22px 25px;
            display: flex;
            align-items: center;
            gap: 18px;
        }

        .section-number {
            background: linear-gradient(135deg, var(--accent-blue) 0%, var(--accent-teal) 100%);
            color: white;
            width: 48px;
            height: 48px;
            border-radius: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 800;
            font-size: 1.3rem;
            flex-shrink: 0;
        }

        .section-title h2 { font-size: 1.35rem; font-weight: 700; margin-bottom: 4px; color: var(--text-primary); }
        .section-title span { font-size: 0.9rem; color: var(--text-muted); }
        .section-content { padding: 28px; }

        /* Workflow Diagrams */
        .workflow-diagram {
            background: rgba(0,0,0,0.3);
            border: 1px solid var(--border-subtle);
            border-radius: 12px;
            padding: 28px;
            margin-bottom: 22px;
        }

        .flow-row { display: flex; align-items: center; justify-content: center; flex-wrap: wrap; gap: 12px; margin: 15px 0; }

        .flow-node {
            padding: 14px 22px;
            border-radius: 10px;
            text-align: center;
            font-size: 0.9rem;
            font-weight: 600;
            min-width: 150px;
            border: 1px solid var(--border-subtle);
        }

        .flow-node.start { background: linear-gradient(135deg, var(--accent-green) 0%, #16a34a 100%); color: white; border-radius: 25px; border: none; }
        .flow-node.action { background: linear-gradient(135deg, var(--accent-blue) 0%, #2563eb 100%); color: white; border: none; }
        .flow-node.decision { background: linear-gradient(135deg, var(--accent-amber) 0%, #d97706 100%); color: var(--bg-primary); border: none; }
        .flow-node.input { background: var(--bg-secondary); border: 2px solid var(--accent-blue); color: var(--text-primary); }
        .flow-node.output { background: linear-gradient(135deg, var(--accent-teal) 0%, #0d9488 100%); color: white; border: none; }
        .flow-node.exception { background: linear-gradient(135deg, var(--accent-rose) 0%, #dc2626 100%); color: white; border: none; }

        .flow-arrow { color: var(--accent-blue); font-size: 1.5rem; }
        .flow-arrow.down { transform: rotate(90deg); }

        .decision-branch { display: flex; gap: 40px; justify-content: center; margin: 20px 0; flex-wrap: wrap; }
        .branch { display: flex; flex-direction: column; align-items: center; gap: 10px; }

        .branch-label {
            background: var(--bg-secondary);
            border: 1px solid var(--border-subtle);
            padding: 6px 16px;
            border-radius: 20px;
            font-size: 0.8rem;
            font-weight: 700;
            color: var(--text-secondary);
        }

        /* Tables */
        .field-table { width: 100%; border-collapse: collapse; margin: 18px 0; }

        .field-table th {
            background: rgba(59, 130, 246, 0.15);
            color: var(--accent-blue);
            padding: 14px 18px;
            text-align: left;
            font-weight: 600;
            font-size: 0.9rem;
            text-transform: uppercase;
            letter-spacing: 0.05em;
            border-bottom: 1px solid var(--border-subtle);
        }

        .field-table td { padding: 14px 18px; border-bottom: 1px solid var(--border-subtle); color: var(--text-secondary); }
        .field-table tr:hover { background: rgba(255,255,255,0.02); }

        .badge { display: inline-block; padding: 4px 12px; border-radius: 6px; font-size: 0.75rem; font-weight: 700; text-transform: uppercase; letter-spacing: 0.05em; }
        .badge.required-badge { background: rgba(244, 63, 94, 0.15); color: var(--accent-rose); }
        .badge.optional-badge { background: rgba(34, 197, 94, 0.15); color: var(--accent-green); }
        .badge.calculated-badge { background: rgba(59, 130, 246, 0.15); color: var(--accent-blue); }

        /* Info Boxes */
        .exception-box, .tip-box, .info-box {
            padding: 18px 22px;
            margin: 18px 0;
            border-radius: 0 10px 10px 0;
            border-left-width: 4px;
            border-left-style: solid;
        }

        .exception-box { background: rgba(244, 63, 94, 0.08); border-color: var(--accent-rose); border: 1px solid rgba(244, 63, 94, 0.2); border-left: 4px solid var(--accent-rose); }
        .exception-box h4 { color: var(--accent-rose); margin-bottom: 10px; font-size: 1rem; }
        .exception-box p, .exception-box li { color: var(--text-secondary); }

        .tip-box { background: rgba(34, 197, 94, 0.08); border-color: var(--accent-green); border: 1px solid rgba(34, 197, 94, 0.2); border-left: 4px solid var(--accent-green); }
        .tip-box h4 { color: var(--accent-green); margin-bottom: 10px; font-size: 1rem; }
        .tip-box p, .tip-box li { color: var(--text-secondary); }

        .info-box { background: rgba(59, 130, 246, 0.08); border-color: var(--accent-blue); border: 1px solid rgba(59, 130, 246, 0.2); border-left: 4px solid var(--accent-blue); }
        .info-box h4 { color: var(--accent-blue); margin-bottom: 10px; font-size: 1rem; }
        .info-box p, .info-box li { color: var(--text-secondary); }

        /* Decision Tree */
        .decision-tree {
            background: rgba(0,0,0,0.2);
            border: 1px solid var(--border-subtle);
            border-radius: 12px;
            padding: 22px;
            margin: 22px 0;
        }

        .decision-tree h3 { color: var(--accent-blue); margin-bottom: 18px; padding-bottom: 12px; border-bottom: 1px solid var(--border-subtle); font-size: 1.1rem; }

        .tree-node { margin-left: 20px; padding: 12px; border-left: 2px solid var(--accent-teal); position: relative; color: var(--text-secondary); }
        .tree-node::before { content: ''; position: absolute; left: -2px; top: 22px; width: 15px; height: 2px; background: var(--accent-teal); }
        .tree-node.level-1 { margin-left: 0; border-left: none; }
        .tree-node.level-1::before { display: none; }

        .tree-label { background: var(--accent-amber); color: var(--bg-primary); padding: 6px 14px; border-radius: 6px; font-weight: 700; display: inline-block; margin-bottom: 6px; font-size: 0.9rem; }

        /* Summary Grid */
        .summary-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(180px, 1fr)); gap: 18px; margin: 22px 0; }

        .summary-card { background: rgba(0,0,0,0.3); border: 1px solid var(--border-subtle); border-radius: 12px; padding: 22px; text-align: center; }
        .summary-card h4 { color: var(--text-secondary); margin-bottom: 12px; font-size: 0.9rem; }
        .summary-card .value {
            font-size: 2.2rem;
            font-weight: 800;
            background: linear-gradient(135deg, var(--accent-blue) 0%, var(--accent-teal) 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }
        .summary-card .label { font-size: 0.85rem; color: var(--text-muted); margin-top: 8px; }

        /* Step List */
        .step-list { list-style: none; padding: 0; margin: 18px 0; }
        .step-list li {
            padding: 14px 18px;
            border-left: 3px solid var(--accent-blue);
            background: rgba(0,0,0,0.2);
            margin-bottom: 10px;
            border-radius: 0 8px 8px 0;
            color: var(--text-secondary);
        }
        .step-list li strong { color: var(--text-primary); }

        /* Checklist */
        .checklist { list-style: none; padding: 0; margin: 18px 0; }
        .checklist li {
            padding: 12px 18px;
            background: rgba(0,0,0,0.2);
            margin-bottom: 8px;
            border-radius: 8px;
            color: var(--text-secondary);
            display: flex;
            align-items: flex-start;
            gap: 12px;
        }
        .checklist li::before {
            content: '';
            width: 18px;
            height: 18px;
            border: 2px solid var(--accent-blue);
            border-radius: 4px;
            flex-shrink: 0;
            margin-top: 2px;
        }

        /* Quick Reference */
        .quick-ref {
            background: linear-gradient(135deg, var(--bg-secondary) 0%, var(--bg-card) 100%);
            border: 1px solid var(--border-subtle);
            padding: 28px;
            border-radius: 16px;
            margin-top: 30px;
            font-family: 'JetBrains Mono', monospace;
            scroll-margin-top: 75px;
        }

        .quick-ref h3 { color: var(--accent-amber); margin-bottom: 18px; font-family: 'Plus Jakarta Sans', sans-serif; }
        .quick-ref pre { background: rgba(0,0,0,0.4); border: 1px solid var(--border-subtle); padding: 20px; border-radius: 10px; overflow-x: auto; font-size: 0.85rem; line-height: 1.7; color: var(--text-secondary); }

        /* ====== AGENT OPPORTUNITIES STYLES ====== */
        .agent-header {
            background: var(--bg-card);
            border: 1px solid var(--border-subtle);
            padding: 35px;
            border-radius: 16px;
            margin-bottom: 30px;
            position: relative;
            overflow: hidden;
        }

        .agent-header::before {
            content: '';
            position: absolute;
            top: 0; left: 0; right: 0; bottom: 0;
            background:
                radial-gradient(ellipse at 20% 20%, rgba(139, 92, 246, 0.12) 0%, transparent 50%),
                radial-gradient(ellipse at 80% 80%, rgba(245, 158, 11, 0.1) 0%, transparent 50%);
            pointer-events: none;
        }

        .agent-header h1 {
            font-size: 2.2rem;
            font-weight: 800;
            margin-bottom: 10px;
            position: relative;
            background: linear-gradient(135deg, var(--accent-purple) 0%, var(--accent-amber) 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .agent-header .subtitle { color: var(--text-secondary); font-size: 1.1rem; position: relative; }

        /* Heat Map */
        .heat-map-container { margin-bottom: 35px; }
        .heat-map-title { font-size: 1.3rem; font-weight: 700; color: var(--text-primary); margin-bottom: 20px; display: flex; align-items: center; gap: 12px; }

        .heat-map-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
        }

        .heat-item {
            background: var(--bg-card);
            border: 1px solid var(--border-subtle);
            border-radius: 12px;
            padding: 20px;
            position: relative;
            overflow: hidden;
            transition: transform 0.2s, box-shadow 0.2s;
            cursor: pointer;
        }

        .heat-item:hover { transform: translateY(-3px); box-shadow: 0 10px 30px rgba(0,0,0,0.3); }
        .heat-item:active { transform: scale(0.98); }

        .heat-item::before {
            content: '';
            position: absolute;
            top: 0; left: 0; right: 0; height: 4px;
        }

        .heat-item.critical::before { background: linear-gradient(90deg, #ef4444, #f97316); }
        .heat-item.high::before { background: linear-gradient(90deg, #f97316, #eab308); }
        .heat-item.medium::before { background: linear-gradient(90deg, #eab308, #22c55e); }
        .heat-item.low::before { background: linear-gradient(90deg, #22c55e, #14b8a6); }

        .heat-score {
            position: absolute;
            top: 15px;
            right: 15px;
            font-size: 1.8rem;
            font-weight: 800;
        }

        .heat-item.critical .heat-score { color: #ef4444; }
        .heat-item.high .heat-score { color: #f97316; }
        .heat-item.medium .heat-score { color: #eab308; }
        .heat-item.low .heat-score { color: #22c55e; }

        .heat-name { font-size: 1rem; font-weight: 700; color: var(--text-primary); margin-bottom: 6px; padding-right: 50px; }
        .heat-desc { font-size: 0.85rem; color: var(--text-muted); margin-bottom: 12px; }

        .heat-metrics { display: flex; gap: 15px; margin-top: 12px; }
        .heat-metric { font-size: 0.75rem; color: var(--text-muted); }
        .heat-metric span { color: var(--text-secondary); font-weight: 600; }

        /* Agent Cards */
        .agent-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(380px, 1fr)); gap: 25px; margin-bottom: 35px; }

        .agent-card {
            background: var(--bg-card);
            border: 1px solid var(--border-subtle);
            border-radius: 16px;
            overflow: hidden;
            transition: transform 0.2s, box-shadow 0.2s;
        }

        .agent-card:hover { transform: translateY(-5px); box-shadow: 0 15px 50px rgba(0,0,0,0.3); }

        .agent-card.highlight {
            animation: highlightPulse 2s ease;
            box-shadow: 0 0 0 3px var(--accent-purple), 0 15px 50px rgba(139, 92, 246, 0.4);
        }

        @keyframes highlightPulse {
            0% { box-shadow: 0 0 0 3px var(--accent-purple), 0 15px 50px rgba(139, 92, 246, 0.6); }
            50% { box-shadow: 0 0 0 6px rgba(139, 92, 246, 0.5), 0 15px 50px rgba(139, 92, 246, 0.3); }
            100% { box-shadow: 0 0 0 0px transparent, 0 15px 50px rgba(0,0,0,0.3); }
        }

        .agent-card-header {
            padding: 22px;
            display: flex;
            align-items: flex-start;
            gap: 18px;
            border-bottom: 1px solid var(--border-subtle);
        }

        .agent-icon {
            width: 55px;
            height: 55px;
            background: linear-gradient(135deg, var(--accent-purple) 0%, var(--accent-blue) 100%);
            border-radius: 14px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.6rem;
            flex-shrink: 0;
        }

        .agent-info { flex: 1; }
        .agent-name { font-size: 1.15rem; font-weight: 700; color: var(--text-primary); margin-bottom: 5px; }
        .agent-type { font-size: 0.8rem; color: var(--accent-purple); font-weight: 600; text-transform: uppercase; letter-spacing: 0.05em; }

        .agent-priority {
            padding: 6px 12px;
            border-radius: 20px;
            font-size: 0.75rem;
            font-weight: 700;
            text-transform: uppercase;
        }

        .agent-priority.critical { background: rgba(239, 68, 68, 0.15); color: #ef4444; }
        .agent-priority.high { background: rgba(249, 115, 22, 0.15); color: #f97316; }
        .agent-priority.medium { background: rgba(234, 179, 8, 0.15); color: #eab308; }
        .agent-priority.low { background: rgba(34, 197, 94, 0.15); color: #22c55e; }

        .agent-card-body { padding: 22px; }
        .agent-description { font-size: 0.95rem; color: var(--text-secondary); line-height: 1.6; margin-bottom: 20px; }

        .agent-flow {
            background: rgba(0,0,0,0.3);
            border: 1px solid var(--border-subtle);
            border-radius: 10px;
            padding: 18px;
            margin-bottom: 20px;
        }

        .agent-flow-title { font-size: 0.85rem; color: var(--text-muted); margin-bottom: 12px; font-weight: 600; text-transform: uppercase; letter-spacing: 0.05em; }

        .agent-flow-diagram { display: flex; align-items: center; flex-wrap: wrap; gap: 8px; justify-content: center; }

        .agent-step {
            background: linear-gradient(135deg, var(--accent-purple) 0%, var(--accent-blue) 100%);
            color: white;
            padding: 8px 14px;
            border-radius: 6px;
            font-size: 0.8rem;
            font-weight: 600;
            white-space: nowrap;
        }

        .agent-arrow { color: var(--accent-purple); font-size: 1.2rem; }

        .agent-stats { display: grid; grid-template-columns: repeat(3, 1fr); gap: 12px; }

        .agent-stat {
            background: rgba(0,0,0,0.2);
            border-radius: 8px;
            padding: 12px;
            text-align: center;
        }

        .agent-stat-value {
            font-size: 1.3rem;
            font-weight: 800;
            background: linear-gradient(135deg, var(--accent-purple) 0%, var(--accent-amber) 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .agent-stat-label { font-size: 0.7rem; color: var(--text-muted); text-transform: uppercase; letter-spacing: 0.05em; margin-top: 4px; }

        /* View Prompt Button */
        .agent-prompt-btn {
            width: 100%;
            margin-top: 18px;
            padding: 14px 20px;
            background: linear-gradient(135deg, rgba(139, 92, 246, 0.2) 0%, rgba(59, 130, 246, 0.2) 100%);
            border: 1px solid rgba(139, 92, 246, 0.4);
            border-radius: 10px;
            color: var(--accent-purple);
            font-weight: 700;
            cursor: pointer;
            transition: all 0.2s;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
            font-size: 0.9rem;
        }

        .agent-prompt-btn:hover {
            background: linear-gradient(135deg, rgba(139, 92, 246, 0.3) 0%, rgba(59, 130, 246, 0.3) 100%);
            border-color: var(--accent-purple);
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(139, 92, 246, 0.25);
        }

        /* Summary Stats */
        .agent-summary {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin-bottom: 35px;
        }

        .agent-summary-card {
            background: var(--bg-card);
            border: 1px solid var(--border-subtle);
            border-radius: 14px;
            padding: 25px;
            text-align: center;
        }

        .agent-summary-value {
            font-size: 2.5rem;
            font-weight: 800;
            background: linear-gradient(135deg, var(--accent-purple) 0%, var(--accent-amber) 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .agent-summary-label { font-size: 0.9rem; color: var(--text-muted); margin-top: 8px; }

        /* Heat Map Legend */
        .heat-legend {
            display: flex;
            gap: 25px;
            padding: 18px 22px;
            background: var(--bg-card);
            border: 1px solid var(--border-subtle);
            border-radius: 12px;
            margin-bottom: 25px;
            flex-wrap: wrap;
        }

        .heat-legend-item { display: flex; align-items: center; gap: 10px; font-size: 0.9rem; color: var(--text-secondary); }
        .heat-legend-color { width: 24px; height: 24px; border-radius: 6px; }

        /* Modal */
        .modal-overlay {
            display: none;
            position: fixed;
            top: 0; left: 0; right: 0; bottom: 0;
            background: rgba(10, 15, 26, 0.9);
            z-index: 2000;
            justify-content: center;
            align-items: center;
            padding: 20px;
            backdrop-filter: blur(5px);
        }

        .modal-overlay.show { display: flex; }

        .modal {
            background: var(--bg-card);
            border: 1px solid var(--border-subtle);
            border-radius: 16px;
            width: 100%;
            max-width: 950px;
            max-height: 90vh;
            display: flex;
            flex-direction: column;
            box-shadow: 0 25px 80px rgba(0,0,0,0.5);
        }

        .modal-header {
            background: linear-gradient(135deg, var(--accent-blue) 0%, var(--accent-teal) 100%);
            color: white;
            padding: 22px 28px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            border-radius: 16px 16px 0 0;
        }

        .modal-header h3 { font-size: 1.25rem; font-weight: 700; }
        .modal-actions { display: flex; gap: 12px; }

        .modal-btn {
            padding: 10px 18px;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-weight: 700;
            transition: transform 0.2s;
            font-size: 0.9rem;
        }

        .modal-btn:hover { transform: scale(1.05); }
        .modal-btn.copy { background: white; color: var(--accent-blue); }
        .modal-btn.close { background: rgba(255,255,255,0.2); color: white; }

        .modal-body { padding: 28px; overflow-y: auto; flex: 1; }

        .modal-body pre {
            background: rgba(0,0,0,0.3);
            border: 1px solid var(--border-subtle);
            padding: 22px;
            border-radius: 10px;
            font-family: 'JetBrains Mono', monospace;
            font-size: 0.9rem;
            line-height: 1.7;
            white-space: pre-wrap;
            word-wrap: break-word;
            color: var(--text-secondary);
        }

        .copy-success {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: var(--accent-green);
            color: white;
            padding: 18px 35px;
            border-radius: 10px;
            font-weight: 700;
            z-index: 3000;
            display: none;
            animation: fadeInOut 2s ease;
        }

        @keyframes fadeInOut { 0%, 100% { opacity: 0; } 10%, 90% { opacity: 1; } }

        /* Prompt Modal */
        .prompt-modal .modal { max-width: 800px; }
        .prompt-modal .modal-header { background: linear-gradient(135deg, var(--accent-purple) 0%, var(--accent-blue) 100%); }

        .prompt-section { margin-bottom: 25px; }
        .prompt-section h4 { color: var(--accent-purple); font-size: 1rem; margin-bottom: 12px; display: flex; align-items: center; gap: 8px; }

        .prompt-box {
            background: rgba(0,0,0,0.4);
            border: 1px solid var(--border-subtle);
            border-radius: 10px;
            padding: 20px;
            font-family: 'JetBrains Mono', monospace;
            font-size: 0.85rem;
            line-height: 1.7;
            color: var(--text-secondary);
            white-space: pre-wrap;
            word-wrap: break-word;
        }

        .prompt-tags { display: flex; gap: 10px; flex-wrap: wrap; margin-bottom: 20px; }
        .prompt-tag { background: rgba(139, 92, 246, 0.15); color: var(--accent-purple); padding: 6px 14px; border-radius: 20px; font-size: 0.8rem; font-weight: 600; }

        .copy-prompt-btn {
            background: linear-gradient(135deg, var(--accent-purple) 0%, var(--accent-blue) 100%);
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 8px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.2s;
            margin-top: 15px;
        }

        .copy-prompt-btn:hover { transform: scale(1.05); box-shadow: 0 5px 20px rgba(139, 92, 246, 0.3); }

        @media (max-width: 900px) {
            .sidebar { display: none; }
            .main-content { margin-left: 0; padding: 75px 20px 30px 20px; }
            .agent-grid { grid-template-columns: 1fr; }
        }
        .breadcrumb-logo-link { display: inline-flex; align-items: center; padding: 4px 8px; background: rgba(255,255,255,0.08); border-radius: 8px; border: 1px solid rgba(255,255,255,0.12); transition: all 0.2s; flex-shrink: 0; margin-right: 4px; }
        .breadcrumb-logo-link:hover { background: rgba(255,255,255,0.15); }
        .breadcrumb-logo { height: 24px; width: auto; display: block; }
    </style>
</head>
<body>
    <!-- Breadcrumb -->
    <nav class="breadcrumb">
<a href="../../index.html" class="breadcrumb-logo-link"><img src="../../images/clear-ai-logo.png" alt="Clear AI" class="breadcrumb-logo"></a>
        <a href="../../index.html">Home</a>
        <span class="separator">></span>
        <a href="./index.html">Mortgage Fundamentals</a>
        <span class="separator">></span>
        <span class="current">TBD Checklist</span>
    </nav>

    <!-- Fixed Sidebar -->
    <aside class="sidebar">
        <div class="sidebar-header">
            <h2>TBD Checklist</h2>
            <p>Credit Only Approval Process</p>
        </div>

        <!-- Tab Switcher -->
        <div class="sidebar-tabs">
            <button class="sidebar-tab active" onclick="switchTab('workflow')">Workflow</button>
            <button class="sidebar-tab agent-tab" onclick="switchTab('agents')">AI Agents</button>
        </div>

        <!-- Workflow Navigation -->
        <nav class="sidebar-nav" id="workflow-nav">
            <a href="#section-1" class="nav-item active">
                <span class="nav-number">1</span>
                <span class="nav-label">Overview</span>
            </a>
            <a href="#section-2" class="nav-item">
                <span class="nav-number">2</span>
                <span class="nav-label">Borrower Qualifications</span>
            </a>
            <a href="#section-3" class="nav-item">
                <span class="nav-number">3</span>
                <span class="nav-label">Credit Report</span>
            </a>
            <a href="#section-4" class="nav-item">
                <span class="nav-number">4</span>
                <span class="nav-label">Income Documentation</span>
            </a>
            <a href="#section-5" class="nav-item">
                <span class="nav-number">5</span>
                <span class="nav-label">Assets</span>
            </a>
            <a href="#section-6" class="nav-item">
                <span class="nav-number">6</span>
                <span class="nav-label">Miscellaneous</span>
            </a>
            <a href="#section-7" class="nav-item">
                <span class="nav-number">7</span>
                <span class="nav-label">Submission to Operations</span>
            </a>
            <a href="#section-8" class="nav-item">
                <span class="nav-number">8</span>
                <span class="nav-label">Accepted Offer Process</span>
            </a>
            <a href="#quick-ref" class="nav-item">
                <span class="nav-number">*</span>
                <span class="nav-label">Quick Reference</span>
            </a>
        </nav>

        <!-- Agent Navigation -->
        <nav class="sidebar-nav" id="agents-nav" style="display: none;">
            <a href="#agent-summary" class="nav-item active">
                <span class="nav-number">S</span>
                <span class="nav-label">Summary</span>
            </a>
            <a href="#agent-heatmap" class="nav-item">
                <span class="nav-number">H</span>
                <span class="nav-label">Heat Map</span>
            </a>
            <a href="#agent-details" class="nav-item">
                <span class="nav-number">A</span>
                <span class="nav-label">Agent Details</span>
            </a>
        </nav>

        <div class="sidebar-footer">
            <button class="doc-btn" onclick="openDocModal()">
                View Workflow Markdown
            </button>
        </div>
    </aside>

    <!-- Main Content -->
    <main class="main-content">

        <!-- ==================== WORKFLOW TAB ==================== -->
        <div id="workflow-panel" class="tab-panel active">
            <!-- Header -->
            <div class="header">
                <h1>TBD Checklist</h1>
                <p class="subtitle">Credit Only approval process for borrowers without a subject property address</p>
                <div class="meta">
                    <span class="meta-item">System: Byte LOS</span>
                    <span class="meta-item">Role: Loan Officer / Sales</span>
                    <span class="meta-item">Updated: Jan 16, 2026</span>
                    <span class="meta-item">Type: Pre-Approval</span>
                </div>
            </div>

            <!-- Legend -->
            <div class="legend">
                <div class="legend-item"><div class="legend-color" style="background: linear-gradient(135deg, #22c55e, #16a34a);"></div><span>Start/End</span></div>
                <div class="legend-item"><div class="legend-color" style="background: linear-gradient(135deg, #3b82f6, #2563eb);"></div><span>Action Step</span></div>
                <div class="legend-item"><div class="legend-color" style="background: linear-gradient(135deg, #f59e0b, #d97706);"></div><span>Decision Point</span></div>
                <div class="legend-item"><div class="legend-color" style="background: #111827; border: 2px solid #3b82f6;"></div><span>User Input</span></div>
                <div class="legend-item"><div class="legend-color" style="background: linear-gradient(135deg, #f43f5e, #dc2626);"></div><span>Exception</span></div>
                <div class="legend-item"><div class="legend-color" style="background: linear-gradient(135deg, #14b8a6, #0d9488);"></div><span>Output</span></div>
            </div>

            <!-- Section 1: Overview -->
            <section id="section-1" class="section">
                <div class="section-header">
                    <div class="section-number">1</div>
                    <div class="section-title"><h2>TBD Process Overview</h2><span>Understanding the Credit Only approval workflow</span></div>
                </div>
                <div class="section-content">
                    <div class="workflow-diagram">
                        <div class="flow-row">
                            <div class="flow-node start">Borrower Qualifies</div>
                            <span class="flow-arrow">-></span>
                            <div class="flow-node action">Submit TBD Loan</div>
                            <span class="flow-arrow">-></span>
                            <div class="flow-node action">Credit Only Review</div>
                            <span class="flow-arrow">-></span>
                            <div class="flow-node output">Conditional Approval</div>
                        </div>
                    </div>
                    <div class="info-box">
                        <h4>What is TBD?</h4>
                        <p>The TBD (To Be Determined) process empowers Sales to submit a loan with Borrower qualifying fields and documentation to obtain a <strong>Credit Only approval</strong>. The loan is submitted <strong>without a subject property address</strong>.</p>
                    </div>
                    <div class="tip-box">
                        <h4>Key Benefits</h4>
                        <ul style="margin-top: 10px; margin-left: 20px;">
                            <li>Borrowers with credit and qualifying risk can obtain a Conditional loan decision from underwriting</li>
                            <li>Well-qualified Borrowers can credit qualify before finding a property</li>
                            <li>Expedites loan closing when Borrower goes to contract on a Purchase transaction</li>
                            <li>Provides confidence to buyers and sellers with a Conditional Commitment letter</li>
                        </ul>
                    </div>
                    <div class="exception-box">
                        <h4>Important Requirements</h4>
                        <p>Loan Officers must ensure that all items are documented in the loan fields for Credit Only review. All applicable documentation listed must be in Clear Docs. <strong>Always confirm the product guidelines allow TBD submissions.</strong></p>
                    </div>
                </div>
            </section>

            <!-- Section 2: Borrower Qualifications -->
            <section id="section-2" class="section">
                <div class="section-header">
                    <div class="section-number">2</div>
                    <div class="section-title"><h2>Borrower Qualifications</h2><span>Required field entry and documentation for borrower information</span></div>
                </div>
                <div class="section-content">
                    <div class="workflow-diagram">
                        <div class="flow-row">
                            <div class="flow-node action">Enter Residency History</div>
                            <span class="flow-arrow">-></span>
                            <div class="flow-node action">Verify Citizenship</div>
                            <span class="flow-arrow">-></span>
                            <div class="flow-node action">Complete Declarations</div>
                            <span class="flow-arrow">-></span>
                            <div class="flow-node output">HMDA Information</div>
                        </div>
                    </div>
                    <ul class="checklist">
                        <li>Two-year residency history documented</li>
                        <li>Acceptable Citizenship and/or any other Borrower-related qualifications verified</li>
                        <li>Complete Declaration information entered</li>
                        <li>HMDA information fully documented</li>
                    </ul>
                    <table class="field-table">
                        <thead>
                            <tr>
                                <th>Field</th>
                                <th>Requirement</th>
                                <th>Status</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td><strong>Residency History</strong></td>
                                <td>Full 2-year address history</td>
                                <td><span class="badge required-badge">Required</span></td>
                            </tr>
                            <tr>
                                <td><strong>Citizenship Status</strong></td>
                                <td>US Citizen, Permanent Resident, or eligible non-citizen</td>
                                <td><span class="badge required-badge">Required</span></td>
                            </tr>
                            <tr>
                                <td><strong>Declarations</strong></td>
                                <td>All 1003 declaration questions answered</td>
                                <td><span class="badge required-badge">Required</span></td>
                            </tr>
                            <tr>
                                <td><strong>HMDA Data</strong></td>
                                <td>Ethnicity, race, sex, and other demographic info</td>
                                <td><span class="badge required-badge">Required</span></td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </section>

            <!-- Section 3: Credit Report -->
            <section id="section-3" class="section">
                <div class="section-header">
                    <div class="section-number">3</div>
                    <div class="section-title"><h2>Credit Report</h2><span>SoftCheck or Full-Trimerge as required per guidelines</span></div>
                </div>
                <div class="section-content">
                    <div class="workflow-diagram">
                        <div class="flow-row">
                            <div class="flow-node action">Pull Credit Report</div>
                            <span class="flow-arrow">-></span>
                            <div class="flow-node decision">Scores Acceptable?</div>
                        </div>
                        <div class="decision-branch">
                            <div class="branch">
                                <span class="branch-label">YES</span>
                                <div class="flow-node action">Review Credit History</div>
                            </div>
                            <div class="branch">
                                <span class="branch-label">NO</span>
                                <div class="flow-node exception">Address Credit Issues</div>
                            </div>
                        </div>
                    </div>
                    <ul class="checklist">
                        <li>SoftCheck or Full-Trimerge pulled as required per guidelines</li>
                        <li>Acceptable Credit Scores verified</li>
                        <li>Credit History reviewed for derogatory items</li>
                    </ul>

                    <div class="decision-tree">
                        <h3>Key Documentation as Applicable</h3>
                        <ul class="step-list">
                            <li><strong>Credit Inquiries:</strong> Explanation letter for recent inquiries</li>
                            <li><strong>Omitted Liabilities:</strong> Explanation for debts not shown on credit report</li>
                            <li><strong>Bankruptcy Documents:</strong> Discharge papers, schedules, and court documents</li>
                            <li><strong>Student Loans:</strong> Payment documentation and accurate agency calculation added if deferred</li>
                        </ul>
                    </div>

                    <table class="field-table">
                        <thead>
                            <tr>
                                <th>Document Type</th>
                                <th>When Required</th>
                                <th>Status</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td><strong>Credit Inquiry Letter</strong></td>
                                <td>Recent credit inquiries within 120 days</td>
                                <td><span class="badge optional-badge">If Applicable</span></td>
                            </tr>
                            <tr>
                                <td><strong>Omitted Liabilities LOX</strong></td>
                                <td>Debts not appearing on credit report</td>
                                <td><span class="badge optional-badge">If Applicable</span></td>
                            </tr>
                            <tr>
                                <td><strong>BK Discharge/Schedules</strong></td>
                                <td>Prior bankruptcy on record</td>
                                <td><span class="badge optional-badge">If Applicable</span></td>
                            </tr>
                            <tr>
                                <td><strong>Student Loan Docs</strong></td>
                                <td>Deferred student loans</td>
                                <td><span class="badge optional-badge">If Applicable</span></td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </section>

            <!-- Section 4: Income Documentation -->
            <section id="section-4" class="section">
                <div class="section-header">
                    <div class="section-number">4</div>
                    <div class="section-title"><h2>Income Documentation</h2><span>Two-year sufficient employment and income history</span></div>
                </div>
                <div class="section-content">
                    <div class="workflow-diagram">
                        <div class="flow-row">
                            <div class="flow-node action">Document Employment</div>
                            <span class="flow-arrow">-></span>
                            <div class="flow-node decision">Self-Employed?</div>
                        </div>
                        <div class="decision-branch">
                            <div class="branch">
                                <span class="branch-label">NO (W-2)</span>
                                <div class="flow-node action">TRUV / Borrower Docs</div>
                            </div>
                            <div class="branch">
                                <span class="branch-label">YES</span>
                                <div class="flow-node action">LoanBeam / Tax Returns</div>
                            </div>
                        </div>
                    </div>

                    <div class="decision-tree">
                        <h3>W-2 / Salaried Income (TRUV or Borrower Provided)</h3>
                        <ul class="step-list">
                            <li><strong>Paystub:</strong> Most recent paystub with 30 days of earnings</li>
                            <li><strong>W2s:</strong> Most recent 2 years of W-2 forms</li>
                            <li><strong>Tax Returns:</strong> If needed for income type verification</li>
                            <li><strong>WVOE:</strong> Written Verification of Employment for variable income</li>
                        </ul>
                    </div>

                    <div class="decision-tree">
                        <h3>Self-Employed Income</h3>
                        <ul class="step-list">
                            <li><strong>LoanBeam Findings:</strong> Automated income analysis results</li>
                            <li><strong>Tax Returns:</strong> Complete personal and business returns (2 years)</li>
                            <li><strong>Current P&L:</strong> Profit and Loss statement for current year</li>
                        </ul>
                    </div>

                    <div class="info-box">
                        <h4>Resource Folders</h4>
                        <p>Reference the following resource folders for detailed guidance:</p>
                        <ul style="margin-top: 10px; margin-left: 20px;">
                            <li><strong>TRUV Resources</strong> - Electronic verification setup and troubleshooting</li>
                            <li><strong>LoanBeam Resources</strong> - Self-employed income calculation guidance</li>
                        </ul>
                    </div>

                    <table class="field-table">
                        <thead>
                            <tr>
                                <th>Income Type</th>
                                <th>Required Documents</th>
                                <th>Source</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td><strong>W-2 Salaried</strong></td>
                                <td>Paystub (30 days), W-2s (2 years)</td>
                                <td>TRUV / Borrower</td>
                            </tr>
                            <tr>
                                <td><strong>Variable Income</strong></td>
                                <td>Paystub, W-2s, WVOE</td>
                                <td>TRUV / Borrower</td>
                            </tr>
                            <tr>
                                <td><strong>Self-Employed</strong></td>
                                <td>Tax Returns (2 years), P&L, LoanBeam</td>
                                <td>LoanBeam / Borrower</td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </section>

            <!-- Section 5: Assets -->
            <section id="section-5" class="section">
                <div class="section-header">
                    <div class="section-number">5</div>
                    <div class="section-title"><h2>Assets</h2><span>Sufficient and documented assets to anticipate cash to close</span></div>
                </div>
                <div class="section-content">
                    <div class="workflow-diagram">
                        <div class="flow-row">
                            <div class="flow-node action">AccountChek / Statements</div>
                            <span class="flow-arrow">-></span>
                            <div class="flow-node decision">Large Deposits?</div>
                            <span class="flow-arrow">-></span>
                            <div class="flow-node action">Document & Explain</div>
                            <span class="flow-arrow">-></span>
                            <div class="flow-node output">Assets Verified</div>
                        </div>
                    </div>

                    <ul class="checklist">
                        <li>AccountChek or Borrower provided most recent 60-day asset statements</li>
                        <li>Statements for any other income types (retirement, rental, etc.)</li>
                        <li>Large deposits, transfers, or concerns addressed with documentation</li>
                    </ul>

                    <div class="exception-box">
                        <h4>Special Requirements for AIO and Jumbo Loans</h4>
                        <p>AIO and Jumbo loans require <strong>3 months' asset statements</strong> for self-employed Borrower(s). Ensure you have the appropriate timeframe based on loan type.</p>
                    </div>

                    <div class="info-box">
                        <h4>AccountChek Resources</h4>
                        <p>Reference the AccountChek resources folder for setup instructions, borrower enrollment, and troubleshooting common issues.</p>
                    </div>

                    <table class="field-table">
                        <thead>
                            <tr>
                                <th>Asset Requirement</th>
                                <th>Standard Loans</th>
                                <th>AIO/Jumbo (Self-Emp)</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td><strong>Statement Period</strong></td>
                                <td>60 days (2 statements)</td>
                                <td>90 days (3 statements)</td>
                            </tr>
                            <tr>
                                <td><strong>Verification Method</strong></td>
                                <td>AccountChek or Paper</td>
                                <td>AccountChek or Paper</td>
                            </tr>
                            <tr>
                                <td><strong>Large Deposit Threshold</strong></td>
                                <td>Per agency guidelines</td>
                                <td>Per agency guidelines</td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </section>

            <!-- Section 6: Miscellaneous -->
            <section id="section-6" class="section">
                <div class="section-header">
                    <div class="section-number">6</div>
                    <div class="section-title"><h2>Miscellaneous Entry and Documentation</h2><span>Additional documentation when applicable</span></div>
                </div>
                <div class="section-content">
                    <ul class="checklist">
                        <li>Divorce Decree to document Alimony or Child Support</li>
                        <li>Entry of and documentation for all real estate owned (including details of PITIA or rental income)</li>
                        <li>Sales Contract for current residence with tentative Net Proceeds from Sale, or Rental agreement, whenever applicable</li>
                    </ul>

                    <table class="field-table">
                        <thead>
                            <tr>
                                <th>Document</th>
                                <th>When Required</th>
                                <th>Details to Capture</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td><strong>Divorce Decree</strong></td>
                                <td>Alimony/Child Support paid or received</td>
                                <td>Payment amount, duration, recipient</td>
                            </tr>
                            <tr>
                                <td><strong>REO Documentation</strong></td>
                                <td>Borrower owns other properties</td>
                                <td>PITIA, rental income, mortgage info</td>
                            </tr>
                            <tr>
                                <td><strong>Sales Contract</strong></td>
                                <td>Selling current residence</td>
                                <td>Net proceeds estimate, closing date</td>
                            </tr>
                            <tr>
                                <td><strong>Rental Agreement</strong></td>
                                <td>Converting current residence to rental</td>
                                <td>Lease terms, rental amount</td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </section>

            <!-- Section 7: Submission to Operations -->
            <section id="section-7" class="section">
                <div class="section-header">
                    <div class="section-number">7</div>
                    <div class="section-title"><h2>Submission to Operations</h2><span>Proper workflow for TBD loan submission</span></div>
                </div>
                <div class="section-content">
                    <div class="workflow-diagram">
                        <div class="flow-row">
                            <div class="flow-node action">Complete Documentation</div>
                            <span class="flow-arrow">-></span>
                            <div class="flow-node action">Email Processor</div>
                            <span class="flow-arrow">-></span>
                            <div class="flow-node action">Processing Review</div>
                            <span class="flow-arrow">-></span>
                            <div class="flow-node output">Submit to UW</div>
                        </div>
                    </div>

                    <div class="exception-box">
                        <h4>CRITICAL: Do NOT Use Standard Submission</h4>
                        <p>Sales should <strong>NOT</strong> complete Request LE or Send to Processing status in the LOS. Sales should email the assigned Processor or Processing Manager to notify them that the loan needs a TBD submission.</p>
                    </div>

                    <ul class="step-list">
                        <li><strong>Step 1:</strong> Complete all required documentation in Clear Docs</li>
                        <li><strong>Step 2:</strong> Email assigned Processor or Processing Manager</li>
                        <li><strong>Step 3:</strong> Loan remains in <strong>Prospect</strong> status (TBD Loans are not disclosed as TBD)</li>
                        <li><strong>Step 4:</strong> Processing reviews all information</li>
                        <li><strong>Step 5:</strong> Processing submits to Underwriting for Credit Approval</li>
                    </ul>

                    <div class="decision-tree">
                        <h3>If Changes Needed to TBD Loan Terms</h3>
                        <ul class="step-list">
                            <li><strong>Action:</strong> Loan is put into <strong>Restructured Status</strong></li>
                            <li><strong>Next Step:</strong> Processor resubmits the Restructured loan to Underwriting for confirmation of Credit Only Approval</li>
                            <li><strong>Reference:</strong> See the Byte - Loan Restructure - Job Aid for complete instructions</li>
                        </ul>
                    </div>
                </div>
            </section>

            <!-- Section 8: Accepted Offer Process -->
            <section id="section-8" class="section">
                <div class="section-header">
                    <div class="section-number">8</div>
                    <div class="section-title"><h2>Accepted Offer Process</h2><span>Workflow when borrower finds a property</span></div>
                </div>
                <div class="section-content">
                    <div class="tip-box">
                        <h4>Key Benefit</h4>
                        <p>Once PreApproved, Sales can issue a <strong>Conditional Commitment letter</strong> to the Borrower, which gives Borrowers confidence to shop and gives potential sellers confidence.</p>
                    </div>

                    <div class="workflow-diagram">
                        <div class="flow-row">
                            <div class="flow-node start">Credit Only Status</div>
                            <span class="flow-arrow">-></span>
                            <div class="flow-node action">UW Review</div>
                            <span class="flow-arrow">-></span>
                            <div class="flow-node decision">UW Decision</div>
                        </div>
                        <div class="decision-branch">
                            <div class="branch">
                                <span class="branch-label">APPROVED</span>
                                <div class="flow-node output">PreApproved Status</div>
                            </div>
                            <div class="branch">
                                <span class="branch-label">SUSPENDED</span>
                                <div class="flow-node action">Submit Conditions</div>
                            </div>
                            <div class="branch">
                                <span class="branch-label">DECLINED</span>
                                <div class="flow-node exception">Adverse Action</div>
                            </div>
                        </div>
                    </div>

                    <div class="decision-tree">
                        <h3>TBD Status Flow</h3>
                        <ul class="step-list">
                            <li><strong>Credit Only:</strong> Processor moves loan to this status in Byte after review, which sends the TBD file to Underwriting without an address</li>
                            <li><strong>PreApproved:</strong> Indicates Credit Only approval by underwriting. If there are any conditions, the Processor can submit</li>
                            <li><strong>Waiting Period:</strong> File stays in PreApproved Status until Borrower has an accepted offer OR until the credit-only preapproval expires</li>
                        </ul>
                    </div>

                    <div class="info-box">
                        <h4>Status Outcomes</h4>
                        <ul style="margin-top: 10px; margin-left: 20px;">
                            <li><strong>If Suspended:</strong> Processor will submit the suspense conditions to Underwriting to attempt to achieve Credit Only Approval</li>
                            <li><strong>If Declined:</strong> The loan will be adverse actioned by Operations</li>
                        </ul>
                    </div>

                    <div class="decision-tree">
                        <h3>When Borrower Obtains a Subject Property Contract</h3>
                        <ul class="step-list">
                            <li><strong>Step 1:</strong> Loan Officer is informed that the property is under contract</li>
                            <li><strong>Step 2:</strong> Loan Officer guides Operations to put the loan in <strong>Loan Restructure Status</strong></li>
                            <li><strong>Step 3:</strong> Loan Officer updates all terms, fields, and needed/updated documents added to Clear Docs for full processing and underwriting reconsideration</li>
                            <li><strong>Step 4:</strong> Loan Officer requests disclosure, and the loan is initially disclosed</li>
                            <li><strong>Step 5:</strong> Loan Officer submits the file to Processing for full-file processing</li>
                            <li><strong>Step 6:</strong> Processor submits as UW Received for full underwriting decision</li>
                        </ul>
                    </div>

                    <div class="info-box">
                        <h4>Reference Document</h4>
                        <p>See the <strong>Byte - Loan Restructure - Job Aid</strong> for complete instructions on the restructure process.</p>
                    </div>
                </div>
            </section>

            <!-- Quick Reference -->
            <div id="quick-ref" class="quick-ref">
                <h3>TBD Checklist Quick Reference</h3>
                <pre>
TBD CHECKLIST SUMMARY
=====================

BORROWER QUALIFICATIONS
[ ] Two-year residency history
[ ] Citizenship/eligibility verified
[ ] Declarations complete
[ ] HMDA information documented

CREDIT REPORT
[ ] SoftCheck or Full-Trimerge pulled
[ ] Credit scores acceptable
[ ] Credit inquiry explanations (if applicable)
[ ] Omitted liabilities explanations (if applicable)
[ ] Bankruptcy documents (if applicable)
[ ] Student loan documentation (if deferred)

INCOME - W-2/SALARIED (TRUV or Borrower)
[ ] Most recent paystub (30 days earnings)
[ ] W-2s (2 years)
[ ] Tax Returns (if needed)
[ ] WVOE (for variable income)

INCOME - SELF-EMPLOYED
[ ] LoanBeam findings
[ ] Tax Returns (2 years)
[ ] Current P&L

ASSETS
[ ] AccountChek or 60-day statements
  - NOTE: AIO/Jumbo require 3 months for self-employed
[ ] Large deposit documentation
[ ] Other income source statements

MISCELLANEOUS (When Applicable)
[ ] Divorce Decree (alimony/child support)
[ ] REO documentation (PITIA, rental income)
[ ] Sales Contract (net proceeds)
[ ] Rental Agreement (converting residence)

SUBMISSION PROCESS
==================
1. Complete all docs in Clear Docs
2. EMAIL Processor/Manager (DO NOT use Request LE)
3. Loan stays in PROSPECT status
4. Processing reviews and submits to UW

STATUS FLOW
===========
Prospect -> Credit Only -> PreApproved
                        -> Suspended (submit conditions)
                        -> Declined (adverse action)

WHEN PROPERTY FOUND
===================
1. LO informed of contract
2. Move to Loan Restructure Status
3. Update terms/docs in Clear Docs
4. Request disclosure (initial)
5. Submit to Processing
6. Processor submits as UW Received
                </pre>
            </div>
        </div>

        <!-- ==================== AI AGENTS TAB ==================== -->
        <div id="agents-panel" class="tab-panel">
            <!-- Agent Header -->
            <div class="agent-header">
                <h1>AI Agent Opportunities</h1>
                <p class="subtitle">Automation opportunities identified for the TBD Checklist process</p>
            </div>

            <!-- Summary Stats -->
            <div class="agent-summary" id="agent-summary">
                <div class="agent-summary-card">
                    <div class="agent-summary-value">4</div>
                    <div class="agent-summary-label">Agent Opportunities</div>
                </div>
                <div class="agent-summary-card">
                    <div class="agent-summary-value">68%</div>
                    <div class="agent-summary-label">Automation Potential</div>
                </div>
                <div class="agent-summary-card">
                    <div class="agent-summary-value">15 min</div>
                    <div class="agent-summary-label">Est. Time Saved</div>
                </div>
                <div class="agent-summary-card">
                    <div class="agent-summary-value">High</div>
                    <div class="agent-summary-label">Quality Impact</div>
                </div>
            </div>

            <!-- Heat Map Legend -->
            <div class="heat-legend">
                <div class="heat-legend-item">
                    <div class="heat-legend-color" style="background: linear-gradient(90deg, #ef4444, #f97316);"></div>
                    <span>Critical Priority (9-10)</span>
                </div>
                <div class="heat-legend-item">
                    <div class="heat-legend-color" style="background: linear-gradient(90deg, #f97316, #eab308);"></div>
                    <span>High Priority (7-8)</span>
                </div>
                <div class="heat-legend-item">
                    <div class="heat-legend-color" style="background: linear-gradient(90deg, #eab308, #22c55e);"></div>
                    <span>Medium Priority (5-6)</span>
                </div>
                <div class="heat-legend-item">
                    <div class="heat-legend-color" style="background: linear-gradient(90deg, #22c55e, #14b8a6);"></div>
                    <span>Low Priority (1-4)</span>
                </div>
            </div>

            <!-- Heat Map Grid -->
            <div class="heat-map-container" id="agent-heatmap">
                <div class="heat-map-title">Priority Heat Map</div>
                <div class="heat-map-grid">
                    <div class="heat-item critical" onclick="scrollToAgent('agent-doccheck')">
                        <div class="heat-score">9.4</div>
                        <div class="heat-name">TBD Doc Checker</div>
                        <div class="heat-desc">Validate all required documents before submission</div>
                        <div class="heat-metrics">
                            <div class="heat-metric">Time: <span>8 min</span></div>
                            <div class="heat-metric">Complexity: <span>Medium</span></div>
                        </div>
                    </div>
                    <div class="heat-item high" onclick="scrollToAgent('agent-creditanalyzer')">
                        <div class="heat-score">8.2</div>
                        <div class="heat-name">Credit Analyzer</div>
                        <div class="heat-desc">Auto-identify credit issues requiring documentation</div>
                        <div class="heat-metrics">
                            <div class="heat-metric">Time: <span>4 min</span></div>
                            <div class="heat-metric">Complexity: <span>Medium</span></div>
                        </div>
                    </div>
                    <div class="heat-item high" onclick="scrollToAgent('agent-incomevalidator')">
                        <div class="heat-score">7.8</div>
                        <div class="heat-name">Income Validator</div>
                        <div class="heat-desc">Verify income documentation completeness</div>
                        <div class="heat-metrics">
                            <div class="heat-metric">Time: <span>3 min</span></div>
                            <div class="heat-metric">Complexity: <span>Low</span></div>
                        </div>
                    </div>
                    <div class="heat-item medium" onclick="scrollToAgent('agent-statustracker')">
                        <div class="heat-score">6.5</div>
                        <div class="heat-name">Status Tracker</div>
                        <div class="heat-desc">Monitor TBD loans and alert on expiration</div>
                        <div class="heat-metrics">
                            <div class="heat-metric">Time: <span>N/A</span></div>
                            <div class="heat-metric">Complexity: <span>Low</span></div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Agent Details -->
            <div id="agent-details">
                <h2 style="color: var(--text-primary); margin-bottom: 25px; font-size: 1.5rem;">Agent Details</h2>
                <div class="agent-grid">
                    <!-- TBD Doc Checker Agent -->
                    <div class="agent-card" id="agent-doccheck">
                        <div class="agent-card-header">
                            <div class="agent-icon">D</div>
                            <div class="agent-info">
                                <div class="agent-name">TBD Doc Checker</div>
                                <div class="agent-type">Document Validation</div>
                            </div>
                            <span class="agent-priority critical">Critical</span>
                        </div>
                        <div class="agent-card-body">
                            <p class="agent-description">Automatically validates that all required TBD checklist documents are present in Clear Docs before submission. Checks for borrower qualifications, credit docs, income, and assets based on loan scenario.</p>
                            <div class="agent-flow">
                                <div class="agent-flow-title">Agent Flow</div>
                                <div class="agent-flow-diagram">
                                    <span class="agent-step">Scan Clear Docs</span>
                                    <span class="agent-arrow">-></span>
                                    <span class="agent-step">Match Checklist</span>
                                    <span class="agent-arrow">-></span>
                                    <span class="agent-step">Flag Missing</span>
                                    <span class="agent-arrow">-></span>
                                    <span class="agent-step">Generate Report</span>
                                </div>
                            </div>
                            <div class="agent-stats">
                                <div class="agent-stat">
                                    <div class="agent-stat-value">8 min</div>
                                    <div class="agent-stat-label">Time Saved</div>
                                </div>
                                <div class="agent-stat">
                                    <div class="agent-stat-value">97%</div>
                                    <div class="agent-stat-label">Accuracy</div>
                                </div>
                                <div class="agent-stat">
                                    <div class="agent-stat-value">Med</div>
                                    <div class="agent-stat-label">Complexity</div>
                                </div>
                            </div>
                            <button class="agent-prompt-btn" onclick="showAgentPrompt('doccheck')">
                                View Build Prompt
                            </button>
                        </div>
                    </div>

                    <!-- Credit Analyzer Agent -->
                    <div class="agent-card" id="agent-creditanalyzer">
                        <div class="agent-card-header">
                            <div class="agent-icon">C</div>
                            <div class="agent-info">
                                <div class="agent-name">Credit Analyzer</div>
                                <div class="agent-type">Credit Analysis / AI</div>
                            </div>
                            <span class="agent-priority high">High</span>
                        </div>
                        <div class="agent-card-body">
                            <p class="agent-description">Analyzes credit report data to automatically identify items requiring documentation such as credit inquiries, omitted liabilities, bankruptcy history, and deferred student loans. Generates a documentation requirements list.</p>
                            <div class="agent-flow">
                                <div class="agent-flow-title">Agent Flow</div>
                                <div class="agent-flow-diagram">
                                    <span class="agent-step">Parse Credit</span>
                                    <span class="agent-arrow">-></span>
                                    <span class="agent-step">Identify Issues</span>
                                    <span class="agent-arrow">-></span>
                                    <span class="agent-step">Map Docs</span>
                                    <span class="agent-arrow">-></span>
                                    <span class="agent-step">Create List</span>
                                </div>
                            </div>
                            <div class="agent-stats">
                                <div class="agent-stat">
                                    <div class="agent-stat-value">4 min</div>
                                    <div class="agent-stat-label">Time Saved</div>
                                </div>
                                <div class="agent-stat">
                                    <div class="agent-stat-value">94%</div>
                                    <div class="agent-stat-label">Accuracy</div>
                                </div>
                                <div class="agent-stat">
                                    <div class="agent-stat-value">Med</div>
                                    <div class="agent-stat-label">Complexity</div>
                                </div>
                            </div>
                            <button class="agent-prompt-btn" onclick="showAgentPrompt('creditanalyzer')">
                                View Build Prompt
                            </button>
                        </div>
                    </div>

                    <!-- Income Validator Agent -->
                    <div class="agent-card" id="agent-incomevalidator">
                        <div class="agent-card-header">
                            <div class="agent-icon">I</div>
                            <div class="agent-info">
                                <div class="agent-name">Income Validator</div>
                                <div class="agent-type">Document Validation</div>
                            </div>
                            <span class="agent-priority high">High</span>
                        </div>
                        <div class="agent-card-body">
                            <p class="agent-description">Validates income documentation completeness based on employment type (W-2 vs self-employed). Checks for paystub currency, W-2 coverage, tax return completeness, and LoanBeam findings for self-employed borrowers.</p>
                            <div class="agent-flow">
                                <div class="agent-flow-title">Agent Flow</div>
                                <div class="agent-flow-diagram">
                                    <span class="agent-step">Detect Income Type</span>
                                    <span class="agent-arrow">-></span>
                                    <span class="agent-step">Check Docs</span>
                                    <span class="agent-arrow">-></span>
                                    <span class="agent-step">Validate Dates</span>
                                    <span class="agent-arrow">-></span>
                                    <span class="agent-step">Report Status</span>
                                </div>
                            </div>
                            <div class="agent-stats">
                                <div class="agent-stat">
                                    <div class="agent-stat-value">3 min</div>
                                    <div class="agent-stat-label">Time Saved</div>
                                </div>
                                <div class="agent-stat">
                                    <div class="agent-stat-value">96%</div>
                                    <div class="agent-stat-label">Accuracy</div>
                                </div>
                                <div class="agent-stat">
                                    <div class="agent-stat-value">Low</div>
                                    <div class="agent-stat-label">Complexity</div>
                                </div>
                            </div>
                            <button class="agent-prompt-btn" onclick="showAgentPrompt('incomevalidator')">
                                View Build Prompt
                            </button>
                        </div>
                    </div>

                    <!-- Status Tracker Agent -->
                    <div class="agent-card" id="agent-statustracker">
                        <div class="agent-card-header">
                            <div class="agent-icon">S</div>
                            <div class="agent-info">
                                <div class="agent-name">Status Tracker</div>
                                <div class="agent-type">Monitoring / Alerts</div>
                            </div>
                            <span class="agent-priority medium">Medium</span>
                        </div>
                        <div class="agent-card-body">
                            <p class="agent-description">Monitors all TBD loans in PreApproved status and sends proactive alerts when credit-only approvals are approaching expiration. Notifies LO and processor to re-engage borrower or refresh documentation.</p>
                            <div class="agent-flow">
                                <div class="agent-flow-title">Agent Flow</div>
                                <div class="agent-flow-diagram">
                                    <span class="agent-step">Scan TBD Loans</span>
                                    <span class="agent-arrow">-></span>
                                    <span class="agent-step">Check Dates</span>
                                    <span class="agent-arrow">-></span>
                                    <span class="agent-step">Send Alerts</span>
                                    <span class="agent-arrow">-></span>
                                    <span class="agent-step">Track Response</span>
                                </div>
                            </div>
                            <div class="agent-stats">
                                <div class="agent-stat">
                                    <div class="agent-stat-value">N/A</div>
                                    <div class="agent-stat-label">Time Saved</div>
                                </div>
                                <div class="agent-stat">
                                    <div class="agent-stat-value">99%</div>
                                    <div class="agent-stat-label">Accuracy</div>
                                </div>
                                <div class="agent-stat">
                                    <div class="agent-stat-value">Low</div>
                                    <div class="agent-stat-label">Complexity</div>
                                </div>
                            </div>
                            <button class="agent-prompt-btn" onclick="showAgentPrompt('statustracker')">
                                View Build Prompt
                            </button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </main>

    <!-- Documentation Modal -->
    <div class="modal-overlay" id="docModal">
        <div class="modal">
            <div class="modal-header">
                <h3>TBD Checklist Workflow Documentation</h3>
                <div class="modal-actions">
                    <button class="modal-btn copy" onclick="copyToClipboard()">Copy</button>
                    <button class="modal-btn close" onclick="closeDocModal()">Close</button>
                </div>
            </div>
            <div class="modal-body">
                <pre id="docContent"># TBD Checklist - Credit Only Approval Process

## Overview
The TBD process empowers Sales to submit a loan with Borrower qualifying fields and documentation to obtain a Credit Only approval. The loan is submitted without a subject property address.

## Benefits
- Borrowers can obtain Conditional loan decision before finding a property
- Expedites closing when borrower goes to contract
- Provides confidence to buyers and sellers

## Required Documentation

### Borrower Qualifications
- Two-year residency history
- Citizenship verification
- Complete Declarations and HMDA

### Credit Report
- SoftCheck or Full-Trimerge per guidelines
- Acceptable scores and history
- Credit inquiry explanations (if applicable)
- Bankruptcy documents (if applicable)
- Student loan documentation (if deferred)

### Income (W-2/Salaried)
- Most recent paystub (30 days)
- W-2s (2 years)
- Tax Returns (if needed)
- WVOE for variable income

### Income (Self-Employed)
- LoanBeam findings
- Tax Returns (2 years)
- Current P&L

### Assets
- AccountChek or 60-day statements
- AIO/Jumbo: 3 months for self-employed
- Large deposit documentation

## Submission Process
1. DO NOT use Request LE or Send to Processing
2. Email Processor/Processing Manager
3. Loan stays in Prospect status
4. Processing submits to UW for Credit Approval

## Status Flow
- Credit Only -> PreApproved (approved)
- Credit Only -> Suspended (conditions needed)
- Credit Only -> Declined (adverse action)

## When Property Found
1. LO notified of contract
2. Move to Loan Restructure Status
3. Update terms and docs
4. Request disclosure
5. Submit to Processing
6. UW Received for full decision</pre>
            </div>
        </div>
    </div>

    <!-- AI Prompt Modal -->
    <div class="modal-overlay prompt-modal" id="promptModal">
        <div class="modal">
            <div class="modal-header">
                <h3 id="promptModalTitle">AI Agent Build Prompt</h3>
                <div class="modal-actions">
                    <button class="modal-btn copy" onclick="copyPromptToClipboard()">Copy Prompt</button>
                    <button class="modal-btn close" onclick="closePromptModal()">Close</button>
                </div>
            </div>
            <div class="modal-body">
                <div class="prompt-tags" id="promptTags"></div>
                <div class="prompt-section">
                    <h4>Agent Purpose</h4>
                    <div class="prompt-box" id="promptPurpose"></div>
                </div>
                <div class="prompt-section">
                    <h4>Full Build Prompt</h4>
                    <div class="prompt-box" id="promptContent"></div>
                </div>
                <div class="prompt-section">
                    <h4>Integration Points</h4>
                    <div class="prompt-box" id="promptIntegration"></div>
                </div>
            </div>
        </div>
    </div>

    <div class="copy-success" id="copySuccess">Copied to clipboard!</div>

    <script>
        // Tab switching
        function switchTab(tab) {
            document.querySelectorAll('.sidebar-tab').forEach(t => t.classList.remove('active'));
            document.querySelectorAll('.tab-panel').forEach(p => p.classList.remove('active'));

            if (tab === 'workflow') {
                document.querySelector('.sidebar-tab:not(.agent-tab)').classList.add('active');
                document.getElementById('workflow-panel').classList.add('active');
                document.getElementById('workflow-nav').style.display = 'block';
                document.getElementById('agents-nav').style.display = 'none';
            } else {
                document.querySelector('.sidebar-tab.agent-tab').classList.add('active');
                document.getElementById('agents-panel').classList.add('active');
                document.getElementById('workflow-nav').style.display = 'none';
                document.getElementById('agents-nav').style.display = 'block';
            }

            window.scrollTo(0, 0);
        }

        // Scroll spy with isScrolling flag and 1000ms timeout
        const sections = document.querySelectorAll('.section, .quick-ref');
        const navItems = document.querySelectorAll('#workflow-nav .nav-item');
        let isScrolling = false;
        let scrollTimeout;

        function updateActiveNav() {
            if (isScrolling) return;

            let current = '';
            sections.forEach(section => {
                const sectionTop = section.offsetTop - 100;
                if (window.scrollY >= sectionTop) current = section.getAttribute('id');
            });
            navItems.forEach(item => {
                item.classList.remove('active');
                if (item.getAttribute('href') === '#' + current) item.classList.add('active');
            });
        }

        // Handle nav click to temporarily disable scroll spy
        navItems.forEach(item => {
            item.addEventListener('click', function(e) {
                isScrolling = true;
                clearTimeout(scrollTimeout);

                // Remove active from all, add to clicked
                navItems.forEach(nav => nav.classList.remove('active'));
                this.classList.add('active');

                // Re-enable scroll spy after 1000ms
                scrollTimeout = setTimeout(() => {
                    isScrolling = false;
                }, 1000);
            });
        });

        window.addEventListener('scroll', updateActiveNav);

        // Modal
        function openDocModal() {
            document.getElementById('docModal').classList.add('show');
            document.body.style.overflow = 'hidden';
        }

        function closeDocModal() {
            document.getElementById('docModal').classList.remove('show');
            document.body.style.overflow = '';
        }

        async function copyToClipboard() {
            try {
                await navigator.clipboard.writeText(document.getElementById('docContent').textContent);
                const success = document.getElementById('copySuccess');
                success.style.display = 'block';
                setTimeout(() => { success.style.display = 'none'; }, 2000);
            } catch (e) { alert('Failed to copy.'); }
        }

        document.addEventListener('keydown', (e) => { if (e.key === 'Escape') { closeDocModal(); closePromptModal(); } });
        document.getElementById('docModal').addEventListener('click', (e) => { if (e.target.id === 'docModal') closeDocModal(); });

        document.addEventListener('DOMContentLoaded', () => { updateActiveNav(); });

        // Scroll to agent card and highlight
        function scrollToAgent(agentId) {
            const agentCard = document.getElementById(agentId);
            if (agentCard) {
                document.querySelectorAll('.agent-card.highlight').forEach(card => {
                    card.classList.remove('highlight');
                });

                agentCard.scrollIntoView({ behavior: 'smooth', block: 'center' });

                setTimeout(() => {
                    agentCard.classList.add('highlight');
                }, 300);

                setTimeout(() => {
                    agentCard.classList.remove('highlight');
                }, 2500);
            }
        }

        // Agent Prompt System
        const agentPrompts = {
            doccheck: {
                name: 'TBD Doc Checker',
                tags: ['Document Validation', 'Quality Control', 'Medium Complexity', 'Critical Priority'],
                purpose: `This agent automatically validates that all required TBD checklist documents are present in Clear Docs before submission to Operations. It checks for borrower qualifications, credit documentation, income documents, and assets based on the specific loan scenario and borrower characteristics.`,
                prompt: `You are building a Document Validation Agent for CMG Financial's TBD Checklist process.

AGENT NAME: TBD Doc Checker
TYPE: Document Validation / Quality Control

OBJECTIVE:
Automatically validate that all required TBD checklist documents are present in Clear Docs before the Loan Officer emails the Processor for submission.

INPUT DATA:
- Loan Number
- Borrower employment type (W-2/Self-Employed)
- Loan type (Conventional/FHA/VA/Jumbo/AIO)
- Credit report data (for identifying required docs)

CHECKLIST VALIDATION RULES:

1. BORROWER QUALIFICATIONS:
   [ ] 2-year residency history in URLA
   [ ] Citizenship status documented
   [ ] Declarations complete (all questions answered)
   [ ] HMDA data populated

2. CREDIT DOCUMENTS (Conditional):
   [ ] Credit inquiry LOX (if inquiries within 120 days)
   [ ] Omitted liabilities LOX (if debts identified)
   [ ] BK discharge/schedules (if bankruptcy on record)
   [ ] Student loan docs (if deferred loans present)

3. INCOME - W-2/SALARIED:
   [ ] Paystub dated within 30 days
   [ ] W-2s for 2 years
   [ ] Tax returns (if variable income)
   [ ] WVOE (if variable income)

4. INCOME - SELF-EMPLOYED:
   [ ] LoanBeam findings report
   [ ] 2 years tax returns (personal + business)
   [ ] YTD Profit & Loss statement

5. ASSETS:
   [ ] 60-day bank statements OR AccountChek
   [ ] 90-day statements (if AIO/Jumbo + self-employed)
   [ ] Large deposit documentation (if applicable)

OUTPUT:
{
  "loan_number": "2026-001234",
  "validation_status": "INCOMPLETE",
  "missing_documents": [
    {"category": "Income", "document": "W-2 (2024)", "required": true},
    {"category": "Credit", "document": "Credit Inquiry LOX", "required": true}
  ],
  "warnings": [
    "Paystub is 28 days old - refresh soon"
  ],
  "ready_for_submission": false
}`,
                integration: `INTEGRATION POINTS:
1. Byte Clear Docs API
   - Query document inventory
   - Check document types and dates
   - Validate document categorization

2. Credit Report Data
   - Parse for inquiries, derogatory items
   - Identify student loans, bankruptcy
   - Flag items requiring documentation

3. URLA/1003 Data
   - Employment type detection
   - Residency history validation
   - Declaration completion check

4. Notification System
   - Email missing doc list to LO
   - Dashboard indicator for status
   - Checklist PDF generation`
            },
            creditanalyzer: {
                name: 'Credit Analyzer',
                tags: ['Credit Analysis', 'AI/ML', 'Medium Complexity', 'High Priority'],
                purpose: `This agent analyzes credit report data to automatically identify items that require supporting documentation for the TBD submission. It detects credit inquiries, omitted liabilities, bankruptcy history, and deferred student loans, then generates a prioritized documentation requirements list.`,
                prompt: `You are building a Credit Analysis Agent for CMG Financial's TBD Checklist process.

AGENT NAME: Credit Analyzer
TYPE: Credit Analysis / Document Mapping

OBJECTIVE:
Analyze credit report data to identify items requiring documentation and generate a prioritized list of required documents for TBD submission.

INPUT DATA:
- Credit report XML/JSON from bureau
- Borrower SSN (for matching)
- Loan type (for guideline-specific rules)

ANALYSIS RULES:

1. CREDIT INQUIRIES:
   - Identify inquiries within 120 days
   - Flag mortgage inquiries (may indicate other applications)
   - Flag auto/credit card inquiries (potential new debt)
   - OUTPUT: Require Credit Inquiry LOX

2. OMITTED LIABILITIES:
   - Cross-reference declared debts vs credit report
   - Identify accounts not in URLA
   - Flag joint accounts where borrower is authorized user
   - OUTPUT: Require Omitted Liabilities LOX

3. BANKRUPTCY:
   - Detect BK public record
   - Identify BK type (7, 11, 13)
   - Calculate seasoning from discharge date
   - OUTPUT: Require BK Discharge + Schedules

4. STUDENT LOANS:
   - Identify student loan tradelines
   - Check payment status (current, deferred, IBR)
   - Flag deferred loans (special calculation needed)
   - OUTPUT: Require student loan documentation

5. DEROGATORY CREDIT:
   - Collections, charge-offs, judgments
   - Late payment history
   - Foreclosure/short sale history
   - OUTPUT: May require LOX or payoff documentation

OUTPUT FORMAT:
{
  "credit_score": 720,
  "analysis_date": "2026-01-27",
  "findings": [
    {
      "type": "INQUIRY",
      "description": "3 mortgage inquiries in last 90 days",
      "required_doc": "Credit Inquiry Letter of Explanation",
      "priority": "HIGH"
    },
    {
      "type": "STUDENT_LOAN",
      "description": "2 deferred student loans totaling $45,000",
      "required_doc": "Student loan statements showing payment/deferment status",
      "priority": "HIGH",
      "calculation_note": "Use 0.5% of balance for agency calculation if no payment documented"
    }
  ],
  "total_issues": 2,
  "docs_required": 2
}`,
                integration: `INTEGRATION POINTS:
1. Credit Bureau Integration
   - Parse Equifax/Experian/TransUnion XML
   - Extract tradelines, public records, inquiries
   - Handle soft-pull vs hard-pull data

2. Byte LOS Integration
   - Compare credit data to URLA liabilities
   - Flag discrepancies automatically
   - Update condition tracking

3. Document Generation
   - Auto-generate LOX templates
   - Pre-fill known information
   - Route to borrower via secure portal

4. Compliance Engine
   - Apply agency-specific rules
   - Calculate student loan payments per guidelines
   - Flag items requiring UW review`
            },
            incomevalidator: {
                name: 'Income Validator',
                tags: ['Document Validation', 'Income Analysis', 'Low Complexity', 'High Priority'],
                purpose: `This agent validates income documentation completeness based on employment type. It verifies paystub currency, W-2 coverage periods, tax return completeness, and LoanBeam findings for self-employed borrowers. Ensures all required income docs are present before TBD submission.`,
                prompt: `You are building an Income Validation Agent for CMG Financial's TBD Checklist process.

AGENT NAME: Income Validator
TYPE: Document Validation / Income Analysis

OBJECTIVE:
Validate that income documentation is complete and current based on borrower employment type before TBD submission.

INPUT DATA:
- Employment type (W-2, Self-Employed, Both)
- Income type (Salary, Hourly, Variable, Commission, Bonus)
- Documents in Clear Docs with dates

VALIDATION RULES:

W-2/SALARIED INCOME:
1. Paystub Validation:
   - Must be dated within 30 days of submission
   - Must show 30 days of YTD earnings
   - Must match employer in URLA

2. W-2 Validation:
   - Must have 2 most recent tax years
   - Employer name must match paystub
   - Income amounts should be consistent (+/- 20%)

3. Variable Income (Bonus/Commission/OT):
   - Requires WVOE in addition to above
   - May require tax returns for 2-year history

SELF-EMPLOYED INCOME:
1. LoanBeam Findings:
   - Must be present and current
   - Income calculation must be documented

2. Tax Returns:
   - Personal returns (2 years)
   - Business returns if applicable (2 years)
   - All schedules included (Schedule C, K-1, etc.)

3. Profit & Loss Statement:
   - YTD P&L required
   - Must be prepared by CPA or signed by borrower

DATE VALIDATION:
- Paystub: Within 30 days
- W-2s: Most recent 2 tax years
- Tax Returns: Most recent 2 tax years
- P&L: Current year, within 60 days

OUTPUT:
{
  "borrower": "John Smith",
  "employment_type": "Self-Employed",
  "validation_status": "INCOMPLETE",
  "income_docs": [
    {"doc": "2024 Tax Return", "status": "PRESENT", "valid": true},
    {"doc": "2023 Tax Return", "status": "PRESENT", "valid": true},
    {"doc": "LoanBeam Findings", "status": "MISSING", "valid": false},
    {"doc": "YTD P&L", "status": "PRESENT", "valid": true, "warning": "Dated 45 days ago"}
  ],
  "ready": false,
  "missing": ["LoanBeam Findings"]
}`,
                integration: `INTEGRATION POINTS:
1. Clear Docs Integration
   - Query income document inventory
   - Extract document dates and types
   - Validate document metadata

2. TRUV/LoanBeam Integration
   - Check for electronic verification status
   - Retrieve findings reports
   - Validate data currency

3. URLA Employment Data
   - Match employer names
   - Verify employment dates
   - Cross-reference income amounts

4. Alert System
   - Notify LO of missing docs
   - Warn of expiring documents
   - Track document refresh needs`
            },
            statustracker: {
                name: 'Status Tracker',
                tags: ['Monitoring', 'Alerts', 'Low Complexity', 'Medium Priority'],
                purpose: `This agent monitors all TBD loans in PreApproved status and sends proactive alerts when credit-only approvals are approaching expiration. It notifies Loan Officers and Processors to re-engage borrowers or refresh documentation before the approval expires.`,
                prompt: `You are building a Status Tracking Agent for CMG Financial's TBD Checklist process.

AGENT NAME: TBD Status Tracker
TYPE: Monitoring / Push Notifications

OBJECTIVE:
Monitor all TBD loans in PreApproved status and alert relevant parties when credit-only approvals are approaching expiration.

MONITORING SCOPE:
- All loans in "PreApproved" status
- Loans with "Credit Only" approval type
- Filter by branch/LO for targeted alerts

EXPIRATION RULES:
- Credit-only approvals typically valid 90-120 days
- Refresh required before expiration
- Some documentation may expire earlier (credit report, income docs)

ALERT THRESHOLDS:
- 30 days: INFO - "Approval expires in 30 days"
- 14 days: WARNING - "Approval expires soon - contact borrower"
- 7 days: URGENT - "Immediate action required"
- 0 days: CRITICAL - "Approval EXPIRED - loan no longer preapproved"

DOCUMENT EXPIRATION TRACKING:
- Credit Report: Per investor guidelines
- Paystubs: 30 days from date
- Bank Statements: 60 days from statement date
- VVOE: Per investor guidelines

ALERT CONTENT:
{
  "loan_number": "2026-001234",
  "borrower_name": "John Smith",
  "preapproval_date": "2026-01-15",
  "expiration_date": "2026-04-15",
  "days_remaining": 14,
  "alert_level": "WARNING",
  "loan_officer": "Jane Doe",
  "processor": "Bob Johnson",
  "expiring_docs": [
    {"doc": "Paystub", "expires": "2026-01-30"},
    {"doc": "Credit Report", "expires": "2026-04-15"}
  ],
  "recommended_action": "Contact borrower to check property search status. Refresh paystub if extending approval."
}

BATCH PROCESSING:
- Run daily at 7:00 AM
- Group alerts by LO for digest email
- Escalate unacknowledged warnings`,
                integration: `INTEGRATION POINTS:
1. Byte LOS Database
   - Query loans by status
   - Track approval dates
   - Monitor document expiration

2. Notification Services
   - Email alerts to LO/Processor
   - Dashboard notifications
   - Weekly digest reports

3. CRM Integration
   - Trigger borrower follow-up tasks
   - Log contact attempts
   - Track borrower engagement

4. Reporting
   - TBD pipeline aging report
   - Expiration risk dashboard
   - Conversion rate tracking (TBD to funded)`
            }
        };

        // Show agent prompt modal
        let currentPromptContent = '';

        function showAgentPrompt(agentKey) {
            const agent = agentPrompts[agentKey];
            if (!agent) return;

            document.getElementById('promptModalTitle').textContent = agent.name + ' - Build Prompt';

            const tagsHtml = agent.tags.map(tag => '<span class="prompt-tag">' + tag + '</span>').join('');
            document.getElementById('promptTags').innerHTML = tagsHtml;

            document.getElementById('promptPurpose').textContent = agent.purpose;
            document.getElementById('promptContent').textContent = agent.prompt;
            document.getElementById('promptIntegration').textContent = agent.integration;

            currentPromptContent = '# ' + agent.name + '\n\n## Purpose\n' + agent.purpose + '\n\n## Build Prompt\n' + agent.prompt + '\n\n## Integration Points\n' + agent.integration;

            document.getElementById('promptModal').classList.add('show');
            document.body.style.overflow = 'hidden';
        }

        function closePromptModal() {
            document.getElementById('promptModal').classList.remove('show');
            document.body.style.overflow = '';
        }

        async function copyPromptToClipboard() {
            try {
                await navigator.clipboard.writeText(currentPromptContent);
                const success = document.getElementById('copySuccess');
                success.style.display = 'block';
                setTimeout(() => { success.style.display = 'none'; }, 2000);
            } catch (e) {
                alert('Failed to copy prompt.');
            }
        }

        document.getElementById('promptModal').addEventListener('click', (e) => {
            if (e.target.id === 'promptModal') closePromptModal();
        });
    </script>
</body>
</html>
