<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Who's Who in the Mortgage Process - Workflow Guide</title>
    <link href="https://fonts.googleapis.com/css2?family=Plus+Jakarta+Sans:wght@400;500;600;700;800&family=JetBrains+Mono:wght@400;500&display=swap" rel="stylesheet">
    <style>
        :root {
            --bg-primary: #0a0f1a;
            --bg-secondary: #111827;
            --bg-card: #1a2234;
            --accent-blue: #3b82f6;
            --accent-teal: #14b8a6;
            --accent-amber: #f59e0b;
            --accent-rose: #f43f5e;
            --accent-green: #22c55e;
            --accent-purple: #8b5cf6;
            --text-primary: #f1f5f9;
            --text-secondary: #94a3b8;
            --text-muted: #64748b;
            --border-subtle: rgba(255,255,255,0.08);
            --sidebar-width: 280px;
        }

        * { box-sizing: border-box; margin: 0; padding: 0; }
        html { scroll-behavior: smooth; }
        body {
            font-family: 'Plus Jakarta Sans', -apple-system, BlinkMacSystemFont, sans-serif;
            background: var(--bg-primary);
            color: var(--text-primary);
            min-height: 100vh;
        }

        /* Breadcrumb */
        .breadcrumb {
            background: linear-gradient(90deg, #0d1525 0%, #1a2234 100%);
            padding: 14px 25px;
            display: flex;
            align-items: center;
            gap: 12px;
            font-size: 0.95rem;
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            z-index: 1001;
            border-bottom: 1px solid var(--border-subtle);
        }

        .breadcrumb a {
            color: var(--text-secondary);
            text-decoration: none;
            font-weight: 600;
            padding: 8px 16px;
            background: rgba(255,255,255,0.05);
            border-radius: 8px;
            transition: all 0.2s;
            border: 1px solid var(--border-subtle);
        }

        .breadcrumb a:hover {
            background: rgba(59, 130, 246, 0.15);
            color: var(--accent-blue);
            border-color: rgba(59, 130, 246, 0.3);
        }

        .breadcrumb .separator { color: var(--text-muted); font-size: 1.2rem; }
        .breadcrumb .current { color: var(--accent-amber); font-weight: 600; padding: 8px 16px; }

        /* Sidebar */
        .sidebar {
            position: fixed;
            top: 54px;
            left: 0;
            width: var(--sidebar-width);
            height: calc(100vh - 54px);
            background: var(--bg-secondary);
            overflow-y: auto;
            z-index: 1000;
            border-right: 1px solid var(--border-subtle);
            display: flex;
            flex-direction: column;
        }

        .sidebar-header {
            padding: 25px 20px;
            background: rgba(0,0,0,0.3);
            border-bottom: 1px solid var(--border-subtle);
        }

        .sidebar-header h2 { color: var(--text-primary); font-size: 1.2rem; font-weight: 700; margin-bottom: 5px; }
        .sidebar-header p { color: var(--text-muted); font-size: 0.85rem; }

        /* Tab Switch */
        .sidebar-tabs {
            display: flex;
            border-bottom: 1px solid var(--border-subtle);
        }

        .sidebar-tab {
            flex: 1;
            padding: 14px 10px;
            text-align: center;
            font-size: 0.8rem;
            font-weight: 700;
            color: var(--text-muted);
            cursor: pointer;
            transition: all 0.2s;
            border-bottom: 3px solid transparent;
            background: none;
            border-left: none;
            border-right: none;
            border-top: none;
        }

        .sidebar-tab:hover { background: rgba(255,255,255,0.03); color: var(--text-secondary); }
        .sidebar-tab.active { color: var(--accent-blue); border-bottom-color: var(--accent-blue); background: rgba(59, 130, 246, 0.08); }
        .sidebar-tab.agent-tab.active { color: var(--accent-purple); border-bottom-color: var(--accent-purple); background: rgba(139, 92, 246, 0.08); }

        .sidebar-nav { padding: 15px 0; flex: 1; overflow-y: auto; }

        .nav-item {
            display: flex;
            align-items: center;
            gap: 12px;
            padding: 14px 20px;
            color: var(--text-secondary);
            text-decoration: none;
            border-left: 3px solid transparent;
            transition: all 0.2s ease;
            cursor: pointer;
        }

        .nav-item:hover { background: rgba(255,255,255,0.03); color: var(--text-primary); }
        .nav-item.active { background: rgba(59, 130, 246, 0.1); border-left-color: var(--accent-blue); color: var(--text-primary); }

        .nav-number {
            background: rgba(255,255,255,0.1);
            color: var(--text-secondary);
            width: 28px;
            height: 28px;
            border-radius: 8px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 700;
            font-size: 0.85rem;
            flex-shrink: 0;
        }

        .nav-item.active .nav-number { background: var(--accent-blue); color: white; }
        .nav-label { font-size: 0.95rem; font-weight: 500; }

        .sidebar-footer {
            padding: 20px;
            border-top: 1px solid var(--border-subtle);
            background: rgba(0,0,0,0.2);
        }

        .doc-btn {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
            width: 100%;
            padding: 14px 20px;
            background: linear-gradient(135deg, var(--accent-blue) 0%, var(--accent-teal) 100%);
            color: white;
            border: none;
            border-radius: 10px;
            font-weight: 600;
            cursor: pointer;
            transition: transform 0.2s, box-shadow 0.2s;
            text-decoration: none;
            font-size: 0.95rem;
        }

        .doc-btn:hover { transform: translateY(-2px); box-shadow: 0 8px 25px rgba(59, 130, 246, 0.3); }

        /* Main Content */
        .main-content { margin-left: var(--sidebar-width); padding: 80px 40px 40px 40px; }

        /* Tab Panels */
        .tab-panel { display: none; }
        .tab-panel.active { display: block; }

        .header {
            background: var(--bg-card);
            border: 1px solid var(--border-subtle);
            padding: 35px;
            border-radius: 16px;
            margin-bottom: 30px;
            position: relative;
            overflow: hidden;
        }

        .header::before {
            content: '';
            position: absolute;
            top: 0; left: 0; right: 0; bottom: 0;
            background:
                radial-gradient(ellipse at 20% 20%, rgba(59, 130, 246, 0.1) 0%, transparent 50%),
                radial-gradient(ellipse at 80% 80%, rgba(20, 184, 166, 0.08) 0%, transparent 50%);
            pointer-events: none;
        }

        .header h1 {
            font-size: 2.2rem;
            font-weight: 800;
            margin-bottom: 10px;
            position: relative;
            background: linear-gradient(135deg, var(--text-primary) 0%, var(--accent-blue) 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .header .subtitle { color: var(--text-secondary); font-size: 1.1rem; position: relative; }

        .header .meta { display: flex; gap: 15px; margin-top: 20px; flex-wrap: wrap; position: relative; }

        .header .meta-item {
            background: rgba(255,255,255,0.05);
            border: 1px solid var(--border-subtle);
            padding: 8px 16px;
            border-radius: 8px;
            font-size: 0.9rem;
            color: var(--text-secondary);
        }

        /* Legend */
        .legend {
            display: flex;
            flex-wrap: wrap;
            gap: 15px;
            padding: 18px 22px;
            background: var(--bg-card);
            border: 1px solid var(--border-subtle);
            border-radius: 12px;
            margin-bottom: 25px;
        }

        .legend-item { display: flex; align-items: center; gap: 8px; font-size: 0.85rem; color: var(--text-secondary); }
        .legend-color { width: 18px; height: 18px; border-radius: 4px; }

        /* Sections */
        .section {
            background: var(--bg-card);
            border: 1px solid var(--border-subtle);
            border-radius: 16px;
            margin-bottom: 25px;
            overflow: hidden;
            scroll-margin-top: 75px;
        }

        .section-header {
            background: linear-gradient(135deg, var(--bg-secondary) 0%, rgba(59, 130, 246, 0.1) 100%);
            border-bottom: 1px solid var(--border-subtle);
            padding: 22px 25px;
            display: flex;
            align-items: center;
            gap: 18px;
        }

        .section-number {
            background: linear-gradient(135deg, var(--accent-blue) 0%, var(--accent-teal) 100%);
            color: white;
            width: 48px;
            height: 48px;
            border-radius: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 800;
            font-size: 1.3rem;
            flex-shrink: 0;
        }

        .section-title h2 { font-size: 1.35rem; font-weight: 700; margin-bottom: 4px; color: var(--text-primary); }
        .section-title span { font-size: 0.9rem; color: var(--text-muted); }
        .section-content { padding: 28px; }

        /* Role Cards Grid */
        .role-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(320px, 1fr));
            gap: 20px;
            margin: 20px 0;
        }

        .role-card {
            background: rgba(0,0,0,0.3);
            border: 1px solid var(--border-subtle);
            border-radius: 12px;
            padding: 24px;
            transition: transform 0.2s, box-shadow 0.2s;
        }

        .role-card:hover {
            transform: translateY(-3px);
            box-shadow: 0 10px 30px rgba(0,0,0,0.3);
        }

        .role-card-header {
            display: flex;
            align-items: center;
            gap: 15px;
            margin-bottom: 15px;
            padding-bottom: 15px;
            border-bottom: 1px solid var(--border-subtle);
        }

        .role-icon {
            width: 50px;
            height: 50px;
            border-radius: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.4rem;
            font-weight: 700;
            flex-shrink: 0;
        }

        .role-icon.lender { background: linear-gradient(135deg, var(--accent-blue) 0%, #2563eb 100%); color: white; }
        .role-icon.real-estate { background: linear-gradient(135deg, var(--accent-green) 0%, #16a34a 100%); color: white; }
        .role-icon.service { background: linear-gradient(135deg, var(--accent-teal) 0%, #0d9488 100%); color: white; }
        .role-icon.closing { background: linear-gradient(135deg, var(--accent-purple) 0%, #7c3aed 100%); color: white; }
        .role-icon.insurance { background: linear-gradient(135deg, var(--accent-amber) 0%, #d97706 100%); color: white; }

        .role-name { font-size: 1.15rem; font-weight: 700; color: var(--text-primary); }
        .role-category { font-size: 0.8rem; color: var(--accent-blue); font-weight: 600; text-transform: uppercase; letter-spacing: 0.05em; }

        .role-description { color: var(--text-secondary); font-size: 0.95rem; line-height: 1.6; }

        /* Workflow Diagrams */
        .workflow-diagram {
            background: rgba(0,0,0,0.3);
            border: 1px solid var(--border-subtle);
            border-radius: 12px;
            padding: 28px;
            margin-bottom: 22px;
        }

        .flow-row { display: flex; align-items: center; justify-content: center; flex-wrap: wrap; gap: 12px; margin: 15px 0; }

        .flow-node {
            padding: 14px 22px;
            border-radius: 10px;
            text-align: center;
            font-size: 0.9rem;
            font-weight: 600;
            min-width: 150px;
            border: 1px solid var(--border-subtle);
        }

        .flow-node.start { background: linear-gradient(135deg, var(--accent-green) 0%, #16a34a 100%); color: white; border-radius: 25px; border: none; }
        .flow-node.action { background: linear-gradient(135deg, var(--accent-blue) 0%, #2563eb 100%); color: white; border: none; }
        .flow-node.decision { background: linear-gradient(135deg, var(--accent-amber) 0%, #d97706 100%); color: var(--bg-primary); border: none; }
        .flow-node.input { background: var(--bg-secondary); border: 2px solid var(--accent-blue); color: var(--text-primary); }
        .flow-node.output { background: linear-gradient(135deg, var(--accent-teal) 0%, #0d9488 100%); color: white; border: none; }
        .flow-node.exception { background: linear-gradient(135deg, var(--accent-rose) 0%, #dc2626 100%); color: white; border: none; }

        .flow-arrow { color: var(--accent-blue); font-size: 1.5rem; }
        .flow-arrow.down { transform: rotate(90deg); }

        .decision-branch { display: flex; gap: 40px; justify-content: center; margin: 20px 0; flex-wrap: wrap; }
        .branch { display: flex; flex-direction: column; align-items: center; gap: 10px; }

        .branch-label {
            background: var(--bg-secondary);
            border: 1px solid var(--border-subtle);
            padding: 6px 16px;
            border-radius: 20px;
            font-size: 0.8rem;
            font-weight: 700;
            color: var(--text-secondary);
        }

        /* Tables */
        .field-table { width: 100%; border-collapse: collapse; margin: 18px 0; }

        .field-table th {
            background: rgba(59, 130, 246, 0.15);
            color: var(--accent-blue);
            padding: 14px 18px;
            text-align: left;
            font-weight: 600;
            font-size: 0.9rem;
            text-transform: uppercase;
            letter-spacing: 0.05em;
            border-bottom: 1px solid var(--border-subtle);
        }

        .field-table td { padding: 14px 18px; border-bottom: 1px solid var(--border-subtle); color: var(--text-secondary); }
        .field-table tr:hover { background: rgba(255,255,255,0.02); }

        .badge { display: inline-block; padding: 4px 12px; border-radius: 6px; font-size: 0.75rem; font-weight: 700; text-transform: uppercase; letter-spacing: 0.05em; }
        .badge.lender-badge { background: rgba(59, 130, 246, 0.15); color: var(--accent-blue); }
        .badge.service-badge { background: rgba(20, 184, 166, 0.15); color: var(--accent-teal); }
        .badge.real-estate-badge { background: rgba(34, 197, 94, 0.15); color: var(--accent-green); }
        .badge.closing-badge { background: rgba(139, 92, 246, 0.15); color: var(--accent-purple); }
        .badge.insurance-badge { background: rgba(245, 158, 11, 0.15); color: var(--accent-amber); }

        /* Info Boxes */
        .exception-box, .tip-box, .info-box {
            padding: 18px 22px;
            margin: 18px 0;
            border-radius: 0 10px 10px 0;
            border-left-width: 4px;
            border-left-style: solid;
        }

        .exception-box { background: rgba(244, 63, 94, 0.08); border-color: var(--accent-rose); border: 1px solid rgba(244, 63, 94, 0.2); border-left: 4px solid var(--accent-rose); }
        .exception-box h4 { color: var(--accent-rose); margin-bottom: 10px; font-size: 1rem; }
        .exception-box p, .exception-box li { color: var(--text-secondary); }

        .tip-box { background: rgba(34, 197, 94, 0.08); border-color: var(--accent-green); border: 1px solid rgba(34, 197, 94, 0.2); border-left: 4px solid var(--accent-green); }
        .tip-box h4 { color: var(--accent-green); margin-bottom: 10px; font-size: 1rem; }
        .tip-box p, .tip-box li { color: var(--text-secondary); }

        .info-box { background: rgba(59, 130, 246, 0.08); border-color: var(--accent-blue); border: 1px solid rgba(59, 130, 246, 0.2); border-left: 4px solid var(--accent-blue); }
        .info-box h4 { color: var(--accent-blue); margin-bottom: 10px; font-size: 1rem; }
        .info-box p, .info-box li { color: var(--text-secondary); }

        /* Step List */
        .step-list { list-style: none; padding: 0; margin: 18px 0; }
        .step-list li {
            padding: 14px 18px;
            border-left: 3px solid var(--accent-blue);
            background: rgba(0,0,0,0.2);
            margin-bottom: 10px;
            border-radius: 0 8px 8px 0;
            color: var(--text-secondary);
        }
        .step-list li strong { color: var(--text-primary); }

        /* Summary Grid */
        .summary-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(180px, 1fr)); gap: 18px; margin: 22px 0; }

        .summary-card { background: rgba(0,0,0,0.3); border: 1px solid var(--border-subtle); border-radius: 12px; padding: 22px; text-align: center; }
        .summary-card h4 { color: var(--text-secondary); margin-bottom: 12px; font-size: 0.9rem; }
        .summary-card .value {
            font-size: 2.2rem;
            font-weight: 800;
            background: linear-gradient(135deg, var(--accent-blue) 0%, var(--accent-teal) 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }
        .summary-card .label { font-size: 0.85rem; color: var(--text-muted); margin-top: 8px; }

        /* Quick Reference */
        .quick-ref {
            background: linear-gradient(135deg, var(--bg-secondary) 0%, var(--bg-card) 100%);
            border: 1px solid var(--border-subtle);
            padding: 28px;
            border-radius: 16px;
            margin-top: 30px;
            font-family: 'JetBrains Mono', monospace;
            scroll-margin-top: 75px;
        }

        .quick-ref h3 { color: var(--accent-amber); margin-bottom: 18px; font-family: 'Plus Jakarta Sans', sans-serif; }
        .quick-ref pre { background: rgba(0,0,0,0.4); border: 1px solid var(--border-subtle); padding: 20px; border-radius: 10px; overflow-x: auto; font-size: 0.85rem; line-height: 1.7; color: var(--text-secondary); }

        /* ====== AGENT OPPORTUNITIES STYLES ====== */
        .agent-header {
            background: var(--bg-card);
            border: 1px solid var(--border-subtle);
            padding: 35px;
            border-radius: 16px;
            margin-bottom: 30px;
            position: relative;
            overflow: hidden;
        }

        .agent-header::before {
            content: '';
            position: absolute;
            top: 0; left: 0; right: 0; bottom: 0;
            background:
                radial-gradient(ellipse at 20% 20%, rgba(139, 92, 246, 0.12) 0%, transparent 50%),
                radial-gradient(ellipse at 80% 80%, rgba(245, 158, 11, 0.1) 0%, transparent 50%);
            pointer-events: none;
        }

        .agent-header h1 {
            font-size: 2.2rem;
            font-weight: 800;
            margin-bottom: 10px;
            position: relative;
            background: linear-gradient(135deg, var(--accent-purple) 0%, var(--accent-amber) 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .agent-header .subtitle { color: var(--text-secondary); font-size: 1.1rem; position: relative; }

        /* Heat Map */
        .heat-map-container { margin-bottom: 35px; }
        .heat-map-title { font-size: 1.3rem; font-weight: 700; color: var(--text-primary); margin-bottom: 20px; display: flex; align-items: center; gap: 12px; }

        .heat-map-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
        }

        .heat-item {
            background: var(--bg-card);
            border: 1px solid var(--border-subtle);
            border-radius: 12px;
            padding: 20px;
            position: relative;
            overflow: hidden;
            transition: transform 0.2s, box-shadow 0.2s;
            cursor: pointer;
        }

        .heat-item:hover { transform: translateY(-3px); box-shadow: 0 10px 30px rgba(0,0,0,0.3); }
        .heat-item:active { transform: scale(0.98); }

        .heat-item::before {
            content: '';
            position: absolute;
            top: 0; left: 0; right: 0; height: 4px;
        }

        .heat-item.critical::before { background: linear-gradient(90deg, #ef4444, #f97316); }
        .heat-item.high::before { background: linear-gradient(90deg, #f97316, #eab308); }
        .heat-item.medium::before { background: linear-gradient(90deg, #eab308, #22c55e); }
        .heat-item.low::before { background: linear-gradient(90deg, #22c55e, #14b8a6); }

        .heat-score {
            position: absolute;
            top: 15px;
            right: 15px;
            font-size: 1.8rem;
            font-weight: 800;
        }

        .heat-item.critical .heat-score { color: #ef4444; }
        .heat-item.high .heat-score { color: #f97316; }
        .heat-item.medium .heat-score { color: #eab308; }
        .heat-item.low .heat-score { color: #22c55e; }

        .heat-name { font-size: 1rem; font-weight: 700; color: var(--text-primary); margin-bottom: 6px; padding-right: 50px; }
        .heat-desc { font-size: 0.85rem; color: var(--text-muted); margin-bottom: 12px; }

        .heat-metrics { display: flex; gap: 15px; margin-top: 12px; }
        .heat-metric { font-size: 0.75rem; color: var(--text-muted); }
        .heat-metric span { color: var(--text-secondary); font-weight: 600; }

        /* Agent Cards */
        .agent-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(380px, 1fr)); gap: 25px; margin-bottom: 35px; }

        .agent-card {
            background: var(--bg-card);
            border: 1px solid var(--border-subtle);
            border-radius: 16px;
            overflow: hidden;
            transition: transform 0.2s, box-shadow 0.2s;
        }

        .agent-card:hover { transform: translateY(-5px); box-shadow: 0 15px 50px rgba(0,0,0,0.3); }

        .agent-card.highlight {
            animation: highlightPulse 2s ease;
            box-shadow: 0 0 0 3px var(--accent-purple), 0 15px 50px rgba(139, 92, 246, 0.4);
        }

        @keyframes highlightPulse {
            0% { box-shadow: 0 0 0 3px var(--accent-purple), 0 15px 50px rgba(139, 92, 246, 0.6); }
            50% { box-shadow: 0 0 0 6px rgba(139, 92, 246, 0.5), 0 15px 50px rgba(139, 92, 246, 0.3); }
            100% { box-shadow: 0 0 0 0px transparent, 0 15px 50px rgba(0,0,0,0.3); }
        }

        .agent-card-header {
            padding: 22px;
            display: flex;
            align-items: flex-start;
            gap: 18px;
            border-bottom: 1px solid var(--border-subtle);
        }

        .agent-icon {
            width: 55px;
            height: 55px;
            background: linear-gradient(135deg, var(--accent-purple) 0%, var(--accent-blue) 100%);
            border-radius: 14px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.6rem;
            flex-shrink: 0;
        }

        .agent-info { flex: 1; }
        .agent-name { font-size: 1.15rem; font-weight: 700; color: var(--text-primary); margin-bottom: 5px; }
        .agent-type { font-size: 0.8rem; color: var(--accent-purple); font-weight: 600; text-transform: uppercase; letter-spacing: 0.05em; }

        .agent-priority {
            padding: 6px 12px;
            border-radius: 20px;
            font-size: 0.75rem;
            font-weight: 700;
            text-transform: uppercase;
        }

        .agent-priority.critical { background: rgba(239, 68, 68, 0.15); color: #ef4444; }
        .agent-priority.high { background: rgba(249, 115, 22, 0.15); color: #f97316; }
        .agent-priority.medium { background: rgba(234, 179, 8, 0.15); color: #eab308; }
        .agent-priority.low { background: rgba(34, 197, 94, 0.15); color: #22c55e; }

        .agent-card-body { padding: 22px; }
        .agent-description { font-size: 0.95rem; color: var(--text-secondary); line-height: 1.6; margin-bottom: 20px; }

        .agent-flow {
            background: rgba(0,0,0,0.3);
            border: 1px solid var(--border-subtle);
            border-radius: 10px;
            padding: 18px;
            margin-bottom: 20px;
        }

        .agent-flow-title { font-size: 0.85rem; color: var(--text-muted); margin-bottom: 12px; font-weight: 600; text-transform: uppercase; letter-spacing: 0.05em; }

        .agent-flow-diagram { display: flex; align-items: center; flex-wrap: wrap; gap: 8px; justify-content: center; }

        .agent-step {
            background: linear-gradient(135deg, var(--accent-purple) 0%, var(--accent-blue) 100%);
            color: white;
            padding: 8px 14px;
            border-radius: 6px;
            font-size: 0.8rem;
            font-weight: 600;
            white-space: nowrap;
        }

        .agent-arrow { color: var(--accent-purple); font-size: 1.2rem; }

        .agent-stats { display: grid; grid-template-columns: repeat(3, 1fr); gap: 12px; }

        .agent-stat {
            background: rgba(0,0,0,0.2);
            border-radius: 8px;
            padding: 12px;
            text-align: center;
        }

        .agent-stat-value {
            font-size: 1.3rem;
            font-weight: 800;
            background: linear-gradient(135deg, var(--accent-purple) 0%, var(--accent-amber) 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .agent-stat-label { font-size: 0.7rem; color: var(--text-muted); text-transform: uppercase; letter-spacing: 0.05em; margin-top: 4px; }

        /* View Prompt Button */
        .agent-prompt-btn {
            width: 100%;
            margin-top: 18px;
            padding: 14px 20px;
            background: linear-gradient(135deg, rgba(139, 92, 246, 0.2) 0%, rgba(59, 130, 246, 0.2) 100%);
            border: 1px solid rgba(139, 92, 246, 0.4);
            border-radius: 10px;
            color: var(--accent-purple);
            font-weight: 700;
            cursor: pointer;
            transition: all 0.2s;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
            font-size: 0.9rem;
        }

        .agent-prompt-btn:hover {
            background: linear-gradient(135deg, rgba(139, 92, 246, 0.3) 0%, rgba(59, 130, 246, 0.3) 100%);
            border-color: var(--accent-purple);
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(139, 92, 246, 0.25);
        }

        /* Summary Stats */
        .agent-summary {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin-bottom: 35px;
        }

        .agent-summary-card {
            background: var(--bg-card);
            border: 1px solid var(--border-subtle);
            border-radius: 14px;
            padding: 25px;
            text-align: center;
        }

        .agent-summary-value {
            font-size: 2.5rem;
            font-weight: 800;
            background: linear-gradient(135deg, var(--accent-purple) 0%, var(--accent-amber) 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .agent-summary-label { font-size: 0.9rem; color: var(--text-muted); margin-top: 8px; }

        /* Heat Map Legend */
        .heat-legend {
            display: flex;
            gap: 25px;
            padding: 18px 22px;
            background: var(--bg-card);
            border: 1px solid var(--border-subtle);
            border-radius: 12px;
            margin-bottom: 25px;
            flex-wrap: wrap;
        }

        .heat-legend-item { display: flex; align-items: center; gap: 10px; font-size: 0.9rem; color: var(--text-secondary); }
        .heat-legend-color { width: 24px; height: 24px; border-radius: 6px; }

        /* Modal */
        .modal-overlay {
            display: none;
            position: fixed;
            top: 0; left: 0; right: 0; bottom: 0;
            background: rgba(10, 15, 26, 0.9);
            z-index: 2000;
            justify-content: center;
            align-items: center;
            padding: 20px;
            backdrop-filter: blur(5px);
        }

        .modal-overlay.show { display: flex; }

        .modal {
            background: var(--bg-card);
            border: 1px solid var(--border-subtle);
            border-radius: 16px;
            width: 100%;
            max-width: 950px;
            max-height: 90vh;
            display: flex;
            flex-direction: column;
            box-shadow: 0 25px 80px rgba(0,0,0,0.5);
        }

        .modal-header {
            background: linear-gradient(135deg, var(--accent-blue) 0%, var(--accent-teal) 100%);
            color: white;
            padding: 22px 28px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            border-radius: 16px 16px 0 0;
        }

        .modal-header h3 { font-size: 1.25rem; font-weight: 700; }
        .modal-actions { display: flex; gap: 12px; }

        .modal-btn {
            padding: 10px 18px;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-weight: 700;
            transition: transform 0.2s;
            font-size: 0.9rem;
        }

        .modal-btn:hover { transform: scale(1.05); }
        .modal-btn.copy { background: white; color: var(--accent-blue); }
        .modal-btn.close { background: rgba(255,255,255,0.2); color: white; }

        .modal-body { padding: 28px; overflow-y: auto; flex: 1; }

        .modal-body pre {
            background: rgba(0,0,0,0.3);
            border: 1px solid var(--border-subtle);
            padding: 22px;
            border-radius: 10px;
            font-family: 'JetBrains Mono', monospace;
            font-size: 0.9rem;
            line-height: 1.7;
            white-space: pre-wrap;
            word-wrap: break-word;
            color: var(--text-secondary);
        }

        .copy-success {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: var(--accent-green);
            color: white;
            padding: 18px 35px;
            border-radius: 10px;
            font-weight: 700;
            z-index: 3000;
            display: none;
            animation: fadeInOut 2s ease;
        }

        @keyframes fadeInOut { 0%, 100% { opacity: 0; } 10%, 90% { opacity: 1; } }

        /* Prompt Modal */
        .prompt-modal .modal { max-width: 800px; }
        .prompt-modal .modal-header { background: linear-gradient(135deg, var(--accent-purple) 0%, var(--accent-blue) 100%); }

        .prompt-section { margin-bottom: 25px; }
        .prompt-section h4 { color: var(--accent-purple); font-size: 1rem; margin-bottom: 12px; display: flex; align-items: center; gap: 8px; }

        .prompt-box {
            background: rgba(0,0,0,0.4);
            border: 1px solid var(--border-subtle);
            border-radius: 10px;
            padding: 20px;
            font-family: 'JetBrains Mono', monospace;
            font-size: 0.85rem;
            line-height: 1.7;
            color: var(--text-secondary);
            white-space: pre-wrap;
            word-wrap: break-word;
        }

        .prompt-tags { display: flex; gap: 10px; flex-wrap: wrap; margin-bottom: 20px; }
        .prompt-tag { background: rgba(139, 92, 246, 0.15); color: var(--accent-purple); padding: 6px 14px; border-radius: 20px; font-size: 0.8rem; font-weight: 600; }

        @media (max-width: 900px) {
            .sidebar { display: none; }
            .main-content { margin-left: 0; padding: 75px 20px 30px 20px; }
            .agent-grid { grid-template-columns: 1fr; }
            .role-grid { grid-template-columns: 1fr; }
        }
        .breadcrumb-logo-link { display: inline-flex; align-items: center; padding: 4px 8px; background: rgba(255,255,255,0.08); border-radius: 8px; border: 1px solid rgba(255,255,255,0.12); transition: all 0.2s; flex-shrink: 0; margin-right: 4px; }
        .breadcrumb-logo-link:hover { background: rgba(255,255,255,0.15); }
        .breadcrumb-logo { height: 24px; width: auto; display: block; }
    </style>
</head>
<body>
    <!-- Breadcrumb -->
    <nav class="breadcrumb">
<a href="../../index.html" class="breadcrumb-logo-link"><img src="../../images/clear-ai-logo.png" alt="Clear AI" class="breadcrumb-logo"></a>
        <a href="../../index.html">Portal Home</a>
        <span class="separator">></span>
        <a href="./index.html">Mortgage Fundamentals</a>
        <span class="separator">></span>
        <span class="current">Who's Who in the Mortgage Process</span>
    </nav>

    <!-- Fixed Sidebar -->
    <aside class="sidebar">
        <div class="sidebar-header">
            <h2>Who's Who Guide</h2>
            <p>Mortgage Process Participants</p>
        </div>

        <!-- Tab Switcher -->
        <div class="sidebar-tabs">
            <button class="sidebar-tab active" onclick="switchTab('workflow')">Workflow</button>
            <button class="sidebar-tab agent-tab" onclick="switchTab('agents')">AI Agents</button>
        </div>

        <!-- Workflow Navigation -->
        <nav class="sidebar-nav" id="workflow-nav">
            <a href="#section-1" class="nav-item active">
                <span class="nav-number">1</span>
                <span class="nav-label">Overview</span>
            </a>
            <a href="#section-2" class="nav-item">
                <span class="nav-number">2</span>
                <span class="nav-label">Lender Team</span>
            </a>
            <a href="#section-3" class="nav-item">
                <span class="nav-number">3</span>
                <span class="nav-label">Real Estate Professionals</span>
            </a>
            <a href="#section-4" class="nav-item">
                <span class="nav-number">4</span>
                <span class="nav-label">Service Providers</span>
            </a>
            <a href="#section-5" class="nav-item">
                <span class="nav-number">5</span>
                <span class="nav-label">Insurance & Closing</span>
            </a>
            <a href="#section-6" class="nav-item">
                <span class="nav-number">6</span>
                <span class="nav-label">Process Flow</span>
            </a>
            <a href="#quick-ref" class="nav-item">
                <span class="nav-number">*</span>
                <span class="nav-label">Quick Reference</span>
            </a>
        </nav>

        <!-- Agent Navigation -->
        <nav class="sidebar-nav" id="agents-nav" style="display: none;">
            <a href="#agent-summary" class="nav-item active">
                <span class="nav-number">S</span>
                <span class="nav-label">Summary</span>
            </a>
            <a href="#agent-heatmap" class="nav-item">
                <span class="nav-number">H</span>
                <span class="nav-label">Heat Map</span>
            </a>
            <a href="#agent-details" class="nav-item">
                <span class="nav-number">A</span>
                <span class="nav-label">Agent Details</span>
            </a>
        </nav>

        <div class="sidebar-footer">
            <button class="doc-btn" onclick="openDocModal()">
                View Workflow Markdown
            </button>
        </div>
    </aside>

    <!-- Main Content -->
    <main class="main-content">

        <!-- ==================== WORKFLOW TAB ==================== -->
        <div id="workflow-panel" class="tab-panel active">
            <!-- Header -->
            <div class="header">
                <h1>Who's Who in the Mortgage Process</h1>
                <p class="subtitle">Complete guide to understanding all the key participants involved in a mortgage transaction</p>
                <div class="meta">
                    <span class="meta-item">Source: Enact Mortgage Insurance</span>
                    <span class="meta-item">Audience: First-Time Homebuyers</span>
                    <span class="meta-item">11 Key Roles</span>
                    <span class="meta-item">CMG Home Loans</span>
                </div>
            </div>

            <!-- Legend -->
            <div class="legend">
                <div class="legend-item"><div class="legend-color" style="background: linear-gradient(135deg, #3b82f6, #2563eb);"></div><span>Lender Team</span></div>
                <div class="legend-item"><div class="legend-color" style="background: linear-gradient(135deg, #22c55e, #16a34a);"></div><span>Real Estate</span></div>
                <div class="legend-item"><div class="legend-color" style="background: linear-gradient(135deg, #14b8a6, #0d9488);"></div><span>Service Providers</span></div>
                <div class="legend-item"><div class="legend-color" style="background: linear-gradient(135deg, #8b5cf6, #7c3aed);"></div><span>Closing</span></div>
                <div class="legend-item"><div class="legend-color" style="background: linear-gradient(135deg, #f59e0b, #d97706);"></div><span>Insurance</span></div>
            </div>

            <!-- Section 1: Overview -->
            <section id="section-1" class="section">
                <div class="section-header">
                    <div class="section-number">1</div>
                    <div class="section-title"><h2>Overview</h2><span>Understanding the mortgage process participants</span></div>
                </div>
                <div class="section-content">
                    <div class="info-box">
                        <h4>Why Understanding Roles Matters</h4>
                        <p>The mortgage process involves many professionals working together to help you achieve homeownership. Understanding each person's role helps first-time homebuyers navigate the process with confidence and know who to contact for specific questions.</p>
                    </div>

                    <div class="summary-grid">
                        <div class="summary-card">
                            <h4>Lender Team</h4>
                            <div class="value">4</div>
                            <div class="label">Key Roles</div>
                        </div>
                        <div class="summary-card">
                            <h4>Real Estate</h4>
                            <div class="value">2</div>
                            <div class="label">Professionals</div>
                        </div>
                        <div class="summary-card">
                            <h4>Service Providers</h4>
                            <div class="value">2</div>
                            <div class="label">Specialists</div>
                        </div>
                        <div class="summary-card">
                            <h4>Insurance & Closing</h4>
                            <div class="value">3</div>
                            <div class="label">Participants</div>
                        </div>
                    </div>

                    <div class="tip-box">
                        <h4>Private Mortgage Insurance (PMI)</h4>
                        <p><strong>Homeownership doesn't have to be a dream.</strong> Private mortgage insurance can get you into a house faster with less than a 20% down payment. Talk to your loan officer to learn more about the value of mortgage insurance from Enact.</p>
                    </div>
                </div>
            </section>

            <!-- Section 2: Lender Team -->
            <section id="section-2" class="section">
                <div class="section-header">
                    <div class="section-number">2</div>
                    <div class="section-title"><h2>Lender Team</h2><span>The professionals at your lending institution</span></div>
                </div>
                <div class="section-content">
                    <div class="role-grid">
                        <div class="role-card">
                            <div class="role-card-header">
                                <div class="role-icon lender">LO</div>
                                <div>
                                    <div class="role-name">Loan Officer</div>
                                    <div class="role-category">Primary Contact</div>
                                </div>
                            </div>
                            <div class="role-description">
                                A Loan Officer represents one lending institution and their loan programs. They help you choose the best mortgage loan based upon your situation and will help you complete the loan application.
                            </div>
                        </div>

                        <div class="role-card">
                            <div class="role-card-header">
                                <div class="role-icon lender">LP</div>
                                <div>
                                    <div class="role-name">Loan Processor</div>
                                    <div class="role-category">Application Processing</div>
                                </div>
                            </div>
                            <div class="role-description">
                                A Loan Processor is one who gathers, administers, and processes your loan application before it gets the approval of a loan underwriter. This individual is essential to getting your mortgage loan request to the final close.
                            </div>
                        </div>

                        <div class="role-card">
                            <div class="role-card-header">
                                <div class="role-icon lender">UW</div>
                                <div>
                                    <div class="role-name">Underwriter</div>
                                    <div class="role-category">Risk Evaluation</div>
                                </div>
                            </div>
                            <div class="role-description">
                                A worker who evaluates and determines the risk for potential clients when applying for a mortgage. They may decide whether and under what terms to provide the mortgage.
                            </div>
                        </div>

                        <div class="role-card">
                            <div class="role-card-header">
                                <div class="role-icon lender">ML</div>
                                <div>
                                    <div class="role-name">Mortgage Lender</div>
                                    <div class="role-category">Financial Institution</div>
                                </div>
                            </div>
                            <div class="role-description">
                                A financial institution that issues loans. Unlike brokers, lenders control the whole process, from underwriting to funding.
                            </div>
                        </div>
                    </div>

                    <table class="field-table">
                        <thead>
                            <tr>
                                <th>Role</th>
                                <th>Primary Function</th>
                                <th>When to Contact</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td><strong>Loan Officer</strong></td>
                                <td>Loan selection and application assistance</td>
                                <td>Initial questions, loan options, application help</td>
                            </tr>
                            <tr>
                                <td><strong>Loan Processor</strong></td>
                                <td>Document gathering and file preparation</td>
                                <td>Document requests, status updates</td>
                            </tr>
                            <tr>
                                <td><strong>Underwriter</strong></td>
                                <td>Risk assessment and loan approval</td>
                                <td>Condition clarification (via processor)</td>
                            </tr>
                            <tr>
                                <td><strong>Mortgage Lender</strong></td>
                                <td>Loan funding and closing</td>
                                <td>Funding questions, rate locks</td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </section>

            <!-- Section 3: Real Estate Professionals -->
            <section id="section-3" class="section">
                <div class="section-header">
                    <div class="section-number">3</div>
                    <div class="section-title"><h2>Real Estate Professionals</h2><span>Your guides to finding and purchasing property</span></div>
                </div>
                <div class="section-content">
                    <div class="role-grid">
                        <div class="role-card">
                            <div class="role-card-header">
                                <div class="role-icon real-estate">RA</div>
                                <div>
                                    <div class="role-name">Real Estate Agent</div>
                                    <div class="role-category">Buyer/Seller Representative</div>
                                </div>
                            </div>
                            <div class="role-description">
                                A real estate agent is a person who acts as an intermediary between sellers and buyers of real estate/real property and attempts to find sellers who wish to sell and buyers who wish to buy. They can often provide helpful and specific community information such as shopping, transportation, and schools.
                            </div>
                        </div>

                        <div class="role-card">
                            <div class="role-card-header">
                                <div class="role-icon real-estate">RB</div>
                                <div>
                                    <div class="role-name">Real Estate Broker</div>
                                    <div class="role-category">Licensed Professional</div>
                                </div>
                            </div>
                            <div class="role-description">
                                A broker is a licensed real estate professional who represents the sellers or buyers of a property, and can typically help determine the market values of properties. While a broker may work independently and has the ability to manage their own firm, an agent usually works under a licensed broker to represent clients.
                            </div>
                        </div>
                    </div>

                    <div class="info-box">
                        <h4>Agent vs. Broker: Key Differences</h4>
                        <ul style="margin-top: 10px; margin-left: 20px;">
                            <li><strong>Real Estate Agent:</strong> Works under a licensed broker, represents clients in property transactions</li>
                            <li><strong>Real Estate Broker:</strong> Higher level of licensing, can work independently or manage their own firm</li>
                            <li>Both can help with property searches, market analysis, and transaction negotiations</li>
                        </ul>
                    </div>

                    <div class="tip-box">
                        <h4>Community Knowledge</h4>
                        <p>Real estate professionals can provide valuable insights about neighborhoods including shopping options, transportation accessibility, school districts, and local amenities. Don't hesitate to ask about community-specific information!</p>
                    </div>
                </div>
            </section>

            <!-- Section 4: Service Providers -->
            <section id="section-4" class="section">
                <div class="section-header">
                    <div class="section-number">4</div>
                    <div class="section-title"><h2>Service Providers</h2><span>Specialists who evaluate and assess the property</span></div>
                </div>
                <div class="section-content">
                    <div class="role-grid">
                        <div class="role-card">
                            <div class="role-card-header">
                                <div class="role-icon service">AP</div>
                                <div>
                                    <div class="role-name">Appraiser</div>
                                    <div class="role-category">Value Assessment</div>
                                </div>
                            </div>
                            <div class="role-description">
                                An individual who is licensed to estimate the worth (fair market value) of the property you are purchasing. The appraisal helps ensure the loan amount is appropriate for the property's value.
                            </div>
                        </div>

                        <div class="role-card">
                            <div class="role-card-header">
                                <div class="role-icon service">PI</div>
                                <div>
                                    <div class="role-name">Property Inspector</div>
                                    <div class="role-category">Condition Assessment</div>
                                </div>
                            </div>
                            <div class="role-description">
                                An individual certified to conduct an examination of the home. An inspector will look for issues that may affect the value of the property and can assess the condition of a property's roof, foundation, heating and cooling systems, plumbing, electrical work, water and sewage, and some safety issues.
                            </div>
                        </div>
                    </div>

                    <table class="field-table">
                        <thead>
                            <tr>
                                <th>Service Provider</th>
                                <th>What They Evaluate</th>
                                <th>Why It Matters</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td><strong>Appraiser</strong></td>
                                <td>Fair market value of the property</td>
                                <td>Ensures loan amount is appropriate; protects both buyer and lender</td>
                            </tr>
                            <tr>
                                <td><strong>Property Inspector</strong></td>
                                <td>Physical condition and safety</td>
                                <td>Identifies issues before purchase; helps negotiate repairs</td>
                            </tr>
                        </tbody>
                    </table>

                    <div class="exception-box">
                        <h4>Property Inspector Assessment Areas</h4>
                        <ul style="margin-top: 10px; margin-left: 20px;">
                            <li>Roof condition and integrity</li>
                            <li>Foundation and structural elements</li>
                            <li>Heating and cooling systems (HVAC)</li>
                            <li>Plumbing systems</li>
                            <li>Electrical work</li>
                            <li>Water and sewage systems</li>
                            <li>Safety issues and concerns</li>
                        </ul>
                    </div>
                </div>
            </section>

            <!-- Section 5: Insurance & Closing -->
            <section id="section-5" class="section">
                <div class="section-header">
                    <div class="section-number">5</div>
                    <div class="section-title"><h2>Insurance & Closing</h2><span>Professionals who finalize and protect your investment</span></div>
                </div>
                <div class="section-content">
                    <div class="role-grid">
                        <div class="role-card">
                            <div class="role-card-header">
                                <div class="role-icon insurance">MI</div>
                                <div>
                                    <div class="role-name">Mortgage Insurer</div>
                                    <div class="role-category">Risk Protection</div>
                                </div>
                            </div>
                            <div class="role-description">
                                By compensating the lender for losses should a borrower be unable to make payments, Mortgage Insurance allows a borrower to get into a home without having to come up with a 20% down payment. Many Mortgage Insurers, such as Enact Mortgage Insurance, can assist borrowers if they become behind in their mortgage payments.
                            </div>
                        </div>

                        <div class="role-card">
                            <div class="role-card-header">
                                <div class="role-icon closing">CA</div>
                                <div>
                                    <div class="role-name">Closing or Settlement Agent</div>
                                    <div class="role-category">Transaction Completion</div>
                                </div>
                            </div>
                            <div class="role-description">
                                The party who conducts the closing meeting. This role may be filled by an attorney, title company, or real estate agent depending upon the state where the property is located.
                            </div>
                        </div>

                        <div class="role-card">
                            <div class="role-card-header">
                                <div class="role-icon closing">LS</div>
                                <div>
                                    <div class="role-name">Loan Servicer</div>
                                    <div class="role-category">Payment Management</div>
                                </div>
                            </div>
                            <div class="role-description">
                                The entity that collects mortgage payments (it may or may not be the lender) and pays taxes and insurance and mortgage insurance, if required, on your behalf.
                            </div>
                        </div>
                    </div>

                    <div class="info-box">
                        <h4>Mortgage Insurance Benefits</h4>
                        <p>Private mortgage insurance (PMI) enables homebuyers to purchase a home with less than 20% down payment. Key benefits include:</p>
                        <ul style="margin-top: 10px; margin-left: 20px;">
                            <li>Lower down payment requirements</li>
                            <li>Faster path to homeownership</li>
                            <li>Assistance programs if you fall behind on payments</li>
                            <li>Protection for the lender reduces overall market risk</li>
                        </ul>
                    </div>

                    <div class="tip-box">
                        <h4>Closing Agent Variations by State</h4>
                        <p>The closing or settlement agent role varies by state:</p>
                        <ul style="margin-top: 10px; margin-left: 20px;">
                            <li><strong>Attorney States:</strong> A real estate attorney must conduct the closing</li>
                            <li><strong>Title Company States:</strong> Title companies handle the settlement process</li>
                            <li><strong>Escrow States:</strong> An escrow company manages the transaction</li>
                        </ul>
                    </div>

                    <table class="field-table">
                        <thead>
                            <tr>
                                <th>Role</th>
                                <th>Primary Function</th>
                                <th>Post-Closing Contact</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td><strong>Mortgage Insurer</strong></td>
                                <td>Protects lender; enables low down payment</td>
                                <td>Payment assistance if you fall behind</td>
                            </tr>
                            <tr>
                                <td><strong>Closing Agent</strong></td>
                                <td>Conducts settlement meeting</td>
                                <td>Title questions, deed recording</td>
                            </tr>
                            <tr>
                                <td><strong>Loan Servicer</strong></td>
                                <td>Collects payments, pays escrow items</td>
                                <td>Monthly payments, tax/insurance questions</td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </section>

            <!-- Section 6: Process Flow -->
            <section id="section-6" class="section">
                <div class="section-header">
                    <div class="section-number">6</div>
                    <div class="section-title"><h2>Process Flow</h2><span>How participants interact throughout your mortgage journey</span></div>
                </div>
                <div class="section-content">
                    <div class="workflow-diagram">
                        <h4 style="color: var(--accent-blue); margin-bottom: 20px; text-align: center;">Mortgage Process Timeline</h4>
                        <div class="flow-row">
                            <div class="flow-node start">Begin Home Search</div>
                            <span class="flow-arrow">-></span>
                            <div class="flow-node action">Real Estate Agent</div>
                            <span class="flow-arrow">-></span>
                            <div class="flow-node action">Find Property</div>
                        </div>
                        <div class="flow-row">
                            <div class="flow-node action">Loan Officer</div>
                            <span class="flow-arrow">-></span>
                            <div class="flow-node input">Application</div>
                            <span class="flow-arrow">-></span>
                            <div class="flow-node action">Loan Processor</div>
                        </div>
                        <div class="flow-row">
                            <div class="flow-node action">Appraiser</div>
                            <span class="flow-arrow">-></span>
                            <div class="flow-node action">Property Inspector</div>
                            <span class="flow-arrow">-></span>
                            <div class="flow-node decision">Underwriter Review</div>
                        </div>
                        <div class="decision-branch">
                            <div class="branch">
                                <span class="branch-label">APPROVED</span>
                                <div class="flow-node output">Clear to Close</div>
                            </div>
                            <div class="branch">
                                <span class="branch-label">CONDITIONS</span>
                                <div class="flow-node exception">Additional Docs Needed</div>
                            </div>
                        </div>
                        <div class="flow-row">
                            <div class="flow-node action">Closing Agent</div>
                            <span class="flow-arrow">-></span>
                            <div class="flow-node output">Sign Documents</div>
                            <span class="flow-arrow">-></span>
                            <div class="flow-node start">Homeowner!</div>
                        </div>
                    </div>

                    <ul class="step-list">
                        <li><strong>Step 1 - Home Search:</strong> Work with a Real Estate Agent/Broker to find your ideal property</li>
                        <li><strong>Step 2 - Pre-Approval:</strong> Meet with a Loan Officer to determine your budget and get pre-approved</li>
                        <li><strong>Step 3 - Make an Offer:</strong> Your Real Estate Agent helps negotiate the purchase contract</li>
                        <li><strong>Step 4 - Loan Application:</strong> Complete your application with the Loan Officer</li>
                        <li><strong>Step 5 - Processing:</strong> Loan Processor gathers and verifies all documentation</li>
                        <li><strong>Step 6 - Property Evaluation:</strong> Appraiser determines value; Inspector assesses condition</li>
                        <li><strong>Step 7 - Underwriting:</strong> Underwriter reviews file and makes lending decision</li>
                        <li><strong>Step 8 - Closing:</strong> Closing Agent conducts settlement; sign final documents</li>
                        <li><strong>Step 9 - Post-Closing:</strong> Loan Servicer manages your monthly payments and escrow</li>
                    </ul>
                </div>
            </section>

            <!-- Quick Reference -->
            <div id="quick-ref" class="quick-ref">
                <h3>Who's Who Quick Reference</h3>
                <pre>
MORTGAGE PROCESS PARTICIPANTS
=============================

LENDER TEAM
-----------
Role                 | Primary Function                    | Contact For
---------------------|-------------------------------------|---------------------------
Loan Officer         | Loan selection & application        | Loan options, application
Loan Processor       | Document gathering                  | Doc requests, status
Underwriter          | Risk evaluation & approval          | Conditions (via processor)
Mortgage Lender      | Funding & closing                   | Rate locks, funding

REAL ESTATE PROFESSIONALS
-------------------------
Role                 | Primary Function                    | Services Provided
---------------------|-------------------------------------|---------------------------
Real Estate Agent    | Buyer/seller intermediary           | Property search, negotiations
Real Estate Broker   | Licensed professional               | Market values, firm management

SERVICE PROVIDERS
-----------------
Role                 | Primary Function                    | What They Assess
---------------------|-------------------------------------|---------------------------
Appraiser            | Property value estimation           | Fair market value
Property Inspector   | Home condition examination          | Structural, systems, safety

INSURANCE & CLOSING
-------------------
Role                 | Primary Function                    | Post-Closing Contact
---------------------|-------------------------------------|---------------------------
Mortgage Insurer     | Lender protection / Low down PMI    | Payment assistance
Closing Agent        | Settlement meeting                  | Title, deed recording
Loan Servicer        | Payment collection                  | Monthly payments, escrow

KEY TAKEAWAYS
=============
- PMI enables < 20% down payment homeownership
- Closing agent varies by state (attorney/title/escrow)
- Loan servicer may be different from your lender
- Real estate broker has higher licensing than agent
- Property inspector checks: roof, foundation, HVAC,
  plumbing, electrical, water/sewage, safety

SOURCE: Enact Mortgage Insurance
        Enact Mortgage Insurance Corporation
        Enact Mortgage Insurance Corporation of North Carolina
        Document: 01563.CB.1222
                </pre>
            </div>
        </div>

        <!-- ==================== AI AGENTS TAB ==================== -->
        <div id="agents-panel" class="tab-panel">
            <!-- Agent Header -->
            <div class="agent-header">
                <h1>AI Agent Opportunities</h1>
                <p class="subtitle">Automation opportunities identified for FTHB education and mortgage participant coordination</p>
            </div>

            <!-- Summary Stats -->
            <div class="agent-summary" id="agent-summary">
                <div class="agent-summary-card">
                    <div class="agent-summary-value">4</div>
                    <div class="agent-summary-label">Agent Opportunities</div>
                </div>
                <div class="agent-summary-card">
                    <div class="agent-summary-value">65%</div>
                    <div class="agent-summary-label">Automation Potential</div>
                </div>
                <div class="agent-summary-card">
                    <div class="agent-summary-value">High</div>
                    <div class="agent-summary-label">Education Impact</div>
                </div>
                <div class="agent-summary-card">
                    <div class="agent-summary-value">FTHB</div>
                    <div class="agent-summary-label">Target Audience</div>
                </div>
            </div>

            <!-- Heat Map Legend -->
            <div class="heat-legend">
                <div class="heat-legend-item">
                    <div class="heat-legend-color" style="background: linear-gradient(90deg, #ef4444, #f97316);"></div>
                    <span>Critical Priority (9-10)</span>
                </div>
                <div class="heat-legend-item">
                    <div class="heat-legend-color" style="background: linear-gradient(90deg, #f97316, #eab308);"></div>
                    <span>High Priority (7-8)</span>
                </div>
                <div class="heat-legend-item">
                    <div class="heat-legend-color" style="background: linear-gradient(90deg, #eab308, #22c55e);"></div>
                    <span>Medium Priority (5-6)</span>
                </div>
                <div class="heat-legend-item">
                    <div class="heat-legend-color" style="background: linear-gradient(90deg, #22c55e, #14b8a6);"></div>
                    <span>Low Priority (1-4)</span>
                </div>
            </div>

            <!-- Heat Map Grid -->
            <div class="heat-map-container" id="agent-heatmap">
                <div class="heat-map-title">Priority Heat Map</div>
                <div class="heat-map-grid">
                    <div class="heat-item high" onclick="scrollToAgent('agent-education')">
                        <div class="heat-score">8.5</div>
                        <div class="heat-name">FTHB Education Bot</div>
                        <div class="heat-desc">Interactive Q&A for first-time homebuyers</div>
                        <div class="heat-metrics">
                            <div class="heat-metric">Impact: <span>High</span></div>
                            <div class="heat-metric">Complexity: <span>Medium</span></div>
                        </div>
                    </div>
                    <div class="heat-item high" onclick="scrollToAgent('agent-coordinator')">
                        <div class="heat-score">7.8</div>
                        <div class="heat-name">Process Coordinator</div>
                        <div class="heat-desc">Auto-route questions to appropriate party</div>
                        <div class="heat-metrics">
                            <div class="heat-metric">Impact: <span>High</span></div>
                            <div class="heat-metric">Complexity: <span>Low</span></div>
                        </div>
                    </div>
                    <div class="heat-item medium" onclick="scrollToAgent('agent-timeline')">
                        <div class="heat-score">6.5</div>
                        <div class="heat-name">Timeline Tracker</div>
                        <div class="heat-desc">Show borrower current stage and next steps</div>
                        <div class="heat-metrics">
                            <div class="heat-metric">Impact: <span>Med</span></div>
                            <div class="heat-metric">Complexity: <span>Low</span></div>
                        </div>
                    </div>
                    <div class="heat-item medium" onclick="scrollToAgent('agent-contact')">
                        <div class="heat-score">5.8</div>
                        <div class="heat-name">Contact Directory</div>
                        <div class="heat-desc">Dynamic contact lookup for loan participants</div>
                        <div class="heat-metrics">
                            <div class="heat-metric">Impact: <span>Med</span></div>
                            <div class="heat-metric">Complexity: <span>Low</span></div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Agent Details -->
            <div id="agent-details">
                <h2 style="color: var(--text-primary); margin-bottom: 25px; font-size: 1.5rem;">Agent Details</h2>
                <div class="agent-grid">
                    <!-- FTHB Education Bot -->
                    <div class="agent-card" id="agent-education">
                        <div class="agent-card-header">
                            <div class="agent-icon">E</div>
                            <div class="agent-info">
                                <div class="agent-name">FTHB Education Bot</div>
                                <div class="agent-type">Conversational AI / Education</div>
                            </div>
                            <span class="agent-priority high">High</span>
                        </div>
                        <div class="agent-card-body">
                            <p class="agent-description">An interactive chatbot that educates first-time homebuyers about the mortgage process, explains roles of each participant, answers common questions, and provides personalized guidance based on where they are in their homebuying journey.</p>
                            <div class="agent-flow">
                                <div class="agent-flow-title">Agent Flow</div>
                                <div class="agent-flow-diagram">
                                    <span class="agent-step">User Question</span>
                                    <span class="agent-arrow">-></span>
                                    <span class="agent-step">NLP Processing</span>
                                    <span class="agent-arrow">-></span>
                                    <span class="agent-step">Knowledge Base</span>
                                    <span class="agent-arrow">-></span>
                                    <span class="agent-step">Personalized Response</span>
                                </div>
                            </div>
                            <div class="agent-stats">
                                <div class="agent-stat">
                                    <div class="agent-stat-value">24/7</div>
                                    <div class="agent-stat-label">Availability</div>
                                </div>
                                <div class="agent-stat">
                                    <div class="agent-stat-value">95%</div>
                                    <div class="agent-stat-label">Query Resolution</div>
                                </div>
                                <div class="agent-stat">
                                    <div class="agent-stat-value">Med</div>
                                    <div class="agent-stat-label">Complexity</div>
                                </div>
                            </div>
                            <button class="agent-prompt-btn" onclick="showAgentPrompt('education')">
                                View Build Prompt
                            </button>
                        </div>
                    </div>

                    <!-- Process Coordinator -->
                    <div class="agent-card" id="agent-coordinator">
                        <div class="agent-card-header">
                            <div class="agent-icon">C</div>
                            <div class="agent-info">
                                <div class="agent-name">Process Coordinator</div>
                                <div class="agent-type">Routing / Communication</div>
                            </div>
                            <span class="agent-priority high">High</span>
                        </div>
                        <div class="agent-card-body">
                            <p class="agent-description">Automatically analyzes borrower questions and routes them to the appropriate mortgage participant (Loan Officer, Processor, Real Estate Agent, etc.) based on the nature of the inquiry and current loan stage.</p>
                            <div class="agent-flow">
                                <div class="agent-flow-title">Agent Flow</div>
                                <div class="agent-flow-diagram">
                                    <span class="agent-step">Analyze Query</span>
                                    <span class="agent-arrow">-></span>
                                    <span class="agent-step">Identify Topic</span>
                                    <span class="agent-arrow">-></span>
                                    <span class="agent-step">Match Expert</span>
                                    <span class="agent-arrow">-></span>
                                    <span class="agent-step">Route Request</span>
                                </div>
                            </div>
                            <div class="agent-stats">
                                <div class="agent-stat">
                                    <div class="agent-stat-value">90%</div>
                                    <div class="agent-stat-label">Routing Accuracy</div>
                                </div>
                                <div class="agent-stat">
                                    <div class="agent-stat-value">< 1 min</div>
                                    <div class="agent-stat-label">Response Time</div>
                                </div>
                                <div class="agent-stat">
                                    <div class="agent-stat-value">Low</div>
                                    <div class="agent-stat-label">Complexity</div>
                                </div>
                            </div>
                            <button class="agent-prompt-btn" onclick="showAgentPrompt('coordinator')">
                                View Build Prompt
                            </button>
                        </div>
                    </div>

                    <!-- Timeline Tracker -->
                    <div class="agent-card" id="agent-timeline">
                        <div class="agent-card-header">
                            <div class="agent-icon">T</div>
                            <div class="agent-info">
                                <div class="agent-name">Timeline Tracker</div>
                                <div class="agent-type">Status / Visualization</div>
                            </div>
                            <span class="agent-priority medium">Medium</span>
                        </div>
                        <div class="agent-card-body">
                            <p class="agent-description">Provides borrowers with a visual timeline showing their current position in the mortgage process, which participants they've interacted with, upcoming milestones, and estimated time to closing.</p>
                            <div class="agent-flow">
                                <div class="agent-flow-title">Agent Flow</div>
                                <div class="agent-flow-diagram">
                                    <span class="agent-step">Check Loan Status</span>
                                    <span class="agent-arrow">-></span>
                                    <span class="agent-step">Map to Timeline</span>
                                    <span class="agent-arrow">-></span>
                                    <span class="agent-step">Render Visual</span>
                                    <span class="agent-arrow">-></span>
                                    <span class="agent-step">Show Next Steps</span>
                                </div>
                            </div>
                            <div class="agent-stats">
                                <div class="agent-stat">
                                    <div class="agent-stat-value">Real-time</div>
                                    <div class="agent-stat-label">Updates</div>
                                </div>
                                <div class="agent-stat">
                                    <div class="agent-stat-value">9</div>
                                    <div class="agent-stat-label">Stages Tracked</div>
                                </div>
                                <div class="agent-stat">
                                    <div class="agent-stat-value">Low</div>
                                    <div class="agent-stat-label">Complexity</div>
                                </div>
                            </div>
                            <button class="agent-prompt-btn" onclick="showAgentPrompt('timeline')">
                                View Build Prompt
                            </button>
                        </div>
                    </div>

                    <!-- Contact Directory -->
                    <div class="agent-card" id="agent-contact">
                        <div class="agent-card-header">
                            <div class="agent-icon">D</div>
                            <div class="agent-info">
                                <div class="agent-name">Contact Directory</div>
                                <div class="agent-type">Lookup / Information</div>
                            </div>
                            <span class="agent-priority medium">Medium</span>
                        </div>
                        <div class="agent-card-body">
                            <p class="agent-description">A dynamic directory that provides borrowers with contact information for all participants involved in their specific loan file, including role descriptions and when each contact should be used.</p>
                            <div class="agent-flow">
                                <div class="agent-flow-title">Agent Flow</div>
                                <div class="agent-flow-diagram">
                                    <span class="agent-step">Loan Number</span>
                                    <span class="agent-arrow">-></span>
                                    <span class="agent-step">Fetch Participants</span>
                                    <span class="agent-arrow">-></span>
                                    <span class="agent-step">Add Role Info</span>
                                    <span class="agent-arrow">-></span>
                                    <span class="agent-step">Display Directory</span>
                                </div>
                            </div>
                            <div class="agent-stats">
                                <div class="agent-stat">
                                    <div class="agent-stat-value">11</div>
                                    <div class="agent-stat-label">Role Types</div>
                                </div>
                                <div class="agent-stat">
                                    <div class="agent-stat-value">99%</div>
                                    <div class="agent-stat-label">Data Accuracy</div>
                                </div>
                                <div class="agent-stat">
                                    <div class="agent-stat-value">Low</div>
                                    <div class="agent-stat-label">Complexity</div>
                                </div>
                            </div>
                            <button class="agent-prompt-btn" onclick="showAgentPrompt('contact')">
                                View Build Prompt
                            </button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </main>

    <!-- Documentation Modal -->
    <div class="modal-overlay" id="docModal">
        <div class="modal">
            <div class="modal-header">
                <h3>Who's Who Workflow Documentation</h3>
                <div class="modal-actions">
                    <button class="modal-btn copy" onclick="copyToClipboard()">Copy</button>
                    <button class="modal-btn close" onclick="closeDocModal()">Close</button>
                </div>
            </div>
            <div class="modal-body">
                <pre id="docContent"># Who's Who in the Mortgage Process

## Overview
This guide helps first-time homebuyers understand all the key participants involved in a mortgage transaction.

## Lender Team

### Loan Officer
- Represents one lending institution and their loan programs
- Helps choose the best mortgage loan based on your situation
- Assists with completing the loan application

### Loan Processor
- Gathers, administers, and processes your loan application
- Essential to getting your mortgage to final close
- Primary document collection contact

### Underwriter
- Evaluates and determines risk for mortgage applications
- Decides whether and under what terms to provide the mortgage
- Makes final lending decisions

### Mortgage Lender
- Financial institution that issues loans
- Controls the whole process from underwriting to funding
- Unlike brokers, handles everything in-house

## Real Estate Professionals

### Real Estate Agent
- Acts as intermediary between sellers and buyers
- Provides community information (shopping, transportation, schools)
- Helps find properties and negotiate purchases

### Real Estate Broker
- Licensed professional representing sellers or buyers
- Can determine market values of properties
- May work independently or manage their own firm
- Agents work under licensed brokers

## Service Providers

### Appraiser
- Licensed to estimate fair market value of property
- Ensures loan amount is appropriate for property value

### Property Inspector
- Certified to examine homes
- Assesses: roof, foundation, HVAC, plumbing, electrical, water/sewage, safety

## Insurance & Closing

### Mortgage Insurer
- Compensates lender for losses if borrower can't pay
- Enables homeownership with less than 20% down
- May assist borrowers who fall behind on payments

### Closing or Settlement Agent
- Conducts the closing meeting
- May be attorney, title company, or real estate agent (varies by state)

### Loan Servicer
- Collects mortgage payments
- Pays taxes, insurance, and MI on your behalf
- May or may not be the original lender

## Source
Enact Mortgage Insurance (Document 01563.CB.1222)</pre>
            </div>
        </div>
    </div>

    <!-- AI Prompt Modal -->
    <div class="modal-overlay prompt-modal" id="promptModal">
        <div class="modal">
            <div class="modal-header">
                <h3 id="promptModalTitle">AI Agent Build Prompt</h3>
                <div class="modal-actions">
                    <button class="modal-btn copy" onclick="copyPromptToClipboard()">Copy Prompt</button>
                    <button class="modal-btn close" onclick="closePromptModal()">Close</button>
                </div>
            </div>
            <div class="modal-body">
                <div class="prompt-tags" id="promptTags"></div>
                <div class="prompt-section">
                    <h4>Agent Purpose</h4>
                    <div class="prompt-box" id="promptPurpose"></div>
                </div>
                <div class="prompt-section">
                    <h4>Full Build Prompt</h4>
                    <div class="prompt-box" id="promptContent"></div>
                </div>
                <div class="prompt-section">
                    <h4>Integration Points</h4>
                    <div class="prompt-box" id="promptIntegration"></div>
                </div>
            </div>
        </div>
    </div>

    <div class="copy-success" id="copySuccess">Copied to clipboard!</div>

    <script>
        // Tab switching
        function switchTab(tab) {
            document.querySelectorAll('.sidebar-tab').forEach(t => t.classList.remove('active'));
            document.querySelectorAll('.tab-panel').forEach(p => p.classList.remove('active'));

            if (tab === 'workflow') {
                document.querySelector('.sidebar-tab:not(.agent-tab)').classList.add('active');
                document.getElementById('workflow-panel').classList.add('active');
                document.getElementById('workflow-nav').style.display = 'block';
                document.getElementById('agents-nav').style.display = 'none';
            } else {
                document.querySelector('.sidebar-tab.agent-tab').classList.add('active');
                document.getElementById('agents-panel').classList.add('active');
                document.getElementById('workflow-nav').style.display = 'none';
                document.getElementById('agents-nav').style.display = 'block';
            }

            window.scrollTo(0, 0);
        }

        // Scroll spy with isScrolling flag and 1000ms timeout
        const sections = document.querySelectorAll('.section, .quick-ref');
        const navItems = document.querySelectorAll('#workflow-nav .nav-item');
        let isScrolling = false;
        let scrollTimeout;

        function updateActiveNav() {
            if (isScrolling) return;

            let current = '';
            sections.forEach(section => {
                const sectionTop = section.offsetTop - 100;
                if (window.scrollY >= sectionTop) current = section.getAttribute('id');
            });
            navItems.forEach(item => {
                item.classList.remove('active');
                if (item.getAttribute('href') === '#' + current) item.classList.add('active');
            });
        }

        // Handle nav click to temporarily disable scroll spy
        navItems.forEach(item => {
            item.addEventListener('click', function(e) {
                isScrolling = true;
                clearTimeout(scrollTimeout);

                // Remove active from all, add to clicked
                navItems.forEach(nav => nav.classList.remove('active'));
                this.classList.add('active');

                // Re-enable scroll spy after 1000ms
                scrollTimeout = setTimeout(() => {
                    isScrolling = false;
                }, 1000);
            });
        });

        window.addEventListener('scroll', updateActiveNav);

        // Modal
        function openDocModal() {
            document.getElementById('docModal').classList.add('show');
            document.body.style.overflow = 'hidden';
        }

        function closeDocModal() {
            document.getElementById('docModal').classList.remove('show');
            document.body.style.overflow = '';
        }

        async function copyToClipboard() {
            try {
                await navigator.clipboard.writeText(document.getElementById('docContent').textContent);
                const success = document.getElementById('copySuccess');
                success.style.display = 'block';
                setTimeout(() => { success.style.display = 'none'; }, 2000);
            } catch (e) { alert('Failed to copy.'); }
        }

        document.addEventListener('keydown', (e) => { if (e.key === 'Escape') { closeDocModal(); closePromptModal(); } });
        document.getElementById('docModal').addEventListener('click', (e) => { if (e.target.id === 'docModal') closeDocModal(); });

        document.addEventListener('DOMContentLoaded', () => { updateActiveNav(); });

        // Scroll to agent card and highlight
        function scrollToAgent(agentId) {
            const agentCard = document.getElementById(agentId);
            if (agentCard) {
                document.querySelectorAll('.agent-card.highlight').forEach(card => {
                    card.classList.remove('highlight');
                });

                agentCard.scrollIntoView({ behavior: 'smooth', block: 'center' });

                setTimeout(() => {
                    agentCard.classList.add('highlight');
                }, 300);

                setTimeout(() => {
                    agentCard.classList.remove('highlight');
                }, 2500);
            }
        }

        // Agent Prompt System
        const agentPrompts = {
            education: {
                name: 'FTHB Education Bot',
                tags: ['Conversational AI', 'Education', 'Medium Complexity', 'High Priority'],
                purpose: `This agent provides 24/7 educational support for first-time homebuyers. It explains the roles of each mortgage participant, answers common questions about the process, and provides personalized guidance based on where the borrower is in their homebuying journey.`,
                prompt: `You are building an Educational Chatbot for CMG Financial's First-Time Homebuyer program.

AGENT NAME: FTHB Education Bot
TYPE: Conversational AI / Education

OBJECTIVE:
Create an interactive chatbot that educates first-time homebuyers about the mortgage process and the roles of all participants.

KNOWLEDGE BASE:
1. Lender Team
   - Loan Officer: Primary contact, loan selection, application assistance
   - Loan Processor: Document gathering, file preparation
   - Underwriter: Risk evaluation, loan approval decisions
   - Mortgage Lender: Funding, closing, overall process control

2. Real Estate Professionals
   - Real Estate Agent: Property search, negotiations, community info
   - Real Estate Broker: Market values, licensed to manage firms

3. Service Providers
   - Appraiser: Fair market value estimation
   - Property Inspector: Condition assessment (roof, foundation, HVAC, etc.)

4. Insurance & Closing
   - Mortgage Insurer: Enables low down payment, borrower assistance
   - Closing Agent: Conducts settlement (varies by state)
   - Loan Servicer: Payment collection, escrow management

CONVERSATION FLOWS:
1. "Who should I contact about..." routing logic
2. "What does a [role] do?" explanations
3. "Where am I in the process?" stage identification
4. "What's the difference between..." comparisons

PERSONALIZATION:
- Track user's current stage in process
- Remember previous questions
- Provide stage-appropriate information
- Escalate complex questions to human support`,
                integration: `INTEGRATION POINTS:
1. CRM System
   - Pull borrower data for personalization
   - Log interactions for LO follow-up
   - Track engagement metrics

2. Knowledge Base
   - Enact MI educational content
   - CMG-specific procedures
   - State-specific closing info

3. Escalation System
   - Route complex questions to LO
   - Schedule callbacks
   - Create support tickets

4. Analytics
   - Common question tracking
   - Knowledge gap identification
   - Bot performance metrics`
            },
            coordinator: {
                name: 'Process Coordinator',
                tags: ['Routing', 'Communication', 'Low Complexity', 'High Priority'],
                purpose: `This agent analyzes borrower questions and automatically routes them to the appropriate mortgage participant based on topic classification and current loan stage, reducing response time and ensuring questions reach the right expert.`,
                prompt: `You are building a Question Routing Agent for CMG Financial's mortgage process.

AGENT NAME: Process Coordinator
TYPE: Routing / Communication

OBJECTIVE:
Automatically analyze and route borrower questions to the appropriate mortgage professional.

ROUTING RULES:

Topic: Loan Options, Rates, Pre-approval
-> Route to: Loan Officer
-> Priority: Normal

Topic: Document Requests, Status Updates
-> Route to: Loan Processor
-> Priority: Normal

Topic: Condition Questions, Approval Status
-> Route to: Loan Processor (who contacts Underwriter)
-> Priority: High

Topic: Property Search, Negotiations
-> Route to: Real Estate Agent
-> Priority: Normal

Topic: Property Value Questions
-> Route to: Appraiser (via Processor)
-> Priority: Low

Topic: Inspection Results
-> Route to: Property Inspector
-> Priority: Normal

Topic: Insurance Questions
-> Route to: Mortgage Insurer
-> Priority: Normal

Topic: Closing Documents, Settlement
-> Route to: Closing Agent
-> Priority: High (if within 7 days of close)

Topic: Payment Questions, Escrow
-> Route to: Loan Servicer
-> Priority: Normal

CLASSIFICATION MODEL:
- NLP intent classification
- Keyword matching backup
- Stage-aware routing
- Urgency detection`,
                integration: `INTEGRATION POINTS:
1. Email/Messaging System
   - Parse incoming messages
   - Auto-categorize topics
   - Forward to appropriate party

2. LOS Integration
   - Pull current loan stage
   - Identify assigned personnel
   - Access contact information

3. Notification System
   - Alert recipient of routed message
   - CC borrower on routing
   - Track response times

4. Analytics Dashboard
   - Routing accuracy metrics
   - Response time tracking
   - Volume by topic/recipient`
            },
            timeline: {
                name: 'Timeline Tracker',
                tags: ['Status', 'Visualization', 'Low Complexity', 'Medium Priority'],
                purpose: `This agent provides borrowers with a visual timeline showing their current position in the mortgage process, completed milestones, upcoming steps, and which participants they'll interact with at each stage.`,
                prompt: `You are building a Timeline Visualization Agent for CMG Financial's borrower portal.

AGENT NAME: Timeline Tracker
TYPE: Status / Visualization

OBJECTIVE:
Provide borrowers with a visual timeline showing their mortgage process progress.

TIMELINE STAGES:
1. Home Search (Real Estate Agent)
   - Finding properties
   - Making offers
   - Contract acceptance

2. Pre-Approval (Loan Officer)
   - Budget determination
   - Initial qualification
   - Pre-approval letter

3. Application (Loan Officer)
   - Complete 1003
   - Initial disclosures
   - Lock rate

4. Processing (Loan Processor)
   - Document collection
   - Verification
   - File preparation

5. Property Evaluation (Appraiser, Inspector)
   - Appraisal ordered
   - Inspection completed
   - Value determined

6. Underwriting (Underwriter)
   - File review
   - Conditions issued
   - Final approval

7. Clear to Close (Loan Processor)
   - Conditions cleared
   - Final docs prepared
   - CD issued

8. Closing (Closing Agent)
   - Settlement meeting
   - Document signing
   - Funding

9. Post-Closing (Loan Servicer)
   - Welcome packet
   - First payment setup
   - Ongoing servicing

VISUAL ELEMENTS:
- Progress bar with percentage
- Stage icons with participant avatars
- Estimated days remaining
- Next action required`,
                integration: `INTEGRATION POINTS:
1. LOS Status API
   - Real-time stage updates
   - Milestone completion dates
   - Estimated timeline

2. Document Management
   - Outstanding document count
   - Condition status
   - Disclosure tracking

3. Calendar Integration
   - Appraisal scheduling
   - Closing date
   - Important deadlines

4. Notification System
   - Stage change alerts
   - Action required reminders
   - Milestone celebrations`
            },
            contact: {
                name: 'Contact Directory',
                tags: ['Lookup', 'Information', 'Low Complexity', 'Medium Priority'],
                purpose: `This agent provides borrowers with a dynamic, loan-specific contact directory showing all participants involved in their mortgage transaction, their roles, and guidance on when to contact each person.`,
                prompt: `You are building a Contact Directory Agent for CMG Financial's borrower portal.

AGENT NAME: Contact Directory
TYPE: Lookup / Information

OBJECTIVE:
Provide borrowers with contact information for all participants in their specific loan transaction.

CONTACT CARD FORMAT:
{
  "role": "Loan Officer",
  "name": "Jane Smith",
  "company": "CMG Financial",
  "phone": "(555) 123-4567",
  "email": "jsmith@cmgfi.com",
  "photo": "/images/jsmith.jpg",
  "description": "Your primary contact for loan questions",
  "contactFor": [
    "Loan options and rates",
    "Application questions",
    "Pre-approval letters",
    "Rate lock decisions"
  ],
  "availability": "Mon-Fri 8am-6pm PST"
}

ROLES TO INCLUDE:
1. Loan Officer - CMG Financial
2. Loan Processor - CMG Financial
3. Real Estate Agent - External
4. Real Estate Broker - If applicable
5. Appraiser - Management Company
6. Property Inspector - If ordered
7. Title Company - Closing Agent
8. Mortgage Insurer - If applicable
9. Loan Servicer - Post-closing

DYNAMIC POPULATION:
- Pull from loan file assignments
- Include company/office info
- Show current availability
- Link to scheduling tools

SMART SUGGESTIONS:
Based on common questions, suggest who to contact:
- "Rate lock expiring?" -> Loan Officer
- "Need to upload docs?" -> Loan Processor
- "Closing date question?" -> Closing Agent`,
                integration: `INTEGRATION POINTS:
1. LOS Contact Data
   - Personnel assignments
   - Company information
   - Contact preferences

2. External Partner APIs
   - Real estate agent data
   - Title company contacts
   - Appraiser assignments

3. Availability System
   - Office hours
   - Out-of-office status
   - Backup contacts

4. Communication Tools
   - Click-to-call
   - Email composition
   - Secure messaging`
            }
        };

        function showAgentPrompt(agentKey) {
            const agent = agentPrompts[agentKey];
            if (!agent) return;

            document.getElementById('promptModalTitle').textContent = agent.name + ' - Build Prompt';
            document.getElementById('promptTags').innerHTML = agent.tags.map(t => `<span class="prompt-tag">${t}</span>`).join('');
            document.getElementById('promptPurpose').textContent = agent.purpose;
            document.getElementById('promptContent').textContent = agent.prompt;
            document.getElementById('promptIntegration').textContent = agent.integration;

            document.getElementById('promptModal').classList.add('show');
            document.body.style.overflow = 'hidden';
        }

        function closePromptModal() {
            document.getElementById('promptModal').classList.remove('show');
            document.body.style.overflow = '';
        }

        async function copyPromptToClipboard() {
            const content = document.getElementById('promptContent').textContent;
            try {
                await navigator.clipboard.writeText(content);
                const success = document.getElementById('copySuccess');
                success.style.display = 'block';
                setTimeout(() => { success.style.display = 'none'; }, 2000);
            } catch (e) { alert('Failed to copy.'); }
        }

        document.getElementById('promptModal').addEventListener('click', (e) => { if (e.target.id === 'promptModal') closePromptModal(); });
    </script>
</body>
</html>
