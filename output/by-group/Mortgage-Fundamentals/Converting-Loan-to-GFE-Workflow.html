<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Converting Loan to GFE - Process Workflow</title>
    <link href="https://fonts.googleapis.com/css2?family=Plus+Jakarta+Sans:wght@400;500;600;700;800&family=JetBrains+Mono:wght@400;500&display=swap" rel="stylesheet">
    <style>
        :root {
            --bg-primary: #0a0f1a;
            --bg-secondary: #111827;
            --bg-card: #1a2234;
            --accent-blue: #3b82f6;
            --accent-teal: #14b8a6;
            --accent-amber: #f59e0b;
            --accent-rose: #f43f5e;
            --accent-green: #22c55e;
            --accent-purple: #8b5cf6;
            --text-primary: #f1f5f9;
            --text-secondary: #94a3b8;
            --text-muted: #64748b;
            --border-subtle: rgba(255,255,255,0.08);
            --sidebar-width: 280px;
        }

        * { box-sizing: border-box; margin: 0; padding: 0; }
        html { scroll-behavior: smooth; }
        body {
            font-family: 'Plus Jakarta Sans', -apple-system, BlinkMacSystemFont, sans-serif;
            background: var(--bg-primary);
            color: var(--text-primary);
            min-height: 100vh;
        }

        /* Breadcrumb */
        .breadcrumb {
            background: linear-gradient(90deg, #0d1525 0%, #1a2234 100%);
            padding: 14px 25px;
            display: flex;
            align-items: center;
            gap: 12px;
            font-size: 0.95rem;
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            z-index: 1001;
            border-bottom: 1px solid var(--border-subtle);
        }

        .breadcrumb a {
            color: var(--text-secondary);
            text-decoration: none;
            font-weight: 600;
            padding: 8px 16px;
            background: rgba(255,255,255,0.05);
            border-radius: 8px;
            transition: all 0.2s;
            border: 1px solid var(--border-subtle);
        }

        .breadcrumb a:hover {
            background: rgba(59, 130, 246, 0.15);
            color: var(--accent-blue);
            border-color: rgba(59, 130, 246, 0.3);
        }

        .breadcrumb .separator { color: var(--text-muted); font-size: 1.2rem; }
        .breadcrumb .current { color: var(--accent-amber); font-weight: 600; padding: 8px 16px; }

        /* Sidebar */
        .sidebar {
            position: fixed;
            top: 54px;
            left: 0;
            width: var(--sidebar-width);
            height: calc(100vh - 54px);
            background: var(--bg-secondary);
            overflow-y: auto;
            z-index: 1000;
            border-right: 1px solid var(--border-subtle);
            display: flex;
            flex-direction: column;
        }

        .sidebar-header {
            padding: 25px 20px;
            background: rgba(0,0,0,0.3);
            border-bottom: 1px solid var(--border-subtle);
        }

        .sidebar-header h2 { color: var(--text-primary); font-size: 1.2rem; font-weight: 700; margin-bottom: 5px; }
        .sidebar-header p { color: var(--text-muted); font-size: 0.85rem; }

        /* Tab Switch */
        .sidebar-tabs {
            display: flex;
            border-bottom: 1px solid var(--border-subtle);
        }

        .sidebar-tab {
            flex: 1;
            padding: 14px 10px;
            text-align: center;
            font-size: 0.8rem;
            font-weight: 700;
            color: var(--text-muted);
            cursor: pointer;
            transition: all 0.2s;
            border-bottom: 3px solid transparent;
            background: none;
            border-left: none;
            border-right: none;
            border-top: none;
        }

        .sidebar-tab:hover { background: rgba(255,255,255,0.03); color: var(--text-secondary); }
        .sidebar-tab.active { color: var(--accent-blue); border-bottom-color: var(--accent-blue); background: rgba(59, 130, 246, 0.08); }
        .sidebar-tab.agent-tab.active { color: var(--accent-purple); border-bottom-color: var(--accent-purple); background: rgba(139, 92, 246, 0.08); }

        .sidebar-nav { padding: 15px 0; flex: 1; overflow-y: auto; }

        .nav-item {
            display: flex;
            align-items: center;
            gap: 12px;
            padding: 14px 20px;
            color: var(--text-secondary);
            text-decoration: none;
            border-left: 3px solid transparent;
            transition: all 0.2s ease;
            cursor: pointer;
        }

        .nav-item:hover { background: rgba(255,255,255,0.03); color: var(--text-primary); }
        .nav-item.active { background: rgba(59, 130, 246, 0.1); border-left-color: var(--accent-blue); color: var(--text-primary); }

        .nav-number {
            background: rgba(255,255,255,0.1);
            color: var(--text-secondary);
            width: 28px;
            height: 28px;
            border-radius: 8px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 700;
            font-size: 0.85rem;
            flex-shrink: 0;
        }

        .nav-item.active .nav-number { background: var(--accent-blue); color: white; }
        .nav-label { font-size: 0.95rem; font-weight: 500; }

        .sidebar-footer {
            padding: 20px;
            border-top: 1px solid var(--border-subtle);
            background: rgba(0,0,0,0.2);
        }

        .doc-btn {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
            width: 100%;
            padding: 14px 20px;
            background: linear-gradient(135deg, var(--accent-blue) 0%, var(--accent-teal) 100%);
            color: white;
            border: none;
            border-radius: 10px;
            font-weight: 600;
            cursor: pointer;
            transition: transform 0.2s, box-shadow 0.2s;
            text-decoration: none;
            font-size: 0.95rem;
        }

        .doc-btn:hover { transform: translateY(-2px); box-shadow: 0 8px 25px rgba(59, 130, 246, 0.3); }

        /* Main Content */
        .main-content { margin-left: var(--sidebar-width); padding: 80px 40px 40px 40px; }

        /* Tab Panels */
        .tab-panel { display: none; }
        .tab-panel.active { display: block; }

        .header {
            background: var(--bg-card);
            border: 1px solid var(--border-subtle);
            padding: 35px;
            border-radius: 16px;
            margin-bottom: 30px;
            position: relative;
            overflow: hidden;
        }

        .header::before {
            content: '';
            position: absolute;
            top: 0; left: 0; right: 0; bottom: 0;
            background:
                radial-gradient(ellipse at 20% 20%, rgba(59, 130, 246, 0.1) 0%, transparent 50%),
                radial-gradient(ellipse at 80% 80%, rgba(20, 184, 166, 0.08) 0%, transparent 50%);
            pointer-events: none;
        }

        .header h1 {
            font-size: 2.2rem;
            font-weight: 800;
            margin-bottom: 10px;
            position: relative;
            background: linear-gradient(135deg, var(--text-primary) 0%, var(--accent-blue) 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .header .subtitle { color: var(--text-secondary); font-size: 1.1rem; position: relative; }

        .header .meta { display: flex; gap: 15px; margin-top: 20px; flex-wrap: wrap; position: relative; }

        .header .meta-item {
            background: rgba(255,255,255,0.05);
            border: 1px solid var(--border-subtle);
            padding: 8px 16px;
            border-radius: 8px;
            font-size: 0.9rem;
            color: var(--text-secondary);
        }

        /* Legend */
        .legend {
            display: flex;
            flex-wrap: wrap;
            gap: 15px;
            padding: 18px 22px;
            background: var(--bg-card);
            border: 1px solid var(--border-subtle);
            border-radius: 12px;
            margin-bottom: 25px;
        }

        .legend-item { display: flex; align-items: center; gap: 8px; font-size: 0.85rem; color: var(--text-secondary); }
        .legend-color { width: 18px; height: 18px; border-radius: 4px; }

        /* Sections */
        .section {
            background: var(--bg-card);
            border: 1px solid var(--border-subtle);
            border-radius: 16px;
            margin-bottom: 25px;
            overflow: hidden;
            scroll-margin-top: 75px;
        }

        .section-header {
            background: linear-gradient(135deg, var(--bg-secondary) 0%, rgba(59, 130, 246, 0.1) 100%);
            border-bottom: 1px solid var(--border-subtle);
            padding: 22px 25px;
            display: flex;
            align-items: center;
            gap: 18px;
        }

        .section-number {
            background: linear-gradient(135deg, var(--accent-blue) 0%, var(--accent-teal) 100%);
            color: white;
            width: 48px;
            height: 48px;
            border-radius: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 800;
            font-size: 1.3rem;
            flex-shrink: 0;
        }

        .section-title h2 { font-size: 1.35rem; font-weight: 700; margin-bottom: 4px; color: var(--text-primary); }
        .section-title span { font-size: 0.9rem; color: var(--text-muted); }
        .section-content { padding: 28px; }

        /* Workflow Diagrams */
        .workflow-diagram {
            background: rgba(0,0,0,0.3);
            border: 1px solid var(--border-subtle);
            border-radius: 12px;
            padding: 28px;
            margin-bottom: 22px;
        }

        .flow-row { display: flex; align-items: center; justify-content: center; flex-wrap: wrap; gap: 12px; margin: 15px 0; }

        .flow-node {
            padding: 14px 22px;
            border-radius: 10px;
            text-align: center;
            font-size: 0.9rem;
            font-weight: 600;
            min-width: 150px;
            border: 1px solid var(--border-subtle);
        }

        .flow-node.start { background: linear-gradient(135deg, var(--accent-green) 0%, #16a34a 100%); color: white; border-radius: 25px; border: none; }
        .flow-node.action { background: linear-gradient(135deg, var(--accent-blue) 0%, #2563eb 100%); color: white; border: none; }
        .flow-node.decision { background: linear-gradient(135deg, var(--accent-amber) 0%, #d97706 100%); color: var(--bg-primary); border: none; }
        .flow-node.input { background: var(--bg-secondary); border: 2px solid var(--accent-blue); color: var(--text-primary); }
        .flow-node.output { background: linear-gradient(135deg, var(--accent-teal) 0%, #0d9488 100%); color: white; border: none; }
        .flow-node.exception { background: linear-gradient(135deg, var(--accent-rose) 0%, #dc2626 100%); color: white; border: none; }

        .flow-arrow { color: var(--accent-blue); font-size: 1.5rem; }
        .flow-arrow.down { transform: rotate(90deg); }

        .decision-branch { display: flex; gap: 40px; justify-content: center; margin: 20px 0; flex-wrap: wrap; }
        .branch { display: flex; flex-direction: column; align-items: center; gap: 10px; }

        .branch-label {
            background: var(--bg-secondary);
            border: 1px solid var(--border-subtle);
            padding: 6px 16px;
            border-radius: 20px;
            font-size: 0.8rem;
            font-weight: 700;
            color: var(--text-secondary);
        }

        /* Tables */
        .field-table { width: 100%; border-collapse: collapse; margin: 18px 0; }

        .field-table th {
            background: rgba(59, 130, 246, 0.15);
            color: var(--accent-blue);
            padding: 14px 18px;
            text-align: left;
            font-weight: 600;
            font-size: 0.9rem;
            text-transform: uppercase;
            letter-spacing: 0.05em;
            border-bottom: 1px solid var(--border-subtle);
        }

        .field-table td { padding: 14px 18px; border-bottom: 1px solid var(--border-subtle); color: var(--text-secondary); }
        .field-table tr:hover { background: rgba(255,255,255,0.02); }

        .badge { display: inline-block; padding: 4px 12px; border-radius: 6px; font-size: 0.75rem; font-weight: 700; text-transform: uppercase; letter-spacing: 0.05em; }
        .badge.required-badge { background: rgba(244, 63, 94, 0.15); color: var(--accent-rose); }
        .badge.optional-badge { background: rgba(34, 197, 94, 0.15); color: var(--accent-green); }
        .badge.calculated-badge { background: rgba(59, 130, 246, 0.15); color: var(--accent-blue); }

        /* Info Boxes */
        .exception-box, .tip-box, .info-box {
            padding: 18px 22px;
            margin: 18px 0;
            border-radius: 0 10px 10px 0;
            border-left-width: 4px;
            border-left-style: solid;
        }

        .exception-box { background: rgba(244, 63, 94, 0.08); border-color: var(--accent-rose); border: 1px solid rgba(244, 63, 94, 0.2); border-left: 4px solid var(--accent-rose); }
        .exception-box h4 { color: var(--accent-rose); margin-bottom: 10px; font-size: 1rem; }
        .exception-box p, .exception-box li { color: var(--text-secondary); }

        .tip-box { background: rgba(34, 197, 94, 0.08); border-color: var(--accent-green); border: 1px solid rgba(34, 197, 94, 0.2); border-left: 4px solid var(--accent-green); }
        .tip-box h4 { color: var(--accent-green); margin-bottom: 10px; font-size: 1rem; }
        .tip-box p, .tip-box li { color: var(--text-secondary); }

        .info-box { background: rgba(59, 130, 246, 0.08); border-color: var(--accent-blue); border: 1px solid rgba(59, 130, 246, 0.2); border-left: 4px solid var(--accent-blue); }
        .info-box h4 { color: var(--accent-blue); margin-bottom: 10px; font-size: 1rem; }
        .info-box p, .info-box li { color: var(--text-secondary); }

        /* Decision Tree */
        .decision-tree {
            background: rgba(0,0,0,0.2);
            border: 1px solid var(--border-subtle);
            border-radius: 12px;
            padding: 22px;
            margin: 22px 0;
        }

        .decision-tree h3 { color: var(--accent-blue); margin-bottom: 18px; padding-bottom: 12px; border-bottom: 1px solid var(--border-subtle); font-size: 1.1rem; }

        .tree-node { margin-left: 20px; padding: 12px; border-left: 2px solid var(--accent-teal); position: relative; color: var(--text-secondary); }
        .tree-node::before { content: ''; position: absolute; left: -2px; top: 22px; width: 15px; height: 2px; background: var(--accent-teal); }
        .tree-node.level-1 { margin-left: 0; border-left: none; }
        .tree-node.level-1::before { display: none; }

        .tree-label { background: var(--accent-amber); color: var(--bg-primary); padding: 6px 14px; border-radius: 6px; font-weight: 700; display: inline-block; margin-bottom: 6px; font-size: 0.9rem; }

        /* Summary Grid */
        .summary-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(180px, 1fr)); gap: 18px; margin: 22px 0; }

        .summary-card { background: rgba(0,0,0,0.3); border: 1px solid var(--border-subtle); border-radius: 12px; padding: 22px; text-align: center; }
        .summary-card h4 { color: var(--text-secondary); margin-bottom: 12px; font-size: 0.9rem; }
        .summary-card .value {
            font-size: 2.2rem;
            font-weight: 800;
            background: linear-gradient(135deg, var(--accent-blue) 0%, var(--accent-teal) 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }
        .summary-card .label { font-size: 0.85rem; color: var(--text-muted); margin-top: 8px; }

        /* Quick Reference */
        .quick-ref {
            background: linear-gradient(135deg, var(--bg-secondary) 0%, var(--bg-card) 100%);
            border: 1px solid var(--border-subtle);
            padding: 28px;
            border-radius: 16px;
            margin-top: 30px;
            font-family: 'JetBrains Mono', monospace;
            scroll-margin-top: 75px;
        }

        .quick-ref h3 { color: var(--accent-amber); margin-bottom: 18px; font-family: 'Plus Jakarta Sans', sans-serif; }
        .quick-ref pre { background: rgba(0,0,0,0.4); border: 1px solid var(--border-subtle); padding: 20px; border-radius: 10px; overflow-x: auto; font-size: 0.85rem; line-height: 1.7; color: var(--text-secondary); }

        /* Step List */
        .step-list { list-style: none; padding: 0; margin: 18px 0; }
        .step-list li {
            padding: 14px 18px;
            border-left: 3px solid var(--accent-blue);
            background: rgba(0,0,0,0.2);
            margin-bottom: 10px;
            border-radius: 0 8px 8px 0;
            color: var(--text-secondary);
        }
        .step-list li strong { color: var(--text-primary); }

        /* ====== AGENT OPPORTUNITIES STYLES ====== */
        .agent-header {
            background: var(--bg-card);
            border: 1px solid var(--border-subtle);
            padding: 35px;
            border-radius: 16px;
            margin-bottom: 30px;
            position: relative;
            overflow: hidden;
        }

        .agent-header::before {
            content: '';
            position: absolute;
            top: 0; left: 0; right: 0; bottom: 0;
            background:
                radial-gradient(ellipse at 20% 20%, rgba(139, 92, 246, 0.12) 0%, transparent 50%),
                radial-gradient(ellipse at 80% 80%, rgba(245, 158, 11, 0.1) 0%, transparent 50%);
            pointer-events: none;
        }

        .agent-header h1 {
            font-size: 2.2rem;
            font-weight: 800;
            margin-bottom: 10px;
            position: relative;
            background: linear-gradient(135deg, var(--accent-purple) 0%, var(--accent-amber) 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .agent-header .subtitle { color: var(--text-secondary); font-size: 1.1rem; position: relative; }

        /* Heat Map */
        .heat-map-container { margin-bottom: 35px; }
        .heat-map-title { font-size: 1.3rem; font-weight: 700; color: var(--text-primary); margin-bottom: 20px; display: flex; align-items: center; gap: 12px; }

        .heat-map-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
        }

        .heat-item {
            background: var(--bg-card);
            border: 1px solid var(--border-subtle);
            border-radius: 12px;
            padding: 20px;
            position: relative;
            overflow: hidden;
            transition: transform 0.2s, box-shadow 0.2s;
            cursor: pointer;
        }

        .heat-item:hover { transform: translateY(-3px); box-shadow: 0 10px 30px rgba(0,0,0,0.3); }
        .heat-item:active { transform: scale(0.98); }

        .heat-item::before {
            content: '';
            position: absolute;
            top: 0; left: 0; right: 0; height: 4px;
        }

        .heat-item.critical::before { background: linear-gradient(90deg, #ef4444, #f97316); }
        .heat-item.high::before { background: linear-gradient(90deg, #f97316, #eab308); }
        .heat-item.medium::before { background: linear-gradient(90deg, #eab308, #22c55e); }
        .heat-item.low::before { background: linear-gradient(90deg, #22c55e, #14b8a6); }

        .heat-score {
            position: absolute;
            top: 15px;
            right: 15px;
            font-size: 1.8rem;
            font-weight: 800;
        }

        .heat-item.critical .heat-score { color: #ef4444; }
        .heat-item.high .heat-score { color: #f97316; }
        .heat-item.medium .heat-score { color: #eab308; }
        .heat-item.low .heat-score { color: #22c55e; }

        .heat-name { font-size: 1rem; font-weight: 700; color: var(--text-primary); margin-bottom: 6px; padding-right: 50px; }
        .heat-desc { font-size: 0.85rem; color: var(--text-muted); margin-bottom: 12px; }

        .heat-metrics { display: flex; gap: 15px; margin-top: 12px; }
        .heat-metric { font-size: 0.75rem; color: var(--text-muted); }
        .heat-metric span { color: var(--text-secondary); font-weight: 600; }

        /* Agent Cards */
        .agent-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(380px, 1fr)); gap: 25px; margin-bottom: 35px; }

        .agent-card {
            background: var(--bg-card);
            border: 1px solid var(--border-subtle);
            border-radius: 16px;
            overflow: hidden;
            transition: transform 0.2s, box-shadow 0.2s;
        }

        .agent-card:hover { transform: translateY(-5px); box-shadow: 0 15px 50px rgba(0,0,0,0.3); }

        .agent-card.highlight {
            animation: highlightPulse 2s ease;
            box-shadow: 0 0 0 3px var(--accent-purple), 0 15px 50px rgba(139, 92, 246, 0.4);
        }

        @keyframes highlightPulse {
            0% { box-shadow: 0 0 0 3px var(--accent-purple), 0 15px 50px rgba(139, 92, 246, 0.6); }
            50% { box-shadow: 0 0 0 6px rgba(139, 92, 246, 0.5), 0 15px 50px rgba(139, 92, 246, 0.3); }
            100% { box-shadow: 0 0 0 0px transparent, 0 15px 50px rgba(0,0,0,0.3); }
        }

        .agent-card-header {
            padding: 22px;
            display: flex;
            align-items: flex-start;
            gap: 18px;
            border-bottom: 1px solid var(--border-subtle);
        }

        .agent-icon {
            width: 55px;
            height: 55px;
            background: linear-gradient(135deg, var(--accent-purple) 0%, var(--accent-blue) 100%);
            border-radius: 14px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.6rem;
            flex-shrink: 0;
        }

        .agent-info { flex: 1; }
        .agent-name { font-size: 1.15rem; font-weight: 700; color: var(--text-primary); margin-bottom: 5px; }
        .agent-type { font-size: 0.8rem; color: var(--accent-purple); font-weight: 600; text-transform: uppercase; letter-spacing: 0.05em; }

        .agent-priority {
            padding: 6px 12px;
            border-radius: 20px;
            font-size: 0.75rem;
            font-weight: 700;
            text-transform: uppercase;
        }

        .agent-priority.critical { background: rgba(239, 68, 68, 0.15); color: #ef4444; }
        .agent-priority.high { background: rgba(249, 115, 22, 0.15); color: #f97316; }
        .agent-priority.medium { background: rgba(234, 179, 8, 0.15); color: #eab308; }
        .agent-priority.low { background: rgba(34, 197, 94, 0.15); color: #22c55e; }

        .agent-card-body { padding: 22px; }
        .agent-description { font-size: 0.95rem; color: var(--text-secondary); line-height: 1.6; margin-bottom: 20px; }

        .agent-flow {
            background: rgba(0,0,0,0.3);
            border: 1px solid var(--border-subtle);
            border-radius: 10px;
            padding: 18px;
            margin-bottom: 20px;
        }

        .agent-flow-title { font-size: 0.85rem; color: var(--text-muted); margin-bottom: 12px; font-weight: 600; text-transform: uppercase; letter-spacing: 0.05em; }

        .agent-flow-diagram { display: flex; align-items: center; flex-wrap: wrap; gap: 8px; justify-content: center; }

        .agent-step {
            background: linear-gradient(135deg, var(--accent-purple) 0%, var(--accent-blue) 100%);
            color: white;
            padding: 8px 14px;
            border-radius: 6px;
            font-size: 0.8rem;
            font-weight: 600;
            white-space: nowrap;
        }

        .agent-arrow { color: var(--accent-purple); font-size: 1.2rem; }

        .agent-stats { display: grid; grid-template-columns: repeat(3, 1fr); gap: 12px; }

        .agent-stat {
            background: rgba(0,0,0,0.2);
            border-radius: 8px;
            padding: 12px;
            text-align: center;
        }

        .agent-stat-value {
            font-size: 1.3rem;
            font-weight: 800;
            background: linear-gradient(135deg, var(--accent-purple) 0%, var(--accent-amber) 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .agent-stat-label { font-size: 0.7rem; color: var(--text-muted); text-transform: uppercase; letter-spacing: 0.05em; margin-top: 4px; }

        /* View Prompt Button */
        .agent-prompt-btn {
            width: 100%;
            margin-top: 18px;
            padding: 14px 20px;
            background: linear-gradient(135deg, rgba(139, 92, 246, 0.2) 0%, rgba(59, 130, 246, 0.2) 100%);
            border: 1px solid rgba(139, 92, 246, 0.4);
            border-radius: 10px;
            color: var(--accent-purple);
            font-weight: 700;
            cursor: pointer;
            transition: all 0.2s;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
            font-size: 0.9rem;
        }

        .agent-prompt-btn:hover {
            background: linear-gradient(135deg, rgba(139, 92, 246, 0.3) 0%, rgba(59, 130, 246, 0.3) 100%);
            border-color: var(--accent-purple);
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(139, 92, 246, 0.25);
        }

        /* Summary Stats */
        .agent-summary {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin-bottom: 35px;
        }

        .agent-summary-card {
            background: var(--bg-card);
            border: 1px solid var(--border-subtle);
            border-radius: 14px;
            padding: 25px;
            text-align: center;
        }

        .agent-summary-value {
            font-size: 2.5rem;
            font-weight: 800;
            background: linear-gradient(135deg, var(--accent-purple) 0%, var(--accent-amber) 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .agent-summary-label { font-size: 0.9rem; color: var(--text-muted); margin-top: 8px; }

        /* Heat Map Legend */
        .heat-legend {
            display: flex;
            gap: 25px;
            padding: 18px 22px;
            background: var(--bg-card);
            border: 1px solid var(--border-subtle);
            border-radius: 12px;
            margin-bottom: 25px;
            flex-wrap: wrap;
        }

        .heat-legend-item { display: flex; align-items: center; gap: 10px; font-size: 0.9rem; color: var(--text-secondary); }
        .heat-legend-color { width: 24px; height: 24px; border-radius: 6px; }

        /* Modal */
        .modal-overlay {
            display: none;
            position: fixed;
            top: 0; left: 0; right: 0; bottom: 0;
            background: rgba(10, 15, 26, 0.9);
            z-index: 2000;
            justify-content: center;
            align-items: center;
            padding: 20px;
            backdrop-filter: blur(5px);
        }

        .modal-overlay.show { display: flex; }

        .modal {
            background: var(--bg-card);
            border: 1px solid var(--border-subtle);
            border-radius: 16px;
            width: 100%;
            max-width: 950px;
            max-height: 90vh;
            display: flex;
            flex-direction: column;
            box-shadow: 0 25px 80px rgba(0,0,0,0.5);
        }

        .modal-header {
            background: linear-gradient(135deg, var(--accent-blue) 0%, var(--accent-teal) 100%);
            color: white;
            padding: 22px 28px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            border-radius: 16px 16px 0 0;
        }

        .modal-header h3 { font-size: 1.25rem; font-weight: 700; }
        .modal-actions { display: flex; gap: 12px; }

        .modal-btn {
            padding: 10px 18px;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-weight: 700;
            transition: transform 0.2s;
            font-size: 0.9rem;
        }

        .modal-btn:hover { transform: scale(1.05); }
        .modal-btn.copy { background: white; color: var(--accent-blue); }
        .modal-btn.close { background: rgba(255,255,255,0.2); color: white; }

        .modal-body { padding: 28px; overflow-y: auto; flex: 1; }

        .modal-body pre {
            background: rgba(0,0,0,0.3);
            border: 1px solid var(--border-subtle);
            padding: 22px;
            border-radius: 10px;
            font-family: 'JetBrains Mono', monospace;
            font-size: 0.9rem;
            line-height: 1.7;
            white-space: pre-wrap;
            word-wrap: break-word;
            color: var(--text-secondary);
        }

        .copy-success {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: var(--accent-green);
            color: white;
            padding: 18px 35px;
            border-radius: 10px;
            font-weight: 700;
            z-index: 3000;
            display: none;
            animation: fadeInOut 2s ease;
        }

        @keyframes fadeInOut { 0%, 100% { opacity: 0; } 10%, 90% { opacity: 1; } }

        /* Prompt Modal */
        .prompt-modal .modal { max-width: 800px; }
        .prompt-modal .modal-header { background: linear-gradient(135deg, var(--accent-purple) 0%, var(--accent-blue) 100%); }

        .prompt-section { margin-bottom: 25px; }
        .prompt-section h4 { color: var(--accent-purple); font-size: 1rem; margin-bottom: 12px; display: flex; align-items: center; gap: 8px; }

        .prompt-box {
            background: rgba(0,0,0,0.4);
            border: 1px solid var(--border-subtle);
            border-radius: 10px;
            padding: 20px;
            font-family: 'JetBrains Mono', monospace;
            font-size: 0.85rem;
            line-height: 1.7;
            color: var(--text-secondary);
            white-space: pre-wrap;
            word-wrap: break-word;
        }

        .prompt-tags { display: flex; gap: 10px; flex-wrap: wrap; margin-bottom: 20px; }
        .prompt-tag { background: rgba(139, 92, 246, 0.15); color: var(--accent-purple); padding: 6px 14px; border-radius: 20px; font-size: 0.8rem; font-weight: 600; }

        @media (max-width: 900px) {
            .sidebar { display: none; }
            .main-content { margin-left: 0; padding: 75px 20px 30px 20px; }
            .agent-grid { grid-template-columns: 1fr; }
        }
        .breadcrumb-logo-link { display: inline-flex; align-items: center; padding: 4px 8px; background: rgba(255,255,255,0.08); border-radius: 8px; border: 1px solid rgba(255,255,255,0.12); transition: all 0.2s; flex-shrink: 0; margin-right: 4px; }
        .breadcrumb-logo-link:hover { background: rgba(255,255,255,0.15); }
        .breadcrumb-logo { height: 24px; width: auto; display: block; }
    </style>
</head>
<body>
    <!-- Breadcrumb -->
    <nav class="breadcrumb">
<a href="../../index.html" class="breadcrumb-logo-link"><img src="../../images/clear-ai-logo.png" alt="Clear AI" class="breadcrumb-logo"></a>
        <a href="../../index.html">Portal Home</a>
        <span class="separator">></span>
        <a href="./index.html">Mortgage Fundamentals</a>
        <span class="separator">></span>
        <span class="current">Converting Loan to GFE (Good Faith Estimate)</span>
    </nav>

    <!-- Fixed Sidebar -->
    <aside class="sidebar">
        <div class="sidebar-header">
            <h2>GFE Conversion</h2>
            <p>Interactive Workflow Guide</p>
        </div>

        <!-- Tab Switcher -->
        <div class="sidebar-tabs">
            <button class="sidebar-tab active" onclick="switchTab('workflow')">Workflow</button>
            <button class="sidebar-tab agent-tab" onclick="switchTab('agents')">AI Agents</button>
        </div>

        <!-- Workflow Navigation -->
        <nav class="sidebar-nav" id="workflow-nav">
            <a href="#section-1" class="nav-item active">
                <span class="nav-number">1</span>
                <span class="nav-label">Access GFE Screens</span>
            </a>
            <a href="#section-2" class="nav-item">
                <span class="nav-number">2</span>
                <span class="nav-label">Enable GFE Mode</span>
            </a>
            <a href="#section-3" class="nav-item">
                <span class="nav-number">3</span>
                <span class="nav-label">Set Delivery Date</span>
            </a>
            <a href="#section-4" class="nav-item">
                <span class="nav-number">4</span>
                <span class="nav-label">Important Dates</span>
            </a>
            <a href="#section-5" class="nav-item">
                <span class="nav-number">5</span>
                <span class="nav-label">TRID Applicability</span>
            </a>
            <a href="#section-6" class="nav-item">
                <span class="nav-number">6</span>
                <span class="nav-label">Key Considerations</span>
            </a>
            <a href="#quick-ref" class="nav-item">
                <span class="nav-number">*</span>
                <span class="nav-label">Quick Reference</span>
            </a>
        </nav>

        <!-- Agent Navigation -->
        <nav class="sidebar-nav" id="agents-nav" style="display: none;">
            <a href="#agent-summary" class="nav-item active">
                <span class="nav-number">S</span>
                <span class="nav-label">Summary</span>
            </a>
            <a href="#agent-heatmap" class="nav-item">
                <span class="nav-number">H</span>
                <span class="nav-label">Heat Map</span>
            </a>
            <a href="#agent-details" class="nav-item">
                <span class="nav-number">A</span>
                <span class="nav-label">Agent Details</span>
            </a>
        </nav>

        <div class="sidebar-footer">
            <button class="doc-btn" onclick="openDocModal()">
                View Workflow Markdown
            </button>
        </div>
    </aside>

    <!-- Main Content -->
    <main class="main-content">

        <!-- ==================== WORKFLOW TAB ==================== -->
        <div id="workflow-panel" class="tab-panel active">
            <!-- Header -->
            <div class="header">
                <h1>Converting Loan to GFE (Good Faith Estimate)</h1>
                <p class="subtitle">Complete guide for converting a loan file to use the GFE and HUD-1 forms for pre-TRID application dates</p>
                <div class="meta">
                    <span class="meta-item">System: Byte LOS</span>
                    <span class="meta-item">Role: Processor / Loan Officer</span>
                    <span class="meta-item">Updated: Oct 9, 2023</span>
                    <span class="meta-item">Duration: 2-5 min</span>
                </div>
            </div>

            <!-- Legend -->
            <div class="legend">
                <div class="legend-item"><div class="legend-color" style="background: linear-gradient(135deg, #22c55e, #16a34a);"></div><span>Start/End</span></div>
                <div class="legend-item"><div class="legend-color" style="background: linear-gradient(135deg, #3b82f6, #2563eb);"></div><span>Action Step</span></div>
                <div class="legend-item"><div class="legend-color" style="background: linear-gradient(135deg, #f59e0b, #d97706);"></div><span>Decision Point</span></div>
                <div class="legend-item"><div class="legend-color" style="background: #111827; border: 2px solid #3b82f6;"></div><span>User Input</span></div>
                <div class="legend-item"><div class="legend-color" style="background: linear-gradient(135deg, #f43f5e, #dc2626);"></div><span>Exception</span></div>
                <div class="legend-item"><div class="legend-color" style="background: linear-gradient(135deg, #14b8a6, #0d9488);"></div><span>Output</span></div>
            </div>

            <!-- Section 1: Access GFE Screens -->
            <section id="section-1" class="section">
                <div class="section-header">
                    <div class="section-number">1</div>
                    <div class="section-title"><h2>Access GFE Screens</h2><span>Navigate to the GFE 2010 Pages in Byte</span></div>
                </div>
                <div class="section-content">
                    <div class="workflow-diagram">
                        <div class="flow-row">
                            <div class="flow-node start">Start</div>
                            <span class="flow-arrow">-></span>
                            <div class="flow-node action">Click All Screens</div>
                            <span class="flow-arrow">-></span>
                            <div class="flow-node action">Open GFE 2010 Pages 1 and 3</div>
                            <span class="flow-arrow">-></span>
                            <div class="flow-node output">GFE Screen Loaded</div>
                        </div>
                    </div>
                    <ul class="step-list">
                        <li><strong>Step 1:</strong> Click <strong>All Screens</strong> in the Byte navigation menu</li>
                        <li><strong>Step 2:</strong> Open <strong>GFE 2010 Pages 1 and 3</strong> from the screen list</li>
                    </ul>
                    <div class="info-box">
                        <h4>GFE Screen Location</h4>
                        <p>The GFE 2010 screens are located in the All Screens menu. You will see options for "GFE 2010 Pages 1 and 3", "GFE 2010 Page 2", and other GFE-related screens.</p>
                    </div>
                    <div class="tip-box">
                        <h4>When to Use GFE</h4>
                        <p>The GFE (Good Faith Estimate) and HUD-1 forms are used for loan applications dated <strong>before October 3, 2015</strong>. Applications on or after this date must use the Loan Estimate (LE) and Closing Disclosure (CD) under TRID regulations.</p>
                    </div>
                </div>
            </section>

            <!-- Section 2: Enable GFE Mode -->
            <section id="section-2" class="section">
                <div class="section-header">
                    <div class="section-number">2</div>
                    <div class="section-title"><h2>Enable GFE Mode</h2><span>Configure the loan file to use GFE and HUD-1 forms</span></div>
                </div>
                <div class="section-content">
                    <div class="workflow-diagram">
                        <div class="flow-row">
                            <div class="flow-node action">Click Learn More Link</div>
                            <span class="flow-arrow">-></span>
                            <div class="flow-node output">TRID Applicability Window Opens</div>
                            <span class="flow-arrow">-></span>
                            <div class="flow-node action">Check GFE Box</div>
                            <span class="flow-arrow">-></span>
                            <div class="flow-node output">Click OK</div>
                        </div>
                    </div>
                    <ul class="step-list">
                        <li><strong>Step 3:</strong> At the top of the screen, you will see a message: <em>"This file should use the GFE."</em> Click the <strong>Learn More</strong> link</li>
                        <li><strong>Step 4:</strong> The <strong>TRID Applicability</strong> window opens</li>
                        <li><strong>Step 5:</strong> Check the box next to <strong>"Use the GFE and HUD-1 for this file"</strong></li>
                        <li><strong>Step 6:</strong> Click <strong>OK</strong> to confirm</li>
                    </ul>
                    <div class="info-box">
                        <h4>TRID Applicability Window</h4>
                        <p>The TRID Applicability window displays important information about why the file should use GFE forms:</p>
                        <ul style="margin-top: 10px; margin-left: 20px;">
                            <li>The application date on this file is before 10/03/2015, or</li>
                            <li>The application date has not been entered, or</li>
                            <li>The box below is checked</li>
                        </ul>
                        <p style="margin-top: 10px;">The Loan Estimate may only be used when the application date is on or after 10/03/2015 and the box below is NOT checked.</p>
                    </div>
                    <div class="exception-box">
                        <h4>Important: Fee Fields Activation</h4>
                        <p>Checking this box opens the fee fields on the GFE and HUD-1 Screens. Without enabling this option, you will not be able to enter fee information on these forms.</p>
                    </div>
                </div>
            </section>

            <!-- Section 3: Set Delivery Date -->
            <section id="section-3" class="section">
                <div class="section-header">
                    <div class="section-number">3</div>
                    <div class="section-title"><h2>Set GFE/TIL Delivery Date</h2><span>Enter the delivery date for the Good Faith Estimate</span></div>
                </div>
                <div class="section-content">
                    <div class="workflow-diagram">
                        <div class="flow-row">
                            <div class="flow-node action">Locate Delivery Info Section</div>
                            <span class="flow-arrow">-></span>
                            <div class="flow-node input">Click Radio Button</div>
                            <span class="flow-arrow">-></span>
                            <div class="flow-node output">GFE/TIL Delivery Date Set</div>
                        </div>
                    </div>
                    <ul class="step-list">
                        <li><strong>Step 5:</strong> In the <strong>DELIVERY INFO</strong> section on the right side of the screen, locate the <strong>GFE/TIL Delivery Date</strong> field</li>
                        <li><strong>Step 6:</strong> Click the <strong>radio button</strong> to enter the GFE/TIL Delivery Date as today's date</li>
                    </ul>
                    <table class="field-table">
                        <thead>
                            <tr>
                                <th>Field</th>
                                <th>Description</th>
                                <th>Action</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td><strong>Property TBD</strong></td>
                                <td>Checkbox for property to be determined</td>
                                <td><span class="badge optional-badge">Optional</span></td>
                            </tr>
                            <tr>
                                <td><strong>Street</strong></td>
                                <td>Subject property street address</td>
                                <td><span class="badge calculated-badge">Auto-Populated</span></td>
                            </tr>
                            <tr>
                                <td><strong>City, State, Zip</strong></td>
                                <td>Subject property location details</td>
                                <td><span class="badge calculated-badge">Auto-Populated</span></td>
                            </tr>
                            <tr>
                                <td><strong>County</strong></td>
                                <td>Property county with unit count</td>
                                <td><span class="badge calculated-badge">Auto-Populated</span></td>
                            </tr>
                            <tr>
                                <td><strong>Property Type</strong></td>
                                <td>Type of property (Detached, Condo, etc.)</td>
                                <td><span class="badge calculated-badge">Auto-Populated</span></td>
                            </tr>
                            <tr>
                                <td><strong>Parcel No</strong></td>
                                <td>Property parcel number</td>
                                <td><span class="badge calculated-badge">Auto-Populated</span></td>
                            </tr>
                            <tr>
                                <td><strong>Intent to Proceed Date</strong></td>
                                <td>Date borrower indicated intent to proceed</td>
                                <td><span class="badge optional-badge">Optional</span></td>
                            </tr>
                            <tr>
                                <td><strong>GFE/TIL Delivery Date</strong></td>
                                <td>Date GFE was delivered to borrower</td>
                                <td><span class="badge required-badge">Required</span></td>
                            </tr>
                            <tr>
                                <td><strong>GFE/TIL Delivery Method</strong></td>
                                <td>How GFE was delivered (Mail, Email, etc.)</td>
                                <td><span class="badge optional-badge">Optional</span></td>
                            </tr>
                            <tr>
                                <td><strong>GFE Revision Date</strong></td>
                                <td>Date of any GFE revision</td>
                                <td><span class="badge optional-badge">If Applicable</span></td>
                            </tr>
                            <tr>
                                <td><strong>GFE Revision Delivery Method</strong></td>
                                <td>How revised GFE was delivered</td>
                                <td><span class="badge optional-badge">If Applicable</span></td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </section>

            <!-- Section 4: Important Dates -->
            <section id="section-4" class="section">
                <div class="section-header">
                    <div class="section-number">4</div>
                    <div class="section-title"><h2>Important Dates</h2><span>Configure the GFE validity period</span></div>
                </div>
                <div class="section-content">
                    <div class="workflow-diagram">
                        <div class="flow-row">
                            <div class="flow-node action">Navigate to GFE Page 1</div>
                            <span class="flow-arrow">-></span>
                            <div class="flow-node action">Click Fill Button</div>
                            <span class="flow-arrow">-></span>
                            <div class="flow-node output">Business Day Explanation</div>
                            <span class="flow-arrow">-></span>
                            <div class="flow-node action">Click OK</div>
                        </div>
                    </div>
                    <ul class="step-list">
                        <li><strong>Step 6:</strong> On <strong>GFE PAGE 1</strong>, locate the <strong>Important Dates</strong> section</li>
                        <li><strong>Step 7:</strong> Click the <strong>Fill</strong> button next to "This estimate for all other settlement charges is available through"</li>
                        <li><strong>Step 8:</strong> The <strong>Business Day Explanation</strong> window appears</li>
                        <li><strong>Step 9:</strong> Click <strong>OK</strong> to confirm</li>
                    </ul>
                    <table class="field-table">
                        <thead>
                            <tr>
                                <th>Important Date Field</th>
                                <th>Description</th>
                                <th>Status</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td><strong>1. Interest Rate Availability</strong></td>
                                <td>The interest rate for this GFE is available through [date]</td>
                                <td><span class="badge optional-badge">Optional</span></td>
                            </tr>
                            <tr>
                                <td><strong>2. Settlement Charges Estimate</strong></td>
                                <td>This estimate for all other settlement charges is available through [date]</td>
                                <td><span class="badge required-badge">Required</span></td>
                            </tr>
                            <tr>
                                <td><strong>3. Rate Lock Settlement Period</strong></td>
                                <td>After you lock your interest rate, you must go to settlement within [X] days</td>
                                <td><span class="badge optional-badge">Optional</span></td>
                            </tr>
                            <tr>
                                <td><strong>4. Minimum Lock Period</strong></td>
                                <td>You must lock the interest rate at least [X] days before settlement</td>
                                <td><span class="badge optional-badge">Optional</span></td>
                            </tr>
                        </tbody>
                    </table>
                    <div class="info-box">
                        <h4>Business Day Explanation</h4>
                        <p>The Fill button automatically calculates the date that is <strong>10 business days from today</strong>. Business days can be set up in the defaults. The Details button to the right of the Fill button displays how the date is calculated.</p>
                    </div>
                    <div class="tip-box">
                        <h4>Do Not Show Again Option</h4>
                        <p>The Business Day Explanation window includes a checkbox for "Do not show this message again" if you do not wish to see this explanation each time you use the Fill button.</p>
                    </div>
                </div>
            </section>

            <!-- Section 5: TRID Applicability -->
            <section id="section-5" class="section">
                <div class="section-header">
                    <div class="section-number">5</div>
                    <div class="section-title"><h2>TRID Applicability Rules</h2><span>Understanding when to use GFE vs. Loan Estimate</span></div>
                </div>
                <div class="section-content">
                    <div class="decision-tree">
                        <h3>When to Use GFE and HUD-1</h3>
                        <p style="color: var(--text-secondary); margin-bottom: 15px;">The GFE (Good Faith Estimate) and HUD-1 Settlement Statement are used when:</p>
                        <ul class="step-list">
                            <li><strong>Condition 1:</strong> The application date on the file is <strong>before October 3, 2015</strong></li>
                            <li><strong>Condition 2:</strong> The application date has <strong>not been entered</strong> in the system</li>
                            <li><strong>Condition 3:</strong> The "Use the GFE and HUD-1 for this file" checkbox is <strong>manually checked</strong></li>
                        </ul>
                    </div>
                    <div class="decision-tree">
                        <h3>When to Use Loan Estimate (LE) and Closing Disclosure (CD)</h3>
                        <p style="color: var(--text-secondary); margin-bottom: 15px;">The Loan Estimate and Closing Disclosure (TRID forms) must be used when:</p>
                        <ul class="step-list">
                            <li><strong>Requirement 1:</strong> The application date is on or after <strong>October 3, 2015</strong></li>
                            <li><strong>Requirement 2:</strong> The "Use the GFE and HUD-1 for this file" checkbox is <strong>NOT checked</strong></li>
                        </ul>
                    </div>
                    <div class="exception-box">
                        <h4>TRID Compliance Warning</h4>
                        <p>TRID (TILA-RESPA Integrated Disclosure) regulations require the use of Loan Estimate and Closing Disclosure forms for most mortgage transactions with application dates on or after October 3, 2015. Using the wrong forms can result in compliance violations. Always verify the application date before selecting the appropriate disclosure forms.</p>
                    </div>
                </div>
            </section>

            <!-- Section 6: Key Considerations -->
            <section id="section-6" class="section">
                <div class="section-header">
                    <div class="section-number">6</div>
                    <div class="section-title"><h2>Key Considerations</h2><span>Additional information for GFE processing</span></div>
                </div>
                <div class="section-content">
                    <div class="summary-grid">
                        <div class="summary-card">
                            <h4>TRID Effective Date</h4>
                            <div class="value">10/3/15</div>
                            <div class="label">Implementation Date</div>
                        </div>
                        <div class="summary-card">
                            <h4>GFE Validity</h4>
                            <div class="value">10</div>
                            <div class="label">Business Days</div>
                        </div>
                        <div class="summary-card">
                            <h4>Related Screens</h4>
                            <div class="value">5+</div>
                            <div class="label">GFE Screens Available</div>
                        </div>
                        <div class="summary-card">
                            <h4>Settlement Form</h4>
                            <div class="value">HUD-1</div>
                            <div class="label">Paired Document</div>
                        </div>
                    </div>

                    <div class="info-box">
                        <h4>Related GFE Screens in Byte</h4>
                        <ul style="margin-top: 10px; margin-left: 20px;">
                            <li><strong>GFE 2010 Pages 1 and 3</strong> - Main GFE entry screen</li>
                            <li><strong>GFE 2010 Page 2</strong> - Additional GFE details</li>
                            <li><strong>HUD1 2010 Page 1</strong> - Settlement statement page 1</li>
                            <li><strong>Funding Review</strong> - Review funding details</li>
                            <li><strong>Gift Letter</strong> - Gift funds documentation</li>
                            <li><strong>Global DMS</strong> - Document management</li>
                            <li><strong>HMDA</strong> - Home Mortgage Disclosure Act data</li>
                            <li><strong>HMDA Calculations</strong> - HMDA calculated fields</li>
                            <li><strong>HMDA Reporting</strong> - HMDA report generation</li>
                        </ul>
                    </div>

                    <div class="tip-box">
                        <h4>Defaults Configuration</h4>
                        <p>Business day calculations and other GFE-related defaults can be configured in the system defaults. The Details button next to the Fill button shows how dates are calculated based on these settings.</p>
                    </div>
                </div>
            </section>

            <!-- Quick Reference -->
            <div id="quick-ref" class="quick-ref">
                <h3>GFE Conversion Quick Reference</h3>
                <pre>
CONVERTING LOAN TO GFE - STEP-BY-STEP
=====================================

STEP 1: ACCESS GFE SCREENS
- Click All Screens
- Open GFE 2010 Pages 1 and 3

STEP 2: ENABLE GFE MODE
- Look for message: "This file should use the GFE"
- Click "Learn More" link
- TRID Applicability window opens
- Check box: "Use the GFE and HUD-1 for this file"
- Click OK
  > This opens fee fields on GFE and HUD-1 screens

STEP 3: SET DELIVERY DATE
- Locate DELIVERY INFO section (right side)
- Click radio button for GFE/TIL Delivery Date
- Date will be set to today's date

STEP 4: IMPORTANT DATES (GFE PAGE 1)
- Locate "Important Dates" section
- Click "Fill" button for settlement charges estimate
- Business Day Explanation window appears
  > Date is calculated as 10 business days from today
- Click OK

TRID APPLICABILITY RULES
========================

USE GFE + HUD-1 WHEN:
- Application date is BEFORE 10/03/2015, OR
- Application date not entered, OR
- "Use the GFE and HUD-1" box is checked

USE LOAN ESTIMATE + CLOSING DISCLOSURE WHEN:
- Application date is ON OR AFTER 10/03/2015, AND
- "Use the GFE and HUD-1" box is NOT checked

DELIVERY INFO FIELDS
====================
Field                           Status
------------------------------- ----------
Intent to Proceed Date          Optional
GFE/TIL Delivery Date           REQUIRED
GFE/TIL Delivery Method         Optional
GFE Revision Date               If Applicable
GFE Revision Delivery Method    If Applicable

IMPORTANT DATES FIELDS (GFE PAGE 1)
===================================
1. Interest rate availability through [date]
2. Settlement charges estimate through [date] - USE FILL BUTTON
3. Rate lock settlement period [days]
4. Minimum lock period before settlement [days]

KEY DATES
=========
TRID Effective Date: October 3, 2015
GFE Validity Period: 10 business days (default)
                </pre>
            </div>
        </div>

        <!-- ==================== AI AGENTS TAB ==================== -->
        <div id="agents-panel" class="tab-panel">
            <!-- Agent Header -->
            <div class="agent-header">
                <h1>AI Agent Opportunities</h1>
                <p class="subtitle">Automation opportunities identified for the GFE Conversion process</p>
            </div>

            <!-- Summary Stats -->
            <div class="agent-summary" id="agent-summary">
                <div class="agent-summary-card">
                    <div class="agent-summary-value">3</div>
                    <div class="agent-summary-label">Agent Opportunities</div>
                </div>
                <div class="agent-summary-card">
                    <div class="agent-summary-value">65%</div>
                    <div class="agent-summary-label">Automation Potential</div>
                </div>
                <div class="agent-summary-card">
                    <div class="agent-summary-value">3 min</div>
                    <div class="agent-summary-label">Est. Time Saved</div>
                </div>
                <div class="agent-summary-card">
                    <div class="agent-summary-value">High</div>
                    <div class="agent-summary-label">Compliance Impact</div>
                </div>
            </div>

            <!-- Heat Map Legend -->
            <div class="heat-legend">
                <div class="heat-legend-item">
                    <div class="heat-legend-color" style="background: linear-gradient(90deg, #ef4444, #f97316);"></div>
                    <span>Critical Priority (9-10)</span>
                </div>
                <div class="heat-legend-item">
                    <div class="heat-legend-color" style="background: linear-gradient(90deg, #f97316, #eab308);"></div>
                    <span>High Priority (7-8)</span>
                </div>
                <div class="heat-legend-item">
                    <div class="heat-legend-color" style="background: linear-gradient(90deg, #eab308, #22c55e);"></div>
                    <span>Medium Priority (5-6)</span>
                </div>
                <div class="heat-legend-item">
                    <div class="heat-legend-color" style="background: linear-gradient(90deg, #22c55e, #14b8a6);"></div>
                    <span>Low Priority (1-4)</span>
                </div>
            </div>

            <!-- Heat Map Grid -->
            <div class="heat-map-container" id="agent-heatmap">
                <div class="heat-map-title">Priority Heat Map</div>
                <div class="heat-map-grid">
                    <div class="heat-item critical" onclick="scrollToAgent('agent-triddetector')">
                        <div class="heat-score">9.0</div>
                        <div class="heat-name">TRID Detector Agent</div>
                        <div class="heat-desc">Auto-detect application date and recommend correct disclosure forms</div>
                        <div class="heat-metrics">
                            <div class="heat-metric">Time: <span>1 min</span></div>
                            <div class="heat-metric">Complexity: <span>Low</span></div>
                        </div>
                    </div>
                    <div class="heat-item high" onclick="scrollToAgent('agent-datefill')">
                        <div class="heat-score">7.5</div>
                        <div class="heat-name">Date Auto-Fill Agent</div>
                        <div class="heat-desc">Automatically populate delivery dates and calculate validity periods</div>
                        <div class="heat-metrics">
                            <div class="heat-metric">Time: <span>1 min</span></div>
                            <div class="heat-metric">Complexity: <span>Low</span></div>
                        </div>
                    </div>
                    <div class="heat-item medium" onclick="scrollToAgent('agent-compliancecheck')">
                        <div class="heat-score">6.2</div>
                        <div class="heat-name">Compliance Checker</div>
                        <div class="heat-desc">Validate GFE completion and flag missing required fields</div>
                        <div class="heat-metrics">
                            <div class="heat-metric">Time: <span>1 min</span></div>
                            <div class="heat-metric">Complexity: <span>Med</span></div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Agent Details -->
            <div id="agent-details">
                <h2 style="color: var(--text-primary); margin-bottom: 25px; font-size: 1.5rem;">Agent Details</h2>
                <div class="agent-grid">
                    <!-- TRID Detector Agent -->
                    <div class="agent-card" id="agent-triddetector">
                        <div class="agent-card-header">
                            <div class="agent-icon">T</div>
                            <div class="agent-info">
                                <div class="agent-name">TRID Detector Agent</div>
                                <div class="agent-type">Compliance / Decision Logic</div>
                            </div>
                            <span class="agent-priority critical">Critical</span>
                        </div>
                        <div class="agent-card-body">
                            <p class="agent-description">Automatically analyzes the loan application date and determines whether the file should use GFE/HUD-1 or Loan Estimate/Closing Disclosure forms. Prevents compliance violations by ensuring correct form selection based on TRID regulations.</p>
                            <div class="agent-flow">
                                <div class="agent-flow-title">Agent Flow</div>
                                <div class="agent-flow-diagram">
                                    <span class="agent-step">Read App Date</span>
                                    <span class="agent-arrow">-></span>
                                    <span class="agent-step">Compare to 10/3/15</span>
                                    <span class="agent-arrow">-></span>
                                    <span class="agent-step">Recommend Forms</span>
                                    <span class="agent-arrow">-></span>
                                    <span class="agent-step">Auto-Configure</span>
                                </div>
                            </div>
                            <div class="agent-stats">
                                <div class="agent-stat">
                                    <div class="agent-stat-value">1 min</div>
                                    <div class="agent-stat-label">Time Saved</div>
                                </div>
                                <div class="agent-stat">
                                    <div class="agent-stat-value">99%</div>
                                    <div class="agent-stat-label">Accuracy</div>
                                </div>
                                <div class="agent-stat">
                                    <div class="agent-stat-value">Low</div>
                                    <div class="agent-stat-label">Complexity</div>
                                </div>
                            </div>
                            <button class="agent-prompt-btn" onclick="showAgentPrompt('triddetector')">
                                View Build Prompt
                            </button>
                        </div>
                    </div>

                    <!-- Date Auto-Fill Agent -->
                    <div class="agent-card" id="agent-datefill">
                        <div class="agent-card-header">
                            <div class="agent-icon">D</div>
                            <div class="agent-info">
                                <div class="agent-name">Date Auto-Fill Agent</div>
                                <div class="agent-type">Data Entry / Automation</div>
                            </div>
                            <span class="agent-priority high">High</span>
                        </div>
                        <div class="agent-card-body">
                            <p class="agent-description">Automatically populates GFE delivery dates, calculates 10-business-day validity periods, and sets related date fields. Reduces manual data entry and ensures accurate business day calculations.</p>
                            <div class="agent-flow">
                                <div class="agent-flow-title">Agent Flow</div>
                                <div class="agent-flow-diagram">
                                    <span class="agent-step">Detect GFE Mode</span>
                                    <span class="agent-arrow">-></span>
                                    <span class="agent-step">Set Delivery Date</span>
                                    <span class="agent-arrow">-></span>
                                    <span class="agent-step">Calculate Validity</span>
                                    <span class="agent-arrow">-></span>
                                    <span class="agent-step">Fill Fields</span>
                                </div>
                            </div>
                            <div class="agent-stats">
                                <div class="agent-stat">
                                    <div class="agent-stat-value">1 min</div>
                                    <div class="agent-stat-label">Time Saved</div>
                                </div>
                                <div class="agent-stat">
                                    <div class="agent-stat-value">98%</div>
                                    <div class="agent-stat-label">Accuracy</div>
                                </div>
                                <div class="agent-stat">
                                    <div class="agent-stat-value">Low</div>
                                    <div class="agent-stat-label">Complexity</div>
                                </div>
                            </div>
                            <button class="agent-prompt-btn" onclick="showAgentPrompt('datefill')">
                                View Build Prompt
                            </button>
                        </div>
                    </div>

                    <!-- Compliance Checker Agent -->
                    <div class="agent-card" id="agent-compliancecheck">
                        <div class="agent-card-header">
                            <div class="agent-icon">C</div>
                            <div class="agent-info">
                                <div class="agent-name">Compliance Checker</div>
                                <div class="agent-type">Validation / QC</div>
                            </div>
                            <span class="agent-priority medium">Medium</span>
                        </div>
                        <div class="agent-card-body">
                            <p class="agent-description">Validates that all required GFE fields are completed before submission. Checks for missing delivery dates, incomplete fee sections, and ensures HUD-1 alignment. Flags issues before they become compliance problems.</p>
                            <div class="agent-flow">
                                <div class="agent-flow-title">Agent Flow</div>
                                <div class="agent-flow-diagram">
                                    <span class="agent-step">Scan GFE Fields</span>
                                    <span class="agent-arrow">-></span>
                                    <span class="agent-step">Check Required</span>
                                    <span class="agent-arrow">-></span>
                                    <span class="agent-step">Validate HUD-1</span>
                                    <span class="agent-arrow">-></span>
                                    <span class="agent-step">Report Issues</span>
                                </div>
                            </div>
                            <div class="agent-stats">
                                <div class="agent-stat">
                                    <div class="agent-stat-value">1 min</div>
                                    <div class="agent-stat-label">Time Saved</div>
                                </div>
                                <div class="agent-stat">
                                    <div class="agent-stat-value">95%</div>
                                    <div class="agent-stat-label">Accuracy</div>
                                </div>
                                <div class="agent-stat">
                                    <div class="agent-stat-value">Med</div>
                                    <div class="agent-stat-label">Complexity</div>
                                </div>
                            </div>
                            <button class="agent-prompt-btn" onclick="showAgentPrompt('compliancecheck')">
                                View Build Prompt
                            </button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </main>

    <!-- Documentation Modal -->
    <div class="modal-overlay" id="docModal">
        <div class="modal">
            <div class="modal-header">
                <h3>GFE Conversion Workflow Documentation</h3>
                <div class="modal-actions">
                    <button class="modal-btn copy" onclick="copyToClipboard()">Copy</button>
                    <button class="modal-btn close" onclick="closeDocModal()">Close</button>
                </div>
            </div>
            <div class="modal-body">
                <pre id="docContent"># Converting Loan to GFE (Good Faith Estimate) - Byte LOS

## Overview
This guide covers converting a loan file to use the GFE (Good Faith Estimate) and HUD-1 forms for loans with application dates before October 3, 2015.

## Step-by-Step Process

### Step 1: Access GFE Screens
- Click All Screens
- Open GFE 2010 Pages 1 and 3

### Step 2: Enable GFE Mode
- Click "Learn More" link at the top
- TRID Applicability window opens
- Check "Use the GFE and HUD-1 for this file"
- Click OK
- This opens fee fields on GFE and HUD-1 screens

### Step 3: Set Delivery Date
- Locate DELIVERY INFO section
- Click radio button for GFE/TIL Delivery Date
- Date set to today's date

### Step 4: Configure Important Dates
- On GFE PAGE 1, locate Important Dates section
- Click Fill button for settlement charges estimate
- Date calculates as 10 business days from today
- Click OK to confirm

## TRID Applicability Rules

### Use GFE + HUD-1 When:
- Application date before 10/03/2015
- Application date not entered
- GFE checkbox manually checked

### Use Loan Estimate + Closing Disclosure When:
- Application date on or after 10/03/2015
- GFE checkbox NOT checked

## Key Dates
- TRID Effective Date: October 3, 2015
- GFE Validity: 10 business days (default)</pre>
            </div>
        </div>
    </div>

    <!-- AI Prompt Modal -->
    <div class="modal-overlay prompt-modal" id="promptModal">
        <div class="modal">
            <div class="modal-header">
                <h3 id="promptModalTitle">AI Agent Build Prompt</h3>
                <div class="modal-actions">
                    <button class="modal-btn copy" onclick="copyPromptToClipboard()">Copy Prompt</button>
                    <button class="modal-btn close" onclick="closePromptModal()">Close</button>
                </div>
            </div>
            <div class="modal-body">
                <div class="prompt-tags" id="promptTags"></div>
                <div class="prompt-section">
                    <h4>Agent Purpose</h4>
                    <div class="prompt-box" id="promptPurpose"></div>
                </div>
                <div class="prompt-section">
                    <h4>Full Build Prompt</h4>
                    <div class="prompt-box" id="promptContent"></div>
                </div>
                <div class="prompt-section">
                    <h4>Integration Points</h4>
                    <div class="prompt-box" id="promptIntegration"></div>
                </div>
            </div>
        </div>
    </div>

    <div class="copy-success" id="copySuccess">Copied to clipboard!</div>

    <script>
        // Tab switching
        function switchTab(tab) {
            document.querySelectorAll('.sidebar-tab').forEach(t => t.classList.remove('active'));
            document.querySelectorAll('.tab-panel').forEach(p => p.classList.remove('active'));

            if (tab === 'workflow') {
                document.querySelector('.sidebar-tab:not(.agent-tab)').classList.add('active');
                document.getElementById('workflow-panel').classList.add('active');
                document.getElementById('workflow-nav').style.display = 'block';
                document.getElementById('agents-nav').style.display = 'none';
            } else {
                document.querySelector('.sidebar-tab.agent-tab').classList.add('active');
                document.getElementById('agents-panel').classList.add('active');
                document.getElementById('workflow-nav').style.display = 'none';
                document.getElementById('agents-nav').style.display = 'block';
            }

            window.scrollTo(0, 0);
        }

        // Scroll spy with isScrolling flag and 1000ms timeout
        const sections = document.querySelectorAll('.section, .quick-ref');
        const navItems = document.querySelectorAll('#workflow-nav .nav-item');
        let isScrolling = false;
        let scrollTimeout;

        function updateActiveNav() {
            if (isScrolling) return;

            let current = '';
            sections.forEach(section => {
                const sectionTop = section.offsetTop - 100;
                if (window.scrollY >= sectionTop) current = section.getAttribute('id');
            });
            navItems.forEach(item => {
                item.classList.remove('active');
                if (item.getAttribute('href') === '#' + current) item.classList.add('active');
            });
        }

        // Handle nav click to temporarily disable scroll spy
        navItems.forEach(item => {
            item.addEventListener('click', function(e) {
                isScrolling = true;
                clearTimeout(scrollTimeout);

                // Remove active from all, add to clicked
                navItems.forEach(nav => nav.classList.remove('active'));
                this.classList.add('active');

                // Re-enable scroll spy after 1000ms
                scrollTimeout = setTimeout(() => {
                    isScrolling = false;
                }, 1000);
            });
        });

        window.addEventListener('scroll', updateActiveNav);

        // Modal
        function openDocModal() {
            document.getElementById('docModal').classList.add('show');
            document.body.style.overflow = 'hidden';
        }

        function closeDocModal() {
            document.getElementById('docModal').classList.remove('show');
            document.body.style.overflow = '';
        }

        async function copyToClipboard() {
            try {
                await navigator.clipboard.writeText(document.getElementById('docContent').textContent);
                const success = document.getElementById('copySuccess');
                success.style.display = 'block';
                setTimeout(() => { success.style.display = 'none'; }, 2000);
            } catch (e) { alert('Failed to copy.'); }
        }

        document.addEventListener('keydown', (e) => { if (e.key === 'Escape') { closeDocModal(); closePromptModal(); } });
        document.getElementById('docModal').addEventListener('click', (e) => { if (e.target.id === 'docModal') closeDocModal(); });

        document.addEventListener('DOMContentLoaded', () => { updateActiveNav(); });

        // Scroll to agent card and highlight
        function scrollToAgent(agentId) {
            const agentCard = document.getElementById(agentId);
            if (agentCard) {
                document.querySelectorAll('.agent-card.highlight').forEach(card => {
                    card.classList.remove('highlight');
                });

                agentCard.scrollIntoView({ behavior: 'smooth', block: 'center' });

                setTimeout(() => {
                    agentCard.classList.add('highlight');
                }, 300);

                setTimeout(() => {
                    agentCard.classList.remove('highlight');
                }, 2500);
            }
        }

        // Agent Prompt System
        const agentPrompts = {
            triddetector: {
                name: 'TRID Detector Agent',
                tags: ['Compliance', 'Decision Logic', 'Low Complexity', 'Critical Priority'],
                purpose: `This agent automatically analyzes the loan application date and determines whether the file should use GFE/HUD-1 or Loan Estimate/Closing Disclosure forms. It prevents compliance violations by ensuring correct form selection based on TRID regulations effective October 3, 2015.`,
                prompt: `You are building a Compliance Decision Agent for CMG Financial's Byte LOS GFE Conversion process.

AGENT NAME: TRID Detector Agent
TYPE: Compliance / Decision Logic

OBJECTIVE:
Automatically detect the loan application date and recommend the correct disclosure forms (GFE/HUD-1 vs. LE/CD) based on TRID regulations.

INPUT DATA:
- Loan Application Date
- Current "Use GFE and HUD-1" checkbox status
- File creation date (as fallback)

DECISION LOGIC:
IF application_date < October 3, 2015 THEN
    Recommend: GFE + HUD-1
    Action: Auto-check "Use the GFE and HUD-1 for this file"
ELSE IF application_date >= October 3, 2015 THEN
    Recommend: Loan Estimate + Closing Disclosure
    Action: Ensure GFE checkbox is unchecked
ELSE IF application_date IS NULL THEN
    Alert: "Application date missing - please enter before proceeding"
    Default: Show GFE option based on file age

OUTPUT:
- Form recommendation (GFE/HUD-1 or LE/CD)
- Auto-configuration of disclosure settings
- Compliance status indicator
- Warning if wrong forms are selected`,
                integration: `INTEGRATION POINTS:
1. Byte LOS Application Date Field
   - Read from URLA or application screen
   - Monitor for changes

2. TRID Applicability Window
   - Trigger on GFE screen access
   - Auto-populate checkbox

3. Compliance Dashboard
   - Log form selection decisions
   - Track potential violations

DEPLOYMENT:
- Runs on loan file open
- Background monitoring for date changes
- Real-time alerts for mismatches`
            },
            datefill: {
                name: 'Date Auto-Fill Agent',
                tags: ['Data Entry', 'Automation', 'Low Complexity', 'High Priority'],
                purpose: `This agent automatically populates GFE delivery dates, calculates 10-business-day validity periods, and sets related date fields. It reduces manual data entry errors and ensures accurate business day calculations based on configured defaults.`,
                prompt: `You are building a Data Entry Automation Agent for CMG Financial's Byte LOS GFE Conversion process.

AGENT NAME: Date Auto-Fill Agent
TYPE: Data Entry / Automation

OBJECTIVE:
Automatically populate GFE date fields including delivery date, validity period, and related timestamps while respecting business day calculations.

INPUT DATA:
- Current system date
- Business day calendar (configured in defaults)
- Holidays list
- Existing date field values

CALCULATIONS:
1. GFE/TIL Delivery Date = Current Date
2. Settlement Charges Estimate Valid Through = Current Date + 10 business days
3. Exclude weekends and configured holidays

FIELD MAPPING:
- GFE/TIL Delivery Date: Today's date
- Settlement charges availability date: Today + 10 business days
- Intent to Proceed Date: Optional, leave if populated
- GFE Revision Date: Only fill on revision trigger

BUSINESS DAY LOGIC:
function addBusinessDays(startDate, days) {
    let current = startDate;
    let added = 0;
    while (added < days) {
        current = addDay(current);
        if (!isWeekend(current) && !isHoliday(current)) {
            added++;
        }
    }
    return current;
}`,
                integration: `INTEGRATION POINTS:
1. Byte Date Fields
   - GFE/TIL Delivery Date
   - Settlement charges estimate date
   - Important Dates section

2. System Defaults
   - Business day configuration
   - Holiday calendar

3. Fill Button Enhancement
   - Hook into existing Fill functionality
   - Maintain Details display

DEPLOYMENT:
- Trigger on GFE screen load (if GFE mode enabled)
- Respect existing values (don't overwrite)
- Provide manual override option`
            },
            compliancecheck: {
                name: 'Compliance Checker Agent',
                tags: ['Validation', 'QC', 'Medium Complexity', 'Medium Priority'],
                purpose: `This agent validates that all required GFE fields are completed before submission. It checks for missing delivery dates, incomplete fee sections, and ensures GFE-HUD-1 alignment. Flags issues proactively before they become compliance problems.`,
                prompt: `You are building a Validation/QC Agent for CMG Financial's Byte LOS GFE Conversion process.

AGENT NAME: Compliance Checker Agent
TYPE: Validation / QC

OBJECTIVE:
Validate GFE completion status and flag missing or inconsistent data before loan submission.

VALIDATION CHECKLIST:
Required Fields:
[ ] GFE/TIL Delivery Date populated
[ ] Settlement charges estimate date filled
[ ] Fee fields unlocked and accessible
[ ] HUD-1 fields aligned with GFE

Optional but Recommended:
[ ] Intent to Proceed Date
[ ] Delivery Method specified
[ ] Interest rate availability date

Cross-Validation:
[ ] GFE fees match HUD-1 fees within tolerance
[ ] Dates are logically consistent (delivery < validity)
[ ] Application date confirms GFE eligibility

ERROR LEVELS:
- CRITICAL: Missing required fields, wrong form type
- WARNING: Missing recommended fields
- INFO: Optimization suggestions

OUTPUT FORMAT:
{
    "status": "PASS" | "FAIL" | "WARNING",
    "criticalIssues": [],
    "warnings": [],
    "recommendations": [],
    "completionScore": 0-100
}`,
                integration: `INTEGRATION POINTS:
1. GFE Screens (Pages 1, 2, 3)
   - Read all field values
   - Check required vs optional

2. HUD-1 Screen
   - Cross-reference fee totals
   - Validate alignment

3. Submission Pipeline
   - Block submission on critical errors
   - Allow override with manager approval

DEPLOYMENT:
- Run on-demand via button
- Auto-run before file submission
- Generate compliance report PDF`
            }
        };

        function showAgentPrompt(agentId) {
            const agent = agentPrompts[agentId];
            if (!agent) return;

            document.getElementById('promptModalTitle').textContent = agent.name + ' - Build Prompt';
            document.getElementById('promptTags').innerHTML = agent.tags.map(t => `<span class="prompt-tag">${t}</span>`).join('');
            document.getElementById('promptPurpose').textContent = agent.purpose;
            document.getElementById('promptContent').textContent = agent.prompt;
            document.getElementById('promptIntegration').textContent = agent.integration;

            document.getElementById('promptModal').classList.add('show');
            document.body.style.overflow = 'hidden';
        }

        function closePromptModal() {
            document.getElementById('promptModal').classList.remove('show');
            document.body.style.overflow = '';
        }

        async function copyPromptToClipboard() {
            const content = document.getElementById('promptContent').textContent;
            try {
                await navigator.clipboard.writeText(content);
                const success = document.getElementById('copySuccess');
                success.style.display = 'block';
                setTimeout(() => { success.style.display = 'none'; }, 2000);
            } catch (e) { alert('Failed to copy.'); }
        }

        document.getElementById('promptModal').addEventListener('click', (e) => { if (e.target.id === 'promptModal') closePromptModal(); });
    </script>
</body>
</html>
