<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ordering Transcripts via 8821 - Process Workflow</title>
    <link href="https://fonts.googleapis.com/css2?family=Plus+Jakarta+Sans:wght@400;500;600;700;800&family=JetBrains+Mono:wght@400;500&display=swap" rel="stylesheet">
    <style>
        :root {
            --bg-primary: #0a0f1a;
            --bg-secondary: #111827;
            --bg-card: #1a2234;
            --accent-blue: #3b82f6;
            --accent-teal: #14b8a6;
            --accent-amber: #f59e0b;
            --accent-rose: #f43f5e;
            --accent-green: #22c55e;
            --accent-purple: #8b5cf6;
            --text-primary: #f1f5f9;
            --text-secondary: #94a3b8;
            --text-muted: #64748b;
            --border-subtle: rgba(255,255,255,0.08);
            --sidebar-width: 280px;
        }

        * { box-sizing: border-box; margin: 0; padding: 0; }
        html { scroll-behavior: smooth; }
        body {
            font-family: 'Plus Jakarta Sans', -apple-system, BlinkMacSystemFont, sans-serif;
            background: var(--bg-primary);
            color: var(--text-primary);
            min-height: 100vh;
        }

        /* Breadcrumb */
        .breadcrumb {
            background: linear-gradient(90deg, #0d1525 0%, #1a2234 100%);
            padding: 14px 25px;
            display: flex;
            align-items: center;
            gap: 12px;
            font-size: 0.95rem;
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            z-index: 1001;
            border-bottom: 1px solid var(--border-subtle);
        }

        .breadcrumb a {
            color: var(--text-secondary);
            text-decoration: none;
            font-weight: 600;
            padding: 8px 16px;
            background: rgba(255,255,255,0.05);
            border-radius: 8px;
            transition: all 0.2s;
            border: 1px solid var(--border-subtle);
        }

        .breadcrumb a:hover {
            background: rgba(59, 130, 246, 0.15);
            color: var(--accent-blue);
            border-color: rgba(59, 130, 246, 0.3);
        }

        .breadcrumb .separator { color: var(--text-muted); font-size: 1.2rem; }
        .breadcrumb .current { color: var(--accent-amber); font-weight: 600; padding: 8px 16px; }

        /* Sidebar */
        .sidebar {
            position: fixed;
            top: 54px;
            left: 0;
            width: var(--sidebar-width);
            height: calc(100vh - 54px);
            background: var(--bg-secondary);
            overflow-y: auto;
            z-index: 1000;
            border-right: 1px solid var(--border-subtle);
            display: flex;
            flex-direction: column;
        }

        .sidebar-header {
            padding: 25px 20px;
            background: rgba(0,0,0,0.3);
            border-bottom: 1px solid var(--border-subtle);
        }

        .sidebar-header h2 { color: var(--text-primary); font-size: 1.2rem; font-weight: 700; margin-bottom: 5px; }
        .sidebar-header p { color: var(--text-muted); font-size: 0.85rem; }

        /* Tab Switch */
        .sidebar-tabs {
            display: flex;
            border-bottom: 1px solid var(--border-subtle);
        }

        .sidebar-tab {
            flex: 1;
            padding: 14px 10px;
            text-align: center;
            font-size: 0.8rem;
            font-weight: 700;
            color: var(--text-muted);
            cursor: pointer;
            transition: all 0.2s;
            border-bottom: 3px solid transparent;
            background: none;
            border-left: none;
            border-right: none;
            border-top: none;
        }

        .sidebar-tab:hover { background: rgba(255,255,255,0.03); color: var(--text-secondary); }
        .sidebar-tab.active { color: var(--accent-blue); border-bottom-color: var(--accent-blue); background: rgba(59, 130, 246, 0.08); }
        .sidebar-tab.agent-tab.active { color: var(--accent-purple); border-bottom-color: var(--accent-purple); background: rgba(139, 92, 246, 0.08); }

        .sidebar-nav { padding: 15px 0; flex: 1; overflow-y: auto; }

        .nav-item {
            display: flex;
            align-items: center;
            gap: 12px;
            padding: 14px 20px;
            color: var(--text-secondary);
            text-decoration: none;
            border-left: 3px solid transparent;
            transition: all 0.2s ease;
            cursor: pointer;
        }

        .nav-item:hover { background: rgba(255,255,255,0.03); color: var(--text-primary); }
        .nav-item.active { background: rgba(59, 130, 246, 0.1); border-left-color: var(--accent-blue); color: var(--text-primary); }

        .nav-number {
            background: rgba(255,255,255,0.1);
            color: var(--text-secondary);
            width: 28px;
            height: 28px;
            border-radius: 8px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 700;
            font-size: 0.85rem;
            flex-shrink: 0;
        }

        .nav-item.active .nav-number { background: var(--accent-blue); color: white; }
        .nav-label { font-size: 0.95rem; font-weight: 500; }

        .sidebar-footer {
            padding: 20px;
            border-top: 1px solid var(--border-subtle);
            background: rgba(0,0,0,0.2);
        }

        .doc-btn {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
            width: 100%;
            padding: 14px 20px;
            background: linear-gradient(135deg, var(--accent-blue) 0%, var(--accent-teal) 100%);
            color: white;
            border: none;
            border-radius: 10px;
            font-weight: 600;
            cursor: pointer;
            transition: transform 0.2s, box-shadow 0.2s;
            text-decoration: none;
            font-size: 0.95rem;
        }

        .doc-btn:hover { transform: translateY(-2px); box-shadow: 0 8px 25px rgba(59, 130, 246, 0.3); }

        /* Main Content */
        .main-content { margin-left: var(--sidebar-width); padding: 80px 40px 40px 40px; }

        /* Tab Panels */
        .tab-panel { display: none; }
        .tab-panel.active { display: block; }

        .header {
            background: var(--bg-card);
            border: 1px solid var(--border-subtle);
            padding: 35px;
            border-radius: 16px;
            margin-bottom: 30px;
            position: relative;
            overflow: hidden;
        }

        .header::before {
            content: '';
            position: absolute;
            top: 0; left: 0; right: 0; bottom: 0;
            background:
                radial-gradient(ellipse at 20% 20%, rgba(59, 130, 246, 0.1) 0%, transparent 50%),
                radial-gradient(ellipse at 80% 80%, rgba(20, 184, 166, 0.08) 0%, transparent 50%);
            pointer-events: none;
        }

        .header h1 {
            font-size: 2.2rem;
            font-weight: 800;
            margin-bottom: 10px;
            position: relative;
            background: linear-gradient(135deg, var(--text-primary) 0%, var(--accent-blue) 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .header .subtitle { color: var(--text-secondary); font-size: 1.1rem; position: relative; }

        .header .meta { display: flex; gap: 15px; margin-top: 20px; flex-wrap: wrap; position: relative; }

        .header .meta-item {
            background: rgba(255,255,255,0.05);
            border: 1px solid var(--border-subtle);
            padding: 8px 16px;
            border-radius: 8px;
            font-size: 0.9rem;
            color: var(--text-secondary);
        }

        /* Legend */
        .legend {
            display: flex;
            flex-wrap: wrap;
            gap: 15px;
            padding: 18px 22px;
            background: var(--bg-card);
            border: 1px solid var(--border-subtle);
            border-radius: 12px;
            margin-bottom: 25px;
        }

        .legend-item { display: flex; align-items: center; gap: 8px; font-size: 0.85rem; color: var(--text-secondary); }
        .legend-color { width: 18px; height: 18px; border-radius: 4px; }

        /* Sections */
        .section {
            background: var(--bg-card);
            border: 1px solid var(--border-subtle);
            border-radius: 16px;
            margin-bottom: 25px;
            overflow: hidden;
            scroll-margin-top: 75px;
        }

        .section-header {
            background: linear-gradient(135deg, var(--bg-secondary) 0%, rgba(59, 130, 246, 0.1) 100%);
            border-bottom: 1px solid var(--border-subtle);
            padding: 22px 25px;
            display: flex;
            align-items: center;
            gap: 18px;
        }

        .section-number {
            background: linear-gradient(135deg, var(--accent-blue) 0%, var(--accent-teal) 100%);
            color: white;
            width: 48px;
            height: 48px;
            border-radius: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 800;
            font-size: 1.3rem;
            flex-shrink: 0;
        }

        .section-title h2 { font-size: 1.35rem; font-weight: 700; margin-bottom: 4px; color: var(--text-primary); }
        .section-title span { font-size: 0.9rem; color: var(--text-muted); }
        .section-content { padding: 28px; }

        /* Workflow Diagrams */
        .workflow-diagram {
            background: rgba(0,0,0,0.3);
            border: 1px solid var(--border-subtle);
            border-radius: 12px;
            padding: 28px;
            margin-bottom: 22px;
        }

        .flow-row { display: flex; align-items: center; justify-content: center; flex-wrap: wrap; gap: 12px; margin: 15px 0; }

        .flow-node {
            padding: 14px 22px;
            border-radius: 10px;
            text-align: center;
            font-size: 0.9rem;
            font-weight: 600;
            min-width: 150px;
            border: 1px solid var(--border-subtle);
        }

        .flow-node.start { background: linear-gradient(135deg, var(--accent-green) 0%, #16a34a 100%); color: white; border-radius: 25px; border: none; }
        .flow-node.action { background: linear-gradient(135deg, var(--accent-blue) 0%, #2563eb 100%); color: white; border: none; }
        .flow-node.decision { background: linear-gradient(135deg, var(--accent-amber) 0%, #d97706 100%); color: var(--bg-primary); border: none; }
        .flow-node.input { background: var(--bg-secondary); border: 2px solid var(--accent-blue); color: var(--text-primary); }
        .flow-node.output { background: linear-gradient(135deg, var(--accent-teal) 0%, #0d9488 100%); color: white; border: none; }
        .flow-node.exception { background: linear-gradient(135deg, var(--accent-rose) 0%, #dc2626 100%); color: white; border: none; }

        .flow-arrow { color: var(--accent-blue); font-size: 1.5rem; }
        .flow-arrow.down { transform: rotate(90deg); }

        .decision-branch { display: flex; gap: 40px; justify-content: center; margin: 20px 0; flex-wrap: wrap; }
        .branch { display: flex; flex-direction: column; align-items: center; gap: 10px; }

        .branch-label {
            background: var(--bg-secondary);
            border: 1px solid var(--border-subtle);
            padding: 6px 16px;
            border-radius: 20px;
            font-size: 0.8rem;
            font-weight: 700;
            color: var(--text-secondary);
        }

        /* Tables */
        .field-table { width: 100%; border-collapse: collapse; margin: 18px 0; }

        .field-table th {
            background: rgba(59, 130, 246, 0.15);
            color: var(--accent-blue);
            padding: 14px 18px;
            text-align: left;
            font-weight: 600;
            font-size: 0.9rem;
            text-transform: uppercase;
            letter-spacing: 0.05em;
            border-bottom: 1px solid var(--border-subtle);
        }

        .field-table td { padding: 14px 18px; border-bottom: 1px solid var(--border-subtle); color: var(--text-secondary); }
        .field-table tr:hover { background: rgba(255,255,255,0.02); }

        .badge { display: inline-block; padding: 4px 12px; border-radius: 6px; font-size: 0.75rem; font-weight: 700; text-transform: uppercase; letter-spacing: 0.05em; }
        .badge.required-badge { background: rgba(244, 63, 94, 0.15); color: var(--accent-rose); }
        .badge.optional-badge { background: rgba(34, 197, 94, 0.15); color: var(--accent-green); }
        .badge.calculated-badge { background: rgba(59, 130, 246, 0.15); color: var(--accent-blue); }

        /* Info Boxes */
        .exception-box, .tip-box, .info-box {
            padding: 18px 22px;
            margin: 18px 0;
            border-radius: 0 10px 10px 0;
            border-left-width: 4px;
            border-left-style: solid;
        }

        .exception-box { background: rgba(244, 63, 94, 0.08); border-color: var(--accent-rose); border: 1px solid rgba(244, 63, 94, 0.2); border-left: 4px solid var(--accent-rose); }
        .exception-box h4 { color: var(--accent-rose); margin-bottom: 10px; font-size: 1rem; }
        .exception-box p, .exception-box li { color: var(--text-secondary); }

        .tip-box { background: rgba(34, 197, 94, 0.08); border-color: var(--accent-green); border: 1px solid rgba(34, 197, 94, 0.2); border-left: 4px solid var(--accent-green); }
        .tip-box h4 { color: var(--accent-green); margin-bottom: 10px; font-size: 1rem; }
        .tip-box p, .tip-box li { color: var(--text-secondary); }

        .info-box { background: rgba(59, 130, 246, 0.08); border-color: var(--accent-blue); border: 1px solid rgba(59, 130, 246, 0.2); border-left: 4px solid var(--accent-blue); }
        .info-box h4 { color: var(--accent-blue); margin-bottom: 10px; font-size: 1rem; }
        .info-box p, .info-box li { color: var(--text-secondary); }

        /* Decision Tree */
        .decision-tree {
            background: rgba(0,0,0,0.2);
            border: 1px solid var(--border-subtle);
            border-radius: 12px;
            padding: 22px;
            margin: 22px 0;
        }

        .decision-tree h3 { color: var(--accent-blue); margin-bottom: 18px; padding-bottom: 12px; border-bottom: 1px solid var(--border-subtle); font-size: 1.1rem; }

        .tree-node { margin-left: 20px; padding: 12px; border-left: 2px solid var(--accent-teal); position: relative; color: var(--text-secondary); }
        .tree-node::before { content: ''; position: absolute; left: -2px; top: 22px; width: 15px; height: 2px; background: var(--accent-teal); }
        .tree-node.level-1 { margin-left: 0; border-left: none; }
        .tree-node.level-1::before { display: none; }

        .tree-label { background: var(--accent-amber); color: var(--bg-primary); padding: 6px 14px; border-radius: 6px; font-weight: 700; display: inline-block; margin-bottom: 6px; font-size: 0.9rem; }

        /* Summary Grid */
        .summary-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(180px, 1fr)); gap: 18px; margin: 22px 0; }

        .summary-card { background: rgba(0,0,0,0.3); border: 1px solid var(--border-subtle); border-radius: 12px; padding: 22px; text-align: center; }
        .summary-card h4 { color: var(--text-secondary); margin-bottom: 12px; font-size: 0.9rem; }
        .summary-card .value {
            font-size: 2.2rem;
            font-weight: 800;
            background: linear-gradient(135deg, var(--accent-blue) 0%, var(--accent-teal) 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }
        .summary-card .label { font-size: 0.85rem; color: var(--text-muted); margin-top: 8px; }

        /* Quick Reference */
        .quick-ref {
            background: linear-gradient(135deg, var(--bg-secondary) 0%, var(--bg-card) 100%);
            border: 1px solid var(--border-subtle);
            padding: 28px;
            border-radius: 16px;
            margin-top: 30px;
            font-family: 'JetBrains Mono', monospace;
            scroll-margin-top: 75px;
        }

        .quick-ref h3 { color: var(--accent-amber); margin-bottom: 18px; font-family: 'Plus Jakarta Sans', sans-serif; }
        .quick-ref pre { background: rgba(0,0,0,0.4); border: 1px solid var(--border-subtle); padding: 20px; border-radius: 10px; overflow-x: auto; font-size: 0.85rem; line-height: 1.7; color: var(--text-secondary); }

        /* ====== AGENT OPPORTUNITIES STYLES ====== */
        .agent-header {
            background: var(--bg-card);
            border: 1px solid var(--border-subtle);
            padding: 35px;
            border-radius: 16px;
            margin-bottom: 30px;
            position: relative;
            overflow: hidden;
        }

        .agent-header::before {
            content: '';
            position: absolute;
            top: 0; left: 0; right: 0; bottom: 0;
            background:
                radial-gradient(ellipse at 20% 20%, rgba(139, 92, 246, 0.12) 0%, transparent 50%),
                radial-gradient(ellipse at 80% 80%, rgba(245, 158, 11, 0.1) 0%, transparent 50%);
            pointer-events: none;
        }

        .agent-header h1 {
            font-size: 2.2rem;
            font-weight: 800;
            margin-bottom: 10px;
            position: relative;
            background: linear-gradient(135deg, var(--accent-purple) 0%, var(--accent-amber) 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .agent-header .subtitle { color: var(--text-secondary); font-size: 1.1rem; position: relative; }

        /* Heat Map */
        .heat-map-container { margin-bottom: 35px; }
        .heat-map-title { font-size: 1.3rem; font-weight: 700; color: var(--text-primary); margin-bottom: 20px; display: flex; align-items: center; gap: 12px; }

        .heat-map-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
        }

        .heat-item {
            background: var(--bg-card);
            border: 1px solid var(--border-subtle);
            border-radius: 12px;
            padding: 20px;
            position: relative;
            overflow: hidden;
            transition: transform 0.2s, box-shadow 0.2s;
            cursor: pointer;
        }

        .heat-item:hover { transform: translateY(-3px); box-shadow: 0 10px 30px rgba(0,0,0,0.3); }
        .heat-item:active { transform: scale(0.98); }

        .heat-item::before {
            content: '';
            position: absolute;
            top: 0; left: 0; right: 0; height: 4px;
        }

        .heat-item.critical::before { background: linear-gradient(90deg, #ef4444, #f97316); }
        .heat-item.high::before { background: linear-gradient(90deg, #f97316, #eab308); }
        .heat-item.medium::before { background: linear-gradient(90deg, #eab308, #22c55e); }
        .heat-item.low::before { background: linear-gradient(90deg, #22c55e, #14b8a6); }

        .heat-score {
            position: absolute;
            top: 15px;
            right: 15px;
            font-size: 1.8rem;
            font-weight: 800;
        }

        .heat-item.critical .heat-score { color: #ef4444; }
        .heat-item.high .heat-score { color: #f97316; }
        .heat-item.medium .heat-score { color: #eab308; }
        .heat-item.low .heat-score { color: #22c55e; }

        .heat-name { font-size: 1rem; font-weight: 700; color: var(--text-primary); margin-bottom: 6px; padding-right: 50px; }
        .heat-desc { font-size: 0.85rem; color: var(--text-muted); margin-bottom: 12px; }

        .heat-metrics { display: flex; gap: 15px; margin-top: 12px; }
        .heat-metric { font-size: 0.75rem; color: var(--text-muted); }
        .heat-metric span { color: var(--text-secondary); font-weight: 600; }

        /* Agent Cards */
        .agent-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(380px, 1fr)); gap: 25px; margin-bottom: 35px; }

        .agent-card {
            background: var(--bg-card);
            border: 1px solid var(--border-subtle);
            border-radius: 16px;
            overflow: hidden;
            transition: transform 0.2s, box-shadow 0.2s;
        }

        .agent-card:hover { transform: translateY(-5px); box-shadow: 0 15px 50px rgba(0,0,0,0.3); }

        .agent-card.highlight {
            animation: highlightPulse 2s ease;
            box-shadow: 0 0 0 3px var(--accent-purple), 0 15px 50px rgba(139, 92, 246, 0.4);
        }

        @keyframes highlightPulse {
            0% { box-shadow: 0 0 0 3px var(--accent-purple), 0 15px 50px rgba(139, 92, 246, 0.6); }
            50% { box-shadow: 0 0 0 6px rgba(139, 92, 246, 0.5), 0 15px 50px rgba(139, 92, 246, 0.3); }
            100% { box-shadow: 0 0 0 0px transparent, 0 15px 50px rgba(0,0,0,0.3); }
        }

        .agent-card-header {
            padding: 22px;
            display: flex;
            align-items: flex-start;
            gap: 18px;
            border-bottom: 1px solid var(--border-subtle);
        }

        .agent-icon {
            width: 55px;
            height: 55px;
            background: linear-gradient(135deg, var(--accent-purple) 0%, var(--accent-blue) 100%);
            border-radius: 14px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.6rem;
            flex-shrink: 0;
        }

        .agent-info { flex: 1; }
        .agent-name { font-size: 1.15rem; font-weight: 700; color: var(--text-primary); margin-bottom: 5px; }
        .agent-type { font-size: 0.8rem; color: var(--accent-purple); font-weight: 600; text-transform: uppercase; letter-spacing: 0.05em; }

        .agent-priority {
            padding: 6px 12px;
            border-radius: 20px;
            font-size: 0.75rem;
            font-weight: 700;
            text-transform: uppercase;
        }

        .agent-priority.critical { background: rgba(239, 68, 68, 0.15); color: #ef4444; }
        .agent-priority.high { background: rgba(249, 115, 22, 0.15); color: #f97316; }
        .agent-priority.medium { background: rgba(234, 179, 8, 0.15); color: #eab308; }
        .agent-priority.low { background: rgba(34, 197, 94, 0.15); color: #22c55e; }

        .agent-card-body { padding: 22px; }
        .agent-description { font-size: 0.95rem; color: var(--text-secondary); line-height: 1.6; margin-bottom: 20px; }

        .agent-flow {
            background: rgba(0,0,0,0.3);
            border: 1px solid var(--border-subtle);
            border-radius: 10px;
            padding: 18px;
            margin-bottom: 20px;
        }

        .agent-flow-title { font-size: 0.85rem; color: var(--text-muted); margin-bottom: 12px; font-weight: 600; text-transform: uppercase; letter-spacing: 0.05em; }

        .agent-flow-diagram { display: flex; align-items: center; flex-wrap: wrap; gap: 8px; justify-content: center; }

        .agent-step {
            background: linear-gradient(135deg, var(--accent-purple) 0%, var(--accent-blue) 100%);
            color: white;
            padding: 8px 14px;
            border-radius: 6px;
            font-size: 0.8rem;
            font-weight: 600;
            white-space: nowrap;
        }

        .agent-arrow { color: var(--accent-purple); font-size: 1.2rem; }

        .agent-stats { display: grid; grid-template-columns: repeat(3, 1fr); gap: 12px; }

        .agent-stat {
            background: rgba(0,0,0,0.2);
            border-radius: 8px;
            padding: 12px;
            text-align: center;
        }

        .agent-stat-value {
            font-size: 1.3rem;
            font-weight: 800;
            background: linear-gradient(135deg, var(--accent-purple) 0%, var(--accent-amber) 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .agent-stat-label { font-size: 0.7rem; color: var(--text-muted); text-transform: uppercase; letter-spacing: 0.05em; margin-top: 4px; }

        /* View Prompt Button */
        .agent-prompt-btn {
            width: 100%;
            margin-top: 18px;
            padding: 14px 20px;
            background: linear-gradient(135deg, rgba(139, 92, 246, 0.2) 0%, rgba(59, 130, 246, 0.2) 100%);
            border: 1px solid rgba(139, 92, 246, 0.4);
            border-radius: 10px;
            color: var(--accent-purple);
            font-weight: 700;
            cursor: pointer;
            transition: all 0.2s;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
            font-size: 0.9rem;
        }

        .agent-prompt-btn:hover {
            background: linear-gradient(135deg, rgba(139, 92, 246, 0.3) 0%, rgba(59, 130, 246, 0.3) 100%);
            border-color: var(--accent-purple);
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(139, 92, 246, 0.25);
        }

        /* Summary Stats */
        .agent-summary {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin-bottom: 35px;
        }

        .agent-summary-card {
            background: var(--bg-card);
            border: 1px solid var(--border-subtle);
            border-radius: 14px;
            padding: 25px;
            text-align: center;
        }

        .agent-summary-value {
            font-size: 2.5rem;
            font-weight: 800;
            background: linear-gradient(135deg, var(--accent-purple) 0%, var(--accent-amber) 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .agent-summary-label { font-size: 0.9rem; color: var(--text-muted); margin-top: 8px; }

        /* Heat Map Legend */
        .heat-legend {
            display: flex;
            gap: 25px;
            padding: 18px 22px;
            background: var(--bg-card);
            border: 1px solid var(--border-subtle);
            border-radius: 12px;
            margin-bottom: 25px;
            flex-wrap: wrap;
        }

        .heat-legend-item { display: flex; align-items: center; gap: 10px; font-size: 0.9rem; color: var(--text-secondary); }
        .heat-legend-color { width: 24px; height: 24px; border-radius: 6px; }

        /* Modal */
        .modal-overlay {
            display: none;
            position: fixed;
            top: 0; left: 0; right: 0; bottom: 0;
            background: rgba(10, 15, 26, 0.9);
            z-index: 2000;
            justify-content: center;
            align-items: center;
            padding: 20px;
            backdrop-filter: blur(5px);
        }

        .modal-overlay.show { display: flex; }

        .modal {
            background: var(--bg-card);
            border: 1px solid var(--border-subtle);
            border-radius: 16px;
            width: 100%;
            max-width: 950px;
            max-height: 90vh;
            display: flex;
            flex-direction: column;
            box-shadow: 0 25px 80px rgba(0,0,0,0.5);
        }

        .modal-header {
            background: linear-gradient(135deg, var(--accent-blue) 0%, var(--accent-teal) 100%);
            color: white;
            padding: 22px 28px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            border-radius: 16px 16px 0 0;
        }

        .modal-header h3 { font-size: 1.25rem; font-weight: 700; }
        .modal-actions { display: flex; gap: 12px; }

        .modal-btn {
            padding: 10px 18px;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-weight: 700;
            transition: transform 0.2s;
            font-size: 0.9rem;
        }

        .modal-btn:hover { transform: scale(1.05); }
        .modal-btn.copy { background: white; color: var(--accent-blue); }
        .modal-btn.close { background: rgba(255,255,255,0.2); color: white; }

        .modal-body { padding: 28px; overflow-y: auto; flex: 1; }

        .modal-body pre {
            background: rgba(0,0,0,0.3);
            border: 1px solid var(--border-subtle);
            padding: 22px;
            border-radius: 10px;
            font-family: 'JetBrains Mono', monospace;
            font-size: 0.9rem;
            line-height: 1.7;
            white-space: pre-wrap;
            word-wrap: break-word;
            color: var(--text-secondary);
        }

        .copy-success {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: var(--accent-green);
            color: white;
            padding: 18px 35px;
            border-radius: 10px;
            font-weight: 700;
            z-index: 3000;
            display: none;
            animation: fadeInOut 2s ease;
        }

        @keyframes fadeInOut { 0%, 100% { opacity: 0; } 10%, 90% { opacity: 1; } }

        /* Prompt Modal */
        .prompt-modal .modal { max-width: 800px; }
        .prompt-modal .modal-header { background: linear-gradient(135deg, var(--accent-purple) 0%, var(--accent-blue) 100%); }

        .prompt-section { margin-bottom: 25px; }
        .prompt-section h4 { color: var(--accent-purple); font-size: 1rem; margin-bottom: 12px; display: flex; align-items: center; gap: 8px; }

        .prompt-box {
            background: rgba(0,0,0,0.4);
            border: 1px solid var(--border-subtle);
            border-radius: 10px;
            padding: 20px;
            font-family: 'JetBrains Mono', monospace;
            font-size: 0.85rem;
            line-height: 1.7;
            color: var(--text-secondary);
            white-space: pre-wrap;
            word-wrap: break-word;
        }

        .prompt-tags { display: flex; gap: 10px; flex-wrap: wrap; margin-bottom: 20px; }
        .prompt-tag { background: rgba(139, 92, 246, 0.15); color: var(--accent-purple); padding: 6px 14px; border-radius: 20px; font-size: 0.8rem; font-weight: 600; }

        /* Step List */
        .step-list { list-style: none; padding: 0; margin: 18px 0; }
        .step-list li {
            padding: 14px 18px;
            border-left: 3px solid var(--accent-blue);
            background: rgba(0,0,0,0.2);
            margin-bottom: 10px;
            border-radius: 0 8px 8px 0;
            color: var(--text-secondary);
        }
        .step-list li strong { color: var(--text-primary); }

        @media (max-width: 900px) {
            .sidebar { display: none; }
            .main-content { margin-left: 0; padding: 75px 20px 30px 20px; }
            .agent-grid { grid-template-columns: 1fr; }
        }
    </style>
</head>
<body>
    <!-- Breadcrumb -->
    <nav class="breadcrumb">
        <a href="../../index.html">Portal Home</a>
        <span class="separator">></span>
        <a href="./index.html">Mortgage Fundamentals</a>
        <span class="separator">></span>
        <span class="current">Ordering Transcripts via 8821</span>
    </nav>

    <!-- Fixed Sidebar -->
    <aside class="sidebar">
        <div class="sidebar-header">
            <h2>8821 Transcript Process</h2>
            <p>Interactive Workflow Guide</p>
        </div>

        <!-- Tab Switcher -->
        <div class="sidebar-tabs">
            <button class="sidebar-tab active" onclick="switchTab('workflow')">Workflow</button>
            <button class="sidebar-tab agent-tab" onclick="switchTab('agents')">AI Agents</button>
        </div>

        <!-- Workflow Navigation -->
        <nav class="sidebar-nav" id="workflow-nav">
            <a href="#section-1" class="nav-item active">
                <span class="nav-number">1</span>
                <span class="nav-label">Send 8821 via DocuTech</span>
            </a>
            <a href="#section-2" class="nav-item">
                <span class="nav-number">2</span>
                <span class="nav-label">Preview & Store Docs</span>
            </a>
            <a href="#section-3" class="nav-item">
                <span class="nav-number">3</span>
                <span class="nav-label">E-Sign Disclosure</span>
            </a>
            <a href="#section-4" class="nav-item">
                <span class="nav-number">4</span>
                <span class="nav-label">Review Executed 8821</span>
            </a>
            <a href="#section-5" class="nav-item">
                <span class="nav-number">5</span>
                <span class="nav-label">Submit Transcript Order</span>
            </a>
            <a href="#section-6" class="nav-item">
                <span class="nav-number">6</span>
                <span class="nav-label">Check Order Status</span>
            </a>
            <a href="#section-7" class="nav-item">
                <span class="nav-number">7</span>
                <span class="nav-label">Retrieve Transcripts</span>
            </a>
            <a href="#quick-ref" class="nav-item">
                <span class="nav-number">*</span>
                <span class="nav-label">Quick Reference</span>
            </a>
        </nav>

        <!-- Agent Navigation -->
        <nav class="sidebar-nav" id="agents-nav" style="display: none;">
            <a href="#agent-summary" class="nav-item active">
                <span class="nav-number">S</span>
                <span class="nav-label">Summary</span>
            </a>
            <a href="#agent-heatmap" class="nav-item">
                <span class="nav-number">H</span>
                <span class="nav-label">Heat Map</span>
            </a>
            <a href="#agent-details" class="nav-item">
                <span class="nav-number">A</span>
                <span class="nav-label">Agent Details</span>
            </a>
        </nav>

        <div class="sidebar-footer">
            <button class="doc-btn" onclick="openDocModal()">
                View Workflow Markdown
            </button>
        </div>
    </aside>

    <!-- Main Content -->
    <main class="main-content">

        <!-- ==================== WORKFLOW TAB ==================== -->
        <div id="workflow-panel" class="tab-panel active">
            <!-- Header -->
            <div class="header">
                <h1>Ordering Transcripts via 8821</h1>
                <p class="subtitle">Complete guide for ordering IRS tax transcripts using Form 8821 through DocuTech and Halcyon Tax Wallet</p>
                <div class="meta">
                    <span class="meta-item">System: Byte LOS / DocuTech / Halcyon</span>
                    <span class="meta-item">Role: Processor</span>
                    <span class="meta-item">Updated: Sep 4, 2024</span>
                    <span class="meta-item">Duration: 10-15 min per borrower</span>
                </div>
            </div>

            <!-- Legend -->
            <div class="legend">
                <div class="legend-item"><div class="legend-color" style="background: linear-gradient(135deg, #22c55e, #16a34a);"></div><span>Start/End</span></div>
                <div class="legend-item"><div class="legend-color" style="background: linear-gradient(135deg, #3b82f6, #2563eb);"></div><span>Action Step</span></div>
                <div class="legend-item"><div class="legend-color" style="background: linear-gradient(135deg, #f59e0b, #d97706);"></div><span>Decision Point</span></div>
                <div class="legend-item"><div class="legend-color" style="background: #111827; border: 2px solid #3b82f6;"></div><span>User Input</span></div>
                <div class="legend-item"><div class="legend-color" style="background: linear-gradient(135deg, #f43f5e, #dc2626);"></div><span>Exception</span></div>
                <div class="legend-item"><div class="legend-color" style="background: linear-gradient(135deg, #14b8a6, #0d9488);"></div><span>Output</span></div>
            </div>

            <!-- Section 1: Send 8821 via DocuTech -->
            <section id="section-1" class="section">
                <div class="section-header">
                    <div class="section-number">1</div>
                    <div class="section-title"><h2>Send 8821 through DocuTech</h2><span>Prepare and send the 8821 form to borrowers for electronic signature</span></div>
                </div>
                <div class="section-content">
                    <div class="workflow-diagram">
                        <div class="flow-row">
                            <div class="flow-node start">Start</div>
                            <span class="flow-arrow">-></span>
                            <div class="flow-node action">Go to Document Preparation</div>
                            <span class="flow-arrow">-></span>
                            <div class="flow-node action">Confirm DocuTech Vendor</div>
                            <span class="flow-arrow">-></span>
                            <div class="flow-node output">Select Package Type: Processing - 8821</div>
                        </div>
                    </div>
                    <div class="info-box">
                        <h4>Navigation Path</h4>
                        <p>Navigate to the <strong>Document Preparation</strong> screen in Byte. This is found under Doc Prep > Document Packages > Document Preparation.</p>
                    </div>
                    <table class="field-table">
                        <thead>
                            <tr>
                                <th>Field</th>
                                <th>Value</th>
                                <th>Notes</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td><strong>Doc Vendor</strong></td>
                                <td>First American Docutech ConformX</td>
                                <td><span class="badge required-badge">Verify Selected</span></td>
                            </tr>
                            <tr>
                                <td><strong>Package Type</strong></td>
                                <td>Processing - 8821</td>
                                <td>Select from dropdown</td>
                            </tr>
                            <tr>
                                <td><strong>Loan Product</strong></td>
                                <td>[Not specified]</td>
                                <td>Auto-populated</td>
                            </tr>
                            <tr>
                                <td><strong>Investor</strong></td>
                                <td>[Not specified]</td>
                                <td>Auto-populated</td>
                            </tr>
                        </tbody>
                    </table>
                    <div class="tip-box">
                        <h4>Contact Information</h4>
                        <p>For DocuTech support, contact: <strong>800-497-3584</strong> (Technical Support) or visit the Docutech Web Site.</p>
                    </div>
                </div>
            </section>

            <!-- Section 2: Preview & Add to Stored Docs -->
            <section id="section-2" class="section">
                <div class="section-header">
                    <div class="section-number">2</div>
                    <div class="section-title"><h2>Preview Document to Add to Stored Docs</h2><span>Generate PDF preview before sending for signature</span></div>
                </div>
                <div class="section-content">
                    <div class="workflow-diagram">
                        <div class="flow-row">
                            <div class="flow-node action">Set Method: Seamless</div>
                            <span class="flow-arrow">-></span>
                            <div class="flow-node action">Set Delivery: PDF</div>
                            <span class="flow-arrow">-></span>
                            <div class="flow-node output">Click Submit</div>
                        </div>
                    </div>
                    <table class="field-table">
                        <thead>
                            <tr>
                                <th>Setting</th>
                                <th>Value</th>
                                <th>Purpose</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td><strong>Method</strong></td>
                                <td>Seamless</td>
                                <td>Enables integrated document generation</td>
                            </tr>
                            <tr>
                                <td><strong>Delivery Option</strong></td>
                                <td>PDF</td>
                                <td>Creates PDF for preview and storage</td>
                            </tr>
                        </tbody>
                    </table>
                    <div class="info-box">
                        <h4>Preview Purpose</h4>
                        <p>This step generates a PDF preview of the 8821 document before sending it for electronic signature. Use this to verify all information is correct and to add to Stored Docs for record keeping.</p>
                    </div>
                </div>
            </section>

            <!-- Section 3: E-Sign Disclosure -->
            <section id="section-3" class="section">
                <div class="section-header">
                    <div class="section-number">3</div>
                    <div class="section-title"><h2>Send 8821 Disclosure for Electronic Signature</h2><span>Configure and send the document for borrower e-signature</span></div>
                </div>
                <div class="section-content">
                    <div class="workflow-diagram">
                        <div class="flow-row">
                            <div class="flow-node action">Set Method: Seamless</div>
                            <span class="flow-arrow">-></span>
                            <div class="flow-node action">Set Delivery: E-Sign</div>
                            <span class="flow-arrow">-></span>
                            <div class="flow-node action">Click Submit</div>
                            <span class="flow-arrow">-></span>
                            <div class="flow-node output">Click OK</div>
                        </div>
                    </div>
                    <table class="field-table">
                        <thead>
                            <tr>
                                <th>Setting</th>
                                <th>Value</th>
                                <th>Purpose</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td><strong>Method</strong></td>
                                <td>Seamless</td>
                                <td>Enables integrated e-signature workflow</td>
                            </tr>
                            <tr>
                                <td><strong>Delivery Option</strong></td>
                                <td>E-Sign</td>
                                <td>Sends document for electronic signature</td>
                            </tr>
                        </tbody>
                    </table>
                    <div class="tip-box">
                        <h4>Auto-Push to Stored Docs</h4>
                        <p>Once all borrowers have signed the 8821, the signed document will be <strong>automatically pushed into Stored Docs</strong>. No manual upload required.</p>
                    </div>
                    <div class="info-box">
                        <h4>Email Notifications</h4>
                        <p>All parties will receive an email notification from <strong>loandocments@cmgfi.com</strong> when the document is sent for signature and when it is completed.</p>
                    </div>
                </div>
            </section>

            <!-- Section 4: Review Executed 8821 -->
            <section id="section-4" class="section">
                <div class="section-header">
                    <div class="section-number">4</div>
                    <div class="section-title"><h2>Reviewing the Executed 8821</h2><span>Understand the 8821 Alt-Package components and verification</span></div>
                </div>
                <div class="section-content">
                    <div class="decision-tree">
                        <h3>Page 1: Halcyon Consent Form (Form 1177)</h3>
                        <ul class="step-list">
                            <li><strong>CMG Mortgage:</strong> Company information pre-populates automatically</li>
                            <li><strong>Authorized Representatives:</strong> James McGowan and Elizabeth Boonin always appear as CMG's authorized representatives</li>
                            <li><strong>Borrower Signature:</strong> Borrower will sign and date at the bottom</li>
                        </ul>
                    </div>

                    <div class="decision-tree">
                        <h3>Page 2: 8821 Tax Authorization Form</h3>
                        <ul class="step-list">
                            <li><strong>Section 1 - Taxpayer Information:</strong> Borrower info pre-populates from loan data</li>
                            <li><strong>Section 2 - Designees:</strong> James McGowan and Elizabeth Boonin appear as authorized designees with their CAF numbers</li>
                            <li><strong>Section 3 - Tax Information:</strong> Borrower must check the authorization checkbox</li>
                            <li><strong>Default Values:</strong> Income, 1040, 2020-2023, and Not Applicable default on every form</li>
                            <li><strong>Borrower Signature:</strong> Borrower will sign and date the form</li>
                        </ul>
                    </div>

                    <table class="field-table">
                        <thead>
                            <tr>
                                <th>Authorized Representative</th>
                                <th>CAF Number</th>
                                <th>PTIN</th>
                                <th>Contact</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td><strong>James McGowan</strong></td>
                                <td>0315-23889R</td>
                                <td>P02537601</td>
                                <td>732-691-4928 / 631-675-1704</td>
                            </tr>
                            <tr>
                                <td><strong>Elizabeth Boonin</strong></td>
                                <td>0310-03870R</td>
                                <td>P01627702</td>
                                <td>732-691-4998 / 631-675-1704</td>
                            </tr>
                        </tbody>
                    </table>

                    <div class="info-box">
                        <h4>Address Information</h4>
                        <p><strong>James McGowan:</strong> 25 Broad Street, Floor 2, Red Bank, NJ 07701<br>
                        <strong>Elizabeth Boonin:</strong> 95 Smithtown Blvd, Smithtown, NY 11787</p>
                    </div>
                </div>
            </section>

            <!-- Section 5: Submit Transcript Order -->
            <section id="section-5" class="section">
                <div class="section-header">
                    <div class="section-number">5</div>
                    <div class="section-title"><h2>Submitting a Transcript Order</h2><span>Create and submit transcript requests through Halcyon Tax Wallet</span></div>
                </div>
                <div class="section-content">
                    <div class="workflow-diagram">
                        <div class="flow-row">
                            <div class="flow-node start">Executed 8821 Received</div>
                            <span class="flow-arrow">-></span>
                            <div class="flow-node action">Login to prod.taxwallet.io</div>
                            <span class="flow-arrow">-></span>
                            <div class="flow-node action">Click Request Transcript</div>
                            <span class="flow-arrow">-></span>
                            <div class="flow-node output">Complete Request Form</div>
                        </div>
                    </div>

                    <div class="info-box">
                        <h4>Halcyon Login</h4>
                        <p>Access Halcyon Tax Wallet at: <strong>prod.taxwallet.io</strong><br>Log in using your Microsoft Credentials.</p>
                    </div>

                    <div class="decision-tree">
                        <h3>Create Request Form</h3>
                        <ul class="step-list">
                            <li><strong>Step 1:</strong> From the Dashboard, click <strong>Request Transcript</strong></li>
                            <li><strong>Step 2:</strong> Enter the complete loan number in the Loan Number box (including prefix and all leading zeros)</li>
                            <li><strong>Step 3:</strong> Click the plus sign next to "Individual Transcripts"</li>
                            <li><strong>Step 4:</strong> Fill in Borrower Information</li>
                            <li><strong>Step 5:</strong> Enter Address on last filed tax return</li>
                            <li><strong>Step 6:</strong> Select Form Types & Available Years</li>
                            <li><strong>Step 7:</strong> Upload required documents</li>
                        </ul>
                    </div>

                    <div class="exception-box">
                        <h4>Important: Separate Requests Required</h4>
                        <p>A separate Individual Transcript Request needs to be created for <strong>each borrower/coborrower</strong> on the loan. The request covers all the form types and years for that borrower/coborrower.</p>
                    </div>

                    <h3 style="color: var(--accent-blue); margin: 25px 0 15px 0;">Borrower Information Fields</h3>
                    <table class="field-table">
                        <thead>
                            <tr>
                                <th>Field</th>
                                <th>Description</th>
                                <th>Status</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td><strong>First Name</strong></td>
                                <td>Exactly as it appears on most recent IRS tax return</td>
                                <td><span class="badge required-badge">Required</span></td>
                            </tr>
                            <tr>
                                <td><strong>Last Name</strong></td>
                                <td>Exactly as it appears on most recent IRS tax return</td>
                                <td><span class="badge required-badge">Required</span></td>
                            </tr>
                            <tr>
                                <td><strong>SSN/TIN</strong></td>
                                <td>Social Security Number or Tax Identification Number exactly as on tax return</td>
                                <td><span class="badge required-badge">Required</span></td>
                            </tr>
                            <tr>
                                <td><strong>Email</strong></td>
                                <td>Do NOT add borrower email</td>
                                <td><span class="badge optional-badge">Do Not Enter</span></td>
                            </tr>
                        </tbody>
                    </table>

                    <h3 style="color: var(--accent-blue); margin: 25px 0 15px 0;">Address on Last Filed Tax Return</h3>
                    <table class="field-table">
                        <thead>
                            <tr>
                                <th>Field</th>
                                <th>Description</th>
                                <th>Status</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td><strong>Address Line 1</strong></td>
                                <td>First line of address as it appears on most recent IRS tax return</td>
                                <td><span class="badge required-badge">Required</span></td>
                            </tr>
                            <tr>
                                <td><strong>Address Line 2</strong></td>
                                <td>Required if borrower included it on their IRS tax return</td>
                                <td><span class="badge optional-badge">Conditional</span></td>
                            </tr>
                            <tr>
                                <td><strong>City</strong></td>
                                <td>As it appears on most recent IRS tax return</td>
                                <td><span class="badge required-badge">Required</span></td>
                            </tr>
                            <tr>
                                <td><strong>State</strong></td>
                                <td>As it appears on most recent IRS tax return</td>
                                <td><span class="badge required-badge">Required</span></td>
                            </tr>
                            <tr>
                                <td><strong>Postal Code</strong></td>
                                <td>As it appears on most recent IRS tax return</td>
                                <td><span class="badge required-badge">Required</span></td>
                            </tr>
                        </tbody>
                    </table>

                    <div class="exception-box">
                        <h4>Foreign Address Restriction</h4>
                        <p>Foreign addresses cannot be processed by the IRS through the borrower/coborrower's tax return at this time. Please use the <strong>No IRS Account</strong> option for a borrower/coborrower who listed a non-US address on their most recent return.</p>
                    </div>

                    <h3 style="color: var(--accent-blue); margin: 25px 0 15px 0;">Form Types & Available Years</h3>
                    <table class="field-table">
                        <thead>
                            <tr>
                                <th>Form Type</th>
                                <th>Description</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td><strong>1040 - Return Transcript</strong></td>
                                <td>Shows most line items from the original tax return</td>
                            </tr>
                            <tr>
                                <td><strong>1040 - Record of Account</strong></td>
                                <td>Combines return transcript and account transcript</td>
                            </tr>
                            <tr>
                                <td><strong>W-2 - Employee Earnings</strong></td>
                                <td>Shows W-2 information reported to IRS</td>
                            </tr>
                            <tr>
                                <td><strong>1099 - Self-Employed Earnings</strong></td>
                                <td>Shows 1099 information for self-employed income</td>
                            </tr>
                            <tr>
                                <td><strong>All Income Data</strong></td>
                                <td>Comprehensive income verification</td>
                            </tr>
                        </tbody>
                    </table>

                    <div class="info-box">
                        <h4>Available Years Default</h4>
                        <p>Available Years defaults to <strong>"Last 2 Years"</strong>. Select specific tax years as needed (2020, 2021, 2022, 2023). Each transcript will be returned in a <strong>separate PDF</strong>.</p>
                    </div>

                    <h3 style="color: var(--accent-blue); margin: 25px 0 15px 0;">Upload Documents</h3>
                    <table class="field-table">
                        <thead>
                            <tr>
                                <th>Document Type</th>
                                <th>What to Upload</th>
                                <th>Accepted Formats</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td><strong>Transcript Authorization</strong></td>
                                <td>Fully executed 8821 form</td>
                                <td>PDF, JPG, JPEG, PNG</td>
                            </tr>
                            <tr>
                                <td><strong>Government Issued Photo ID</strong></td>
                                <td>Fully executed Borrower's Authorization</td>
                                <td>PDF, JPG, JPEG, PNG</td>
                            </tr>
                        </tbody>
                    </table>

                    <div class="tip-box">
                        <h4>Additional Borrowers</h4>
                        <p>Repeat the above steps for all additional borrowers by clicking the <strong>Plus Sign</strong> on the next Individual Transcript Tab. Once all requests are complete, submit the order by clicking the <strong>Submit</strong> button.</p>
                    </div>
                </div>
            </section>

            <!-- Section 6: Check Order Status -->
            <section id="section-6" class="section">
                <div class="section-header">
                    <div class="section-number">6</div>
                    <div class="section-title"><h2>Checking Order Status</h2><span>Monitor the status of your transcript orders</span></div>
                </div>
                <div class="section-content">
                    <div class="workflow-diagram">
                        <div class="flow-row">
                            <div class="flow-node action">Go to Dashboard</div>
                            <span class="flow-arrow">-></span>
                            <div class="flow-node action">Navigate to Requests</div>
                            <span class="flow-arrow">-></span>
                            <div class="flow-node output">View Status Column</div>
                        </div>
                    </div>

                    <div class="info-box">
                        <h4>Request Screen</h4>
                        <p>The Request screen provides a summary and status of each individual order. You can view: Loan Number, Borrower, Loan Professional, Form Type, Tax Year, Request Raised date, Latest Check, Delivery Date, and Status.</p>
                    </div>

                    <h3 style="color: var(--accent-blue); margin: 25px 0 15px 0;">Order Status Values</h3>
                    <table class="field-table">
                        <thead>
                            <tr>
                                <th>Status</th>
                                <th>Description</th>
                                <th>Action Required</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td><strong>Request Submitted</strong></td>
                                <td>Halcyon has received the request</td>
                                <td><span class="badge optional-badge">No Action</span></td>
                            </tr>
                            <tr>
                                <td><strong>Pending IRS Approval</strong></td>
                                <td>The signed 8821 has been submitted to the IRS</td>
                                <td><span class="badge optional-badge">No Action</span></td>
                            </tr>
                            <tr>
                                <td><strong>Ready</strong></td>
                                <td>Request successful - transcripts are complete and available</td>
                                <td><span class="badge required-badge">Retrieve</span></td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </section>

            <!-- Section 7: Retrieve Transcript Order -->
            <section id="section-7" class="section">
                <div class="section-header">
                    <div class="section-number">7</div>
                    <div class="section-title"><h2>Retrieving a Transcript Order</h2><span>Download completed transcripts and upload to Stored Documents</span></div>
                </div>
                <div class="section-content">
                    <div class="workflow-diagram">
                        <div class="flow-row">
                            <div class="flow-node start">Email Notification Received</div>
                            <span class="flow-arrow">-></span>
                            <div class="flow-node action">Click Three Dots Menu</div>
                            <span class="flow-arrow">-></span>
                            <div class="flow-node action">Click View Transcript</div>
                            <span class="flow-arrow">-></span>
                            <div class="flow-node output">Upload to Stored Docs</div>
                        </div>
                    </div>

                    <div class="info-box">
                        <h4>Email Notification</h4>
                        <p>Once the order has been completed, the user that placed the order will receive an email notification from Halcyon Tax Wallet with the loan number and borrower name(s).</p>
                    </div>

                    <ul class="step-list">
                        <li><strong>Step 1:</strong> Receive email notification that transcripts are ready to view and download</li>
                        <li><strong>Step 2:</strong> Log into Halcyon at prod.taxwallet.io</li>
                        <li><strong>Step 3:</strong> Locate the order with "Ready" status</li>
                        <li><strong>Step 4:</strong> Click the <strong>three dots</strong> on the far-right side of the order</li>
                        <li><strong>Step 5:</strong> Click <strong>View Transcript</strong> from the dropdown menu</li>
                        <li><strong>Step 6:</strong> A copy of the transcripts will be added to your downloads</li>
                        <li><strong>Step 7:</strong> Review the PDF version</li>
                        <li><strong>Step 8:</strong> Upload to <strong>Stored Documents</strong> in Byte</li>
                    </ul>

                    <h3 style="color: var(--accent-blue); margin: 25px 0 15px 0;">Available Actions Menu</h3>
                    <table class="field-table">
                        <thead>
                            <tr>
                                <th>Action</th>
                                <th>Description</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td><strong>View Transcript</strong></td>
                                <td>Download the completed transcript PDF</td>
                            </tr>
                            <tr>
                                <td><strong>Reorder</strong></td>
                                <td>Submit a new request for the same borrower</td>
                            </tr>
                            <tr>
                                <td><strong>View Request Details</strong></td>
                                <td>See full details of the original request</td>
                            </tr>
                            <tr>
                                <td><strong>View ID Documents</strong></td>
                                <td>View uploaded identification documents</td>
                            </tr>
                            <tr>
                                <td><strong>New Order</strong></td>
                                <td>Create a new transcript order</td>
                            </tr>
                            <tr>
                                <td><strong>Edit Request</strong></td>
                                <td>Modify the existing request</td>
                            </tr>
                        </tbody>
                    </table>

                    <div class="tip-box">
                        <h4>Support Contact</h4>
                        <p>If you have any questions regarding an order or have trouble accessing the transcripts, contact Halcyon support at: <strong>support@halcyonsw.com</strong> or call <strong>844-880-1040</strong>.<br><br>
                        <strong>Halcyon Still Water LLC</strong><br>
                        25 Broad Street, 2nd Floor<br>
                        Red Bank, NJ 07701</p>
                    </div>
                </div>
            </section>

            <!-- Quick Reference -->
            <div id="quick-ref" class="quick-ref">
                <h3>8821 Transcript Ordering Quick Reference</h3>
                <pre>
8821 TRANSCRIPT ORDERING PROCESS SUMMARY
=========================================

STEP 1: SEND 8821 VIA DOCUTECH
------------------------------
1. Navigate to Document Preparation screen
2. Confirm DocuTech is selected as vendor
3. Select Package Type: Processing - 8821

STEP 2: PREVIEW DOCUMENT
------------------------
- Method: Seamless
- Delivery Option: PDF
- Click Submit

STEP 3: SEND FOR E-SIGNATURE
----------------------------
- Method: Seamless
- Delivery Option: E-Sign
- Click Submit, then OK
- Signed doc auto-pushes to Stored Docs

STEP 4: REVIEW EXECUTED 8821
----------------------------
Page 1: Halcyon Consent Form (1177)
- CMG Mortgage pre-populates
- James McGowan & Elizabeth Boonin listed
- Borrower signs and dates

Page 2: 8821 Tax Authorization Form
- Borrower info pre-populates
- Default: Income, 1040, 2020-2023, Not Applicable
- Borrower checks authorization box
- Borrower signs and dates

STEP 5: SUBMIT TRANSCRIPT ORDER
-------------------------------
Website: prod.taxwallet.io
Login: Microsoft Credentials

Create Request:
[ ] Enter complete loan number (with prefix & zeros)
[ ] Click + Individual Transcripts
[ ] Fill borrower info (exactly as on tax return)
[ ] Enter address from last filed tax return
[ ] Select Form Types & Years
[ ] Upload executed 8821
[ ] Upload Government ID
[ ] Click Submit

NOTE: Create SEPARATE request for each borrower!

FORM TYPES AVAILABLE
--------------------
- 1040 - Return Transcript
- 1040 - Record of Account
- W-2 - Employee Earnings
- 1099 - Self-Employed Earnings
- All Income Data

ORDER STATUS VALUES
-------------------
Request Submitted  -> No action required
Pending IRS Approval -> No action required
Ready              -> Retrieve transcripts!

STEP 6-7: RETRIEVE TRANSCRIPTS
------------------------------
1. Receive email notification
2. Login to prod.taxwallet.io
3. Find order with "Ready" status
4. Click three dots menu
5. Select "View Transcript"
6. Download PDF
7. Upload to Stored Documents

IMPORTANT CONTACTS
==================
DocuTech Support: 800-497-3584
Halcyon Support: support@halcyonsw.com
Halcyon Phone: 844-880-1040

AUTHORIZED REPRESENTATIVES
==========================
James McGowan - CAF: 0315-23889R
Elizabeth Boonin - CAF: 0310-03870R
                </pre>
            </div>
        </div>

        <!-- ==================== AI AGENTS TAB ==================== -->
        <div id="agents-panel" class="tab-panel">
            <!-- Agent Header -->
            <div class="agent-header">
                <h1>AI Agent Opportunities</h1>
                <p class="subtitle">Automation opportunities identified for the 8821 Transcript Ordering process</p>
            </div>

            <!-- Summary Stats -->
            <div class="agent-summary" id="agent-summary">
                <div class="agent-summary-card">
                    <div class="agent-summary-value">4</div>
                    <div class="agent-summary-label">Agent Opportunities</div>
                </div>
                <div class="agent-summary-card">
                    <div class="agent-summary-value">68%</div>
                    <div class="agent-summary-label">Automation Potential</div>
                </div>
                <div class="agent-summary-card">
                    <div class="agent-summary-value">12 min</div>
                    <div class="agent-summary-label">Est. Time Saved</div>
                </div>
                <div class="agent-summary-card">
                    <div class="agent-summary-value">High</div>
                    <div class="agent-summary-label">Compliance Impact</div>
                </div>
            </div>

            <!-- Heat Map Legend -->
            <div class="heat-legend">
                <div class="heat-legend-item">
                    <div class="heat-legend-color" style="background: linear-gradient(90deg, #ef4444, #f97316);"></div>
                    <span>Critical Priority (9-10)</span>
                </div>
                <div class="heat-legend-item">
                    <div class="heat-legend-color" style="background: linear-gradient(90deg, #f97316, #eab308);"></div>
                    <span>High Priority (7-8)</span>
                </div>
                <div class="heat-legend-item">
                    <div class="heat-legend-color" style="background: linear-gradient(90deg, #eab308, #22c55e);"></div>
                    <span>Medium Priority (5-6)</span>
                </div>
                <div class="heat-legend-item">
                    <div class="heat-legend-color" style="background: linear-gradient(90deg, #22c55e, #14b8a6);"></div>
                    <span>Low Priority (1-4)</span>
                </div>
            </div>

            <!-- Heat Map Grid -->
            <div class="heat-map-container" id="agent-heatmap">
                <div class="heat-map-title">Automation Opportunity Heat Map</div>
                <div class="heat-map-grid">
                    <div class="heat-item high" onclick="scrollToAgent('agent-autofill')">
                        <div class="heat-score">8.5</div>
                        <div class="heat-name">Auto-Fill Agent</div>
                        <div class="heat-desc">Pre-populate Halcyon forms from Byte loan data</div>
                        <div class="heat-metrics">
                            <div class="heat-metric">Time: <span>5 min</span></div>
                            <div class="heat-metric">Accuracy: <span>High</span></div>
                        </div>
                    </div>
                    <div class="heat-item high" onclick="scrollToAgent('agent-statusmonitor')">
                        <div class="heat-score">8.0</div>
                        <div class="heat-name">Status Monitor Agent</div>
                        <div class="heat-desc">Track and alert on transcript order status changes</div>
                        <div class="heat-metrics">
                            <div class="heat-metric">Time: <span>3 min</span></div>
                            <div class="heat-metric">Accuracy: <span>High</span></div>
                        </div>
                    </div>
                    <div class="heat-item medium" onclick="scrollToAgent('agent-docmerge')">
                        <div class="heat-score">6.5</div>
                        <div class="heat-name">Doc Merge Agent</div>
                        <div class="heat-desc">Auto-upload transcripts to Stored Docs with correct indexing</div>
                        <div class="heat-metrics">
                            <div class="heat-metric">Time: <span>2 min</span></div>
                            <div class="heat-metric">Accuracy: <span>Med</span></div>
                        </div>
                    </div>
                    <div class="heat-item medium" onclick="scrollToAgent('agent-validation')">
                        <div class="heat-score">6.0</div>
                        <div class="heat-name">8821 Validation Agent</div>
                        <div class="heat-desc">Verify executed 8821 completeness before submission</div>
                        <div class="heat-metrics">
                            <div class="heat-metric">Time: <span>2 min</span></div>
                            <div class="heat-metric">Accuracy: <span>High</span></div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Agent Cards -->
            <div id="agent-details">
                <h2 style="color: var(--text-primary); margin-bottom: 25px; font-size: 1.5rem;">Agent Details</h2>
                <div class="agent-grid">
                    <!-- Auto-Fill Agent -->
                    <div class="agent-card" id="agent-autofill">
                        <div class="agent-card-header">
                            <div class="agent-icon">AI</div>
                            <div class="agent-info">
                                <div class="agent-name">Auto-Fill Agent</div>
                                <div class="agent-type">Data Integration</div>
                            </div>
                            <span class="agent-priority high">High</span>
                        </div>
                        <div class="agent-card-body">
                            <p class="agent-description">Automatically extracts borrower data from Byte LOS and pre-populates the Halcyon Tax Wallet request form, including loan number, borrower information, SSN, and address from most recent tax return.</p>
                            <div class="agent-flow">
                                <div class="agent-flow-title">Agent Workflow</div>
                                <div class="agent-flow-diagram">
                                    <span class="agent-step">Read Byte Data</span>
                                    <span class="agent-arrow">-></span>
                                    <span class="agent-step">Map Fields</span>
                                    <span class="agent-arrow">-></span>
                                    <span class="agent-step">Fill Halcyon Form</span>
                                    <span class="agent-arrow">-></span>
                                    <span class="agent-step">Verify Accuracy</span>
                                </div>
                            </div>
                            <div class="agent-stats">
                                <div class="agent-stat">
                                    <div class="agent-stat-value">5 min</div>
                                    <div class="agent-stat-label">Time Saved</div>
                                </div>
                                <div class="agent-stat">
                                    <div class="agent-stat-value">95%</div>
                                    <div class="agent-stat-label">Accuracy</div>
                                </div>
                                <div class="agent-stat">
                                    <div class="agent-stat-value">Med</div>
                                    <div class="agent-stat-label">Complexity</div>
                                </div>
                            </div>
                            <button class="agent-prompt-btn" onclick="showAgentPrompt('autofill')">
                                View Build Prompt
                            </button>
                        </div>
                    </div>

                    <!-- Status Monitor Agent -->
                    <div class="agent-card" id="agent-statusmonitor">
                        <div class="agent-card-header">
                            <div class="agent-icon">AI</div>
                            <div class="agent-info">
                                <div class="agent-name">Status Monitor Agent</div>
                                <div class="agent-type">Monitoring / Alerts</div>
                            </div>
                            <span class="agent-priority high">High</span>
                        </div>
                        <div class="agent-card-body">
                            <p class="agent-description">Monitors Halcyon Tax Wallet for status changes on transcript orders and sends proactive notifications when orders move to "Ready" status or encounter issues requiring attention.</p>
                            <div class="agent-flow">
                                <div class="agent-flow-title">Agent Workflow</div>
                                <div class="agent-flow-diagram">
                                    <span class="agent-step">Poll Halcyon API</span>
                                    <span class="agent-arrow">-></span>
                                    <span class="agent-step">Detect Changes</span>
                                    <span class="agent-arrow">-></span>
                                    <span class="agent-step">Send Alert</span>
                                    <span class="agent-arrow">-></span>
                                    <span class="agent-step">Log Activity</span>
                                </div>
                            </div>
                            <div class="agent-stats">
                                <div class="agent-stat">
                                    <div class="agent-stat-value">3 min</div>
                                    <div class="agent-stat-label">Time Saved</div>
                                </div>
                                <div class="agent-stat">
                                    <div class="agent-stat-value">99%</div>
                                    <div class="agent-stat-label">Accuracy</div>
                                </div>
                                <div class="agent-stat">
                                    <div class="agent-stat-value">Low</div>
                                    <div class="agent-stat-label">Complexity</div>
                                </div>
                            </div>
                            <button class="agent-prompt-btn" onclick="showAgentPrompt('statusmonitor')">
                                View Build Prompt
                            </button>
                        </div>
                    </div>

                    <!-- Doc Merge Agent -->
                    <div class="agent-card" id="agent-docmerge">
                        <div class="agent-card-header">
                            <div class="agent-icon">AI</div>
                            <div class="agent-info">
                                <div class="agent-name">Doc Merge Agent</div>
                                <div class="agent-type">Document Processing</div>
                            </div>
                            <span class="agent-priority medium">Medium</span>
                        </div>
                        <div class="agent-card-body">
                            <p class="agent-description">Automatically downloads completed transcripts from Halcyon, properly indexes them with document type and borrower information, and uploads to Byte Stored Documents.</p>
                            <div class="agent-flow">
                                <div class="agent-flow-title">Agent Workflow</div>
                                <div class="agent-flow-diagram">
                                    <span class="agent-step">Download PDF</span>
                                    <span class="agent-arrow">-></span>
                                    <span class="agent-step">Parse Metadata</span>
                                    <span class="agent-arrow">-></span>
                                    <span class="agent-step">Index Document</span>
                                    <span class="agent-arrow">-></span>
                                    <span class="agent-step">Upload to Byte</span>
                                </div>
                            </div>
                            <div class="agent-stats">
                                <div class="agent-stat">
                                    <div class="agent-stat-value">2 min</div>
                                    <div class="agent-stat-label">Time Saved</div>
                                </div>
                                <div class="agent-stat">
                                    <div class="agent-stat-value">92%</div>
                                    <div class="agent-stat-label">Accuracy</div>
                                </div>
                                <div class="agent-stat">
                                    <div class="agent-stat-value">Med</div>
                                    <div class="agent-stat-label">Complexity</div>
                                </div>
                            </div>
                            <button class="agent-prompt-btn" onclick="showAgentPrompt('docmerge')">
                                View Build Prompt
                            </button>
                        </div>
                    </div>

                    <!-- 8821 Validation Agent -->
                    <div class="agent-card" id="agent-validation">
                        <div class="agent-card-header">
                            <div class="agent-icon">AI</div>
                            <div class="agent-info">
                                <div class="agent-name">8821 Validation Agent</div>
                                <div class="agent-type">Quality Assurance</div>
                            </div>
                            <span class="agent-priority medium">Medium</span>
                        </div>
                        <div class="agent-card-body">
                            <p class="agent-description">Validates executed 8821 forms for completeness and accuracy before submission, checking for signatures, dates, required checkboxes, and matching borrower information.</p>
                            <div class="agent-flow">
                                <div class="agent-flow-title">Agent Workflow</div>
                                <div class="agent-flow-diagram">
                                    <span class="agent-step">OCR Document</span>
                                    <span class="agent-arrow">-></span>
                                    <span class="agent-step">Check Fields</span>
                                    <span class="agent-arrow">-></span>
                                    <span class="agent-step">Validate Data</span>
                                    <span class="agent-arrow">-></span>
                                    <span class="agent-step">Report Issues</span>
                                </div>
                            </div>
                            <div class="agent-stats">
                                <div class="agent-stat">
                                    <div class="agent-stat-value">2 min</div>
                                    <div class="agent-stat-label">Time Saved</div>
                                </div>
                                <div class="agent-stat">
                                    <div class="agent-stat-value">97%</div>
                                    <div class="agent-stat-label">Accuracy</div>
                                </div>
                                <div class="agent-stat">
                                    <div class="agent-stat-value">Med</div>
                                    <div class="agent-stat-label">Complexity</div>
                                </div>
                            </div>
                            <button class="agent-prompt-btn" onclick="showAgentPrompt('validation')">
                                View Build Prompt
                            </button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </main>

    <!-- Documentation Modal -->
    <div class="modal-overlay" id="docModal">
        <div class="modal">
            <div class="modal-header">
                <h3>8821 Transcript Ordering Documentation</h3>
                <div class="modal-actions">
                    <button class="modal-btn copy" onclick="copyToClipboard()">Copy</button>
                    <button class="modal-btn close" onclick="closeDocModal()">Close</button>
                </div>
            </div>
            <div class="modal-body">
                <pre id="docContent"># Ordering Transcripts via 8821 - Process Documentation

## Overview
This guide covers the complete process for ordering IRS tax transcripts using Form 8821 through DocuTech and Halcyon Tax Wallet.

## Systems Used
- Byte LOS (Document Preparation)
- DocuTech (Document Generation & E-Sign)
- Halcyon Tax Wallet (prod.taxwallet.io)

## Process Steps

### 1. Send 8821 via DocuTech
- Navigate to Document Preparation screen
- Confirm DocuTech vendor selected
- Select Package Type: Processing - 8821

### 2. Preview Document
- Method: Seamless
- Delivery Option: PDF
- Click Submit

### 3. Send for E-Signature
- Method: Seamless
- Delivery Option: E-Sign
- Auto-pushes to Stored Docs when signed

### 4. Submit to Halcyon
- Login: prod.taxwallet.io (Microsoft credentials)
- Create request with complete loan number
- Fill borrower info exactly as on tax return
- Upload executed 8821 and Gov ID
- Submit order

### 5. Monitor Status
- Request Submitted
- Pending IRS Approval
- Ready (retrieve transcripts)

### 6. Retrieve & Store
- Download PDF from Halcyon
- Upload to Byte Stored Documents

## Key Contacts
- DocuTech Support: 800-497-3584
- Halcyon Support: 844-880-1040
- Email: support@halcyonsw.com

## Authorized Representatives
- James McGowan (CAF: 0315-23889R)
- Elizabeth Boonin (CAF: 0310-03870R)</pre>
            </div>
        </div>
    </div>

    <!-- AI Prompt Modal -->
    <div class="modal-overlay prompt-modal" id="promptModal">
        <div class="modal">
            <div class="modal-header">
                <h3 id="promptModalTitle">AI Agent Build Prompt</h3>
                <div class="modal-actions">
                    <button class="modal-btn copy" onclick="copyPromptToClipboard()">Copy Prompt</button>
                    <button class="modal-btn close" onclick="closePromptModal()">Close</button>
                </div>
            </div>
            <div class="modal-body">
                <div class="prompt-tags" id="promptTags"></div>
                <div class="prompt-section">
                    <h4>Agent Purpose</h4>
                    <div class="prompt-box" id="promptPurpose"></div>
                </div>
                <div class="prompt-section">
                    <h4>Full Build Prompt</h4>
                    <div class="prompt-box" id="promptContent"></div>
                </div>
                <div class="prompt-section">
                    <h4>Integration Points</h4>
                    <div class="prompt-box" id="promptIntegration"></div>
                </div>
            </div>
        </div>
    </div>

    <div class="copy-success" id="copySuccess">Copied to clipboard!</div>

    <script>
        // Tab switching
        function switchTab(tab) {
            document.querySelectorAll('.sidebar-tab').forEach(t => t.classList.remove('active'));
            document.querySelectorAll('.tab-panel').forEach(p => p.classList.remove('active'));

            if (tab === 'workflow') {
                document.querySelector('.sidebar-tab:not(.agent-tab)').classList.add('active');
                document.getElementById('workflow-panel').classList.add('active');
                document.getElementById('workflow-nav').style.display = 'block';
                document.getElementById('agents-nav').style.display = 'none';
            } else {
                document.querySelector('.sidebar-tab.agent-tab').classList.add('active');
                document.getElementById('agents-panel').classList.add('active');
                document.getElementById('workflow-nav').style.display = 'none';
                document.getElementById('agents-nav').style.display = 'block';
            }

            window.scrollTo(0, 0);
        }

        // Scroll spy with isScrolling flag and 1000ms timeout
        const sections = document.querySelectorAll('.section, .quick-ref');
        const navItems = document.querySelectorAll('#workflow-nav .nav-item');
        let isScrolling = false;
        let scrollTimeout;

        function updateActiveNav() {
            if (isScrolling) return;

            let current = '';
            sections.forEach(section => {
                const sectionTop = section.offsetTop - 100;
                if (window.scrollY >= sectionTop) current = section.getAttribute('id');
            });
            navItems.forEach(item => {
                item.classList.remove('active');
                if (item.getAttribute('href') === '#' + current) item.classList.add('active');
            });
        }

        // Handle nav click to temporarily disable scroll spy
        navItems.forEach(item => {
            item.addEventListener('click', function(e) {
                isScrolling = true;
                clearTimeout(scrollTimeout);

                // Remove active from all, add to clicked
                navItems.forEach(nav => nav.classList.remove('active'));
                this.classList.add('active');

                // Re-enable scroll spy after 1000ms
                scrollTimeout = setTimeout(() => {
                    isScrolling = false;
                }, 1000);
            });
        });

        window.addEventListener('scroll', updateActiveNav);

        // Modal
        function openDocModal() {
            document.getElementById('docModal').classList.add('show');
            document.body.style.overflow = 'hidden';
        }

        function closeDocModal() {
            document.getElementById('docModal').classList.remove('show');
            document.body.style.overflow = '';
        }

        async function copyToClipboard() {
            try {
                await navigator.clipboard.writeText(document.getElementById('docContent').textContent);
                const success = document.getElementById('copySuccess');
                success.style.display = 'block';
                setTimeout(() => { success.style.display = 'none'; }, 2000);
            } catch (e) { alert('Failed to copy.'); }
        }

        document.addEventListener('keydown', (e) => { if (e.key === 'Escape') { closeDocModal(); closePromptModal(); } });
        document.getElementById('docModal').addEventListener('click', (e) => { if (e.target.id === 'docModal') closeDocModal(); });

        document.addEventListener('DOMContentLoaded', () => { updateActiveNav(); });

        // Scroll to agent card and highlight
        function scrollToAgent(agentId) {
            const agentCard = document.getElementById(agentId);
            if (agentCard) {
                document.querySelectorAll('.agent-card.highlight').forEach(card => {
                    card.classList.remove('highlight');
                });

                agentCard.scrollIntoView({ behavior: 'smooth', block: 'center' });

                setTimeout(() => {
                    agentCard.classList.add('highlight');
                }, 300);

                setTimeout(() => {
                    agentCard.classList.remove('highlight');
                }, 2500);
            }
        }

        // Agent Prompt System
        const agentPrompts = {
            autofill: {
                name: 'Auto-Fill Agent',
                tags: ['Data Integration', 'API', 'Medium Complexity', 'High Priority'],
                purpose: `This agent automatically extracts borrower data from Byte LOS and pre-populates the Halcyon Tax Wallet request form. It maps loan number, borrower names, SSN/TIN, and address information to reduce manual data entry and minimize transcription errors.`,
                prompt: `You are building a Data Integration Agent for CMG Financial's 8821 Transcript Ordering process.

AGENT NAME: Auto-Fill Agent
TYPE: Data Integration / Form Automation

OBJECTIVE:
Create an agent that automatically extracts borrower data from Byte LOS and pre-populates the Halcyon Tax Wallet transcript request form.

INPUT DATA FROM BYTE:
- Loan Number (with prefix and leading zeros)
- Borrower First Name
- Borrower Last Name
- SSN/TIN
- Address Line 1 (from tax return)
- Address Line 2 (if applicable)
- City, State, Postal Code
- Coborrower information (if applicable)

FIELD MAPPING TO HALCYON:
{
  "loan_number": "byte.loan_number",
  "borrower_first_name": "byte.borrower.first_name",
  "borrower_last_name": "byte.borrower.last_name",
  "ssn_tin": "byte.borrower.ssn",
  "address_line_1": "byte.borrower.tax_return_address.line1",
  "address_line_2": "byte.borrower.tax_return_address.line2",
  "city": "byte.borrower.tax_return_address.city",
  "state": "byte.borrower.tax_return_address.state",
  "postal_code": "byte.borrower.tax_return_address.zip"
}

VALIDATION RULES:
- SSN must be 9 digits, format: XXX-XX-XXXX
- Loan number must include prefix and all leading zeros
- Address must match most recent IRS tax return
- Do NOT populate email field

ERROR HANDLING:
- If borrower data incomplete: Flag for manual entry
- If address format invalid: Alert processor
- If foreign address detected: Suggest "No IRS Account" option`,
                integration: `INTEGRATION POINTS:

1. Byte LOS API
   - Read borrower demographics
   - Read loan number and identifiers
   - Read address history for tax return match

2. Halcyon Tax Wallet
   - API endpoint: prod.taxwallet.io/api/requests
   - Form field mapping
   - Session management with Microsoft OAuth

3. Data Validation
   - SSN format validation
   - Address standardization (USPS API)
   - Duplicate request detection

DEPLOYMENT:
- Triggered when user clicks "Request Transcript" in Halcyon
- Browser extension or API integration
- Fallback to manual entry on failure`
            },
            statusmonitor: {
                name: 'Status Monitor Agent',
                tags: ['Monitoring', 'Alerts', 'Low Complexity', 'High Priority'],
                purpose: `This agent monitors Halcyon Tax Wallet for status changes on transcript orders and sends proactive notifications when orders move to "Ready" status or encounter issues. Eliminates manual status checking and ensures timely transcript retrieval.`,
                prompt: `You are building a Monitoring Agent for CMG Financial's 8821 Transcript Ordering process.

AGENT NAME: Status Monitor Agent
TYPE: Monitoring / Push Notifications

OBJECTIVE:
Monitor Halcyon Tax Wallet for transcript order status changes and alert processors when action is required.

MONITORING LOGIC:
1. Poll Halcyon API every 15 minutes
2. Track status changes for all open orders
3. Trigger alerts based on status transitions

STATUS VALUES TO MONITOR:
- Request Submitted -> Pending IRS Approval (INFO)
- Pending IRS Approval -> Ready (ACTION REQUIRED)
- Any status -> Error/Failed (URGENT)

ALERT THRESHOLDS:
- Ready status: Immediate notification to processor
- Pending > 3 days: Warning to processor
- Failed/Error: Urgent alert to processor + supervisor

ALERT CHANNELS:
- Email notification
- Microsoft Teams webhook
- Byte LOS dashboard notification
- SMS (for urgent only)

ALERT MESSAGE FORMAT:
{
  "loan_number": "2026-001234",
  "borrower_name": "John Smith",
  "order_date": "2026-01-25",
  "current_status": "Ready",
  "form_type": "1040 - Return Transcript",
  "tax_year": "2023",
  "processor": "Jane Doe",
  "action_required": "Download and upload to Stored Docs"
}

NOTIFICATION CONTENT:
Subject: [ACTION] Transcript Ready - Loan #2026-001234
Body: Tax transcript for John Smith is ready for download.
      Form Type: 1040 Return Transcript (2023)
      Click here to retrieve: [link to Halcyon]`,
                integration: `INTEGRATION POINTS:

1. Halcyon Tax Wallet API
   - Endpoint: prod.taxwallet.io/api/requests
   - Auth: Microsoft OAuth token
   - Polling interval: 15 minutes

2. Notification Services
   - SendGrid for email
   - Microsoft Graph API for Teams
   - Twilio for SMS (urgent only)

3. Byte LOS
   - Update loan timeline with status
   - Flag loan for processor action

4. Database
   - Store order tracking history
   - Track notification delivery

DEPLOYMENT:
- Scheduled task running every 15 minutes
- Webhook receiver for real-time updates (if available)
- Dashboard for monitoring agent health`
            },
            docmerge: {
                name: 'Doc Merge Agent',
                tags: ['Document Processing', 'Automation', 'Medium Complexity'],
                purpose: `This agent automatically downloads completed transcripts from Halcyon Tax Wallet, properly indexes them with document type, borrower information, and tax year, then uploads to Byte Stored Documents with correct categorization.`,
                prompt: `You are building a Document Processing Agent for CMG Financial's 8821 Transcript Ordering process.

AGENT NAME: Doc Merge Agent
TYPE: Document Processing / Automation

OBJECTIVE:
Automatically download completed transcripts from Halcyon and upload to Byte Stored Documents with proper indexing.

WORKFLOW:
1. Detect "Ready" status in Halcyon
2. Download transcript PDF(s)
3. Parse metadata from filename/content
4. Determine document type and indexing
5. Upload to Byte Stored Documents
6. Update document properties

DOWNLOAD HANDLING:
- Multiple transcripts may be returned per borrower
- Each tax year is a separate PDF
- Filename format: "1040 - Return Transcript_2023 (4).pdf"

DOCUMENT INDEXING FOR BYTE:
{
  "document_type": "IRS Tax Transcript",
  "borrower_name": "parsed from filename or Halcyon",
  "tax_year": "extracted from filename",
  "form_type": "1040 Return Transcript",
  "description": "IRS Tax Transcript - John Smith - 2023",
  "category": "Income Verification",
  "status": "Received"
}

BYTE STORED DOCS UPLOAD:
- Navigate to loan file
- Upload to Stored Documents
- Set document type: "IRS Tax Transcript"
- Set category: "Income Verification"
- Add description with borrower name and year
- Link to income condition if applicable

ERROR HANDLING:
- PDF download failure: Retry 3x, then alert
- Upload failure: Queue for retry
- Duplicate detection: Skip if already uploaded`,
                integration: `INTEGRATION POINTS:

1. Halcyon Tax Wallet
   - Download API: /api/requests/{id}/transcript
   - Auth: Microsoft OAuth
   - Handle multiple file downloads

2. Byte LOS API
   - Stored Documents upload endpoint
   - Document indexing/metadata
   - Condition attachment

3. File Processing
   - PDF parsing for metadata extraction
   - Filename parsing for tax year/type
   - Temporary file storage

4. Logging
   - Track all downloads and uploads
   - Audit trail for compliance

DEPLOYMENT:
- Triggered by Status Monitor Agent
- Or manual trigger from Halcyon
- Queue-based processing for reliability`
            },
            validation: {
                name: '8821 Validation Agent',
                tags: ['Quality Assurance', 'OCR', 'Medium Complexity'],
                purpose: `This agent validates executed 8821 forms for completeness and accuracy before submission to Halcyon. Uses OCR to check for signatures, dates, required checkboxes, and matching borrower information to prevent rejection and delays.`,
                prompt: `You are building a Quality Assurance Agent for CMG Financial's 8821 Transcript Ordering process.

AGENT NAME: 8821 Validation Agent
TYPE: Quality Assurance / Document Validation

OBJECTIVE:
Validate executed 8821 forms for completeness before submission to ensure IRS acceptance and prevent processing delays.

VALIDATION CHECKLIST:

Page 1 - Halcyon Consent Form (1177):
[ ] CMG Mortgage information present
[ ] Authorized representatives listed (McGowan & Boonin)
[ ] Borrower signature present
[ ] Borrower signature date present
[ ] Date is within acceptable range (not future, not > 120 days old)

Page 2 - 8821 Tax Authorization Form:
[ ] Section 1: Taxpayer name matches loan file
[ ] Section 1: Address present
[ ] Section 1: SSN/TIN present (masked OK)
[ ] Section 2: Designees listed (McGowan & Boonin)
[ ] Section 3: Authorization checkbox checked
[ ] Section 3: Tax matters row completed (Income, 1040, years)
[ ] Section 6: Signature present
[ ] Section 6: Signature date present
[ ] Section 6: Print name matches signature

OCR EXTRACTION POINTS:
{
  "borrower_name": "Section 1, Line 1",
  "borrower_address": "Section 1, Lines 2-3",
  "ssn_present": "Section 1, TIN field",
  "authorization_checked": "Section 3, checkbox",
  "tax_years": "Section 3, column c",
  "signature_present": "Section 6, signature line",
  "signature_date": "Section 6, date field",
  "print_name": "Section 6, print name field"
}

VALIDATION RULES:
- Signature date must be within 120 days
- Borrower name must match Byte loan file
- SSN must be present (can be partially masked)
- Authorization checkbox MUST be checked
- At least one tax year must be selected

OUTPUT:
{
  "validation_status": "PASS" | "FAIL" | "NEEDS_REVIEW",
  "issues_found": ["Missing signature date", "Checkbox not checked"],
  "confidence_score": 0.95,
  "recommendations": ["Resend for signature"]
}`,
                integration: `INTEGRATION POINTS:

1. Document Source
   - Byte Stored Documents
   - DocuTech completed packages
   - Direct PDF upload

2. OCR Service
   - Azure Form Recognizer
   - AWS Textract
   - Custom trained model for 8821

3. Byte LOS
   - Compare extracted data to loan file
   - Update document status based on validation
   - Flag issues for processor

4. Halcyon Submission
   - Block submission if validation fails
   - Auto-submit if validation passes (optional)

DEPLOYMENT:
- Pre-submission validation trigger
- Batch validation for auditing
- Real-time feedback during upload`
            }
        };

        function showAgentPrompt(agentId) {
            const agent = agentPrompts[agentId];
            if (!agent) return;

            document.getElementById('promptModalTitle').textContent = agent.name + ' - Build Prompt';
            document.getElementById('promptTags').innerHTML = agent.tags.map(tag => `<span class="prompt-tag">${tag}</span>`).join('');
            document.getElementById('promptPurpose').textContent = agent.purpose;
            document.getElementById('promptContent').textContent = agent.prompt;
            document.getElementById('promptIntegration').textContent = agent.integration;

            document.getElementById('promptModal').classList.add('show');
            document.body.style.overflow = 'hidden';
        }

        function closePromptModal() {
            document.getElementById('promptModal').classList.remove('show');
            document.body.style.overflow = '';
        }

        async function copyPromptToClipboard() {
            const content = document.getElementById('promptContent').textContent;
            try {
                await navigator.clipboard.writeText(content);
                const success = document.getElementById('copySuccess');
                success.style.display = 'block';
                setTimeout(() => { success.style.display = 'none'; }, 2000);
            } catch (e) { alert('Failed to copy.'); }
        }

        document.getElementById('promptModal').addEventListener('click', (e) => { if (e.target.id === 'promptModal') closePromptModal(); });
    </script>
</body>
</html>
